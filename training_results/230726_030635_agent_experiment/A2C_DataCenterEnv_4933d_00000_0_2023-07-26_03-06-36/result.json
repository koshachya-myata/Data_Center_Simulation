{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.47784423828125, "policy_loss": -66707.703125, "vf_loss": 2138338.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "sampler_results": {"episode_reward_max": -516.7663017027915, "episode_reward_min": -832.3019515057898, "episode_reward_mean": -726.9674656487826, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.948007166220542, "mean_inference_ms": 0.40789258116830424, "mean_action_processing_ms": 0.09720939678498582, "mean_env_wait_ms": 10.499754110531795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034411748250325522, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06800492604573567}}, "episode_reward_max": -516.7663017027915, "episode_reward_min": -832.3019515057898, "episode_reward_mean": -726.9674656487826, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.948007166220542, "mean_inference_ms": 0.40789258116830424, "mean_action_processing_ms": 0.09720939678498582, "mean_env_wait_ms": 10.499754110531795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034411748250325522, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06800492604573567}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 31.09559098562588, "num_env_steps_trained_throughput_per_sec": 31.09559098562588, "timesteps_total": 220920, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 220920, "timers": {"training_iteration_time_ms": 3859.053, "sample_time_ms": 3850.648, "load_time_ms": 0.323, "load_throughput": 371908.729, "learn_time_ms": 7.326, "learn_throughput": 16380.978, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "done": false, "episodes_total": 1841, "training_iteration": 461, "trial_id": "4933d_00000", "date": "2023-07-26_03-06-54", "timestamp": 1690330014, "time_this_iter_s": 11.579649925231934, "time_total_s": 5632.9051258563995, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.579649925231934, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.55294117647059, "ram_util_percent": 75.34117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5335693359375, "policy_loss": -72109.9609375, "vf_loss": 2639655.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "sampler_results": {"episode_reward_max": -516.7663017027915, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -799.433660615806, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.114084693436748, "mean_inference_ms": 0.40710977562991923, "mean_action_processing_ms": 0.09713724903863978, "mean_env_wait_ms": 7.919564981678485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003787449428013393, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.0677347183227539}}, "episode_reward_max": -516.7663017027915, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -799.433660615806, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.114084693436748, "mean_inference_ms": 0.40710977562991923, "mean_action_processing_ms": 0.09713724903863978, "mean_env_wait_ms": 7.919564981678485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003787449428013393, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.0677347183227539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.61128102973862, "num_env_steps_trained_throughput_per_sec": 40.61128102973862, "timesteps_total": 221400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221400, "timers": {"training_iteration_time_ms": 3342.355, "sample_time_ms": 3336.602, "load_time_ms": 0.264, "load_throughput": 454198.19, "learn_time_ms": 4.755, "learn_throughput": 25236.486, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "done": false, "episodes_total": 1845, "training_iteration": 462, "trial_id": "4933d_00000", "date": "2023-07-26_03-07-06", "timestamp": 1690330026, "time_this_iter_s": 11.821635007858276, "time_total_s": 5644.726760864258, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 23.40128493309021, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.51764705882353, "ram_util_percent": 74.68823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.49932861328125, "policy_loss": -68705.796875, "vf_loss": 2676481.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "sampler_results": {"episode_reward_max": -516.7663017027915, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -778.7328988147747, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.204982204830248, "mean_inference_ms": 0.40455234586266137, "mean_action_processing_ms": 0.09675035929398042, "mean_env_wait_ms": 6.780088555897527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003910064697265625, "StateBufferConnector_ms": 0.002774325284090909, "ViewRequirementAgentConnector_ms": 0.06705414165150035}}, "episode_reward_max": -516.7663017027915, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -778.7328988147747, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.204982204830248, "mean_inference_ms": 0.40455234586266137, "mean_action_processing_ms": 0.09675035929398042, "mean_env_wait_ms": 6.780088555897527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003910064697265625, "StateBufferConnector_ms": 0.002774325284090909, "ViewRequirementAgentConnector_ms": 0.06705414165150035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.27556772647503, "num_env_steps_trained_throughput_per_sec": 40.27556772647503, "timesteps_total": 221880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221880, "timers": {"training_iteration_time_ms": 2959.495, "sample_time_ms": 2955.693, "load_time_ms": 0.22, "load_throughput": 546133.333, "learn_time_ms": 2.85, "learn_throughput": 42110.429, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "done": false, "episodes_total": 1849, "training_iteration": 463, "trial_id": "4933d_00000", "date": "2023-07-26_03-07-17", "timestamp": 1690330037, "time_this_iter_s": 11.920289039611816, "time_total_s": 5656.64704990387, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 35.321573972702026, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.329411764705874, "ram_util_percent": 75.18823529411766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5007019042969, "policy_loss": -105477.484375, "vf_loss": 4693829.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "sampler_results": {"episode_reward_max": -516.7663017027915, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -750.7813321366684, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.2185946597726, "mean_inference_ms": 0.4029542483774903, "mean_action_processing_ms": 0.09646210167047314, "mean_env_wait_ms": 6.096404915758684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039450327555338545, "StateBufferConnector_ms": 0.002915064493815104, "ViewRequirementAgentConnector_ms": 0.07047653198242188}}, "episode_reward_max": -516.7663017027915, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -750.7813321366684, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.2185946597726, "mean_inference_ms": 0.4029542483774903, "mean_action_processing_ms": 0.09646210167047314, "mean_env_wait_ms": 6.096404915758684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039450327555338545, "StateBufferConnector_ms": 0.002915064493815104, "ViewRequirementAgentConnector_ms": 0.07047653198242188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.37156764091477, "num_env_steps_trained_throughput_per_sec": 41.37156764091477, "timesteps_total": 222360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222360, "timers": {"training_iteration_time_ms": 2954.23, "sample_time_ms": 2950.425, "load_time_ms": 0.221, "load_throughput": 543890.728, "learn_time_ms": 2.845, "learn_throughput": 42178.89, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "done": false, "episodes_total": 1853, "training_iteration": 464, "trial_id": "4933d_00000", "date": "2023-07-26_03-07-29", "timestamp": 1690330049, "time_this_iter_s": 11.604647874832153, "time_total_s": 5668.251697778702, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 46.92622184753418, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.425, "ram_util_percent": 74.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.49041748046875, "policy_loss": -130294.625, "vf_loss": 7203874.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "sampler_results": {"episode_reward_max": -516.7663017027915, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -746.5330014383129, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.20190657268262, "mean_inference_ms": 0.40195784308325627, "mean_action_processing_ms": 0.09629314877266792, "mean_env_wait_ms": 5.6287021533228545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003844813296669408, "StateBufferConnector_ms": 0.0028974131533974095, "ViewRequirementAgentConnector_ms": 0.06970606352153577}}, "episode_reward_max": -516.7663017027915, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -746.5330014383129, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.20190657268262, "mean_inference_ms": 0.40195784308325627, "mean_action_processing_ms": 0.09629314877266792, "mean_env_wait_ms": 5.6287021533228545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003844813296669408, "StateBufferConnector_ms": 0.0028974131533974095, "ViewRequirementAgentConnector_ms": 0.06970606352153577}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.90598550535825, "num_env_steps_trained_throughput_per_sec": 41.90598550535825, "timesteps_total": 222840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222840, "timers": {"training_iteration_time_ms": 2899.595, "sample_time_ms": 2895.831, "load_time_ms": 0.219, "load_throughput": 548275.033, "learn_time_ms": 2.813, "learn_throughput": 42658.639, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "done": false, "episodes_total": 1857, "training_iteration": 465, "trial_id": "4933d_00000", "date": "2023-07-26_03-07-41", "timestamp": 1690330061, "time_this_iter_s": 11.456598997116089, "time_total_s": 5679.708296775818, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.38282084465027, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.752941176470586, "ram_util_percent": 74.04705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.51654052734375, "policy_loss": -80577.859375, "vf_loss": 3271842.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "sampler_results": {"episode_reward_max": -476.80914048681944, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -711.5549109539916, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.180303221950705, "mean_inference_ms": 0.4010886274720989, "mean_action_processing_ms": 0.09613101313727541, "mean_env_wait_ms": 5.284569471603021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037556109221085258, "StateBufferConnector_ms": 0.0028382176938264265, "ViewRequirementAgentConnector_ms": 0.0692699266516644}}, "episode_reward_max": -476.80914048681944, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -711.5549109539916, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.180303221950705, "mean_inference_ms": 0.4010886274720989, "mean_action_processing_ms": 0.09613101313727541, "mean_env_wait_ms": 5.284569471603021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037556109221085258, "StateBufferConnector_ms": 0.0028382176938264265, "ViewRequirementAgentConnector_ms": 0.0692699266516644}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.7971774292916, "num_env_steps_trained_throughput_per_sec": 41.7971774292916, "timesteps_total": 223320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223320, "timers": {"training_iteration_time_ms": 2868.653, "sample_time_ms": 2864.924, "load_time_ms": 0.219, "load_throughput": 548813.085, "learn_time_ms": 2.777, "learn_throughput": 43204.615, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "done": false, "episodes_total": 1861, "training_iteration": 466, "trial_id": "4933d_00000", "date": "2023-07-26_03-07-52", "timestamp": 1690330072, "time_this_iter_s": 11.486515045166016, "time_total_s": 5691.194811820984, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 69.86933588981628, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 75.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.513916015625, "policy_loss": -109008.15625, "vf_loss": 5765398.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -708.6363309203414, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.16993324628079, "mean_inference_ms": 0.400507605930017, "mean_action_processing_ms": 0.09601725785332185, "mean_env_wait_ms": 5.020825557345478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038164633291739004, "StateBufferConnector_ms": 0.0028212865193684897, "ViewRequirementAgentConnector_ms": 0.0688243795324255}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -708.6363309203414, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.16993324628079, "mean_inference_ms": 0.400507605930017, "mean_action_processing_ms": 0.09601725785332185, "mean_env_wait_ms": 5.020825557345478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038164633291739004, "StateBufferConnector_ms": 0.0028212865193684897, "ViewRequirementAgentConnector_ms": 0.0688243795324255}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.76023570355022, "num_env_steps_trained_throughput_per_sec": 40.76023570355022, "timesteps_total": 223800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223800, "timers": {"training_iteration_time_ms": 2900.766, "sample_time_ms": 2897.034, "load_time_ms": 0.219, "load_throughput": 546845.372, "learn_time_ms": 2.766, "learn_throughput": 43376.638, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "done": false, "episodes_total": 1865, "training_iteration": 467, "trial_id": "4933d_00000", "date": "2023-07-26_03-08-04", "timestamp": 1690330084, "time_this_iter_s": 11.779093980789185, "time_total_s": 5702.973905801773, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.64842987060547, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.93529411764706, "ram_util_percent": 75.46470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.46728515625, "policy_loss": -87493.40625, "vf_loss": 3783901.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -720.149253107068, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.169390769287688, "mean_inference_ms": 0.4005602267838083, "mean_action_processing_ms": 0.09601146358947855, "mean_env_wait_ms": 4.811686034765154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038900683003087197, "StateBufferConnector_ms": 0.002829490169402092, "ViewRequirementAgentConnector_ms": 0.06888604933215726}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -720.149253107068, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.169390769287688, "mean_inference_ms": 0.4005602267838083, "mean_action_processing_ms": 0.09601146358947855, "mean_env_wait_ms": 4.811686034765154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038900683003087197, "StateBufferConnector_ms": 0.002829490169402092, "ViewRequirementAgentConnector_ms": 0.06888604933215726}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.255488009828, "num_env_steps_trained_throughput_per_sec": 40.255488009828, "timesteps_total": 224280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224280, "timers": {"training_iteration_time_ms": 2936.518, "sample_time_ms": 2932.729, "load_time_ms": 0.221, "load_throughput": 542366.897, "learn_time_ms": 2.802, "learn_throughput": 42828.155, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "done": false, "episodes_total": 1869, "training_iteration": 468, "trial_id": "4933d_00000", "date": "2023-07-26_03-08-16", "timestamp": 1690330096, "time_this_iter_s": 11.926440000534058, "time_total_s": 5714.900345802307, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 93.57486987113953, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.55882352941177, "ram_util_percent": 74.68235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4579772949219, "policy_loss": -85918.8359375, "vf_loss": 3462726.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -718.6832946764124, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.16895685048088, "mean_inference_ms": 0.40052664345482897, "mean_action_processing_ms": 0.09598750405840932, "mean_env_wait_ms": 4.640605135990203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003822871616908482, "StateBufferConnector_ms": 0.002818788800920759, "ViewRequirementAgentConnector_ms": 0.06855692182268415}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -718.6832946764124, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.16895685048088, "mean_inference_ms": 0.40052664345482897, "mean_action_processing_ms": 0.09598750405840932, "mean_env_wait_ms": 4.640605135990203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003822871616908482, "StateBufferConnector_ms": 0.002818788800920759, "ViewRequirementAgentConnector_ms": 0.06855692182268415}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.00683766425189, "num_env_steps_trained_throughput_per_sec": 41.00683766425189, "timesteps_total": 224760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224760, "timers": {"training_iteration_time_ms": 2968.498, "sample_time_ms": 2964.623, "load_time_ms": 0.225, "load_throughput": 533230.724, "learn_time_ms": 2.862, "learn_throughput": 41934.304, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "done": false, "episodes_total": 1873, "training_iteration": 469, "trial_id": "4933d_00000", "date": "2023-07-26_03-08-28", "timestamp": 1690330108, "time_this_iter_s": 11.707812070846558, "time_total_s": 5726.608157873154, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 105.28268194198608, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 39.237500000000004, "ram_util_percent": 75.00625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4820251464844, "policy_loss": -105896.9765625, "vf_loss": 5157160.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -721.0819868047931, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.166637965914568, "mean_inference_ms": 0.4005930098376348, "mean_action_processing_ms": 0.09598257677625378, "mean_env_wait_ms": 4.496642065111934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003812251946864984, "StateBufferConnector_ms": 0.0028200638599884817, "ViewRequirementAgentConnector_ms": 0.06872201577211037}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1077.3051231289764, "episode_reward_mean": -721.0819868047931, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.166637965914568, "mean_inference_ms": 0.4005930098376348, "mean_action_processing_ms": 0.09598257677625378, "mean_env_wait_ms": 4.496642065111934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003812251946864984, "StateBufferConnector_ms": 0.0028200638599884817, "ViewRequirementAgentConnector_ms": 0.06872201577211037}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.46294744205963, "num_env_steps_trained_throughput_per_sec": 41.46294744205963, "timesteps_total": 225240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225240, "timers": {"training_iteration_time_ms": 2930.919, "sample_time_ms": 2927.058, "load_time_ms": 0.223, "load_throughput": 537329.433, "learn_time_ms": 2.855, "learn_throughput": 42028.498, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "done": false, "episodes_total": 1877, "training_iteration": 470, "trial_id": "4933d_00000", "date": "2023-07-26_03-08-39", "timestamp": 1690330119, "time_this_iter_s": 11.579179048538208, "time_total_s": 5738.187336921692, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.86186099052429, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.48823529411764, "ram_util_percent": 73.53529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.47894287109375, "policy_loss": -75453.21875, "vf_loss": 2234413.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1090.4316705633207, "episode_reward_mean": -729.2261004006598, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.173642946695505, "mean_inference_ms": 0.40094248968659485, "mean_action_processing_ms": 0.09601810304703724, "mean_env_wait_ms": 4.374274912201193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038535095924554868, "StateBufferConnector_ms": 0.0028083490770916607, "ViewRequirementAgentConnector_ms": 0.06859025289846021}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1090.4316705633207, "episode_reward_mean": -729.2261004006598, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.173642946695505, "mean_inference_ms": 0.40094248968659485, "mean_action_processing_ms": 0.09601810304703724, "mean_env_wait_ms": 4.374274912201193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038535095924554868, "StateBufferConnector_ms": 0.0028083490770916607, "ViewRequirementAgentConnector_ms": 0.06859025289846021}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.329419794795136, "num_env_steps_trained_throughput_per_sec": 39.329419794795136, "timesteps_total": 225720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225720, "timers": {"training_iteration_time_ms": 2957.926, "sample_time_ms": 2954.035, "load_time_ms": 0.229, "load_throughput": 525108.482, "learn_time_ms": 2.887, "learn_throughput": 41562.741, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "done": false, "episodes_total": 1881, "training_iteration": 471, "trial_id": "4933d_00000", "date": "2023-07-26_03-08-51", "timestamp": 1690330131, "time_this_iter_s": 12.20723819732666, "time_total_s": 5750.394575119019, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 129.06909918785095, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 52.4, "ram_util_percent": 74.76470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.50872802734375, "policy_loss": -178029.0625, "vf_loss": 12374335.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -754.9909258450123, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.17619506523432, "mean_inference_ms": 0.4013849663524126, "mean_action_processing_ms": 0.09607435032389865, "mean_env_wait_ms": 4.269087744559097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038633955285904257, "StateBufferConnector_ms": 0.002847326562759724, "ViewRequirementAgentConnector_ms": 0.06942596841365734}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -754.9909258450123, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.17619506523432, "mean_inference_ms": 0.4013849663524126, "mean_action_processing_ms": 0.09607435032389865, "mean_env_wait_ms": 4.269087744559097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038633955285904257, "StateBufferConnector_ms": 0.002847326562759724, "ViewRequirementAgentConnector_ms": 0.06942596841365734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.535085848057534, "num_env_steps_trained_throughput_per_sec": 41.535085848057534, "timesteps_total": 226200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226200, "timers": {"training_iteration_time_ms": 2957.556, "sample_time_ms": 2953.642, "load_time_ms": 0.229, "load_throughput": 523089.254, "learn_time_ms": 2.909, "learn_throughput": 41253.42, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "done": false, "episodes_total": 1885, "training_iteration": 472, "trial_id": "4933d_00000", "date": "2023-07-26_03-09-03", "timestamp": 1690330143, "time_this_iter_s": 11.559193134307861, "time_total_s": 5761.953768253326, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 140.6282923221588, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.7764705882353, "ram_util_percent": 74.36470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5054931640625, "policy_loss": -87792.7265625, "vf_loss": 3310052.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -751.8174665607024, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.17861477468854, "mean_inference_ms": 0.4016217371749357, "mean_action_processing_ms": 0.09610054379387521, "mean_env_wait_ms": 4.177517902670324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003882015452665441, "StateBufferConnector_ms": 0.0028488682765586706, "ViewRequirementAgentConnector_ms": 0.06916709974700329}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -751.8174665607024, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.17861477468854, "mean_inference_ms": 0.4016217371749357, "mean_action_processing_ms": 0.09610054379387521, "mean_env_wait_ms": 4.177517902670324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003882015452665441, "StateBufferConnector_ms": 0.0028488682765586706, "ViewRequirementAgentConnector_ms": 0.06916709974700329}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.86911212345397, "num_env_steps_trained_throughput_per_sec": 40.86911212345397, "timesteps_total": 226680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226680, "timers": {"training_iteration_time_ms": 2903.748, "sample_time_ms": 2899.906, "load_time_ms": 0.224, "load_throughput": 535842.095, "learn_time_ms": 2.857, "learn_throughput": 41999.74, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "done": false, "episodes_total": 1889, "training_iteration": 473, "trial_id": "4933d_00000", "date": "2023-07-26_03-09-15", "timestamp": 1690330155, "time_this_iter_s": 11.747379064559937, "time_total_s": 5773.701147317886, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 152.37567138671875, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 38.025000000000006, "ram_util_percent": 73.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.48004150390625, "policy_loss": -87000.390625, "vf_loss": 3776084.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -747.8455916112425, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.18163392406409, "mean_inference_ms": 0.40170579051213157, "mean_action_processing_ms": 0.09610287801533743, "mean_env_wait_ms": 4.097338837828555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003832036798650568, "StateBufferConnector_ms": 0.002846284346147017, "ViewRequirementAgentConnector_ms": 0.06895715540105646}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -747.8455916112425, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.18163392406409, "mean_inference_ms": 0.40170579051213157, "mean_action_processing_ms": 0.09610287801533743, "mean_env_wait_ms": 4.097338837828555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003832036798650568, "StateBufferConnector_ms": 0.002846284346147017, "ViewRequirementAgentConnector_ms": 0.06895715540105646}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.530541345848135, "num_env_steps_trained_throughput_per_sec": 40.530541345848135, "timesteps_total": 227160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227160, "timers": {"training_iteration_time_ms": 2925.406, "sample_time_ms": 2921.637, "load_time_ms": 0.221, "load_throughput": 542250.032, "learn_time_ms": 2.815, "learn_throughput": 42627.207, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "done": false, "episodes_total": 1893, "training_iteration": 474, "trial_id": "4933d_00000", "date": "2023-07-26_03-09-27", "timestamp": 1690330167, "time_this_iter_s": 11.845343112945557, "time_total_s": 5785.546490430832, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 164.2210144996643, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.13529411764706, "ram_util_percent": 75.88235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5197448730469, "policy_loss": -130627.7734375, "vf_loss": 7537644.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -756.0671044068513, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.189254700344918, "mean_inference_ms": 0.40172649847410136, "mean_action_processing_ms": 0.09609489838870645, "mean_env_wait_ms": 4.025953160870044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038033824855998413, "StateBufferConnector_ms": 0.002839201587741658, "ViewRequirementAgentConnector_ms": 0.06885892253811077}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -756.0671044068513, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.189254700344918, "mean_inference_ms": 0.40172649847410136, "mean_action_processing_ms": 0.09609489838870645, "mean_env_wait_ms": 4.025953160870044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038033824855998413, "StateBufferConnector_ms": 0.002839201587741658, "ViewRequirementAgentConnector_ms": 0.06885892253811077}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.221217430599154, "num_env_steps_trained_throughput_per_sec": 39.221217430599154, "timesteps_total": 227640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227640, "timers": {"training_iteration_time_ms": 2994.581, "sample_time_ms": 2990.809, "load_time_ms": 0.222, "load_throughput": 540155.055, "learn_time_ms": 2.812, "learn_throughput": 42677.448, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "done": false, "episodes_total": 1897, "training_iteration": 475, "trial_id": "4933d_00000", "date": "2023-07-26_03-09-39", "timestamp": 1690330179, "time_this_iter_s": 12.24081039428711, "time_total_s": 5797.787300825119, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 176.46182489395142, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 45.27222222222222, "ram_util_percent": 76.00555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5089416503906, "policy_loss": -101965.71875, "vf_loss": 5050029.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -756.6200726503705, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.196495632661886, "mean_inference_ms": 0.40182249657422703, "mean_action_processing_ms": 0.09609926241244625, "mean_env_wait_ms": 3.9621189094348908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038510277157738095, "StateBufferConnector_ms": 0.0028477774726019967, "ViewRequirementAgentConnector_ms": 0.06930865938701326}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -756.6200726503705, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.196495632661886, "mean_inference_ms": 0.40182249657422703, "mean_action_processing_ms": 0.09609926241244625, "mean_env_wait_ms": 3.9621189094348908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038510277157738095, "StateBufferConnector_ms": 0.0028477774726019967, "ViewRequirementAgentConnector_ms": 0.06930865938701326}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120, "num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.47316510152568, "num_env_steps_trained_throughput_per_sec": 40.47316510152568, "timesteps_total": 228120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 228120, "timers": {"training_iteration_time_ms": 3011.178, "sample_time_ms": 3007.326, "load_time_ms": 0.229, "load_throughput": 523960.525, "learn_time_ms": 2.87, "learn_throughput": 41807.167, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120}, "done": false, "episodes_total": 1901, "training_iteration": 476, "trial_id": "4933d_00000", "date": "2023-07-26_03-09-51", "timestamp": 1690330191, "time_this_iter_s": 11.862380027770996, "time_total_s": 5809.64968085289, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 188.3242049217224, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.10588235294117, "ram_util_percent": 76.88235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.51690673828125, "policy_loss": -118451.828125, "vf_loss": 6056355.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -757.5295316905978, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.201221756019436, "mean_inference_ms": 0.401910853542313, "mean_action_processing_ms": 0.09611071539011447, "mean_env_wait_ms": 3.904677191287151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003870565499832381, "StateBufferConnector_ms": 0.0028499916418274836, "ViewRequirementAgentConnector_ms": 0.0691396086963255}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -757.5295316905978, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.201221756019436, "mean_inference_ms": 0.401910853542313, "mean_action_processing_ms": 0.09611071539011447, "mean_env_wait_ms": 3.904677191287151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003870565499832381, "StateBufferConnector_ms": 0.0028499916418274836, "ViewRequirementAgentConnector_ms": 0.0691396086963255}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600, "num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.50462834020196, "num_env_steps_trained_throughput_per_sec": 41.50462834020196, "timesteps_total": 228600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 228600, "timers": {"training_iteration_time_ms": 2989.671, "sample_time_ms": 2985.8, "load_time_ms": 0.231, "load_throughput": 520277.527, "learn_time_ms": 2.882, "learn_throughput": 41633.564, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600}, "done": false, "episodes_total": 1905, "training_iteration": 477, "trial_id": "4933d_00000", "date": "2023-07-26_03-10-02", "timestamp": 1690330202, "time_this_iter_s": 11.567615032196045, "time_total_s": 5821.217295885086, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 199.89181995391846, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 35.643750000000004, "ram_util_percent": 75.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4913635253906, "policy_loss": -77238.1328125, "vf_loss": 2608886.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -758.0303356726897, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.20454895752934, "mean_inference_ms": 0.4019615030435452, "mean_action_processing_ms": 0.0961161857603773, "mean_env_wait_ms": 3.852489164713163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038489489488198725, "StateBufferConnector_ms": 0.002850277323118398, "ViewRequirementAgentConnector_ms": 0.06907557097958847}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -758.0303356726897, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.20454895752934, "mean_inference_ms": 0.4019615030435452, "mean_action_processing_ms": 0.0961161857603773, "mean_env_wait_ms": 3.852489164713163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038489489488198725, "StateBufferConnector_ms": 0.002850277323118398, "ViewRequirementAgentConnector_ms": 0.06907557097958847}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.3509707701629, "num_env_steps_trained_throughput_per_sec": 41.3509707701629, "timesteps_total": 229080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 229080, "timers": {"training_iteration_time_ms": 2926.196, "sample_time_ms": 2922.394, "load_time_ms": 0.226, "load_throughput": 531485.195, "learn_time_ms": 2.834, "learn_throughput": 42336.772, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "done": false, "episodes_total": 1909, "training_iteration": 478, "trial_id": "4933d_00000", "date": "2023-07-26_03-10-14", "timestamp": 1690330214, "time_this_iter_s": 11.610552072525024, "time_total_s": 5832.827847957611, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 211.50237202644348, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 37.14117647058824, "ram_util_percent": 74.06470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.50982666015625, "policy_loss": -109584.78125, "vf_loss": 5639707.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -755.1752724483107, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.209933324496983, "mean_inference_ms": 0.4019756559627141, "mean_action_processing_ms": 0.09611452067165317, "mean_env_wait_ms": 3.80519045751316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038232803344726562, "StateBufferConnector_ms": 0.0028498967488606772, "ViewRequirementAgentConnector_ms": 0.06900278727213542}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -755.1752724483107, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.209933324496983, "mean_inference_ms": 0.4019756559627141, "mean_action_processing_ms": 0.09611452067165317, "mean_env_wait_ms": 3.80519045751316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038232803344726562, "StateBufferConnector_ms": 0.0028498967488606772, "ViewRequirementAgentConnector_ms": 0.06900278727213542}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.351674824919904, "num_env_steps_trained_throughput_per_sec": 39.351674824919904, "timesteps_total": 229560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 229560, "timers": {"training_iteration_time_ms": 2955.483, "sample_time_ms": 2951.685, "load_time_ms": 0.222, "load_throughput": 541491.641, "learn_time_ms": 2.829, "learn_throughput": 42413.834, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "done": false, "episodes_total": 1913, "training_iteration": 479, "trial_id": "4933d_00000", "date": "2023-07-26_03-10-26", "timestamp": 1690330226, "time_this_iter_s": 12.200194835662842, "time_total_s": 5845.028042793274, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 223.70256686210632, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 38.911764705882355, "ram_util_percent": 77.29411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5067138671875, "policy_loss": -93111.046875, "vf_loss": 3974475.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -750.1420174166104, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.214632963342467, "mean_inference_ms": 0.4019475730658036, "mean_action_processing_ms": 0.0961051623142025, "mean_env_wait_ms": 3.7620943498561874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037990038907980616, "StateBufferConnector_ms": 0.0028392936609968355, "ViewRequirementAgentConnector_ms": 0.06894069381907017}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -750.1420174166104, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.214632963342467, "mean_inference_ms": 0.4019475730658036, "mean_action_processing_ms": 0.0961051623142025, "mean_env_wait_ms": 3.7620943498561874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037990038907980616, "StateBufferConnector_ms": 0.0028392936609968355, "ViewRequirementAgentConnector_ms": 0.06894069381907017}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040, "num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.74661084787739, "num_env_steps_trained_throughput_per_sec": 40.74661084787739, "timesteps_total": 230040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 230040, "timers": {"training_iteration_time_ms": 2979.461, "sample_time_ms": 2975.648, "load_time_ms": 0.221, "load_throughput": 542425.348, "learn_time_ms": 2.835, "learn_throughput": 42323.6, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040}, "done": false, "episodes_total": 1917, "training_iteration": 480, "trial_id": "4933d_00000", "date": "2023-07-26_03-10-38", "timestamp": 1690330238, "time_this_iter_s": 11.782824993133545, "time_total_s": 5856.8108677864075, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 235.48539185523987, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.78235294117648, "ram_util_percent": 75.38235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5321044921875, "policy_loss": -138301.15625, "vf_loss": 8629368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -751.2756667033681, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.216996743314635, "mean_inference_ms": 0.4018937604808331, "mean_action_processing_ms": 0.09609151060662441, "mean_env_wait_ms": 3.7223405861434196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038675515048475152, "StateBufferConnector_ms": 0.0028354575835078596, "ViewRequirementAgentConnector_ms": 0.06881507046251412}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -751.2756667033681, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.216996743314635, "mean_inference_ms": 0.4018937604808331, "mean_action_processing_ms": 0.09609151060662441, "mean_env_wait_ms": 3.7223405861434196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038675515048475152, "StateBufferConnector_ms": 0.0028354575835078596, "ViewRequirementAgentConnector_ms": 0.06881507046251412}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.276243738041686, "num_env_steps_trained_throughput_per_sec": 42.276243738041686, "timesteps_total": 230520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 230520, "timers": {"training_iteration_time_ms": 2945.264, "sample_time_ms": 2941.468, "load_time_ms": 0.222, "load_throughput": 541025.992, "learn_time_ms": 2.815, "learn_throughput": 42629.734, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "done": false, "episodes_total": 1921, "training_iteration": 481, "trial_id": "4933d_00000", "date": "2023-07-26_03-10-49", "timestamp": 1690330249, "time_this_iter_s": 11.356571197509766, "time_total_s": 5868.167438983917, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 246.84196305274963, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 37.68125, "ram_util_percent": 74.16874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.52618408203125, "policy_loss": -117757.5625, "vf_loss": 5961956.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -754.3594744322046, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.218697580240523, "mean_inference_ms": 0.40185725500953834, "mean_action_processing_ms": 0.0960835542200463, "mean_env_wait_ms": 3.685607055471035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038840304846051096, "StateBufferConnector_ms": 0.002830055938369926, "ViewRequirementAgentConnector_ms": 0.06872292222647831}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -754.3594744322046, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.218697580240523, "mean_inference_ms": 0.40185725500953834, "mean_action_processing_ms": 0.0960835542200463, "mean_env_wait_ms": 3.685607055471035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038840304846051096, "StateBufferConnector_ms": 0.002830055938369926, "ViewRequirementAgentConnector_ms": 0.06872292222647831}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000, "num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.2033615455511, "num_env_steps_trained_throughput_per_sec": 41.2033615455511, "timesteps_total": 231000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231000, "timers": {"training_iteration_time_ms": 2894.139, "sample_time_ms": 2890.362, "load_time_ms": 0.222, "load_throughput": 539344.706, "learn_time_ms": 2.803, "learn_throughput": 42817.954, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000}, "done": false, "episodes_total": 1925, "training_iteration": 482, "trial_id": "4933d_00000", "date": "2023-07-26_03-11-01", "timestamp": 1690330261, "time_this_iter_s": 11.652255058288574, "time_total_s": 5879.819694042206, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 258.4942181110382, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 39.818749999999994, "ram_util_percent": 76.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.48974609375, "policy_loss": -104073.4296875, "vf_loss": 4809259.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -754.127322832458, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.22047285468671, "mean_inference_ms": 0.40182131460505865, "mean_action_processing_ms": 0.09607571062199727, "mean_env_wait_ms": 3.6515042451210844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038676209502167755, "StateBufferConnector_ms": 0.0028382290850628863, "ViewRequirementAgentConnector_ms": 0.06869599059387878}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -754.127322832458, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.22047285468671, "mean_inference_ms": 0.40182131460505865, "mean_action_processing_ms": 0.09607571062199727, "mean_env_wait_ms": 3.6515042451210844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038676209502167755, "StateBufferConnector_ms": 0.0028382290850628863, "ViewRequirementAgentConnector_ms": 0.06869599059387878}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.72321347011505, "num_env_steps_trained_throughput_per_sec": 40.72321347011505, "timesteps_total": 231480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231480, "timers": {"training_iteration_time_ms": 2906.79, "sample_time_ms": 2902.983, "load_time_ms": 0.224, "load_throughput": 534533.22, "learn_time_ms": 2.832, "learn_throughput": 42368.134, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "done": false, "episodes_total": 1929, "training_iteration": 483, "trial_id": "4933d_00000", "date": "2023-07-26_03-11-13", "timestamp": 1690330273, "time_this_iter_s": 11.789608240127563, "time_total_s": 5891.609302282333, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 270.28382635116577, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 47.07058823529412, "ram_util_percent": 75.51764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4993896484375, "policy_loss": -122974.015625, "vf_loss": 6491727.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -749.6989873797785, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.224647489087364, "mean_inference_ms": 0.40177448751121175, "mean_action_processing_ms": 0.09606578255736618, "mean_env_wait_ms": 3.6196730438673104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003845064263594778, "StateBufferConnector_ms": 0.002833667554353413, "ViewRequirementAgentConnector_ms": 0.06859829551295231}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -749.6989873797785, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.224647489087364, "mean_inference_ms": 0.40177448751121175, "mean_action_processing_ms": 0.09606578255736618, "mean_env_wait_ms": 3.6196730438673104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003845064263594778, "StateBufferConnector_ms": 0.002833667554353413, "ViewRequirementAgentConnector_ms": 0.06859829551295231}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.7076639414982, "num_env_steps_trained_throughput_per_sec": 38.7076639414982, "timesteps_total": 231960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231960, "timers": {"training_iteration_time_ms": 2994.937, "sample_time_ms": 2991.02, "load_time_ms": 0.229, "load_throughput": 524124.211, "learn_time_ms": 2.896, "learn_throughput": 41435.797, "synch_weights_time_ms": 0.75}, "counters": {"num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "done": false, "episodes_total": 1933, "training_iteration": 484, "trial_id": "4933d_00000", "date": "2023-07-26_03-11-25", "timestamp": 1690330285, "time_this_iter_s": 12.403733968734741, "time_total_s": 5904.013036251068, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 282.6875603199005, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 49.11666666666667, "ram_util_percent": 75.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.48052978515625, "policy_loss": -137443.96875, "vf_loss": 8078795.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}}, "num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -755.0790686481854, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.229765188226995, "mean_inference_ms": 0.40179601859947817, "mean_action_processing_ms": 0.09606571883678956, "mean_env_wait_ms": 3.590265406960653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038257753006135575, "StateBufferConnector_ms": 0.0028395893597843672, "ViewRequirementAgentConnector_ms": 0.06864624794083413}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -755.0790686481854, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.3019515057898, -831.8341437377669, -516.7663017027915, -826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.229765188226995, "mean_inference_ms": 0.40179601859947817, "mean_action_processing_ms": 0.09606571883678956, "mean_env_wait_ms": 3.590265406960653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038257753006135575, "StateBufferConnector_ms": 0.0028395893597843672, "ViewRequirementAgentConnector_ms": 0.06864624794083413}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440, "num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.160043405304386, "num_env_steps_trained_throughput_per_sec": 39.160043405304386, "timesteps_total": 232440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 232440, "timers": {"training_iteration_time_ms": 3041.555, "sample_time_ms": 3037.5, "load_time_ms": 0.238, "load_throughput": 503417.163, "learn_time_ms": 2.997, "learn_throughput": 40043.0, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440}, "done": false, "episodes_total": 1937, "training_iteration": 485, "trial_id": "4933d_00000", "date": "2023-07-26_03-11-38", "timestamp": 1690330298, "time_this_iter_s": 12.260331869125366, "time_total_s": 5916.2733681201935, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 294.9478921890259, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 50.54117647058824, "ram_util_percent": 75.91176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.48907470703125, "policy_loss": -59742.265625, "vf_loss": 1877908.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -754.4622651390872, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.242921322603124, "mean_inference_ms": 0.4016030922072379, "mean_action_processing_ms": 0.09602610488366743, "mean_env_wait_ms": 3.3545444972361107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003821134567260742, "StateBufferConnector_ms": 0.0028405189514160156, "ViewRequirementAgentConnector_ms": 0.06864666938781738}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -754.4622651390872, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-826.8034953121262, -1077.3051231289764, -875.2878952753133, -635.7367136478788, -894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.242921322603124, "mean_inference_ms": 0.4016030922072379, "mean_action_processing_ms": 0.09602610488366743, "mean_env_wait_ms": 3.3545444972361107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003821134567260742, "StateBufferConnector_ms": 0.0028405189514160156, "ViewRequirementAgentConnector_ms": 0.06864666938781738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920, "num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.033294252567515, "num_env_steps_trained_throughput_per_sec": 41.033294252567515, "timesteps_total": 232920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 232920, "timers": {"training_iteration_time_ms": 3019.719, "sample_time_ms": 3015.703, "load_time_ms": 0.238, "load_throughput": 505134.966, "learn_time_ms": 2.97, "learn_throughput": 40403.985, "synch_weights_time_ms": 0.761}, "counters": {"num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920}, "done": false, "episodes_total": 1941, "training_iteration": 486, "trial_id": "4933d_00000", "date": "2023-07-26_03-11-49", "timestamp": 1690330309, "time_this_iter_s": 11.700508117675781, "time_total_s": 5927.973876237869, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 306.64840030670166, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 39.57647058823529, "ram_util_percent": 75.4470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.50213623046875, "policy_loss": -77271.46875, "vf_loss": 2700076.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}}, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -749.8841313885238, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.24802470980326, "mean_inference_ms": 0.40143139443547343, "mean_action_processing_ms": 0.09598441656418621, "mean_env_wait_ms": 3.2299568872839632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038368701934814453, "StateBufferConnector_ms": 0.0028417110443115234, "ViewRequirementAgentConnector_ms": 0.06881380081176758}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -749.8841313885238, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-894.3278687294363, -670.3418019354401, -784.9618592886384, -620.3947326983644, -583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.24802470980326, "mean_inference_ms": 0.40143139443547343, "mean_action_processing_ms": 0.09598441656418621, "mean_env_wait_ms": 3.2299568872839632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038368701934814453, "StateBufferConnector_ms": 0.0028417110443115234, "ViewRequirementAgentConnector_ms": 0.06881380081176758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.88578758141629, "num_env_steps_trained_throughput_per_sec": 39.88578758141629, "timesteps_total": 233400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 233400, "timers": {"training_iteration_time_ms": 2999.613, "sample_time_ms": 2995.745, "load_time_ms": 0.229, "load_throughput": 523578.987, "learn_time_ms": 2.869, "learn_throughput": 41823.147, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "done": false, "episodes_total": 1945, "training_iteration": 487, "trial_id": "4933d_00000", "date": "2023-07-26_03-12-01", "timestamp": 1690330321, "time_this_iter_s": 12.03727102279663, "time_total_s": 5940.011147260666, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 318.6856713294983, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 42.02941176470589, "ram_util_percent": 74.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4790344238281, "policy_loss": -88760.1015625, "vf_loss": 3636853.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 110.0}}, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -752.9478832477927, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.247214675199086, "mean_inference_ms": 0.40149205139117855, "mean_action_processing_ms": 0.09597868089395163, "mean_env_wait_ms": 3.1529279165444395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038444995880126953, "StateBufferConnector_ms": 0.002847909927368164, "ViewRequirementAgentConnector_ms": 0.0689387321472168}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -752.9478832477927, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-583.0634740889728, -695.4705464135025, -679.1716464400189, -737.9524281450106, -628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.247214675199086, "mean_inference_ms": 0.40149205139117855, "mean_action_processing_ms": 0.09597868089395163, "mean_env_wait_ms": 3.1529279165444395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038444995880126953, "StateBufferConnector_ms": 0.002847909927368164, "ViewRequirementAgentConnector_ms": 0.0689387321472168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.834389119059615, "num_env_steps_trained_throughput_per_sec": 41.834389119059615, "timesteps_total": 233880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 233880, "timers": {"training_iteration_time_ms": 2928.841, "sample_time_ms": 2925.077, "load_time_ms": 0.221, "load_throughput": 542542.287, "learn_time_ms": 2.798, "learn_throughput": 42886.909, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "done": false, "episodes_total": 1949, "training_iteration": 488, "trial_id": "4933d_00000", "date": "2023-07-26_03-12-13", "timestamp": 1690330333, "time_this_iter_s": 11.476660966873169, "time_total_s": 5951.487808227539, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 330.16233229637146, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 39.517647058823535, "ram_util_percent": 75.86470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.53326416015625, "policy_loss": -84224.625, "vf_loss": 3100320.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 115.0, "diff_num_grad_updates_vs_sampler_policy": 114.0}}, "num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -751.5203601506965, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.251615090594452, "mean_inference_ms": 0.4016090425333725, "mean_action_processing_ms": 0.09598807306005529, "mean_env_wait_ms": 3.098414173082807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038194656372070312, "StateBufferConnector_ms": 0.0028319358825683594, "ViewRequirementAgentConnector_ms": 0.06843209266662598}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -751.5203601506965, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-628.4825509008505, -758.1359554081444, -644.0397893625743, -891.7487496063478, -569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.251615090594452, "mean_inference_ms": 0.4016090425333725, "mean_action_processing_ms": 0.09598807306005529, "mean_env_wait_ms": 3.098414173082807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038194656372070312, "StateBufferConnector_ms": 0.0028319358825683594, "ViewRequirementAgentConnector_ms": 0.06843209266662598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360, "num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.65155905467334, "num_env_steps_trained_throughput_per_sec": 39.65155905467334, "timesteps_total": 234360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 234360, "timers": {"training_iteration_time_ms": 2985.595, "sample_time_ms": 2981.71, "load_time_ms": 0.236, "load_throughput": 507938.722, "learn_time_ms": 2.885, "learn_throughput": 41593.31, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360}, "done": false, "episodes_total": 1953, "training_iteration": 489, "trial_id": "4933d_00000", "date": "2023-07-26_03-12-25", "timestamp": 1690330345, "time_this_iter_s": 12.108189821243286, "time_total_s": 5963.595998048782, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 342.27052211761475, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 41.89411764705883, "ram_util_percent": 77.19411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5013122558594, "policy_loss": -116925.4296875, "vf_loss": 6748588.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 118.0}}, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -757.1534056236061, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.260630121234882, "mean_inference_ms": 0.4017243546086215, "mean_action_processing_ms": 0.09599452922538428, "mean_env_wait_ms": 3.0573618107200016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038230419158935547, "StateBufferConnector_ms": 0.002827167510986328, "ViewRequirementAgentConnector_ms": 0.0685126781463623}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -757.1534056236061, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-569.9422454139008, -531.4033832073726, -476.80914048681944, -603.4811555057694, -887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.260630121234882, "mean_inference_ms": 0.4017243546086215, "mean_action_processing_ms": 0.09599452922538428, "mean_env_wait_ms": 3.0573618107200016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038230419158935547, "StateBufferConnector_ms": 0.002827167510986328, "ViewRequirementAgentConnector_ms": 0.0685126781463623}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.66101267125078, "num_env_steps_trained_throughput_per_sec": 40.66101267125078, "timesteps_total": 234840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 234840, "timers": {"training_iteration_time_ms": 2959.62, "sample_time_ms": 2955.731, "load_time_ms": 0.235, "load_throughput": 510100.821, "learn_time_ms": 2.895, "learn_throughput": 41448.422, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "done": false, "episodes_total": 1957, "training_iteration": 490, "trial_id": "4933d_00000", "date": "2023-07-26_03-12-37", "timestamp": 1690330357, "time_this_iter_s": 11.807873010635376, "time_total_s": 5975.403871059418, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 354.0783951282501, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 37.23529411764706, "ram_util_percent": 76.5235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4877624511719, "policy_loss": -108052.8125, "vf_loss": 5859318.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123.0, "diff_num_grad_updates_vs_sampler_policy": 122.0}}, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "sampler_results": {"episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -764.3082620053241, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.271852801049157, "mean_inference_ms": 0.4018974944634957, "mean_action_processing_ms": 0.09601379803055891, "mean_env_wait_ms": 3.0250247260703045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038309097290039062, "StateBufferConnector_ms": 0.0028383731842041016, "ViewRequirementAgentConnector_ms": 0.06861400604248047}}, "episode_reward_max": -318.96141401133866, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -764.3082620053241, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-887.8932317172856, -617.3166178179895, -318.96141401133866, -943.2467193608003, -820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.271852801049157, "mean_inference_ms": 0.4018974944634957, "mean_action_processing_ms": 0.09601379803055891, "mean_env_wait_ms": 3.0250247260703045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038309097290039062, "StateBufferConnector_ms": 0.0028383731842041016, "ViewRequirementAgentConnector_ms": 0.06861400604248047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.015233547439344, "num_env_steps_trained_throughput_per_sec": 41.015233547439344, "timesteps_total": 235320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 235320, "timers": {"training_iteration_time_ms": 2945.635, "sample_time_ms": 2941.765, "load_time_ms": 0.231, "load_throughput": 518401.978, "learn_time_ms": 2.881, "learn_throughput": 41653.893, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "done": false, "episodes_total": 1961, "training_iteration": 491, "trial_id": "4933d_00000", "date": "2023-07-26_03-12-49", "timestamp": 1690330369, "time_this_iter_s": 11.705658912658691, "time_total_s": 5987.109529972076, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 365.7840540409088, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 37.04375, "ram_util_percent": 75.13749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.500244140625, "policy_loss": -108789.578125, "vf_loss": 5118610.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 126.0}}, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -765.5735667553603, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.281191868736233, "mean_inference_ms": 0.4020534680790878, "mean_action_processing_ms": 0.09603132017613081, "mean_env_wait_ms": 2.9982251337386003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038268566131591797, "StateBufferConnector_ms": 0.002838611602783203, "ViewRequirementAgentConnector_ms": 0.06862020492553711}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -765.5735667553603, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-820.0733059394064, -986.0885592639053, -728.2865608990404, -656.9974853675375, -621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.281191868736233, "mean_inference_ms": 0.4020534680790878, "mean_action_processing_ms": 0.09603132017613081, "mean_env_wait_ms": 2.9982251337386003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038268566131591797, "StateBufferConnector_ms": 0.002838611602783203, "ViewRequirementAgentConnector_ms": 0.06862020492553711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.53533006539744, "num_env_steps_trained_throughput_per_sec": 41.53533006539744, "timesteps_total": 235800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 235800, "timers": {"training_iteration_time_ms": 2919.996, "sample_time_ms": 2916.162, "load_time_ms": 0.25, "load_throughput": 480263.817, "learn_time_ms": 2.834, "learn_throughput": 42339.265, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "done": false, "episodes_total": 1965, "training_iteration": 492, "trial_id": "4933d_00000", "date": "2023-07-26_03-13-00", "timestamp": 1690330380, "time_this_iter_s": 11.559224128723145, "time_total_s": 5998.6687541008, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 377.34327816963196, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 39.01176470588235, "ram_util_percent": 75.19411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.51690673828125, "policy_loss": -133232.1875, "vf_loss": 8565172.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -765.5483443747347, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.287744755270214, "mean_inference_ms": 0.4021220162345627, "mean_action_processing_ms": 0.09603519610963339, "mean_env_wait_ms": 2.9753880539105935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038819313049316406, "StateBufferConnector_ms": 0.002872467041015625, "ViewRequirementAgentConnector_ms": 0.06960844993591309}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -765.5483443747347, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-621.154980725407, -865.9151744911757, -710.8246289605149, -631.3936831782261, -599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.287744755270214, "mean_inference_ms": 0.4021220162345627, "mean_action_processing_ms": 0.09603519610963339, "mean_env_wait_ms": 2.9753880539105935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038819313049316406, "StateBufferConnector_ms": 0.002872467041015625, "ViewRequirementAgentConnector_ms": 0.06960844993591309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.36414873840601, "num_env_steps_trained_throughput_per_sec": 41.36414873840601, "timesteps_total": 236280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 236280, "timers": {"training_iteration_time_ms": 2900.311, "sample_time_ms": 2896.514, "load_time_ms": 0.24, "load_throughput": 500066.051, "learn_time_ms": 2.804, "learn_throughput": 42795.745, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "done": false, "episodes_total": 1969, "training_iteration": 493, "trial_id": "4933d_00000", "date": "2023-07-26_03-13-12", "timestamp": 1690330392, "time_this_iter_s": 11.60695505142212, "time_total_s": 6010.275709152222, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 388.9502332210541, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 41.318749999999994, "ram_util_percent": 73.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.51593017578125, "policy_loss": -125301.859375, "vf_loss": 7666623.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135.0, "diff_num_grad_updates_vs_sampler_policy": 134.0}}, "num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -772.2285334897928, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.296334309351277, "mean_inference_ms": 0.40227452219977794, "mean_action_processing_ms": 0.09605761645309795, "mean_env_wait_ms": 2.955933324196826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00391840934753418, "StateBufferConnector_ms": 0.002900838851928711, "ViewRequirementAgentConnector_ms": 0.07024693489074707}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -772.2285334897928, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-599.8907571979132, -1000.1316933739215, -602.7259419609882, -765.5337791796734, -1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.296334309351277, "mean_inference_ms": 0.40227452219977794, "mean_action_processing_ms": 0.09605761645309795, "mean_env_wait_ms": 2.955933324196826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00391840934753418, "StateBufferConnector_ms": 0.002900838851928711, "ViewRequirementAgentConnector_ms": 0.07024693489074707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760, "num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 37.74423735870981, "num_env_steps_trained_throughput_per_sec": 37.74423735870981, "timesteps_total": 236760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 236760, "timers": {"training_iteration_time_ms": 3011.385, "sample_time_ms": 3007.318, "load_time_ms": 0.255, "load_throughput": 470961.43, "learn_time_ms": 3.0, "learn_throughput": 40004.807, "synch_weights_time_ms": 0.77}, "counters": {"num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760}, "done": false, "episodes_total": 1973, "training_iteration": 494, "trial_id": "4933d_00000", "date": "2023-07-26_03-13-25", "timestamp": 1690330405, "time_this_iter_s": 12.720837116241455, "time_total_s": 6022.996546268463, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 401.67107033729553, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 48.66111111111112, "ram_util_percent": 76.11666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.48406982421875, "policy_loss": -97937.75, "vf_loss": 4558187.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 139.0, "diff_num_grad_updates_vs_sampler_policy": 138.0}}, "num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -775.4625392428832, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.305441953255, "mean_inference_ms": 0.40239104229765843, "mean_action_processing_ms": 0.09607433031790155, "mean_env_wait_ms": 2.9395476776673477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003900289535522461, "StateBufferConnector_ms": 0.0028982162475585938, "ViewRequirementAgentConnector_ms": 0.07006430625915527}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -775.4625392428832, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1090.4316705633207, -901.6218349601096, -762.0910860456547, -480.3802402723554, -959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.305441953255, "mean_inference_ms": 0.40239104229765843, "mean_action_processing_ms": 0.09607433031790155, "mean_env_wait_ms": 2.9395476776673477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003900289535522461, "StateBufferConnector_ms": 0.0028982162475585938, "ViewRequirementAgentConnector_ms": 0.07006430625915527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240, "num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.765220670473184, "num_env_steps_trained_throughput_per_sec": 40.765220670473184, "timesteps_total": 237240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 237240, "timers": {"training_iteration_time_ms": 3040.788, "sample_time_ms": 3036.764, "load_time_ms": 0.235, "load_throughput": 510204.237, "learn_time_ms": 2.979, "learn_throughput": 40280.464, "synch_weights_time_ms": 0.767}, "counters": {"num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240}, "done": false, "episodes_total": 1977, "training_iteration": 495, "trial_id": "4933d_00000", "date": "2023-07-26_03-13-36", "timestamp": 1690330416, "time_this_iter_s": 11.777567148208618, "time_total_s": 6034.774113416672, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 413.44863748550415, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 40.51764705882353, "ram_util_percent": 73.87647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4809265136719, "policy_loss": -77943.609375, "vf_loss": 2750962.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -774.7599858742583, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.310191512604902, "mean_inference_ms": 0.4023879892992673, "mean_action_processing_ms": 0.09607554051465403, "mean_env_wait_ms": 2.925194191453898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038971900939941406, "StateBufferConnector_ms": 0.002905130386352539, "ViewRequirementAgentConnector_ms": 0.07013607025146484}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1352.1365912034535, "episode_reward_mean": -774.7599858742583, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-959.7268147982433, -991.5811256658612, -824.4066658196538, -1352.1365912034535, -976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.310191512604902, "mean_inference_ms": 0.4023879892992673, "mean_action_processing_ms": 0.09607554051465403, "mean_env_wait_ms": 2.925194191453898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038971900939941406, "StateBufferConnector_ms": 0.002905130386352539, "ViewRequirementAgentConnector_ms": 0.07013607025146484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.436903759417625, "num_env_steps_trained_throughput_per_sec": 41.436903759417625, "timesteps_total": 237720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 237720, "timers": {"training_iteration_time_ms": 2974.693, "sample_time_ms": 2970.692, "load_time_ms": 0.237, "load_throughput": 507119.879, "learn_time_ms": 2.97, "learn_throughput": 40400.742, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "done": false, "episodes_total": 1981, "training_iteration": 496, "trial_id": "4933d_00000", "date": "2023-07-26_03-13-48", "timestamp": 1690330428, "time_this_iter_s": 11.5867760181427, "time_total_s": 6046.360889434814, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 425.03541350364685, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 37.182352941176475, "ram_util_percent": 76.3529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.45574951171875, "policy_loss": -101090.796875, "vf_loss": 5142207.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 147.0, "diff_num_grad_updates_vs_sampler_policy": 146.0}}, "num_env_steps_sampled": 238200, "num_env_steps_trained": 238200, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 238200}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1094.5441029089577, "episode_reward_mean": -766.3054220620598, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.31591355441037, "mean_inference_ms": 0.40230398553328184, "mean_action_processing_ms": 0.09606331761820351, "mean_env_wait_ms": 2.9123466279336494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003866910934448242, "StateBufferConnector_ms": 0.002888202667236328, "ViewRequirementAgentConnector_ms": 0.0696558952331543}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1094.5441029089577, "episode_reward_mean": -766.3054220620598, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-976.3801830383505, -374.974473369523, -763.9459340081897, -742.8166894641788, -682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.31591355441037, "mean_inference_ms": 0.40230398553328184, "mean_action_processing_ms": 0.09606331761820351, "mean_env_wait_ms": 2.9123466279336494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003866910934448242, "StateBufferConnector_ms": 0.002888202667236328, "ViewRequirementAgentConnector_ms": 0.0696558952331543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 238200, "num_env_steps_sampled": 238200, "num_env_steps_trained": 238200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.591765480200486, "num_env_steps_trained_throughput_per_sec": 41.591765480200486, "timesteps_total": 238200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 238200, "timers": {"training_iteration_time_ms": 2892.409, "sample_time_ms": 2888.589, "load_time_ms": 0.227, "load_throughput": 529416.725, "learn_time_ms": 2.839, "learn_throughput": 42268.153, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 238200, "num_env_steps_trained": 238200, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 238200}, "done": false, "episodes_total": 1985, "training_iteration": 497, "trial_id": "4933d_00000", "date": "2023-07-26_03-14-00", "timestamp": 1690330440, "time_this_iter_s": 11.543560981750488, "time_total_s": 6057.904450416565, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 436.57897448539734, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 35.175, "ram_util_percent": 76.91875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4803161621094, "policy_loss": -174997.84375, "vf_loss": 12576724.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 151.0, "diff_num_grad_updates_vs_sampler_policy": 150.0}}, "num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -771.7714955741209, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.320987707760104, "mean_inference_ms": 0.40227504825861904, "mean_action_processing_ms": 0.09605941025393804, "mean_env_wait_ms": 2.900739143027779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038857460021972656, "StateBufferConnector_ms": 0.0028891563415527344, "ViewRequirementAgentConnector_ms": 0.0698554515838623}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -771.7714955741209, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-682.3336309557177, -786.4331921213383, -521.6674207818442, -798.3825001636144, -930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.320987707760104, "mean_inference_ms": 0.40227504825861904, "mean_action_processing_ms": 0.09605941025393804, "mean_env_wait_ms": 2.900739143027779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038857460021972656, "StateBufferConnector_ms": 0.0028891563415527344, "ViewRequirementAgentConnector_ms": 0.0698554515838623}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680, "num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.622403548530706, "num_env_steps_trained_throughput_per_sec": 41.622403548530706, "timesteps_total": 238680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 238680, "timers": {"training_iteration_time_ms": 2891.174, "sample_time_ms": 2887.398, "load_time_ms": 0.226, "load_throughput": 531653.618, "learn_time_ms": 2.781, "learn_throughput": 43145.727, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680}, "done": false, "episodes_total": 1989, "training_iteration": 498, "trial_id": "4933d_00000", "date": "2023-07-26_03-14-11", "timestamp": 1690330451, "time_this_iter_s": 11.53570294380188, "time_total_s": 6069.440153360367, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 448.1146774291992, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 41.36470588235294, "ram_util_percent": 76.35882352941178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4964904785156, "policy_loss": -120129.4296875, "vf_loss": 6693500.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 155.0, "diff_num_grad_updates_vs_sampler_policy": 154.0}}, "num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -776.2609167185537, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.325475414253532, "mean_inference_ms": 0.40232326627475584, "mean_action_processing_ms": 0.09606785332245237, "mean_env_wait_ms": 2.890034608899068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003901243209838867, "StateBufferConnector_ms": 0.0028786659240722656, "ViewRequirementAgentConnector_ms": 0.06993365287780762}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -776.2609167185537, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-930.0895658417221, -755.9836393039503, -883.9405104105497, -906.4379058296726, -981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.325475414253532, "mean_inference_ms": 0.40232326627475584, "mean_action_processing_ms": 0.09606785332245237, "mean_env_wait_ms": 2.890034608899068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003901243209838867, "StateBufferConnector_ms": 0.0028786659240722656, "ViewRequirementAgentConnector_ms": 0.06993365287780762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160, "num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.77435606241578, "num_env_steps_trained_throughput_per_sec": 40.77435606241578, "timesteps_total": 239160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 239160, "timers": {"training_iteration_time_ms": 2919.214, "sample_time_ms": 2915.368, "load_time_ms": 0.228, "load_throughput": 526316.512, "learn_time_ms": 2.834, "learn_throughput": 42340.333, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160}, "done": false, "episodes_total": 1993, "training_iteration": 499, "trial_id": "4933d_00000", "date": "2023-07-26_03-14-23", "timestamp": 1690330463, "time_this_iter_s": 11.774785995483398, "time_total_s": 6081.21493935585, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 459.8894634246826, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 44.01875, "ram_util_percent": 76.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4888916015625, "policy_loss": -70512.734375, "vf_loss": 2218175.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 159.0, "diff_num_grad_updates_vs_sampler_policy": 158.0}}, "num_env_steps_sampled": 239640, "num_env_steps_trained": 239640, "num_agent_steps_sampled": 239640, "num_agent_steps_trained": 239640}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -765.124206524227, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.327375472951925, "mean_inference_ms": 0.4023906677886162, "mean_action_processing_ms": 0.09608002991638606, "mean_env_wait_ms": 2.8803437387807764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039288997650146484, "StateBufferConnector_ms": 0.002893209457397461, "ViewRequirementAgentConnector_ms": 0.0702979564666748}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -765.124206524227, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.1074743549575, -550.2822857779393, -728.7189796151793, -798.9966772210419, -510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.327375472951925, "mean_inference_ms": 0.4023906677886162, "mean_action_processing_ms": 0.09608002991638606, "mean_env_wait_ms": 2.8803437387807764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039288997650146484, "StateBufferConnector_ms": 0.002893209457397461, "ViewRequirementAgentConnector_ms": 0.0702979564666748}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239640, "num_agent_steps_trained": 239640, "num_env_steps_sampled": 239640, "num_env_steps_trained": 239640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.22728752237634, "num_env_steps_trained_throughput_per_sec": 40.22728752237634, "timesteps_total": 239640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 239640, "timers": {"training_iteration_time_ms": 2948.174, "sample_time_ms": 2944.322, "load_time_ms": 0.23, "load_throughput": 521301.378, "learn_time_ms": 2.855, "learn_throughput": 42033.412, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 239640, "num_env_steps_trained": 239640, "num_agent_steps_sampled": 239640, "num_agent_steps_trained": 239640}, "done": false, "episodes_total": 1997, "training_iteration": 500, "trial_id": "4933d_00000", "date": "2023-07-26_03-14-35", "timestamp": 1690330475, "time_this_iter_s": 11.935002088546753, "time_total_s": 6093.149941444397, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 471.82446551322937, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 44.817647058823525, "ram_util_percent": 77.38823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.48260498046875, "policy_loss": -60690.30859375, "vf_loss": 1689395.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 163.0, "diff_num_grad_updates_vs_sampler_policy": 162.0}}, "num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -759.0767031461052, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.328943046234507, "mean_inference_ms": 0.4023990307049231, "mean_action_processing_ms": 0.09608320961200079, "mean_env_wait_ms": 2.8713988709527927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003906726837158203, "StateBufferConnector_ms": 0.0028841495513916016, "ViewRequirementAgentConnector_ms": 0.06993246078491211}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -759.0767031461052, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-510.9980797643786, -754.0347643871999, -918.576471930578, -903.8047302145345, -650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.328943046234507, "mean_inference_ms": 0.4023990307049231, "mean_action_processing_ms": 0.09608320961200079, "mean_env_wait_ms": 2.8713988709527927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003906726837158203, "StateBufferConnector_ms": 0.0028841495513916016, "ViewRequirementAgentConnector_ms": 0.06993246078491211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120, "num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.758058876987455, "num_env_steps_trained_throughput_per_sec": 40.758058876987455, "timesteps_total": 240120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 240120, "timers": {"training_iteration_time_ms": 2964.785, "sample_time_ms": 2960.999, "load_time_ms": 0.227, "load_throughput": 529194.07, "learn_time_ms": 2.825, "learn_throughput": 42484.003, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120}, "done": false, "episodes_total": 2001, "training_iteration": 501, "trial_id": "4933d_00000", "date": "2023-07-26_03-14-47", "timestamp": 1690330487, "time_this_iter_s": 11.7796950340271, "time_total_s": 6104.929636478424, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 483.60416054725647, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 41.11176470588236, "ram_util_percent": 76.52352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4587707519531, "policy_loss": -64903.765625, "vf_loss": 2028607.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 166.0}}, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -750.424732098363, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33130207063402, "mean_inference_ms": 0.40238728061078577, "mean_action_processing_ms": 0.09607819938845892, "mean_env_wait_ms": 2.863050814173075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039038658142089844, "StateBufferConnector_ms": 0.0028808116912841797, "ViewRequirementAgentConnector_ms": 0.06997799873352051}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -750.424732098363, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-650.6129812795789, -961.8217147393516, -875.7347994751169, -577.5057139968691, -639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33130207063402, "mean_inference_ms": 0.40238728061078577, "mean_action_processing_ms": 0.09607819938845892, "mean_env_wait_ms": 2.863050814173075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039038658142089844, "StateBufferConnector_ms": 0.0028808116912841797, "ViewRequirementAgentConnector_ms": 0.06997799873352051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.445071422782355, "num_env_steps_trained_throughput_per_sec": 41.445071422782355, "timesteps_total": 240600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 240600, "timers": {"training_iteration_time_ms": 2933.549, "sample_time_ms": 2929.758, "load_time_ms": 0.226, "load_throughput": 530476.897, "learn_time_ms": 2.823, "learn_throughput": 42508.761, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600}, "done": false, "episodes_total": 2005, "training_iteration": 502, "trial_id": "4933d_00000", "date": "2023-07-26_03-14-58", "timestamp": 1690330498, "time_this_iter_s": 11.584560871124268, "time_total_s": 6116.514197349548, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 495.18872141838074, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 39.4, "ram_util_percent": 77.04705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.48272705078125, "policy_loss": -107966.625, "vf_loss": 5449071.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 171.0, "diff_num_grad_updates_vs_sampler_policy": 170.0}}, "num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -751.2612846877963, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.335451644938676, "mean_inference_ms": 0.40240829564935315, "mean_action_processing_ms": 0.09607822734092458, "mean_env_wait_ms": 2.8562327931693674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00397801399230957, "StateBufferConnector_ms": 0.0029184818267822266, "ViewRequirementAgentConnector_ms": 0.07053232192993164}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -751.2612846877963, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-639.2216008168722, -651.5139825857483, -742.0574477260427, -785.1985697336708, -579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.335451644938676, "mean_inference_ms": 0.40240829564935315, "mean_action_processing_ms": 0.09607822734092458, "mean_env_wait_ms": 2.8562327931693674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00397801399230957, "StateBufferConnector_ms": 0.0029184818267822266, "ViewRequirementAgentConnector_ms": 0.07053232192993164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080, "num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 37.46395561459345, "num_env_steps_trained_throughput_per_sec": 37.46395561459345, "timesteps_total": 241080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 241080, "timers": {"training_iteration_time_ms": 3039.497, "sample_time_ms": 3035.566, "load_time_ms": 0.233, "load_throughput": 514060.341, "learn_time_ms": 2.918, "learn_throughput": 41127.348, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080}, "done": false, "episodes_total": 2009, "training_iteration": 503, "trial_id": "4933d_00000", "date": "2023-07-26_03-15-11", "timestamp": 1690330511, "time_this_iter_s": 12.815048933029175, "time_total_s": 6129.3292462825775, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 508.0037703514099, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 51.205555555555556, "ram_util_percent": 76.73888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.53662109375, "policy_loss": -98221.984375, "vf_loss": 4385570.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 175.0, "diff_num_grad_updates_vs_sampler_policy": 174.0}}, "num_env_steps_sampled": 241560, "num_env_steps_trained": 241560, "num_agent_steps_sampled": 241560, "num_agent_steps_trained": 241560}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -754.6003065156656, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.338358309789392, "mean_inference_ms": 0.4024602719436066, "mean_action_processing_ms": 0.09608372130879303, "mean_env_wait_ms": 2.849781960319934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003989219665527344, "StateBufferConnector_ms": 0.0029358863830566406, "ViewRequirementAgentConnector_ms": 0.07069158554077148}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -754.6003065156656, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-579.7795392918199, -764.1057247445352, -582.0331169819028, -697.1555612706679, -342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.338358309789392, "mean_inference_ms": 0.4024602719436066, "mean_action_processing_ms": 0.09608372130879303, "mean_env_wait_ms": 2.849781960319934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003989219665527344, "StateBufferConnector_ms": 0.0029358863830566406, "ViewRequirementAgentConnector_ms": 0.07069158554077148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241560, "num_agent_steps_trained": 241560, "num_env_steps_sampled": 241560, "num_env_steps_trained": 241560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.64604636289072, "num_env_steps_trained_throughput_per_sec": 39.64604636289072, "timesteps_total": 241560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 241560, "timers": {"training_iteration_time_ms": 3082.997, "sample_time_ms": 3079.053, "load_time_ms": 0.235, "load_throughput": 511240.711, "learn_time_ms": 2.929, "learn_throughput": 40976.006, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 241560, "num_env_steps_trained": 241560, "num_agent_steps_sampled": 241560, "num_agent_steps_trained": 241560}, "done": false, "episodes_total": 2013, "training_iteration": 504, "trial_id": "4933d_00000", "date": "2023-07-26_03-15-23", "timestamp": 1690330523, "time_this_iter_s": 12.109925985336304, "time_total_s": 6141.439172267914, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 520.1136963367462, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 44.94705882352942, "ram_util_percent": 77.98235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.50042724609375, "policy_loss": -129316.140625, "vf_loss": 7288579.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 179.0, "diff_num_grad_updates_vs_sampler_policy": 178.0}}, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "sampler_results": {"episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -760.9312061443596, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.341305237385797, "mean_inference_ms": 0.40255903239074214, "mean_action_processing_ms": 0.09609811785904039, "mean_env_wait_ms": 2.843724645225217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003994941711425781, "StateBufferConnector_ms": 0.0029468536376953125, "ViewRequirementAgentConnector_ms": 0.07082772254943848}}, "episode_reward_max": -342.08293035599525, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -760.9312061443596, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-342.08293035599525, -1031.2468113121524, -698.587546059155, -1022.7436727400324, -926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.341305237385797, "mean_inference_ms": 0.40255903239074214, "mean_action_processing_ms": 0.09609811785904039, "mean_env_wait_ms": 2.843724645225217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003994941711425781, "StateBufferConnector_ms": 0.0029468536376953125, "ViewRequirementAgentConnector_ms": 0.07082772254943848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.60969019726038, "num_env_steps_trained_throughput_per_sec": 40.60969019726038, "timesteps_total": 242040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 242040, "timers": {"training_iteration_time_ms": 3052.781, "sample_time_ms": 3048.91, "load_time_ms": 0.23, "load_throughput": 521787.767, "learn_time_ms": 2.882, "learn_throughput": 41643.898, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "done": false, "episodes_total": 2017, "training_iteration": 505, "trial_id": "4933d_00000", "date": "2023-07-26_03-15-35", "timestamp": 1690330535, "time_this_iter_s": 11.822746276855469, "time_total_s": 6153.261918544769, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 531.9364426136017, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 43.76470588235294, "ram_util_percent": 77.18823529411766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5381774902344, "policy_loss": -126028.3203125, "vf_loss": 6036581.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 183.0, "diff_num_grad_updates_vs_sampler_policy": 182.0}}, "num_env_steps_sampled": 242520, "num_env_steps_trained": 242520, "num_agent_steps_sampled": 242520, "num_agent_steps_trained": 242520}, "sampler_results": {"episode_reward_max": -410.48490667218937, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -760.7745435184997, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.345374399808826, "mean_inference_ms": 0.40269989536210277, "mean_action_processing_ms": 0.09611947831940416, "mean_env_wait_ms": 2.8382437804864065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00401759147644043, "StateBufferConnector_ms": 0.002955913543701172, "ViewRequirementAgentConnector_ms": 0.0710301399230957}}, "episode_reward_max": -410.48490667218937, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -760.7745435184997, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-926.8592271687937, -670.8641293210444, -952.1994162625767, -723.4711664698203, -725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.345374399808826, "mean_inference_ms": 0.40269989536210277, "mean_action_processing_ms": 0.09611947831940416, "mean_env_wait_ms": 2.8382437804864065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00401759147644043, "StateBufferConnector_ms": 0.002955913543701172, "ViewRequirementAgentConnector_ms": 0.0710301399230957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242520, "num_agent_steps_trained": 242520, "num_env_steps_sampled": 242520, "num_env_steps_trained": 242520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.36914991523013, "num_env_steps_trained_throughput_per_sec": 41.36914991523013, "timesteps_total": 242520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 242520, "timers": {"training_iteration_time_ms": 2942.724, "sample_time_ms": 2938.692, "load_time_ms": 0.236, "load_throughput": 508349.136, "learn_time_ms": 3.007, "learn_throughput": 39900.469, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 242520, "num_env_steps_trained": 242520, "num_agent_steps_sampled": 242520, "num_agent_steps_trained": 242520}, "done": false, "episodes_total": 2021, "training_iteration": 506, "trial_id": "4933d_00000", "date": "2023-07-26_03-15-47", "timestamp": 1690330547, "time_this_iter_s": 11.605571746826172, "time_total_s": 6164.8674902915955, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 543.5420143604279, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 36.1764705882353, "ram_util_percent": 76.34117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.51611328125, "policy_loss": -85205.0, "vf_loss": 3189527.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 187.0, "diff_num_grad_updates_vs_sampler_policy": 186.0}}, "num_env_steps_sampled": 243000, "num_env_steps_trained": 243000, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 243000}, "sampler_results": {"episode_reward_max": -410.48490667218937, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -758.2830443642835, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.349297297916895, "mean_inference_ms": 0.4028215351551542, "mean_action_processing_ms": 0.09613532453330773, "mean_env_wait_ms": 2.833151833673205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00401759147644043, "StateBufferConnector_ms": 0.0029630661010742188, "ViewRequirementAgentConnector_ms": 0.07110452651977539}}, "episode_reward_max": -410.48490667218937, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -758.2830443642835, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-725.3470413718384, -726.6577223175921, -747.467875940683, -796.8394625217866, -410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.349297297916895, "mean_inference_ms": 0.4028215351551542, "mean_action_processing_ms": 0.09613532453330773, "mean_env_wait_ms": 2.833151833673205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00401759147644043, "StateBufferConnector_ms": 0.0029630661010742188, "ViewRequirementAgentConnector_ms": 0.07110452651977539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 243000, "num_env_steps_sampled": 243000, "num_env_steps_trained": 243000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.814333738489026, "num_env_steps_trained_throughput_per_sec": 41.814333738489026, "timesteps_total": 243000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 243000, "timers": {"training_iteration_time_ms": 2902.036, "sample_time_ms": 2898.056, "load_time_ms": 0.234, "load_throughput": 512229.269, "learn_time_ms": 2.973, "learn_throughput": 40367.367, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 243000, "num_env_steps_trained": 243000, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 243000}, "done": false, "episodes_total": 2025, "training_iteration": 507, "trial_id": "4933d_00000", "date": "2023-07-26_03-15-58", "timestamp": 1690330558, "time_this_iter_s": 11.482146978378296, "time_total_s": 6176.349637269974, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 555.0241613388062, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 35.69375, "ram_util_percent": 73.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4941101074219, "policy_loss": -104597.3046875, "vf_loss": 5394023.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -753.8497411373523, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35275029555136, "mean_inference_ms": 0.4029615017563026, "mean_action_processing_ms": 0.09615449606367689, "mean_env_wait_ms": 2.8284747063603377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004014730453491211, "StateBufferConnector_ms": 0.0029571056365966797, "ViewRequirementAgentConnector_ms": 0.07116961479187012}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -753.8497411373523, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-410.48490667218937, -819.4327919662844, -511.06987400650127, -854.8298506802787, -832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35275029555136, "mean_inference_ms": 0.4029615017563026, "mean_action_processing_ms": 0.09615449606367689, "mean_env_wait_ms": 2.8284747063603377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004014730453491211, "StateBufferConnector_ms": 0.0029571056365966797, "ViewRequirementAgentConnector_ms": 0.07116961479187012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480, "num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.19344629063648, "num_env_steps_trained_throughput_per_sec": 41.19344629063648, "timesteps_total": 243480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 243480, "timers": {"training_iteration_time_ms": 2885.913, "sample_time_ms": 2882.137, "load_time_ms": 0.222, "load_throughput": 540677.28, "learn_time_ms": 2.808, "learn_throughput": 42739.418, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480}, "done": false, "episodes_total": 2029, "training_iteration": 508, "trial_id": "4933d_00000", "date": "2023-07-26_03-16-10", "timestamp": 1690330570, "time_this_iter_s": 11.654979944229126, "time_total_s": 6188.004617214203, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 566.6791412830353, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 40.023529411764706, "ram_util_percent": 76.08235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.47747802734375, "policy_loss": -101912.984375, "vf_loss": 4532685.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 195.0, "diff_num_grad_updates_vs_sampler_policy": 194.0}}, "num_env_steps_sampled": 243960, "num_env_steps_trained": 243960, "num_agent_steps_sampled": 243960, "num_agent_steps_trained": 243960}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -756.3659131794421, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35343225172559, "mean_inference_ms": 0.4031121294199269, "mean_action_processing_ms": 0.09617568014817468, "mean_env_wait_ms": 2.824254264122892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00402069091796875, "StateBufferConnector_ms": 0.0029599666595458984, "ViewRequirementAgentConnector_ms": 0.07120466232299805}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -756.3659131794421, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.6482037501867, -790.3755074169524, -958.7490639001297, -949.6512200241517, -881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35343225172559, "mean_inference_ms": 0.4031121294199269, "mean_action_processing_ms": 0.09617568014817468, "mean_env_wait_ms": 2.824254264122892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00402069091796875, "StateBufferConnector_ms": 0.0029599666595458984, "ViewRequirementAgentConnector_ms": 0.07120466232299805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243960, "num_agent_steps_trained": 243960, "num_env_steps_sampled": 243960, "num_env_steps_trained": 243960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.41147539985489, "num_env_steps_trained_throughput_per_sec": 41.41147539985489, "timesteps_total": 243960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 243960, "timers": {"training_iteration_time_ms": 2903.351, "sample_time_ms": 2899.588, "load_time_ms": 0.223, "load_throughput": 538421.566, "learn_time_ms": 2.801, "learn_throughput": 42848.938, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 243960, "num_env_steps_trained": 243960, "num_agent_steps_sampled": 243960, "num_agent_steps_trained": 243960}, "done": false, "episodes_total": 2033, "training_iteration": 509, "trial_id": "4933d_00000", "date": "2023-07-26_03-16-22", "timestamp": 1690330582, "time_this_iter_s": 11.593858003616333, "time_total_s": 6199.598475217819, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 578.2729992866516, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 43.006249999999994, "ram_util_percent": 78.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5316162109375, "policy_loss": -99779.15625, "vf_loss": 4742951.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 199.0, "diff_num_grad_updates_vs_sampler_policy": 198.0}}, "num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -753.810072359484, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.353273199815767, "mean_inference_ms": 0.4032169642941461, "mean_action_processing_ms": 0.09618907105370443, "mean_env_wait_ms": 2.8201102728742318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004029512405395508, "StateBufferConnector_ms": 0.0029535293579101562, "ViewRequirementAgentConnector_ms": 0.07111430168151855}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -753.810072359484, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-881.1421748196418, -708.2832117092858, -859.1934022593266, -425.68232589645334, -649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.353273199815767, "mean_inference_ms": 0.4032169642941461, "mean_action_processing_ms": 0.09618907105370443, "mean_env_wait_ms": 2.8201102728742318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004029512405395508, "StateBufferConnector_ms": 0.0029535293579101562, "ViewRequirementAgentConnector_ms": 0.07111430168151855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440, "num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.72669983102104, "num_env_steps_trained_throughput_per_sec": 39.72669983102104, "timesteps_total": 244440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 244440, "timers": {"training_iteration_time_ms": 2948.868, "sample_time_ms": 2945.069, "load_time_ms": 0.227, "load_throughput": 527972.81, "learn_time_ms": 2.826, "learn_throughput": 42468.589, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440}, "done": false, "episodes_total": 2037, "training_iteration": 510, "trial_id": "4933d_00000", "date": "2023-07-26_03-16-34", "timestamp": 1690330594, "time_this_iter_s": 12.08516812324524, "time_total_s": 6211.683643341064, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 590.3581674098969, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 43.44117647058823, "ram_util_percent": 78.21176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4928894042969, "policy_loss": -103100.03125, "vf_loss": 4245367.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -753.3304157883993, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.353105033339688, "mean_inference_ms": 0.4033389459274755, "mean_action_processing_ms": 0.09620536919013034, "mean_env_wait_ms": 2.8162875917352697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004020214080810547, "StateBufferConnector_ms": 0.0029501914978027344, "ViewRequirementAgentConnector_ms": 0.07102680206298828}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -753.3304157883993, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-649.6581225813827, -1016.3680559691197, -596.0592954350286, -695.2343783224228, -709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.353105033339688, "mean_inference_ms": 0.4033389459274755, "mean_action_processing_ms": 0.09620536919013034, "mean_env_wait_ms": 2.8162875917352697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004020214080810547, "StateBufferConnector_ms": 0.0029501914978027344, "ViewRequirementAgentConnector_ms": 0.07102680206298828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920, "num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.22683539109229, "num_env_steps_trained_throughput_per_sec": 41.22683539109229, "timesteps_total": 244920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 244920, "timers": {"training_iteration_time_ms": 2959.845, "sample_time_ms": 2956.021, "load_time_ms": 0.226, "load_throughput": 530197.493, "learn_time_ms": 2.839, "learn_throughput": 42263.539, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920}, "done": false, "episodes_total": 2041, "training_iteration": 511, "trial_id": "4933d_00000", "date": "2023-07-26_03-16-45", "timestamp": 1690330605, "time_this_iter_s": 11.645636081695557, "time_total_s": 6223.32927942276, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 602.0038034915924, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 39.62941176470588, "ram_util_percent": 76.63529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.48626708984375, "policy_loss": -55019.08203125, "vf_loss": 1334520.625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 207.0, "diff_num_grad_updates_vs_sampler_policy": 206.0}}, "num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -749.3125602130787, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351724913474346, "mean_inference_ms": 0.4034429731682118, "mean_action_processing_ms": 0.09621860019965467, "mean_env_wait_ms": 2.8127783652929508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004015684127807617, "StateBufferConnector_ms": 0.002957582473754883, "ViewRequirementAgentConnector_ms": 0.0710902214050293}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -749.3125602130787, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-709.8379617130059, -788.7632677904409, -991.7503305347665, -786.0498885405406, -742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351724913474346, "mean_inference_ms": 0.4034429731682118, "mean_action_processing_ms": 0.09621860019965467, "mean_env_wait_ms": 2.8127783652929508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004015684127807617, "StateBufferConnector_ms": 0.002957582473754883, "ViewRequirementAgentConnector_ms": 0.0710902214050293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400, "num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.60266605423288, "num_env_steps_trained_throughput_per_sec": 41.60266605423288, "timesteps_total": 245400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 245400, "timers": {"training_iteration_time_ms": 2934.201, "sample_time_ms": 2930.294, "load_time_ms": 0.242, "load_throughput": 495731.784, "learn_time_ms": 2.903, "learn_throughput": 41339.144, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400}, "done": false, "episodes_total": 2045, "training_iteration": 512, "trial_id": "4933d_00000", "date": "2023-07-26_03-16-57", "timestamp": 1690330617, "time_this_iter_s": 11.540476322174072, "time_total_s": 6234.869755744934, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 613.5442798137665, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 36.425, "ram_util_percent": 77.04375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4755554199219, "policy_loss": -70008.6328125, "vf_loss": 2565451.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 211.0, "diff_num_grad_updates_vs_sampler_policy": 210.0}}, "num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -745.6446621521079, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350977531829678, "mean_inference_ms": 0.4035622173012192, "mean_action_processing_ms": 0.09623436025539465, "mean_env_wait_ms": 2.8094769669346067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004006624221801758, "StateBufferConnector_ms": 0.002951383590698242, "ViewRequirementAgentConnector_ms": 0.07105135917663574}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -745.6446621521079, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-742.456137069755, -648.5300046713578, -507.0602847451282, -654.8593588916843, -786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350977531829678, "mean_inference_ms": 0.4035622173012192, "mean_action_processing_ms": 0.09623436025539465, "mean_env_wait_ms": 2.8094769669346067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004006624221801758, "StateBufferConnector_ms": 0.002951383590698242, "ViewRequirementAgentConnector_ms": 0.07105135917663574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880, "num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.491287187115766, "num_env_steps_trained_throughput_per_sec": 41.491287187115766, "timesteps_total": 245880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 245880, "timers": {"training_iteration_time_ms": 2886.648, "sample_time_ms": 2882.815, "load_time_ms": 0.237, "load_throughput": 507375.484, "learn_time_ms": 2.852, "learn_throughput": 42078.04, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880}, "done": false, "episodes_total": 2049, "training_iteration": 513, "trial_id": "4933d_00000", "date": "2023-07-26_03-17-09", "timestamp": 1690330629, "time_this_iter_s": 11.571364879608154, "time_total_s": 6246.441120624542, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 625.1156446933746, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 38.88823529411764, "ram_util_percent": 76.51176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4842529296875, "policy_loss": -107941.015625, "vf_loss": 5696690.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 215.0, "diff_num_grad_updates_vs_sampler_policy": 214.0}}, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -755.3240061754269, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350011811377737, "mean_inference_ms": 0.4037213263733204, "mean_action_processing_ms": 0.09625757049371968, "mean_env_wait_ms": 2.8064601648353933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004026174545288086, "StateBufferConnector_ms": 0.002952098846435547, "ViewRequirementAgentConnector_ms": 0.07128453254699707}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -755.3240061754269, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-786.932172222778, -938.9839895212439, -751.6608489476976, -1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350011811377737, "mean_inference_ms": 0.4037213263733204, "mean_action_processing_ms": 0.09625757049371968, "mean_env_wait_ms": 2.8064601648353933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004026174545288086, "StateBufferConnector_ms": 0.002952098846435547, "ViewRequirementAgentConnector_ms": 0.07128453254699707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.97229784058301, "num_env_steps_trained_throughput_per_sec": 38.97229784058301, "timesteps_total": 246360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 246360, "timers": {"training_iteration_time_ms": 2965.964, "sample_time_ms": 2962.101, "load_time_ms": 0.229, "load_throughput": 525163.272, "learn_time_ms": 2.873, "learn_throughput": 41770.736, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "done": false, "episodes_total": 2053, "training_iteration": 514, "trial_id": "4933d_00000", "date": "2023-07-26_03-17-21", "timestamp": 1690330641, "time_this_iter_s": 12.319345951080322, "time_total_s": 6258.760466575623, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 637.434990644455, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 46.411764705882355, "ram_util_percent": 77.64117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.48516845703125, "policy_loss": -116178.890625, "vf_loss": 5638039.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 217.0}}, "num_env_steps_sampled": 246720, "num_env_steps_trained": 246720, "num_agent_steps_sampled": 246720, "num_agent_steps_trained": 246720}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -761.4515352344656, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35069409971053, "mean_inference_ms": 0.4038835423281211, "mean_action_processing_ms": 0.09628094650489834, "mean_env_wait_ms": 2.804542771537137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.002981901168823242, "ViewRequirementAgentConnector_ms": 0.07200193405151367}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -761.4515352344656, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1008.13458187713, -681.8708348844546, -926.1564012431132, -509.6101533855227, -779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35069409971053, "mean_inference_ms": 0.4038835423281211, "mean_action_processing_ms": 0.09628094650489834, "mean_env_wait_ms": 2.804542771537137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.002981901168823242, "ViewRequirementAgentConnector_ms": 0.07200193405151367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246720, "num_agent_steps_trained": 246720, "num_env_steps_sampled": 246720, "num_env_steps_trained": 246720, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 34.955830671527465, "num_env_steps_trained_throughput_per_sec": 34.955830671527465, "timesteps_total": 246720, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 246720, "timers": {"training_iteration_time_ms": 3130.542, "sample_time_ms": 3125.917, "load_time_ms": 0.281, "load_throughput": 427662.911, "learn_time_ms": 3.448, "learn_throughput": 34801.966, "synch_weights_time_ms": 0.832}, "counters": {"num_env_steps_sampled": 246720, "num_env_steps_trained": 246720, "num_agent_steps_sampled": 246720, "num_agent_steps_trained": 246720}, "done": false, "episodes_total": 2056, "training_iteration": 515, "trial_id": "4933d_00000", "date": "2023-07-26_03-17-31", "timestamp": 1690330651, "time_this_iter_s": 10.302227973937988, "time_total_s": 6269.062694549561, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 647.737218618393, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 49.373333333333335, "ram_util_percent": 79.20666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5033874511719, "policy_loss": -128569.859375, "vf_loss": 7625658.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 222.0, "diff_num_grad_updates_vs_sampler_policy": 221.0}}, "num_env_steps_sampled": 247200, "num_env_steps_trained": 247200, "num_agent_steps_sampled": 247200, "num_agent_steps_trained": 247200}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -769.4847612486482, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351794935218358, "mean_inference_ms": 0.4040807970901549, "mean_action_processing_ms": 0.09630911655874161, "mean_env_wait_ms": 2.802068423529714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004045724868774414, "StateBufferConnector_ms": 0.002973794937133789, "ViewRequirementAgentConnector_ms": 0.07181930541992188}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -769.4847612486482, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-779.4841732725406, -724.6385499556183, -641.1010574081811, -750.993616002214, -777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351794935218358, "mean_inference_ms": 0.4040807970901549, "mean_action_processing_ms": 0.09630911655874161, "mean_env_wait_ms": 2.802068423529714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004045724868774414, "StateBufferConnector_ms": 0.002973794937133789, "ViewRequirementAgentConnector_ms": 0.07181930541992188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247200, "num_agent_steps_trained": 247200, "num_env_steps_sampled": 247200, "num_env_steps_trained": 247200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.73465659575119, "num_env_steps_trained_throughput_per_sec": 40.73465659575119, "timesteps_total": 247200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 247200, "timers": {"training_iteration_time_ms": 3150.979, "sample_time_ms": 3146.318, "load_time_ms": 0.279, "load_throughput": 429524.219, "learn_time_ms": 3.474, "learn_throughput": 34539.973, "synch_weights_time_ms": 0.843}, "counters": {"num_env_steps_sampled": 247200, "num_env_steps_trained": 247200, "num_agent_steps_sampled": 247200, "num_agent_steps_trained": 247200}, "done": false, "episodes_total": 2060, "training_iteration": 516, "trial_id": "4933d_00000", "date": "2023-07-26_03-17-43", "timestamp": 1690330663, "time_this_iter_s": 11.786214828491211, "time_total_s": 6280.848909378052, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 659.5234334468842, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 46.45882352941176, "ram_util_percent": 76.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.50653076171875, "policy_loss": -108584.5, "vf_loss": 5439501.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 226.0, "diff_num_grad_updates_vs_sampler_policy": 225.0}}, "num_env_steps_sampled": 247680, "num_env_steps_trained": 247680, "num_agent_steps_sampled": 247680, "num_agent_steps_trained": 247680}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -767.3274285896836, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35271627150398, "mean_inference_ms": 0.4042679496757497, "mean_action_processing_ms": 0.09633593681956927, "mean_env_wait_ms": 2.7997296201277497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004043102264404297, "StateBufferConnector_ms": 0.0029861927032470703, "ViewRequirementAgentConnector_ms": 0.07176947593688965}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -767.3274285896836, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-777.2152345450494, -685.8768486605151, -957.5296842119933, -450.97303762588956, -1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35271627150398, "mean_inference_ms": 0.4042679496757497, "mean_action_processing_ms": 0.09633593681956927, "mean_env_wait_ms": 2.7997296201277497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004043102264404297, "StateBufferConnector_ms": 0.0029861927032470703, "ViewRequirementAgentConnector_ms": 0.07176947593688965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247680, "num_agent_steps_trained": 247680, "num_env_steps_sampled": 247680, "num_env_steps_trained": 247680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.45804816333725, "num_env_steps_trained_throughput_per_sec": 42.45804816333725, "timesteps_total": 247680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 247680, "timers": {"training_iteration_time_ms": 3009.988, "sample_time_ms": 3005.584, "load_time_ms": 0.254, "load_throughput": 473264.203, "learn_time_ms": 3.293, "learn_throughput": 36435.773, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 247680, "num_env_steps_trained": 247680, "num_agent_steps_sampled": 247680, "num_agent_steps_trained": 247680}, "done": false, "episodes_total": 2064, "training_iteration": 517, "trial_id": "4933d_00000", "date": "2023-07-26_03-17-54", "timestamp": 1690330674, "time_this_iter_s": 11.307955980300903, "time_total_s": 6292.156865358353, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 670.8313894271851, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 37.68125, "ram_util_percent": 76.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5005187988281, "policy_loss": -143920.921875, "vf_loss": 8547942.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 230.0, "diff_num_grad_updates_vs_sampler_policy": 229.0}}, "num_env_steps_sampled": 248160, "num_env_steps_trained": 248160, "num_agent_steps_sampled": 248160, "num_agent_steps_trained": 248160}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -767.249831111094, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.353735284456885, "mean_inference_ms": 0.4044065601873681, "mean_action_processing_ms": 0.0963539394807669, "mean_env_wait_ms": 2.7974828643544902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004050731658935547, "StateBufferConnector_ms": 0.002983570098876953, "ViewRequirementAgentConnector_ms": 0.07177209854125977}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -767.249831111094, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1094.5441029089577, -951.3943144147902, -752.1480599060735, -792.5823502076629, -1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.353735284456885, "mean_inference_ms": 0.4044065601873681, "mean_action_processing_ms": 0.0963539394807669, "mean_env_wait_ms": 2.7974828643544902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004050731658935547, "StateBufferConnector_ms": 0.002983570098876953, "ViewRequirementAgentConnector_ms": 0.07177209854125977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248160, "num_agent_steps_trained": 248160, "num_env_steps_sampled": 248160, "num_env_steps_trained": 248160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.94394791170584, "num_env_steps_trained_throughput_per_sec": 41.94394791170584, "timesteps_total": 248160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 248160, "timers": {"training_iteration_time_ms": 2848.12, "sample_time_ms": 2844.28, "load_time_ms": 0.218, "load_throughput": 551096.551, "learn_time_ms": 2.809, "learn_throughput": 42720.554, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 248160, "num_env_steps_trained": 248160, "num_agent_steps_sampled": 248160, "num_agent_steps_trained": 248160}, "done": false, "episodes_total": 2068, "training_iteration": 518, "trial_id": "4933d_00000", "date": "2023-07-26_03-18-06", "timestamp": 1690330686, "time_this_iter_s": 11.44660496711731, "time_total_s": 6303.60347032547, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 682.2779943943024, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 39.787499999999994, "ram_util_percent": 77.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.50018310546875, "policy_loss": -153925.046875, "vf_loss": 10742434.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 234.0, "diff_num_grad_updates_vs_sampler_policy": 233.0}}, "num_env_steps_sampled": 248640, "num_env_steps_trained": 248640, "num_agent_steps_sampled": 248640, "num_agent_steps_trained": 248640}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -760.6951057306655, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.352978494964987, "mean_inference_ms": 0.404470337925282, "mean_action_processing_ms": 0.09635787925519898, "mean_env_wait_ms": 2.7951610847385395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395965576171875, "StateBufferConnector_ms": 0.002921581268310547, "ViewRequirementAgentConnector_ms": 0.07015681266784668}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -760.6951057306655, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1001.1826543325674, -822.873705074443, -702.9630805212482, -975.9565417951299, -789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.352978494964987, "mean_inference_ms": 0.404470337925282, "mean_action_processing_ms": 0.09635787925519898, "mean_env_wait_ms": 2.7951610847385395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395965576171875, "StateBufferConnector_ms": 0.002921581268310547, "ViewRequirementAgentConnector_ms": 0.07015681266784668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248640, "num_agent_steps_trained": 248640, "num_env_steps_sampled": 248640, "num_env_steps_trained": 248640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.858610310948436, "num_env_steps_trained_throughput_per_sec": 41.858610310948436, "timesteps_total": 248640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 248640, "timers": {"training_iteration_time_ms": 2855.299, "sample_time_ms": 2851.472, "load_time_ms": 0.217, "load_throughput": 551882.105, "learn_time_ms": 2.796, "learn_throughput": 42912.139, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 248640, "num_env_steps_trained": 248640, "num_agent_steps_sampled": 248640, "num_agent_steps_trained": 248640}, "done": false, "episodes_total": 2072, "training_iteration": 519, "trial_id": "4933d_00000", "date": "2023-07-26_03-18-17", "timestamp": 1690330697, "time_this_iter_s": 11.470058917999268, "time_total_s": 6315.073529243469, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 693.7480533123016, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 42.01875, "ram_util_percent": 77.78125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5130920410156, "policy_loss": -106712.875, "vf_loss": 4816804.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 238.0, "diff_num_grad_updates_vs_sampler_policy": 237.0}}, "num_env_steps_sampled": 249120, "num_env_steps_trained": 249120, "num_agent_steps_sampled": 249120, "num_agent_steps_trained": 249120}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -755.1710499390653, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351986464727975, "mean_inference_ms": 0.404519010522381, "mean_action_processing_ms": 0.09635899477130373, "mean_env_wait_ms": 2.7927906470804817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039670467376708984, "StateBufferConnector_ms": 0.0029168128967285156, "ViewRequirementAgentConnector_ms": 0.07026481628417969}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -755.1710499390653, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-789.8894196307336, -857.6877262374312, -788.1914510607392, -902.2393696721676, -616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351986464727975, "mean_inference_ms": 0.404519010522381, "mean_action_processing_ms": 0.09635899477130373, "mean_env_wait_ms": 2.7927906470804817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039670467376708984, "StateBufferConnector_ms": 0.0029168128967285156, "ViewRequirementAgentConnector_ms": 0.07026481628417969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249120, "num_agent_steps_trained": 249120, "num_env_steps_sampled": 249120, "num_env_steps_trained": 249120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.49518282608301, "num_env_steps_trained_throughput_per_sec": 40.49518282608301, "timesteps_total": 249120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 249120, "timers": {"training_iteration_time_ms": 2899.967, "sample_time_ms": 2896.056, "load_time_ms": 0.219, "load_throughput": 547618.845, "learn_time_ms": 2.862, "learn_throughput": 41930.112, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 249120, "num_env_steps_trained": 249120, "num_agent_steps_sampled": 249120, "num_agent_steps_trained": 249120}, "done": false, "episodes_total": 2076, "training_iteration": 520, "trial_id": "4933d_00000", "date": "2023-07-26_03-18-29", "timestamp": 1690330709, "time_this_iter_s": 11.85731029510498, "time_total_s": 6326.930839538574, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 705.6053636074066, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 42.72941176470589, "ram_util_percent": 78.65882352941175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.50244140625, "policy_loss": -135639.609375, "vf_loss": 7741796.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 242.0, "diff_num_grad_updates_vs_sampler_policy": 241.0}}, "num_env_steps_sampled": 249600, "num_env_steps_trained": 249600, "num_agent_steps_sampled": 249600, "num_agent_steps_trained": 249600}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -758.8188306162828, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35136753862979, "mean_inference_ms": 0.4045889343904986, "mean_action_processing_ms": 0.09636470702221618, "mean_env_wait_ms": 2.790541976735926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003989696502685547, "StateBufferConnector_ms": 0.0029244422912597656, "ViewRequirementAgentConnector_ms": 0.07057809829711914}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -758.8188306162828, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-616.1509480085947, -983.7445086025922, -552.2132812508071, -882.6279851520175, -863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35136753862979, "mean_inference_ms": 0.4045889343904986, "mean_action_processing_ms": 0.09636470702221618, "mean_env_wait_ms": 2.790541976735926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003989696502685547, "StateBufferConnector_ms": 0.0029244422912597656, "ViewRequirementAgentConnector_ms": 0.07057809829711914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249600, "num_agent_steps_trained": 249600, "num_env_steps_sampled": 249600, "num_env_steps_trained": 249600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.72577047713779, "num_env_steps_trained_throughput_per_sec": 40.72577047713779, "timesteps_total": 249600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 249600, "timers": {"training_iteration_time_ms": 2936.818, "sample_time_ms": 2932.99, "load_time_ms": 0.221, "load_throughput": 542074.83, "learn_time_ms": 2.856, "learn_throughput": 42011.308, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 249600, "num_env_steps_trained": 249600, "num_agent_steps_sampled": 249600, "num_agent_steps_trained": 249600}, "done": false, "episodes_total": 2080, "training_iteration": 521, "trial_id": "4933d_00000", "date": "2023-07-26_03-18-41", "timestamp": 1690330721, "time_this_iter_s": 11.788851022720337, "time_total_s": 6338.719690561295, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 717.394214630127, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 42.61764705882353, "ram_util_percent": 77.38823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.52313232421875, "policy_loss": -126580.453125, "vf_loss": 6915061.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 246.0, "diff_num_grad_updates_vs_sampler_policy": 245.0}}, "num_env_steps_sampled": 250080, "num_env_steps_trained": 250080, "num_agent_steps_sampled": 250080, "num_agent_steps_trained": 250080}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -762.6214592732474, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350782912640675, "mean_inference_ms": 0.4046570344476755, "mean_action_processing_ms": 0.09636974822223163, "mean_env_wait_ms": 2.7884082274421207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039899349212646484, "StateBufferConnector_ms": 0.002923250198364258, "ViewRequirementAgentConnector_ms": 0.07050609588623047}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -762.6214592732474, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-863.8090412619688, -842.2194643464316, -637.3484466355213, -605.7974270785728, -1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350782912640675, "mean_inference_ms": 0.4046570344476755, "mean_action_processing_ms": 0.09636974822223163, "mean_env_wait_ms": 2.7884082274421207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039899349212646484, "StateBufferConnector_ms": 0.002923250198364258, "ViewRequirementAgentConnector_ms": 0.07050609588623047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250080, "num_agent_steps_trained": 250080, "num_env_steps_sampled": 250080, "num_env_steps_trained": 250080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.116279172418366, "num_env_steps_trained_throughput_per_sec": 42.116279172418366, "timesteps_total": 250080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 250080, "timers": {"training_iteration_time_ms": 2909.13, "sample_time_ms": 2905.333, "load_time_ms": 0.22, "load_throughput": 544891.718, "learn_time_ms": 2.822, "learn_throughput": 42519.175, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 250080, "num_env_steps_trained": 250080, "num_agent_steps_sampled": 250080, "num_agent_steps_trained": 250080}, "done": false, "episodes_total": 2084, "training_iteration": 522, "trial_id": "4933d_00000", "date": "2023-07-26_03-18-53", "timestamp": 1690330733, "time_this_iter_s": 11.3996901512146, "time_total_s": 6350.119380712509, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 728.7939047813416, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 34.925, "ram_util_percent": 75.24375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4901123046875, "policy_loss": -64695.78125, "vf_loss": 1713095.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 250.0, "diff_num_grad_updates_vs_sampler_policy": 249.0}}, "num_env_steps_sampled": 250560, "num_env_steps_trained": 250560, "num_agent_steps_sampled": 250560, "num_agent_steps_trained": 250560}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -760.1046372097132, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35117391294789, "mean_inference_ms": 0.40477914945488747, "mean_action_processing_ms": 0.0963837820793814, "mean_env_wait_ms": 2.7865295172655498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004014492034912109, "StateBufferConnector_ms": 0.0029370784759521484, "ViewRequirementAgentConnector_ms": 0.07087182998657227}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1319.3592930258258, "episode_reward_mean": -760.1046372097132, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1319.3592930258258, -648.1834352172489, -789.456269010767, -922.3619249064915, -877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35117391294789, "mean_inference_ms": 0.40477914945488747, "mean_action_processing_ms": 0.0963837820793814, "mean_env_wait_ms": 2.7865295172655498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004014492034912109, "StateBufferConnector_ms": 0.0029370784759521484, "ViewRequirementAgentConnector_ms": 0.07087182998657227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250560, "num_agent_steps_trained": 250560, "num_env_steps_sampled": 250560, "num_env_steps_trained": 250560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.20160098987616, "num_env_steps_trained_throughput_per_sec": 39.20160098987616, "timesteps_total": 250560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 250560, "timers": {"training_iteration_time_ms": 2949.487, "sample_time_ms": 2945.748, "load_time_ms": 0.22, "load_throughput": 545364.048, "learn_time_ms": 2.775, "learn_throughput": 43236.533, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 250560, "num_env_steps_trained": 250560, "num_agent_steps_sampled": 250560, "num_agent_steps_trained": 250560}, "done": false, "episodes_total": 2088, "training_iteration": 523, "trial_id": "4933d_00000", "date": "2023-07-26_03-19-05", "timestamp": 1690330745, "time_this_iter_s": 12.247076749801636, "time_total_s": 6362.366457462311, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 741.0409815311432, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 45.90555555555555, "ram_util_percent": 76.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4850769042969, "policy_loss": -64843.01171875, "vf_loss": 2051977.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 254.0, "diff_num_grad_updates_vs_sampler_policy": 253.0}}, "num_env_steps_sampled": 251040, "num_env_steps_trained": 251040, "num_agent_steps_sampled": 251040, "num_agent_steps_trained": 251040}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -751.8159328073672, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351394830267253, "mean_inference_ms": 0.4048839958582202, "mean_action_processing_ms": 0.09639526201625317, "mean_env_wait_ms": 2.7847219531842176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004018068313598633, "StateBufferConnector_ms": 0.00295257568359375, "ViewRequirementAgentConnector_ms": 0.07120513916015625}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -751.8159328073672, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-877.7572293312977, -502.91611265508914, -540.1985566598214, -780.2552925747505, -539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351394830267253, "mean_inference_ms": 0.4048839958582202, "mean_action_processing_ms": 0.09639526201625317, "mean_env_wait_ms": 2.7847219531842176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004018068313598633, "StateBufferConnector_ms": 0.00295257568359375, "ViewRequirementAgentConnector_ms": 0.07120513916015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251040, "num_agent_steps_trained": 251040, "num_env_steps_sampled": 251040, "num_env_steps_trained": 251040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.73819762153136, "num_env_steps_trained_throughput_per_sec": 41.73819762153136, "timesteps_total": 251040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 251040, "timers": {"training_iteration_time_ms": 2952.022, "sample_time_ms": 2948.162, "load_time_ms": 0.228, "load_throughput": 526536.751, "learn_time_ms": 2.853, "learn_throughput": 42054.836, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 251040, "num_env_steps_trained": 251040, "num_agent_steps_sampled": 251040, "num_agent_steps_trained": 251040}, "done": false, "episodes_total": 2092, "training_iteration": 524, "trial_id": "4933d_00000", "date": "2023-07-26_03-19-16", "timestamp": 1690330756, "time_this_iter_s": 11.503586053848267, "time_total_s": 6373.870043516159, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 752.5445675849915, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 40.5625, "ram_util_percent": 76.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.515869140625, "policy_loss": -124005.375, "vf_loss": 6283405.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 258.0, "diff_num_grad_updates_vs_sampler_policy": 257.0}}, "num_env_steps_sampled": 251520, "num_env_steps_trained": 251520, "num_agent_steps_sampled": 251520, "num_agent_steps_trained": 251520}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -755.0467466110084, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35149210056454, "mean_inference_ms": 0.4049842246227899, "mean_action_processing_ms": 0.09640655238195828, "mean_env_wait_ms": 2.7830529956961993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003991127014160156, "StateBufferConnector_ms": 0.002953767776489258, "ViewRequirementAgentConnector_ms": 0.07100439071655273}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -755.0467466110084, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-539.4106400635618, -527.8856902164466, -742.9586846940774, -675.7177813755991, -507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35149210056454, "mean_inference_ms": 0.4049842246227899, "mean_action_processing_ms": 0.09640655238195828, "mean_env_wait_ms": 2.7830529956961993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003991127014160156, "StateBufferConnector_ms": 0.002953767776489258, "ViewRequirementAgentConnector_ms": 0.07100439071655273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251520, "num_agent_steps_trained": 251520, "num_env_steps_sampled": 251520, "num_env_steps_trained": 251520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.34499977455474, "num_env_steps_trained_throughput_per_sec": 40.34499977455474, "timesteps_total": 251520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 251520, "timers": {"training_iteration_time_ms": 2979.584, "sample_time_ms": 2975.709, "load_time_ms": 0.229, "load_throughput": 524342.619, "learn_time_ms": 2.871, "learn_throughput": 41799.875, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 251520, "num_env_steps_trained": 251520, "num_agent_steps_sampled": 251520, "num_agent_steps_trained": 251520}, "done": false, "episodes_total": 2096, "training_iteration": 525, "trial_id": "4933d_00000", "date": "2023-07-26_03-19-28", "timestamp": 1690330768, "time_this_iter_s": 11.900259733200073, "time_total_s": 6385.770303249359, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 764.4448273181915, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 43.182352941176475, "ram_util_percent": 76.85294117647061}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5224609375, "policy_loss": -95832.125, "vf_loss": 3854557.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 262.0, "diff_num_grad_updates_vs_sampler_policy": 261.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -758.5476986304379, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351306304875447, "mean_inference_ms": 0.405089356281501, "mean_action_processing_ms": 0.09641883439834703, "mean_env_wait_ms": 2.7815405068361145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040209293365478516, "StateBufferConnector_ms": 0.0029647350311279297, "ViewRequirementAgentConnector_ms": 0.07126903533935547}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -758.5476986304379, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-507.7929228708002, -424.08931767274487, -686.7074598252846, -563.4986901384854, -547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351306304875447, "mean_inference_ms": 0.405089356281501, "mean_action_processing_ms": 0.09641883439834703, "mean_env_wait_ms": 2.7815405068361145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040209293365478516, "StateBufferConnector_ms": 0.0029647350311279297, "ViewRequirementAgentConnector_ms": 0.07126903533935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.10968837785566, "num_env_steps_trained_throughput_per_sec": 41.10968837785566, "timesteps_total": 252000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2931.734, "sample_time_ms": 2927.839, "load_time_ms": 0.232, "load_throughput": 516858.164, "learn_time_ms": 2.887, "learn_throughput": 41565.487, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 2100, "training_iteration": 526, "trial_id": "4933d_00000", "date": "2023-07-26_03-19-40", "timestamp": 1690330780, "time_this_iter_s": 11.678910970687866, "time_total_s": 6397.449214220047, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 776.1237382888794, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 40.84705882352941, "ram_util_percent": 77.74705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.4703063964844, "policy_loss": -60220.3828125, "vf_loss": 1865986.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 266.0, "diff_num_grad_updates_vs_sampler_policy": 265.0}}, "num_env_steps_sampled": 252480, "num_env_steps_trained": 252480, "num_agent_steps_sampled": 252480, "num_agent_steps_trained": 252480}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -766.6851606571694, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005, -601.2634092978647, -816.7159204778851, -1071.4023051146726, -506.45295829001975], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350837687353696, "mean_inference_ms": 0.40520102732373503, "mean_action_processing_ms": 0.09643227318180893, "mean_env_wait_ms": 2.7801375838616513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004018545150756836, "StateBufferConnector_ms": 0.002964019775390625, "ViewRequirementAgentConnector_ms": 0.07128691673278809}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -766.6851606571694, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-547.9214738859803, -687.6528736954226, -792.7201969764412, -922.0064791593356, -746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005, -601.2634092978647, -816.7159204778851, -1071.4023051146726, -506.45295829001975], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350837687353696, "mean_inference_ms": 0.40520102732373503, "mean_action_processing_ms": 0.09643227318180893, "mean_env_wait_ms": 2.7801375838616513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004018545150756836, "StateBufferConnector_ms": 0.002964019775390625, "ViewRequirementAgentConnector_ms": 0.07128691673278809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252480, "num_agent_steps_trained": 252480, "num_env_steps_sampled": 252480, "num_env_steps_trained": 252480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.32749712913248, "num_env_steps_trained_throughput_per_sec": 42.32749712913248, "timesteps_total": 252480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 252480, "timers": {"training_iteration_time_ms": 2906.649, "sample_time_ms": 2902.761, "load_time_ms": 0.231, "load_throughput": 519150.572, "learn_time_ms": 2.883, "learn_throughput": 41622.891, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 252480, "num_env_steps_trained": 252480, "num_agent_steps_sampled": 252480, "num_agent_steps_trained": 252480}, "done": false, "episodes_total": 2104, "training_iteration": 527, "trial_id": "4933d_00000", "date": "2023-07-26_03-19-51", "timestamp": 1690330791, "time_this_iter_s": 11.343003988265991, "time_total_s": 6408.792218208313, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 787.4667422771454, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 37.431250000000006, "ram_util_percent": 77.21249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.5008850097656, "policy_loss": -94283.3203125, "vf_loss": 4057270.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 270.0, "diff_num_grad_updates_vs_sampler_policy": 269.0}}, "num_env_steps_sampled": 252960, "num_env_steps_trained": 252960, "num_agent_steps_sampled": 252960, "num_agent_steps_trained": 252960}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -765.6261580060035, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005, -601.2634092978647, -816.7159204778851, -1071.4023051146726, -506.45295829001975, -525.9783773349787, -612.7326574702024, -878.0772150686433, -827.6125087267972], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.349340482802113, "mean_inference_ms": 0.4053043288544505, "mean_action_processing_ms": 0.09644452074400667, "mean_env_wait_ms": 2.7782137418208914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039424896240234375, "StateBufferConnector_ms": 0.0029282569885253906, "ViewRequirementAgentConnector_ms": 0.07071137428283691}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -765.6261580060035, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-746.950918603032, -788.7179418624287, -934.1738257931721, -741.545334877965, -687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005, -601.2634092978647, -816.7159204778851, -1071.4023051146726, -506.45295829001975, -525.9783773349787, -612.7326574702024, -878.0772150686433, -827.6125087267972], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.349340482802113, "mean_inference_ms": 0.4053043288544505, "mean_action_processing_ms": 0.09644452074400667, "mean_env_wait_ms": 2.7782137418208914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039424896240234375, "StateBufferConnector_ms": 0.0029282569885253906, "ViewRequirementAgentConnector_ms": 0.07071137428283691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252960, "num_agent_steps_trained": 252960, "num_env_steps_sampled": 252960, "num_env_steps_trained": 252960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.42323620555417, "num_env_steps_trained_throughput_per_sec": 41.42323620555417, "timesteps_total": 252960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 252960, "timers": {"training_iteration_time_ms": 2874.119, "sample_time_ms": 2870.363, "load_time_ms": 0.217, "load_throughput": 553277.432, "learn_time_ms": 2.791, "learn_throughput": 43001.596, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 252960, "num_env_steps_trained": 252960, "num_agent_steps_sampled": 252960, "num_agent_steps_trained": 252960}, "done": false, "episodes_total": 2108, "training_iteration": 528, "trial_id": "4933d_00000", "date": "2023-07-26_03-20-03", "timestamp": 1690330803, "time_this_iter_s": 11.590584993362427, "time_total_s": 6420.382803201675, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 799.0573272705078, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 38.46470588235294, "ram_util_percent": 76.40588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-10, "entropy_coeff": 0.05, "policy_entropy": 267.51202392578125, "policy_loss": -107032.3671875, "vf_loss": 5346954.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 274.0, "diff_num_grad_updates_vs_sampler_policy": 273.0}}, "num_env_steps_sampled": 253440, "num_env_steps_trained": 253440, "num_agent_steps_sampled": 253440, "num_agent_steps_trained": 253440}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -767.350315936782, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005, -601.2634092978647, -816.7159204778851, -1071.4023051146726, -506.45295829001975, -525.9783773349787, -612.7326574702024, -878.0772150686433, -827.6125087267972, -643.5835611939578, -907.9683000392507, -970.3217151422692, -861.9302378389481], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34709167045724, "mean_inference_ms": 0.4053996913189327, "mean_action_processing_ms": 0.09645573345923852, "mean_env_wait_ms": 2.77622482473742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003950595855712891, "StateBufferConnector_ms": 0.002918243408203125, "ViewRequirementAgentConnector_ms": 0.07073426246643066}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -767.350315936782, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-687.4566811156875, -859.0329069140904, -730.2608637727064, -660.6794975719605, -1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005, -601.2634092978647, -816.7159204778851, -1071.4023051146726, -506.45295829001975, -525.9783773349787, -612.7326574702024, -878.0772150686433, -827.6125087267972, -643.5835611939578, -907.9683000392507, -970.3217151422692, -861.9302378389481], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34709167045724, "mean_inference_ms": 0.4053996913189327, "mean_action_processing_ms": 0.09645573345923852, "mean_env_wait_ms": 2.77622482473742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003950595855712891, "StateBufferConnector_ms": 0.002918243408203125, "ViewRequirementAgentConnector_ms": 0.07073426246643066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253440, "num_agent_steps_trained": 253440, "num_env_steps_sampled": 253440, "num_env_steps_trained": 253440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.66464028787005, "num_env_steps_trained_throughput_per_sec": 40.66464028787005, "timesteps_total": 253440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 253440, "timers": {"training_iteration_time_ms": 2911.645, "sample_time_ms": 2907.875, "load_time_ms": 0.217, "load_throughput": 554008.233, "learn_time_ms": 2.787, "learn_throughput": 43061.196, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 253440, "num_env_steps_trained": 253440, "num_agent_steps_sampled": 253440, "num_agent_steps_trained": 253440}, "done": false, "episodes_total": 2112, "training_iteration": 529, "trial_id": "4933d_00000", "date": "2023-07-26_03-20-15", "timestamp": 1690330815, "time_this_iter_s": 11.806517124176025, "time_total_s": 6432.189320325851, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 810.8638443946838, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 38.625, "ram_util_percent": 77.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47479248046875, "policy_loss": -94702.640625, "vf_loss": 4441483.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 278.0, "diff_num_grad_updates_vs_sampler_policy": 277.0}}, "num_env_steps_sampled": 253920, "num_env_steps_trained": 253920, "num_agent_steps_sampled": 253920, "num_agent_steps_trained": 253920}, "sampler_results": {"episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -766.5147139926662, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005, -601.2634092978647, -816.7159204778851, -1071.4023051146726, -506.45295829001975, -525.9783773349787, -612.7326574702024, -878.0772150686433, -827.6125087267972, -643.5835611939578, -907.9683000392507, -970.3217151422692, -861.9302378389481, -777.6640467585805, -671.7316713439866, -656.330855228521, -748.1431816318055], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34482627180163, "mean_inference_ms": 0.4054714569643945, "mean_action_processing_ms": 0.09646291082582348, "mean_env_wait_ms": 2.774280723273571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931760787963867, "StateBufferConnector_ms": 0.002892732620239258, "ViewRequirementAgentConnector_ms": 0.0703737735748291}}, "episode_reward_max": -292.498416379429, "episode_reward_min": -1194.2726695434912, "episode_reward_mean": -766.5147139926662, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1006.1906368995517, -659.6516821503201, -677.050089456908, -843.4266831530916, -898.8662431210424, -707.6762747092502, -1051.3869243426552, -625.7841148554551, -639.3967098932432, -292.498416379429, -801.3762166791424, -631.012081464441, -828.0950649357807, -655.2453027235288, -777.5338395446969, -719.3608856969955, -695.2945995689945, -898.2125762753225, -652.9368565500183, -864.524719241857, -860.1657610284226, -754.4902471631508, -756.9467583328098, -518.966961109455, -795.9314909708125, -672.609929615454, -786.6538677835931, -679.483659241483, -416.7868381353835, -414.48299290144143, -1128.3662953592661, -856.0611706619884, -510.7011835589823, -954.8755647020948, -952.7105545460934, -704.0165438441129, -909.2375246175155, -1194.2726695434912, -960.8301433543558, -935.2271036977147, -998.5118737342125, -1070.4360110545053, -885.0116225418112, -975.1350654779595, -632.8051548599246, -408.298384294157, -793.2411150140325, -846.1394765739872, -640.8670654870506, -742.8230256222616, -460.5140839618128, -1019.6308821133649, -788.3442362455374, -459.23799731777524, -607.2455433817483, -1080.3685124495842, -823.0934206790262, -707.2973029010624, -591.4877664670169, -828.691912516252, -771.2431345103485, -958.5309855802171, -1039.439652297499, -933.5722619347481, -976.3820840267122, -385.386725609385, -1173.5658423298519, -879.6649367445473, -862.2028276717216, -861.4588196349754, -510.39112072316334, -463.439404939214, -678.848287676063, -630.6439566454465, -919.9664301777727, -621.0318074264569, -591.7840222674125, -898.7187491781614, -560.2290573198775, -973.4767428196092, -847.0825174844732, -558.1023298578424, -766.4297816165289, -664.4533693338005, -601.2634092978647, -816.7159204778851, -1071.4023051146726, -506.45295829001975, -525.9783773349787, -612.7326574702024, -878.0772150686433, -827.6125087267972, -643.5835611939578, -907.9683000392507, -970.3217151422692, -861.9302378389481, -777.6640467585805, -671.7316713439866, -656.330855228521, -748.1431816318055], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34482627180163, "mean_inference_ms": 0.4054714569643945, "mean_action_processing_ms": 0.09646291082582348, "mean_env_wait_ms": 2.774280723273571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931760787963867, "StateBufferConnector_ms": 0.002892732620239258, "ViewRequirementAgentConnector_ms": 0.0703737735748291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253920, "num_agent_steps_trained": 253920, "num_env_steps_sampled": 253920, "num_env_steps_trained": 253920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.517669740323285, "num_env_steps_trained_throughput_per_sec": 40.517669740323285, "timesteps_total": 253920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 253920, "timers": {"training_iteration_time_ms": 2951.138, "sample_time_ms": 2947.356, "load_time_ms": 0.216, "load_throughput": 554924.454, "learn_time_ms": 2.793, "learn_throughput": 42965.255, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 253920, "num_env_steps_trained": 253920, "num_agent_steps_sampled": 253920, "num_agent_steps_trained": 253920}, "done": false, "episodes_total": 2116, "training_iteration": 530, "trial_id": "4933d_00000", "date": "2023-07-26_03-20-27", "timestamp": 1690330827, "time_this_iter_s": 11.849360227584839, "time_total_s": 6444.038680553436, "pid": 93500, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-09], [256080, 5e-09], [258480, 2.5e-09], [260880, 2.5e-09], [263280, 2.5e-09], [265680, 2.5e-09], [268080, 1e-09], [270480, 1e-09], [272880, 1e-09], [275280, 5e-10], [277680, 5e-10], [280080, 5e-10], [282480, 5e-10], [284880, 5e-10], [287280, 1e-10], [289680, 1e-10], [292080, 1e-10]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x303653700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 822.7132046222687, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 37.688235294117646, "ram_util_percent": 77.60588235294118}}
