{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00046666666666666666, "entropy_coeff": 0.1, "policy_entropy": 285.9139099121094, "policy_loss": -199369.1875, "vf_loss": 15346583.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 600, "num_env_steps_trained": 600, "num_agent_steps_sampled": 600, "num_agent_steps_trained": 600}, "sampler_results": {"episode_reward_max": -1051.0693343662952, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1323.287918437914, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987], "episode_lengths": [120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.019583189546964, "mean_inference_ms": 0.2750806919548555, "mean_action_processing_ms": 0.06285761041371478, "mean_env_wait_ms": 4.756964383625151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031757354736328125, "StateBufferConnector_ms": 0.0020360946655273438, "ViewRequirementAgentConnector_ms": 0.04913806915283203}}, "episode_reward_max": -1051.0693343662952, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1323.287918437914, "episode_len_mean": 120.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987], "episode_lengths": [120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.019583189546964, "mean_inference_ms": 0.2750806919548555, "mean_action_processing_ms": 0.06285761041371478, "mean_env_wait_ms": 4.756964383625151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031757354736328125, "StateBufferConnector_ms": 0.0020360946655273438, "ViewRequirementAgentConnector_ms": 0.04913806915283203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600, "num_agent_steps_trained": 600, "num_env_steps_sampled": 600, "num_env_steps_trained": 600, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 600, "num_env_steps_sampled_throughput_per_sec": 54.813146761429934, "num_env_steps_trained_throughput_per_sec": 54.813146761429934, "timesteps_total": 600, "num_steps_trained_this_iter": 600, "agent_timesteps_total": 600, "timers": {"training_iteration_time_ms": 2189.245, "sample_time_ms": 2181.514, "load_time_ms": 0.191, "load_throughput": 627420.194, "learn_time_ms": 6.953, "learn_throughput": 17258.853, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 600, "num_env_steps_trained": 600, "num_agent_steps_sampled": 600, "num_agent_steps_trained": 600}, "done": false, "episodes_total": 5, "training_iteration": 1, "trial_id": "487fa_00000", "date": "2023-07-24_20-55-47", "timestamp": 1690221347, "time_this_iter_s": 10.9481360912323, "time_total_s": 10.9481360912323, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.9481360912323, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.931250000000002, "ram_util_percent": 76.01249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0004166666666666667, "entropy_coeff": 0.1, "policy_entropy": 285.4430847167969, "policy_loss": -182645.421875, "vf_loss": 13109140.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 1320, "num_env_steps_trained": 1320, "num_agent_steps_sampled": 1320, "num_agent_steps_trained": 1320}, "sampler_results": {"episode_reward_max": -1051.0693343662952, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1304.263326158038, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.015122457622319, "mean_inference_ms": 0.27526922752505045, "mean_action_processing_ms": 0.06302520133648591, "mean_env_wait_ms": 3.894638814558412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002952055497602983, "StateBufferConnector_ms": 0.0019767067649147725, "ViewRequirementAgentConnector_ms": 0.04995736208829013}}, "episode_reward_max": -1051.0693343662952, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1304.263326158038, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.015122457622319, "mean_inference_ms": 0.27526922752505045, "mean_action_processing_ms": 0.06302520133648591, "mean_env_wait_ms": 3.894638814558412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002952055497602983, "StateBufferConnector_ms": 0.0019767067649147725, "ViewRequirementAgentConnector_ms": 0.04995736208829013}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320, "num_agent_steps_trained": 1320, "num_env_steps_sampled": 1320, "num_env_steps_trained": 1320, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.55060663257169, "num_env_steps_trained_throughput_per_sec": 65.55060663257169, "timesteps_total": 1320, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 1320, "timers": {"training_iteration_time_ms": 1825.812, "sample_time_ms": 1823.092, "load_time_ms": 0.143, "load_throughput": 841244.326, "learn_time_ms": 2.038, "learn_throughput": 58887.398, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 1320, "num_env_steps_trained": 1320, "num_agent_steps_sampled": 1320, "num_agent_steps_trained": 1320}, "done": false, "episodes_total": 11, "training_iteration": 2, "trial_id": "487fa_00000", "date": "2023-07-24_20-55-58", "timestamp": 1690221358, "time_this_iter_s": 10.985657930374146, "time_total_s": 21.933794021606445, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 21.933794021606445, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.293750000000003, "ram_util_percent": 76.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00036666666666666667, "entropy_coeff": 0.1, "policy_entropy": 280.79986572265625, "policy_loss": -124507.796875, "vf_loss": 6215548.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 2040, "num_env_steps_trained": 2040, "num_agent_steps_sampled": 2040, "num_agent_steps_trained": 2040}, "sampler_results": {"episode_reward_max": -934.1740148088348, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1235.7725670824807, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.023402002726513, "mean_inference_ms": 0.2732140306556629, "mean_action_processing_ms": 0.06272002957573657, "mean_env_wait_ms": 3.470714670119457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002781082602108226, "StateBufferConnector_ms": 0.0019045437083524816, "ViewRequirementAgentConnector_ms": 0.04948167239918428}}, "episode_reward_max": -934.1740148088348, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1235.7725670824807, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.023402002726513, "mean_inference_ms": 0.2732140306556629, "mean_action_processing_ms": 0.06272002957573657, "mean_env_wait_ms": 3.470714670119457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002781082602108226, "StateBufferConnector_ms": 0.0019045437083524816, "ViewRequirementAgentConnector_ms": 0.04948167239918428}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040, "num_agent_steps_trained": 2040, "num_env_steps_sampled": 2040, "num_env_steps_trained": 2040, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.48855632647901, "num_env_steps_trained_throughput_per_sec": 65.48855632647901, "timesteps_total": 2040, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 2040, "timers": {"training_iteration_time_ms": 1834.679, "sample_time_ms": 1832.101, "load_time_ms": 0.144, "load_throughput": 831378.394, "learn_time_ms": 1.898, "learn_throughput": 63237.864, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 2040, "num_env_steps_trained": 2040, "num_agent_steps_sampled": 2040, "num_agent_steps_trained": 2040}, "done": false, "episodes_total": 17, "training_iteration": 3, "trial_id": "487fa_00000", "date": "2023-07-24_20-56-09", "timestamp": 1690221369, "time_this_iter_s": 10.996519804000854, "time_total_s": 32.9303138256073, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 32.9303138256073, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.746666666666666, "ram_util_percent": 76.18666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0003166666666666667, "entropy_coeff": 0.1, "policy_entropy": 263.12872314453125, "policy_loss": -94214.5703125, "vf_loss": 4585655.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 2760, "num_env_steps_trained": 2760, "num_agent_steps_sampled": 2760, "num_agent_steps_trained": 2760}, "sampler_results": {"episode_reward_max": -755.998806728208, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1141.0204794623137, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.027969066758025, "mean_inference_ms": 0.2714975700852153, "mean_action_processing_ms": 0.06244962768349863, "mean_env_wait_ms": 3.2064366977508296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027169351992399797, "StateBufferConnector_ms": 0.0019052754277768342, "ViewRequirementAgentConnector_ms": 0.051022612530252205}}, "episode_reward_max": -755.998806728208, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1141.0204794623137, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.027969066758025, "mean_inference_ms": 0.2714975700852153, "mean_action_processing_ms": 0.06244962768349863, "mean_env_wait_ms": 3.2064366977508296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027169351992399797, "StateBufferConnector_ms": 0.0019052754277768342, "ViewRequirementAgentConnector_ms": 0.051022612530252205}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760, "num_agent_steps_trained": 2760, "num_env_steps_sampled": 2760, "num_env_steps_trained": 2760, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.74648434483514, "num_env_steps_trained_throughput_per_sec": 65.74648434483514, "timesteps_total": 2760, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 2760, "timers": {"training_iteration_time_ms": 1828.914, "sample_time_ms": 1826.34, "load_time_ms": 0.146, "load_throughput": 823489.005, "learn_time_ms": 1.894, "learn_throughput": 63359.662, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 2760, "num_env_steps_trained": 2760, "num_agent_steps_sampled": 2760, "num_agent_steps_trained": 2760}, "done": false, "episodes_total": 23, "training_iteration": 4, "trial_id": "487fa_00000", "date": "2023-07-24_20-56-20", "timestamp": 1690221380, "time_this_iter_s": 10.953013896942139, "time_total_s": 43.88332772254944, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 43.88332772254944, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.23125, "ram_util_percent": 76.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0002666666666666667, "entropy_coeff": 0.1, "policy_entropy": 262.7968444824219, "policy_loss": -109989.296875, "vf_loss": 6302709.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 3480, "num_env_steps_trained": 3480, "num_agent_steps_sampled": 3480, "num_agent_steps_trained": 3480}, "sampler_results": {"episode_reward_max": -650.0618154367022, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1074.1875545745418, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.031292354292827, "mean_inference_ms": 0.2704390720668368, "mean_action_processing_ms": 0.06227541659220238, "mean_env_wait_ms": 3.0258921561547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028602008161873653, "StateBufferConnector_ms": 0.0019303683576912716, "ViewRequirementAgentConnector_ms": 0.052091171001565864}}, "episode_reward_max": -650.0618154367022, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1074.1875545745418, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.031292354292827, "mean_inference_ms": 0.2704390720668368, "mean_action_processing_ms": 0.06227541659220238, "mean_env_wait_ms": 3.0258921561547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028602008161873653, "StateBufferConnector_ms": 0.0019303683576912716, "ViewRequirementAgentConnector_ms": 0.052091171001565864}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480, "num_agent_steps_trained": 3480, "num_env_steps_sampled": 3480, "num_env_steps_trained": 3480, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.36809987922082, "num_env_steps_trained_throughput_per_sec": 65.36809987922082, "timesteps_total": 3480, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 3480, "timers": {"training_iteration_time_ms": 1833.163, "sample_time_ms": 1830.553, "load_time_ms": 0.147, "load_throughput": 816144.771, "learn_time_ms": 1.896, "learn_throughput": 63291.938, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 3480, "num_env_steps_trained": 3480, "num_agent_steps_sampled": 3480, "num_agent_steps_trained": 3480}, "done": false, "episodes_total": 29, "training_iteration": 5, "trial_id": "487fa_00000", "date": "2023-07-24_20-56-31", "timestamp": 1690221391, "time_this_iter_s": 11.016525030136108, "time_total_s": 54.89985275268555, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.89985275268555, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 26.381249999999998, "ram_util_percent": 76.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00023, "entropy_coeff": 0.1, "policy_entropy": 266.6741638183594, "policy_loss": -82538.84375, "vf_loss": 3244140.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200}, "sampler_results": {"episode_reward_max": -593.505803523914, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1015.0888696776456, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.031840303201502, "mean_inference_ms": 0.2698224274252411, "mean_action_processing_ms": 0.062184773685218506, "mean_env_wait_ms": 2.8925395902345024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027922221592494418, "StateBufferConnector_ms": 0.001923016139439174, "ViewRequirementAgentConnector_ms": 0.05178383418491909}}, "episode_reward_max": -593.505803523914, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -1015.0888696776456, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.031840303201502, "mean_inference_ms": 0.2698224274252411, "mean_action_processing_ms": 0.062184773685218506, "mean_env_wait_ms": 2.8925395902345024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027922221592494418, "StateBufferConnector_ms": 0.001923016139439174, "ViewRequirementAgentConnector_ms": 0.05178383418491909}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200, "num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.75451818886397, "num_env_steps_trained_throughput_per_sec": 65.75451818886397, "timesteps_total": 4200, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 4200, "timers": {"training_iteration_time_ms": 1832.165, "sample_time_ms": 1829.6, "load_time_ms": 0.146, "load_throughput": 819733.681, "learn_time_ms": 1.86, "learn_throughput": 64514.52, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 4200, "num_env_steps_trained": 4200, "num_agent_steps_sampled": 4200, "num_agent_steps_trained": 4200}, "done": false, "episodes_total": 35, "training_iteration": 6, "trial_id": "487fa_00000", "date": "2023-07-24_20-56-42", "timestamp": 1690221402, "time_this_iter_s": 10.951842784881592, "time_total_s": 65.85169553756714, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 65.85169553756714, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.4, "ram_util_percent": 76.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0002, "entropy_coeff": 0.1, "policy_entropy": 261.1509704589844, "policy_loss": -59882.953125, "vf_loss": 1824086.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 4920, "num_env_steps_trained": 4920, "num_agent_steps_sampled": 4920, "num_agent_steps_trained": 4920}, "sampler_results": {"episode_reward_max": -493.42533459993786, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -955.3348376257351, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.033328265547112, "mean_inference_ms": 0.2691454564864158, "mean_action_processing_ms": 0.06208064593189231, "mean_env_wait_ms": 2.788362308470434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027016895573313644, "StateBufferConnector_ms": 0.0018852513010908917, "ViewRequirementAgentConnector_ms": 0.05097389221191406}}, "episode_reward_max": -493.42533459993786, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -955.3348376257351, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.033328265547112, "mean_inference_ms": 0.2691454564864158, "mean_action_processing_ms": 0.06208064593189231, "mean_env_wait_ms": 2.788362308470434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027016895573313644, "StateBufferConnector_ms": 0.0018852513010908917, "ViewRequirementAgentConnector_ms": 0.05097389221191406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920, "num_agent_steps_trained": 4920, "num_env_steps_sampled": 4920, "num_env_steps_trained": 4920, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.60210750568633, "num_env_steps_trained_throughput_per_sec": 65.60210750568633, "timesteps_total": 4920, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 4920, "timers": {"training_iteration_time_ms": 1827.408, "sample_time_ms": 1824.843, "load_time_ms": 0.148, "load_throughput": 813243.626, "learn_time_ms": 1.859, "learn_throughput": 64534.373, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 4920, "num_env_steps_trained": 4920, "num_agent_steps_sampled": 4920, "num_agent_steps_trained": 4920}, "done": false, "episodes_total": 41, "training_iteration": 7, "trial_id": "487fa_00000", "date": "2023-07-24_20-56-53", "timestamp": 1690221413, "time_this_iter_s": 10.977149963378906, "time_total_s": 76.82884550094604, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 76.82884550094604, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.86875, "ram_util_percent": 76.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00017, "entropy_coeff": 0.1, "policy_entropy": 261.0117492675781, "policy_loss": -118996.0390625, "vf_loss": 6718198.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 5640, "num_env_steps_trained": 5640, "num_agent_steps_sampled": 5640, "num_agent_steps_trained": 5640}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -928.9969021307037, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03399129868883, "mean_inference_ms": 0.26858455434977485, "mean_action_processing_ms": 0.06199096961584226, "mean_env_wait_ms": 2.7047666205775163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027002172267183346, "StateBufferConnector_ms": 0.0018890867842004655, "ViewRequirementAgentConnector_ms": 0.05053560784522523}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -928.9969021307037, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03399129868883, "mean_inference_ms": 0.26858455434977485, "mean_action_processing_ms": 0.06199096961584226, "mean_env_wait_ms": 2.7047666205775163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027002172267183346, "StateBufferConnector_ms": 0.0018890867842004655, "ViewRequirementAgentConnector_ms": 0.05053560784522523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640, "num_agent_steps_trained": 5640, "num_env_steps_sampled": 5640, "num_env_steps_trained": 5640, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.78066180698296, "num_env_steps_trained_throughput_per_sec": 65.78066180698296, "timesteps_total": 5640, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 5640, "timers": {"training_iteration_time_ms": 1825.776, "sample_time_ms": 1823.229, "load_time_ms": 0.148, "load_throughput": 813243.626, "learn_time_ms": 1.853, "learn_throughput": 64749.396, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 5640, "num_env_steps_trained": 5640, "num_agent_steps_sampled": 5640, "num_agent_steps_trained": 5640}, "done": false, "episodes_total": 47, "training_iteration": 8, "trial_id": "487fa_00000", "date": "2023-07-24_20-57-04", "timestamp": 1690221424, "time_this_iter_s": 10.947411060333252, "time_total_s": 87.7762565612793, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 87.7762565612793, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.300000000000004, "ram_util_percent": 76.19333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00014, "entropy_coeff": 0.1, "policy_entropy": 261.0675048828125, "policy_loss": -100727.0078125, "vf_loss": 4774213.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 6360, "num_env_steps_trained": 6360, "num_agent_steps_sampled": 6360, "num_agent_steps_trained": 6360}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -917.2833571039445, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03443579828737, "mean_inference_ms": 0.26822280638085993, "mean_action_processing_ms": 0.06193945727765977, "mean_env_wait_ms": 2.6363967484131634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002708525027868883, "StateBufferConnector_ms": 0.0018695615372567806, "ViewRequirementAgentConnector_ms": 0.05041743224521853}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -917.2833571039445, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03443579828737, "mean_inference_ms": 0.26822280638085993, "mean_action_processing_ms": 0.06193945727765977, "mean_env_wait_ms": 2.6363967484131634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002708525027868883, "StateBufferConnector_ms": 0.0018695615372567806, "ViewRequirementAgentConnector_ms": 0.05041743224521853}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6360, "num_agent_steps_trained": 6360, "num_env_steps_sampled": 6360, "num_env_steps_trained": 6360, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.50628334750225, "num_env_steps_trained_throughput_per_sec": 65.50628334750225, "timesteps_total": 6360, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 6360, "timers": {"training_iteration_time_ms": 1827.046, "sample_time_ms": 1824.485, "load_time_ms": 0.148, "load_throughput": 811669.86, "learn_time_ms": 1.859, "learn_throughput": 64550.926, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 6360, "num_env_steps_trained": 6360, "num_agent_steps_sampled": 6360, "num_agent_steps_trained": 6360}, "done": false, "episodes_total": 53, "training_iteration": 9, "trial_id": "487fa_00000", "date": "2023-07-24_20-57-15", "timestamp": 1690221435, "time_this_iter_s": 10.993276119232178, "time_total_s": 98.76953268051147, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 98.76953268051147, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.95, "ram_util_percent": 76.08749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00010999999999999999, "entropy_coeff": 0.1, "policy_entropy": 260.53271484375, "policy_loss": -112470.0703125, "vf_loss": 5753306.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 7080, "num_env_steps_trained": 7080, "num_agent_steps_sampled": 7080, "num_agent_steps_trained": 7080}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -910.2218569820445, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03566373488128, "mean_inference_ms": 0.26794613136666956, "mean_action_processing_ms": 0.06189537688826679, "mean_env_wait_ms": 2.579367032295924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002734135773222325, "StateBufferConnector_ms": 0.0018867395691952464, "ViewRequirementAgentConnector_ms": 0.051680257764913265}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -910.2218569820445, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03566373488128, "mean_inference_ms": 0.26794613136666956, "mean_action_processing_ms": 0.06189537688826679, "mean_env_wait_ms": 2.579367032295924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002734135773222325, "StateBufferConnector_ms": 0.0018867395691952464, "ViewRequirementAgentConnector_ms": 0.051680257764913265}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7080, "num_agent_steps_trained": 7080, "num_env_steps_sampled": 7080, "num_env_steps_trained": 7080, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.10769928635692, "num_env_steps_trained_throughput_per_sec": 65.10769928635692, "timesteps_total": 7080, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 7080, "timers": {"training_iteration_time_ms": 1842.307, "sample_time_ms": 1839.745, "load_time_ms": 0.149, "load_throughput": 807373.244, "learn_time_ms": 1.858, "learn_throughput": 64588.202, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 7080, "num_env_steps_trained": 7080, "num_agent_steps_sampled": 7080, "num_agent_steps_trained": 7080}, "done": false, "episodes_total": 59, "training_iteration": 10, "trial_id": "487fa_00000", "date": "2023-07-24_20-57-26", "timestamp": 1690221446, "time_this_iter_s": 11.060575008392334, "time_total_s": 109.83010768890381, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 109.83010768890381, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.143749999999997, "ram_util_percent": 76.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.333333333333334e-05, "entropy_coeff": 0.1, "policy_entropy": 258.50262451171875, "policy_loss": -140982.71875, "vf_loss": 9766309.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 7800, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 7800, "num_agent_steps_trained": 7800}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -916.5492719954517, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.037100755916425, "mean_inference_ms": 0.2677602209144314, "mean_action_processing_ms": 0.06186377646177814, "mean_env_wait_ms": 2.530743233251142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027344777033879207, "StateBufferConnector_ms": 0.0018879083486703725, "ViewRequirementAgentConnector_ms": 0.05127173203688402}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -916.5492719954517, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.037100755916425, "mean_inference_ms": 0.2677602209144314, "mean_action_processing_ms": 0.06186377646177814, "mean_env_wait_ms": 2.530743233251142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027344777033879207, "StateBufferConnector_ms": 0.0018879083486703725, "ViewRequirementAgentConnector_ms": 0.05127173203688402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7800, "num_agent_steps_trained": 7800, "num_env_steps_sampled": 7800, "num_env_steps_trained": 7800, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.31197482385615, "num_env_steps_trained_throughput_per_sec": 65.31197482385615, "timesteps_total": 7800, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 7800, "timers": {"training_iteration_time_ms": 1839.512, "sample_time_ms": 1836.968, "load_time_ms": 0.149, "load_throughput": 804534.015, "learn_time_ms": 1.849, "learn_throughput": 64915.583, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 7800, "num_env_steps_trained": 7800, "num_agent_steps_sampled": 7800, "num_agent_steps_trained": 7800}, "done": false, "episodes_total": 65, "training_iteration": 11, "trial_id": "487fa_00000", "date": "2023-07-24_20-57-37", "timestamp": 1690221457, "time_this_iter_s": 11.02605414390564, "time_total_s": 120.85616183280945, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 120.85616183280945, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.025, "ram_util_percent": 76.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.333333333333334e-05, "entropy_coeff": 0.1, "policy_entropy": 259.2169189453125, "policy_loss": -120974.7109375, "vf_loss": 6671326.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 8520, "num_env_steps_trained": 8520, "num_agent_steps_sampled": 8520, "num_agent_steps_trained": 8520}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -914.2199926701275, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.038434027679275, "mean_inference_ms": 0.2676325714480465, "mean_action_processing_ms": 0.06184002345074041, "mean_env_wait_ms": 2.488981021844993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027139421919701806, "StateBufferConnector_ms": 0.0018824993724554358, "ViewRequirementAgentConnector_ms": 0.050802969596755336}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -914.2199926701275, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.038434027679275, "mean_inference_ms": 0.2676325714480465, "mean_action_processing_ms": 0.06184002345074041, "mean_env_wait_ms": 2.488981021844993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027139421919701806, "StateBufferConnector_ms": 0.0018824993724554358, "ViewRequirementAgentConnector_ms": 0.050802969596755336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8520, "num_agent_steps_trained": 8520, "num_env_steps_sampled": 8520, "num_env_steps_trained": 8520, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.277588297109, "num_env_steps_trained_throughput_per_sec": 65.277588297109, "timesteps_total": 8520, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 8520, "timers": {"training_iteration_time_ms": 1835.2, "sample_time_ms": 1832.669, "load_time_ms": 0.148, "load_throughput": 808280.841, "learn_time_ms": 1.843, "learn_throughput": 65113.778, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 8520, "num_env_steps_trained": 8520, "num_agent_steps_sampled": 8520, "num_agent_steps_trained": 8520}, "done": false, "episodes_total": 71, "training_iteration": 12, "trial_id": "487fa_00000", "date": "2023-07-24_20-57-48", "timestamp": 1690221468, "time_this_iter_s": 11.03178882598877, "time_total_s": 131.88795065879822, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 131.88795065879822, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 22.820000000000004, "ram_util_percent": 76.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.333333333333334e-05, "entropy_coeff": 0.1, "policy_entropy": 260.3080749511719, "policy_loss": -111032.640625, "vf_loss": 6543369.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 9240, "num_env_steps_trained": 9240, "num_agent_steps_sampled": 9240, "num_agent_steps_trained": 9240}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -910.1718392143473, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.039469318265198, "mean_inference_ms": 0.267565865327624, "mean_action_processing_ms": 0.061828682200385746, "mean_env_wait_ms": 2.452763368009141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026897950605912642, "StateBufferConnector_ms": 0.0018819586023107752, "ViewRequirementAgentConnector_ms": 0.050938593876826296}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -910.1718392143473, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.039469318265198, "mean_inference_ms": 0.267565865327624, "mean_action_processing_ms": 0.061828682200385746, "mean_env_wait_ms": 2.452763368009141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026897950605912642, "StateBufferConnector_ms": 0.0018819586023107752, "ViewRequirementAgentConnector_ms": 0.050938593876826296}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9240, "num_agent_steps_trained": 9240, "num_env_steps_sampled": 9240, "num_env_steps_trained": 9240, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.29681781303213, "num_env_steps_trained_throughput_per_sec": 65.29681781303213, "timesteps_total": 9240, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 9240, "timers": {"training_iteration_time_ms": 1836.096, "sample_time_ms": 1833.374, "load_time_ms": 0.15, "load_throughput": 799422.618, "learn_time_ms": 1.896, "learn_throughput": 63299.102, "synch_weights_time_ms": 0.646}, "counters": {"num_env_steps_sampled": 9240, "num_env_steps_trained": 9240, "num_agent_steps_sampled": 9240, "num_agent_steps_trained": 9240}, "done": false, "episodes_total": 77, "training_iteration": 13, "trial_id": "487fa_00000", "date": "2023-07-24_20-57-59", "timestamp": 1690221479, "time_this_iter_s": 11.028541088104248, "time_total_s": 142.91649174690247, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 142.91649174690247, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.025, "ram_util_percent": 76.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.333333333333335e-05, "entropy_coeff": 0.1, "policy_entropy": 260.2369384765625, "policy_loss": -95269.3125, "vf_loss": 4447591.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -907.8613733536797, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.039885261792309, "mean_inference_ms": 0.2674857511248998, "mean_action_processing_ms": 0.06181588507726915, "mean_env_wait_ms": 2.420751650648499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027323343667639307, "StateBufferConnector_ms": 0.0018700059637965926, "ViewRequirementAgentConnector_ms": 0.050708184759300876}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -907.8613733536797, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.039885261792309, "mean_inference_ms": 0.2674857511248998, "mean_action_processing_ms": 0.06181588507726915, "mean_env_wait_ms": 2.420751650648499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027323343667639307, "StateBufferConnector_ms": 0.0018700059637965926, "ViewRequirementAgentConnector_ms": 0.050708184759300876}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960, "num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.93136786363469, "num_env_steps_trained_throughput_per_sec": 65.93136786363469, "timesteps_total": 9960, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 9960, "timers": {"training_iteration_time_ms": 1828.974, "sample_time_ms": 1826.234, "load_time_ms": 0.151, "load_throughput": 795254.353, "learn_time_ms": 1.903, "learn_throughput": 63069.87, "synch_weights_time_ms": 0.656}, "counters": {"num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960}, "done": false, "episodes_total": 83, "training_iteration": 14, "trial_id": "487fa_00000", "date": "2023-07-24_20-58-10", "timestamp": 1690221490, "time_this_iter_s": 10.922561883926392, "time_total_s": 153.83905363082886, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 153.83905363082886, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.373333333333335, "ram_util_percent": 76.01333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.333333333333333e-05, "entropy_coeff": 0.1, "policy_entropy": 256.1578674316406, "policy_loss": -74214.9140625, "vf_loss": 3027532.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}}, "num_env_steps_sampled": 10680, "num_env_steps_trained": 10680, "num_agent_steps_sampled": 10680, "num_agent_steps_trained": 10680}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -898.9500019545231, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.040041166572284, "mean_inference_ms": 0.2673660868979511, "mean_action_processing_ms": 0.061796341531174824, "mean_env_wait_ms": 2.3922379201046233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027075242460443735, "StateBufferConnector_ms": 0.0018725234471010357, "ViewRequirementAgentConnector_ms": 0.050400348191850644}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -898.9500019545231, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.040041166572284, "mean_inference_ms": 0.2673660868979511, "mean_action_processing_ms": 0.061796341531174824, "mean_env_wait_ms": 2.3922379201046233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027075242460443735, "StateBufferConnector_ms": 0.0018725234471010357, "ViewRequirementAgentConnector_ms": 0.050400348191850644}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10680, "num_agent_steps_trained": 10680, "num_env_steps_sampled": 10680, "num_env_steps_trained": 10680, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.76703382378963, "num_env_steps_trained_throughput_per_sec": 65.76703382378963, "timesteps_total": 10680, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 10680, "timers": {"training_iteration_time_ms": 1820.646, "sample_time_ms": 1817.957, "load_time_ms": 0.15, "load_throughput": 798788.256, "learn_time_ms": 1.909, "learn_throughput": 62850.923, "synch_weights_time_ms": 0.598}, "counters": {"num_env_steps_sampled": 10680, "num_env_steps_trained": 10680, "num_agent_steps_sampled": 10680, "num_agent_steps_trained": 10680}, "done": false, "episodes_total": 89, "training_iteration": 15, "trial_id": "487fa_00000", "date": "2023-07-24_20-58-21", "timestamp": 1690221501, "time_this_iter_s": 10.94979190826416, "time_total_s": 164.78884553909302, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 164.78884553909302, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.49375, "ram_util_percent": 75.89375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 254.5319061279297, "policy_loss": -66486.671875, "vf_loss": 2283505.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -890.5423642812348, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.040162850152456, "mean_inference_ms": 0.26728946100241513, "mean_action_processing_ms": 0.06178307537222228, "mean_env_wait_ms": 2.366671500708517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026712919536389804, "StateBufferConnector_ms": 0.001864935222424959, "ViewRequirementAgentConnector_ms": 0.05015548906828228}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -890.5423642812348, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1391.8397305607616, -1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.040162850152456, "mean_inference_ms": 0.26728946100241513, "mean_action_processing_ms": 0.06178307537222228, "mean_env_wait_ms": 2.366671500708517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026712919536389804, "StateBufferConnector_ms": 0.001864935222424959, "ViewRequirementAgentConnector_ms": 0.05015548906828228}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.51800245496798, "num_env_steps_trained_throughput_per_sec": 65.51800245496798, "timesteps_total": 11400, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 11400, "timers": {"training_iteration_time_ms": 1828.013, "sample_time_ms": 1825.434, "load_time_ms": 0.148, "load_throughput": 813112.246, "learn_time_ms": 1.853, "learn_throughput": 64746.064, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400}, "done": false, "episodes_total": 95, "training_iteration": 16, "trial_id": "487fa_00000", "date": "2023-07-24_20-58-32", "timestamp": 1690221512, "time_this_iter_s": 10.991421222686768, "time_total_s": 175.78026676177979, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 175.78026676177979, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.1125, "ram_util_percent": 75.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 252.9557342529297, "policy_loss": -98019.6953125, "vf_loss": 4902295.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 12120, "num_env_steps_trained": 12120, "num_agent_steps_sampled": 12120, "num_agent_steps_trained": 12120}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -879.0622750966614, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.04026471107953, "mean_inference_ms": 0.2671214641780986, "mean_action_processing_ms": 0.061756943167275404, "mean_env_wait_ms": 2.3193922048962823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026502609252929688, "StateBufferConnector_ms": 0.0018887519836425781, "ViewRequirementAgentConnector_ms": 0.04997396469116211}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1671.76773367424, "episode_reward_mean": -879.0622750966614, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1051.0693343662952, -1069.3932365642863, -1671.76773367424, -1432.369557023987, -1282.1136769030375, -1055.1612267691355, -1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.04026471107953, "mean_inference_ms": 0.2671214641780986, "mean_action_processing_ms": 0.061756943167275404, "mean_env_wait_ms": 2.3193922048962823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026502609252929688, "StateBufferConnector_ms": 0.0018887519836425781, "ViewRequirementAgentConnector_ms": 0.04997396469116211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12120, "num_agent_steps_trained": 12120, "num_env_steps_sampled": 12120, "num_env_steps_trained": 12120, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.91515374864282, "num_env_steps_trained_throughput_per_sec": 65.91515374864282, "timesteps_total": 12120, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 12120, "timers": {"training_iteration_time_ms": 1823.376, "sample_time_ms": 1820.769, "load_time_ms": 0.149, "load_throughput": 804662.638, "learn_time_ms": 1.876, "learn_throughput": 63971.692, "synch_weights_time_ms": 0.55}, "counters": {"num_env_steps_sampled": 12120, "num_env_steps_trained": 12120, "num_agent_steps_sampled": 12120, "num_agent_steps_trained": 12120}, "done": false, "episodes_total": 101, "training_iteration": 17, "trial_id": "487fa_00000", "date": "2023-07-24_20-58-43", "timestamp": 1690221523, "time_this_iter_s": 10.925174951553345, "time_total_s": 186.70544171333313, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 186.70544171333313, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.42, "ram_util_percent": 75.85999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 252.14486694335938, "policy_loss": -90812.28125, "vf_loss": 4145048.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}}, "num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1393.2763414868614, "episode_reward_mean": -847.3665625333305, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041973404373225, "mean_inference_ms": 0.2665903866146527, "mean_action_processing_ms": 0.061679193872141144, "mean_env_wait_ms": 2.1838643261629067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002615213394165039, "StateBufferConnector_ms": 0.0018761157989501953, "ViewRequirementAgentConnector_ms": 0.049633026123046875}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1393.2763414868614, "episode_reward_mean": -847.3665625333305, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1393.2763414868614, -1337.590466894553, -1348.3662423624223, -1313.949041132838, -1178.9559596485599, -1112.251756490136, -1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041973404373225, "mean_inference_ms": 0.2665903866146527, "mean_action_processing_ms": 0.061679193872141144, "mean_env_wait_ms": 2.1838643261629067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002615213394165039, "StateBufferConnector_ms": 0.0018761157989501953, "ViewRequirementAgentConnector_ms": 0.049633026123046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840, "num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 64.80660920788972, "num_env_steps_trained_throughput_per_sec": 64.80660920788972, "timesteps_total": 12840, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 12840, "timers": {"training_iteration_time_ms": 1840.307, "sample_time_ms": 1837.678, "load_time_ms": 0.151, "load_throughput": 796134.894, "learn_time_ms": 1.922, "learn_throughput": 62426.85, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840}, "done": false, "episodes_total": 107, "training_iteration": 18, "trial_id": "487fa_00000", "date": "2023-07-24_20-58-54", "timestamp": 1690221534, "time_this_iter_s": 11.112030029296875, "time_total_s": 197.81747174263, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 197.81747174263, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.09375, "ram_util_percent": 75.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 251.33128356933594, "policy_loss": -79044.4375, "vf_loss": 3213857.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 13560, "num_env_steps_trained": 13560, "num_agent_steps_sampled": 13560, "num_agent_steps_trained": 13560}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1271.0551429275058, "episode_reward_mean": -814.3162096804965, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.04401433301356, "mean_inference_ms": 0.2662203831027609, "mean_action_processing_ms": 0.06161716537373302, "mean_env_wait_ms": 2.1208775931209574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026073455810546875, "StateBufferConnector_ms": 0.001878976821899414, "ViewRequirementAgentConnector_ms": 0.04948091506958008}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1271.0551429275058, "episode_reward_mean": -814.3162096804965, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1074.154255917207, -1271.0551429275058, -1090.6459228715119, -934.1740148088348, -900.9988488841341, -1099.7531150292925, -768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.04401433301356, "mean_inference_ms": 0.2662203831027609, "mean_action_processing_ms": 0.06161716537373302, "mean_env_wait_ms": 2.1208775931209574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026073455810546875, "StateBufferConnector_ms": 0.001878976821899414, "ViewRequirementAgentConnector_ms": 0.04948091506958008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13560, "num_agent_steps_trained": 13560, "num_env_steps_sampled": 13560, "num_env_steps_trained": 13560, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 64.57612798921038, "num_env_steps_trained_throughput_per_sec": 64.57612798921038, "timesteps_total": 13560, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 13560, "timers": {"training_iteration_time_ms": 1863.259, "sample_time_ms": 1860.561, "load_time_ms": 0.158, "load_throughput": 760871.474, "learn_time_ms": 1.967, "learn_throughput": 61002.143, "synch_weights_time_ms": 0.543}, "counters": {"num_env_steps_sampled": 13560, "num_env_steps_trained": 13560, "num_agent_steps_sampled": 13560, "num_agent_steps_trained": 13560}, "done": false, "episodes_total": 113, "training_iteration": 19, "trial_id": "487fa_00000", "date": "2023-07-24_20-59-05", "timestamp": 1690221545, "time_this_iter_s": 11.151732921600342, "time_total_s": 208.96920466423035, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 208.96920466423035, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.4, "ram_util_percent": 76.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.6666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 250.0278778076172, "policy_loss": -79210.3203125, "vf_loss": 3040207.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 118.0}}, "num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -792.5282272625747, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.044391533745916, "mean_inference_ms": 0.26611143056055847, "mean_action_processing_ms": 0.061599109353869336, "mean_env_wait_ms": 2.0814029973119137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002598285675048828, "StateBufferConnector_ms": 0.0018703937530517578, "ViewRequirementAgentConnector_ms": 0.04930472373962402}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -792.5282272625747, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-768.9965334334995, -755.998806728208, -908.6613841342771, -800.9286990216366, -792.2473718828883, -763.4024714602573, -977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.044391533745916, "mean_inference_ms": 0.26611143056055847, "mean_action_processing_ms": 0.061599109353869336, "mean_env_wait_ms": 2.0814029973119137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002598285675048828, "StateBufferConnector_ms": 0.0018703937530517578, "ViewRequirementAgentConnector_ms": 0.04930472373962402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280, "num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.45672562822634, "num_env_steps_trained_throughput_per_sec": 66.45672562822634, "timesteps_total": 14280, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 14280, "timers": {"training_iteration_time_ms": 1821.745, "sample_time_ms": 1819.143, "load_time_ms": 0.149, "load_throughput": 803250.048, "learn_time_ms": 1.894, "learn_throughput": 63353.281, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280}, "done": false, "episodes_total": 119, "training_iteration": 20, "trial_id": "487fa_00000", "date": "2023-07-24_20-59-16", "timestamp": 1690221556, "time_this_iter_s": 10.83620285987854, "time_total_s": 219.8054075241089, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 219.8054075241089, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 24.193333333333335, "ram_util_percent": 75.66000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3e-05, "entropy_coeff": 0.1, "policy_entropy": 248.96827697753906, "policy_loss": -86325.2421875, "vf_loss": 3838328.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 125.0, "diff_num_grad_updates_vs_sampler_policy": 124.0}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -790.2920883988372, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.044595856089463, "mean_inference_ms": 0.2661031107668239, "mean_action_processing_ms": 0.06159864129297498, "mean_env_wait_ms": 2.053407033506926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025742053985595703, "StateBufferConnector_ms": 0.0018525123596191406, "ViewRequirementAgentConnector_ms": 0.04884505271911621}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -790.2920883988372, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-977.5255385202789, -650.0618154367022, -884.4461651309031, -840.2846925974616, -593.505803523914, -662.165911699012, -790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.044595856089463, "mean_inference_ms": 0.2661031107668239, "mean_action_processing_ms": 0.06159864129297498, "mean_env_wait_ms": 2.053407033506926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025742053985595703, "StateBufferConnector_ms": 0.0018525123596191406, "ViewRequirementAgentConnector_ms": 0.04884505271911621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.68693454869542, "num_env_steps_trained_throughput_per_sec": 65.68693454869542, "timesteps_total": 15000, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 1819.534, "sample_time_ms": 1816.892, "load_time_ms": 0.152, "load_throughput": 787662.723, "learn_time_ms": 1.929, "learn_throughput": 62210.8, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "done": false, "episodes_total": 125, "training_iteration": 21, "trial_id": "487fa_00000", "date": "2023-07-24_20-59-27", "timestamp": 1690221567, "time_this_iter_s": 10.963141918182373, "time_total_s": 230.76854944229126, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 230.76854944229126, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 28.4, "ram_util_percent": 75.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2e-05, "entropy_coeff": 0.1, "policy_entropy": 247.5838165283203, "policy_loss": -78957.2890625, "vf_loss": 3391045.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -788.0627838905006, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.044660371821715, "mean_inference_ms": 0.26607562677632157, "mean_action_processing_ms": 0.06159509880891766, "mean_env_wait_ms": 2.0316970895580813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002554655075073242, "StateBufferConnector_ms": 0.0018432140350341797, "ViewRequirementAgentConnector_ms": 0.048441171646118164}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -788.0627838905006, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-790.5508778618617, -860.1520364700672, -831.0232026434379, -639.2735238575871, -722.2316289236811, -589.4386296753119, -624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.044660371821715, "mean_inference_ms": 0.26607562677632157, "mean_action_processing_ms": 0.06159509880891766, "mean_env_wait_ms": 2.0316970895580813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002554655075073242, "StateBufferConnector_ms": 0.0018432140350341797, "ViewRequirementAgentConnector_ms": 0.048441171646118164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720, "num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.98310570548145, "num_env_steps_trained_throughput_per_sec": 65.98310570548145, "timesteps_total": 15720, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 15720, "timers": {"training_iteration_time_ms": 1822.524, "sample_time_ms": 1819.85, "load_time_ms": 0.158, "load_throughput": 761101.588, "learn_time_ms": 1.953, "learn_throughput": 61438.5, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720}, "done": false, "episodes_total": 131, "training_iteration": 22, "trial_id": "487fa_00000", "date": "2023-07-24_20-59-38", "timestamp": 1690221578, "time_this_iter_s": 10.914005041122437, "time_total_s": 241.6825544834137, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 241.6825544834137, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.733333333333334, "ram_util_percent": 76.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7e-05, "entropy_coeff": 0.1, "policy_entropy": 246.36663818359375, "policy_loss": -85322.765625, "vf_loss": 3874881.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 137.0, "diff_num_grad_updates_vs_sampler_policy": 136.0}}, "num_env_steps_sampled": 16440, "num_env_steps_trained": 16440, "num_agent_steps_sampled": 16440, "num_agent_steps_trained": 16440}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -788.9682196955953, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.045066953645387, "mean_inference_ms": 0.2660724585662176, "mean_action_processing_ms": 0.06159164757178571, "mean_env_wait_ms": 2.0145870112364275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025670528411865234, "StateBufferConnector_ms": 0.0018584728240966797, "ViewRequirementAgentConnector_ms": 0.0487668514251709}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -788.9682196955953, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-624.3525944842708, -658.6754394426165, -552.4942768117277, -493.42533459993786, -747.6667181855015, -695.8019174595876, -708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.045066953645387, "mean_inference_ms": 0.2660724585662176, "mean_action_processing_ms": 0.06159164757178571, "mean_env_wait_ms": 2.0145870112364275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025670528411865234, "StateBufferConnector_ms": 0.0018584728240966797, "ViewRequirementAgentConnector_ms": 0.0487668514251709}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16440, "num_agent_steps_trained": 16440, "num_env_steps_sampled": 16440, "num_env_steps_trained": 16440, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.16406703682247, "num_env_steps_trained_throughput_per_sec": 65.16406703682247, "timesteps_total": 16440, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 16440, "timers": {"training_iteration_time_ms": 1829.817, "sample_time_ms": 1827.249, "load_time_ms": 0.148, "load_throughput": 813506.514, "learn_time_ms": 1.869, "learn_throughput": 64220.647, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 16440, "num_env_steps_trained": 16440, "num_agent_steps_sampled": 16440, "num_agent_steps_trained": 16440}, "done": false, "episodes_total": 137, "training_iteration": 23, "trial_id": "487fa_00000", "date": "2023-07-24_20-59-49", "timestamp": 1690221589, "time_this_iter_s": 11.050941944122314, "time_total_s": 252.733496427536, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.733496427536, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.75625, "ram_util_percent": 76.11874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4000000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 245.61611938476562, "policy_loss": -53034.0859375, "vf_loss": 1672104.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160}, "sampler_results": {"episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -790.8060826426932, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.045102887829193, "mean_inference_ms": 0.266134940713604, "mean_action_processing_ms": 0.061599582795613894, "mean_env_wait_ms": 2.000806129767794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00255584716796875, "StateBufferConnector_ms": 0.001863718032836914, "ViewRequirementAgentConnector_ms": 0.048644304275512695}}, "episode_reward_max": -415.69063952081075, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -790.8060826426932, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-708.0526853341992, -1006.2222474472633, -415.69063952081075, -920.691849540561, -689.8646035760331, -844.065020386173, -739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.045102887829193, "mean_inference_ms": 0.266134940713604, "mean_action_processing_ms": 0.061599582795613894, "mean_env_wait_ms": 2.000806129767794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00255584716796875, "StateBufferConnector_ms": 0.001863718032836914, "ViewRequirementAgentConnector_ms": 0.048644304275512695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160, "num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.85171524494486, "num_env_steps_trained_throughput_per_sec": 65.85171524494486, "timesteps_total": 17160, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 17160, "timers": {"training_iteration_time_ms": 1828.356, "sample_time_ms": 1825.79, "load_time_ms": 0.148, "load_throughput": 809971.806, "learn_time_ms": 1.871, "learn_throughput": 64135.54, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160}, "done": false, "episodes_total": 143, "training_iteration": 24, "trial_id": "487fa_00000", "date": "2023-07-24_21-00-00", "timestamp": 1690221600, "time_this_iter_s": 10.9357328414917, "time_total_s": 263.6692292690277, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 263.6692292690277, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.65625, "ram_util_percent": 76.04375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1000000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 245.02488708496094, "policy_loss": -76946.90625, "vf_loss": 3129396.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 149.0, "diff_num_grad_updates_vs_sampler_policy": 148.0}}, "num_env_steps_sampled": 17880, "num_env_steps_trained": 17880, "num_agent_steps_sampled": 17880, "num_agent_steps_trained": 17880}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -788.1859750160314, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.045036828352227, "mean_inference_ms": 0.2661804859032755, "mean_action_processing_ms": 0.06160496587383412, "mean_env_wait_ms": 1.9892960628955936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552032470703125, "StateBufferConnector_ms": 0.0018525123596191406, "ViewRequirementAgentConnector_ms": 0.04865074157714844}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -788.1859750160314, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-739.2795176914414, -997.7105586474752, -861.9834227820583, -820.2604032828002, -772.2129917443874, -858.6577788515682, -951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.045036828352227, "mean_inference_ms": 0.2661804859032755, "mean_action_processing_ms": 0.06160496587383412, "mean_env_wait_ms": 1.9892960628955936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552032470703125, "StateBufferConnector_ms": 0.0018525123596191406, "ViewRequirementAgentConnector_ms": 0.04865074157714844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17880, "num_agent_steps_trained": 17880, "num_env_steps_sampled": 17880, "num_env_steps_trained": 17880, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.07755489106248, "num_env_steps_trained_throughput_per_sec": 66.07755489106248, "timesteps_total": 17880, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 17880, "timers": {"training_iteration_time_ms": 1820.272, "sample_time_ms": 1817.708, "load_time_ms": 0.148, "load_throughput": 811538.987, "learn_time_ms": 1.863, "learn_throughput": 64399.78, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 17880, "num_env_steps_trained": 17880, "num_agent_steps_sampled": 17880, "num_agent_steps_trained": 17880}, "done": false, "episodes_total": 149, "training_iteration": 25, "trial_id": "487fa_00000", "date": "2023-07-24_21-00-11", "timestamp": 1690221611, "time_this_iter_s": 10.898342847824097, "time_total_s": 274.5675721168518, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 274.5675721168518, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 22.826666666666664, "ram_util_percent": 75.99333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 244.67001342773438, "policy_loss": -95214.171875, "vf_loss": 4454240.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 155.0, "diff_num_grad_updates_vs_sampler_policy": 154.0}}, "num_env_steps_sampled": 18600, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18600, "num_agent_steps_trained": 18600}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -784.7734953699431, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.044754105577697, "mean_inference_ms": 0.2662234004721868, "mean_action_processing_ms": 0.06160860820776071, "mean_env_wait_ms": 1.979462508115267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536296844482422, "StateBufferConnector_ms": 0.0018496513366699219, "ViewRequirementAgentConnector_ms": 0.04824256896972656}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -784.7734953699431, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-951.0389477454228, -793.9667508515279, -764.2247757533829, -946.9703904852943, -1029.747028358653, -797.7432147205482, -1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.044754105577697, "mean_inference_ms": 0.2662234004721868, "mean_action_processing_ms": 0.06160860820776071, "mean_env_wait_ms": 1.979462508115267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002536296844482422, "StateBufferConnector_ms": 0.0018496513366699219, "ViewRequirementAgentConnector_ms": 0.04824256896972656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18600, "num_agent_steps_trained": 18600, "num_env_steps_sampled": 18600, "num_env_steps_trained": 18600, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.46082943165416, "num_env_steps_trained_throughput_per_sec": 65.46082943165416, "timesteps_total": 18600, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 18600, "timers": {"training_iteration_time_ms": 1827.604, "sample_time_ms": 1825.007, "load_time_ms": 0.16, "load_throughput": 749094.33, "learn_time_ms": 1.881, "learn_throughput": 63801.399, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 18600, "num_env_steps_trained": 18600, "num_agent_steps_sampled": 18600, "num_agent_steps_trained": 18600}, "done": false, "episodes_total": 155, "training_iteration": 26, "trial_id": "487fa_00000", "date": "2023-07-24_21-00-22", "timestamp": 1690221622, "time_this_iter_s": 11.000977993011475, "time_total_s": 285.5685501098633, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 285.5685501098633, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.5125, "ram_util_percent": 76.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.166666666666668e-06, "entropy_coeff": 0.1, "policy_entropy": 244.13323974609375, "policy_loss": -81117.0546875, "vf_loss": 3859950.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 161.0, "diff_num_grad_updates_vs_sampler_policy": 160.0}}, "num_env_steps_sampled": 19320, "num_env_steps_trained": 19320, "num_agent_steps_sampled": 19320, "num_agent_steps_trained": 19320}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -775.5658168083994, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.043847271310261, "mean_inference_ms": 0.2662507612272391, "mean_action_processing_ms": 0.061611007106938676, "mean_env_wait_ms": 1.9709165849583348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025053024291992188, "StateBufferConnector_ms": 0.0018343925476074219, "ViewRequirementAgentConnector_ms": 0.04758000373840332}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1156.7053463690775, "episode_reward_mean": -775.5658168083994, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1091.6831049709772, -928.9579281494595, -867.776495195015, -1156.7053463690775, -1030.575263153797, -908.2032712171057, -763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.043847271310261, "mean_inference_ms": 0.2662507612272391, "mean_action_processing_ms": 0.061611007106938676, "mean_env_wait_ms": 1.9709165849583348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025053024291992188, "StateBufferConnector_ms": 0.0018343925476074219, "ViewRequirementAgentConnector_ms": 0.04758000373840332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19320, "num_agent_steps_trained": 19320, "num_env_steps_sampled": 19320, "num_env_steps_trained": 19320, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.87123570090988, "num_env_steps_trained_throughput_per_sec": 65.87123570090988, "timesteps_total": 19320, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 19320, "timers": {"training_iteration_time_ms": 1825.227, "sample_time_ms": 1822.638, "load_time_ms": 0.159, "load_throughput": 753129.553, "learn_time_ms": 1.881, "learn_throughput": 63786.845, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 19320, "num_env_steps_trained": 19320, "num_agent_steps_sampled": 19320, "num_agent_steps_trained": 19320}, "done": false, "episodes_total": 161, "training_iteration": 27, "trial_id": "487fa_00000", "date": "2023-07-24_21-00-33", "timestamp": 1690221633, "time_this_iter_s": 10.932446956634521, "time_total_s": 296.5009970664978, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 296.5009970664978, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 23.68, "ram_util_percent": 76.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666668e-06, "entropy_coeff": 0.1, "policy_entropy": 243.60690307617188, "policy_loss": -78945.1875, "vf_loss": 3692992.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 166.0}}, "num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_agent_steps_sampled": 20040, "num_agent_steps_trained": 20040}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1033.1904319513767, "episode_reward_mean": -755.8570582945249, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.042622368361412, "mean_inference_ms": 0.26624938367349854, "mean_action_processing_ms": 0.06160957933136287, "mean_env_wait_ms": 1.9633818312253508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002504587173461914, "StateBufferConnector_ms": 0.001825094223022461, "ViewRequirementAgentConnector_ms": 0.04745674133300781}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1033.1904319513767, "episode_reward_mean": -755.8570582945249, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-763.2741588707615, -842.7815270737495, -848.221645971491, -940.8609335877838, -768.4316388637307, -787.3421679486255, -736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.042622368361412, "mean_inference_ms": 0.26624938367349854, "mean_action_processing_ms": 0.06160957933136287, "mean_env_wait_ms": 1.9633818312253508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002504587173461914, "StateBufferConnector_ms": 0.001825094223022461, "ViewRequirementAgentConnector_ms": 0.04745674133300781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20040, "num_agent_steps_trained": 20040, "num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.81776947051253, "num_env_steps_trained_throughput_per_sec": 65.81776947051253, "timesteps_total": 20040, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 20040, "timers": {"training_iteration_time_ms": 1822.782, "sample_time_ms": 1820.081, "load_time_ms": 0.155, "load_throughput": 775645.677, "learn_time_ms": 1.911, "learn_throughput": 62799.95, "synch_weights_time_ms": 0.605}, "counters": {"num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_agent_steps_sampled": 20040, "num_agent_steps_trained": 20040}, "done": false, "episodes_total": 167, "training_iteration": 28, "trial_id": "487fa_00000", "date": "2023-07-24_21-00-44", "timestamp": 1690221644, "time_this_iter_s": 10.941645860671997, "time_total_s": 307.4426429271698, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 307.4426429271698, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.19375, "ram_util_percent": 76.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.166666666666668e-06, "entropy_coeff": 0.1, "policy_entropy": 243.45587158203125, "policy_loss": -93563.2109375, "vf_loss": 4571124.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 20760, "num_env_steps_trained": 20760, "num_agent_steps_sampled": 20760, "num_agent_steps_trained": 20760}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1033.1904319513767, "episode_reward_mean": -749.1484909179931, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041996345009045, "mean_inference_ms": 0.266271733223248, "mean_action_processing_ms": 0.06160998146408914, "mean_env_wait_ms": 1.9566610527609904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025298595428466797, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.047646284103393555}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1033.1904319513767, "episode_reward_mean": -749.1484909179931, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-736.2735726217022, -974.1667987754445, -981.0117343007715, -926.3862274154365, -1033.1904319513767, -874.2567282141563, -883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041996345009045, "mean_inference_ms": 0.266271733223248, "mean_action_processing_ms": 0.06160998146408914, "mean_env_wait_ms": 1.9566610527609904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025298595428466797, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.047646284103393555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20760, "num_agent_steps_trained": 20760, "num_env_steps_sampled": 20760, "num_env_steps_trained": 20760, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 63.948892028230524, "num_env_steps_trained_throughput_per_sec": 63.948892028230524, "timesteps_total": 20760, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 20760, "timers": {"training_iteration_time_ms": 1856.404, "sample_time_ms": 1853.689, "load_time_ms": 0.156, "load_throughput": 767484.721, "learn_time_ms": 1.963, "learn_throughput": 61132.546, "synch_weights_time_ms": 0.564}, "counters": {"num_env_steps_sampled": 20760, "num_env_steps_trained": 20760, "num_agent_steps_sampled": 20760, "num_agent_steps_trained": 20760}, "done": false, "episodes_total": 173, "training_iteration": 29, "trial_id": "487fa_00000", "date": "2023-07-24_21-00-55", "timestamp": 1690221655, "time_this_iter_s": 11.261156797409058, "time_total_s": 318.70379972457886, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 318.70379972457886, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 28.525, "ram_util_percent": 76.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 243.3117218017578, "policy_loss": -89020.296875, "vf_loss": 3962005.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 179.0, "diff_num_grad_updates_vs_sampler_policy": 178.0}}, "num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -736.6963324292936, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041908312005292, "mean_inference_ms": 0.26627673293451976, "mean_action_processing_ms": 0.061605992230466304, "mean_env_wait_ms": 1.950551964696557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025196075439453125, "StateBufferConnector_ms": 0.0018265247344970703, "ViewRequirementAgentConnector_ms": 0.04728269577026367}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -736.6963324292936, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-883.075417438817, -985.7146875010912, -735.3274401081164, -757.697663637103, -899.2849304441434, -913.6882897112265, -850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041908312005292, "mean_inference_ms": 0.26627673293451976, "mean_action_processing_ms": 0.061605992230466304, "mean_env_wait_ms": 1.950551964696557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025196075439453125, "StateBufferConnector_ms": 0.0018265247344970703, "ViewRequirementAgentConnector_ms": 0.04728269577026367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480, "num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 64.7669209246624, "num_env_steps_trained_throughput_per_sec": 64.7669209246624, "timesteps_total": 21480, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 21480, "timers": {"training_iteration_time_ms": 1861.972, "sample_time_ms": 1859.272, "load_time_ms": 0.161, "load_throughput": 746649.577, "learn_time_ms": 1.941, "learn_throughput": 61818.062, "synch_weights_time_ms": 0.566}, "counters": {"num_env_steps_sampled": 21480, "num_env_steps_trained": 21480, "num_agent_steps_sampled": 21480, "num_agent_steps_trained": 21480}, "done": false, "episodes_total": 179, "training_iteration": 30, "trial_id": "487fa_00000", "date": "2023-07-24_21-01-06", "timestamp": 1690221666, "time_this_iter_s": 11.118828773498535, "time_total_s": 329.8226284980774, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 329.8226284980774, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 27.21875, "ram_util_percent": 77.11250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 243.02320861816406, "policy_loss": -83945.671875, "vf_loss": 4008987.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 185.0, "diff_num_grad_updates_vs_sampler_policy": 184.0}}, "num_env_steps_sampled": 22200, "num_env_steps_trained": 22200, "num_agent_steps_sampled": 22200, "num_agent_steps_trained": 22200}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -728.4160494753219, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041704510483866, "mean_inference_ms": 0.26629979774149876, "mean_action_processing_ms": 0.061604367565379146, "mean_env_wait_ms": 1.9450585693739078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518892288208008, "StateBufferConnector_ms": 0.0018303394317626953, "ViewRequirementAgentConnector_ms": 0.04721426963806152}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -728.4160494753219, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-850.4443883039439, -780.11309232892, -526.5175354285819, -684.0079493803416, -1005.3813502612007, -724.8207803809202, -962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041704510483866, "mean_inference_ms": 0.26629979774149876, "mean_action_processing_ms": 0.061604367565379146, "mean_env_wait_ms": 1.9450585693739078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518892288208008, "StateBufferConnector_ms": 0.0018303394317626953, "ViewRequirementAgentConnector_ms": 0.04721426963806152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22200, "num_agent_steps_trained": 22200, "num_env_steps_sampled": 22200, "num_env_steps_trained": 22200, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.58994483742403, "num_env_steps_trained_throughput_per_sec": 66.58994483742403, "timesteps_total": 22200, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 22200, "timers": {"training_iteration_time_ms": 1819.394, "sample_time_ms": 1816.81, "load_time_ms": 0.148, "load_throughput": 808800.386, "learn_time_ms": 1.889, "learn_throughput": 63541.235, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 22200, "num_env_steps_trained": 22200, "num_agent_steps_sampled": 22200, "num_agent_steps_trained": 22200}, "done": false, "episodes_total": 185, "training_iteration": 31, "trial_id": "487fa_00000", "date": "2023-07-24_21-01-17", "timestamp": 1690221677, "time_this_iter_s": 10.814770936965942, "time_total_s": 340.63739943504333, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 340.63739943504333, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.406666666666663, "ram_util_percent": 76.41333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 242.74252319335938, "policy_loss": -74882.515625, "vf_loss": 3247873.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 22920, "num_env_steps_trained": 22920, "num_agent_steps_sampled": 22920, "num_agent_steps_trained": 22920}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -725.8016699643593, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041318243591144, "mean_inference_ms": 0.266341576550969, "mean_action_processing_ms": 0.06160665176555455, "mean_env_wait_ms": 1.940155875460218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025391578674316406, "StateBufferConnector_ms": 0.0018160343170166016, "ViewRequirementAgentConnector_ms": 0.04717898368835449}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -725.8016699643593, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-962.369033642889, -747.8041366248368, -538.0443820803256, -616.5547497745783, -906.4450371556021, -651.2434939422518, -776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.041318243591144, "mean_inference_ms": 0.266341576550969, "mean_action_processing_ms": 0.06160665176555455, "mean_env_wait_ms": 1.940155875460218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025391578674316406, "StateBufferConnector_ms": 0.0018160343170166016, "ViewRequirementAgentConnector_ms": 0.04717898368835449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22920, "num_agent_steps_trained": 22920, "num_env_steps_sampled": 22920, "num_env_steps_trained": 22920, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.14353873823865, "num_env_steps_trained_throughput_per_sec": 66.14353873823865, "timesteps_total": 22920, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 22920, "timers": {"training_iteration_time_ms": 1808.766, "sample_time_ms": 1806.189, "load_time_ms": 0.148, "load_throughput": 808930.376, "learn_time_ms": 1.887, "learn_throughput": 63601.456, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 22920, "num_env_steps_trained": 22920, "num_agent_steps_sampled": 22920, "num_agent_steps_trained": 22920}, "done": false, "episodes_total": 191, "training_iteration": 32, "trial_id": "487fa_00000", "date": "2023-07-24_21-01-28", "timestamp": 1690221688, "time_this_iter_s": 10.887459993362427, "time_total_s": 351.52485942840576, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 351.52485942840576, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 22.74375, "ram_util_percent": 76.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 242.6903839111328, "policy_loss": -84619.0, "vf_loss": 3707691.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 197.0, "diff_num_grad_updates_vs_sampler_policy": 196.0}}, "num_env_steps_sampled": 23640, "num_env_steps_trained": 23640, "num_agent_steps_sampled": 23640, "num_agent_steps_trained": 23640}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -721.2368359077885, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.040884518700505, "mean_inference_ms": 0.26637314135345147, "mean_action_processing_ms": 0.06160754952062013, "mean_env_wait_ms": 1.9357408412273422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002540111541748047, "StateBufferConnector_ms": 0.0018107891082763672, "ViewRequirementAgentConnector_ms": 0.04718828201293945}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -721.2368359077885, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-776.2608357200734, -827.1396616750194, -753.8738354820912, -781.5797695345531, -763.5889680400729, -662.7922861009732, -671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.040884518700505, "mean_inference_ms": 0.26637314135345147, "mean_action_processing_ms": 0.06160754952062013, "mean_env_wait_ms": 1.9357408412273422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002540111541748047, "StateBufferConnector_ms": 0.0018107891082763672, "ViewRequirementAgentConnector_ms": 0.04718828201293945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23640, "num_agent_steps_trained": 23640, "num_env_steps_sampled": 23640, "num_env_steps_trained": 23640, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.83737888868582, "num_env_steps_trained_throughput_per_sec": 65.83737888868582, "timesteps_total": 23640, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 23640, "timers": {"training_iteration_time_ms": 1819.533, "sample_time_ms": 1816.953, "load_time_ms": 0.15, "load_throughput": 800694.368, "learn_time_ms": 1.875, "learn_throughput": 63986.331, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 23640, "num_env_steps_trained": 23640, "num_agent_steps_sampled": 23640, "num_agent_steps_trained": 23640}, "done": false, "episodes_total": 197, "training_iteration": 33, "trial_id": "487fa_00000", "date": "2023-07-24_21-01-39", "timestamp": 1690221699, "time_this_iter_s": 10.938297986984253, "time_total_s": 362.46315741539, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 362.46315741539, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 24.50666666666666, "ram_util_percent": 76.96000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 242.66534423828125, "policy_loss": -77902.46875, "vf_loss": 2886322.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 24360, "num_env_steps_trained": 24360, "num_agent_steps_sampled": 24360, "num_agent_steps_trained": 24360}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -716.1076067443128, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.04027758798853, "mean_inference_ms": 0.26639649967710594, "mean_action_processing_ms": 0.06160600157600982, "mean_env_wait_ms": 1.9316526229395519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542734146118164, "StateBufferConnector_ms": 0.001779794692993164, "ViewRequirementAgentConnector_ms": 0.04717707633972168}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -716.1076067443128, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-671.7991531708196, -780.1380216551744, -771.929270077187, -742.0558099236358, -779.2603773211288, -835.4228922455418, -639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.04027758798853, "mean_inference_ms": 0.26639649967710594, "mean_action_processing_ms": 0.06160600157600982, "mean_env_wait_ms": 1.9316526229395519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002542734146118164, "StateBufferConnector_ms": 0.001779794692993164, "ViewRequirementAgentConnector_ms": 0.04717707633972168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24360, "num_agent_steps_trained": 24360, "num_env_steps_sampled": 24360, "num_env_steps_trained": 24360, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.21026272826944, "num_env_steps_trained_throughput_per_sec": 66.21026272826944, "timesteps_total": 24360, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 24360, "timers": {"training_iteration_time_ms": 1818.328, "sample_time_ms": 1815.8, "load_time_ms": 0.148, "load_throughput": 812193.771, "learn_time_ms": 1.833, "learn_throughput": 65481.432, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 24360, "num_env_steps_trained": 24360, "num_agent_steps_sampled": 24360, "num_agent_steps_trained": 24360}, "done": false, "episodes_total": 203, "training_iteration": 34, "trial_id": "487fa_00000", "date": "2023-07-24_21-01-50", "timestamp": 1690221710, "time_this_iter_s": 10.876550912857056, "time_total_s": 373.33970832824707, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 373.33970832824707, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.09375, "ram_util_percent": 76.73750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.1666666666666675e-06, "entropy_coeff": 0.1, "policy_entropy": 242.3937225341797, "policy_loss": -78745.9921875, "vf_loss": 3701730.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 209.0, "diff_num_grad_updates_vs_sampler_policy": 208.0}}, "num_env_steps_sampled": 25080, "num_env_steps_trained": 25080, "num_agent_steps_sampled": 25080, "num_agent_steps_trained": 25080}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -712.2965749225614, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0392533250996, "mean_inference_ms": 0.2663970314443123, "mean_action_processing_ms": 0.06161253064865109, "mean_env_wait_ms": 1.9279117548631053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025408267974853516, "StateBufferConnector_ms": 0.0017728805541992188, "ViewRequirementAgentConnector_ms": 0.04712080955505371}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -712.2965749225614, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-639.7668463797345, -689.4742259466127, -817.3560599196297, -618.0741209193347, -716.4393362941173, -731.5659237773513, -885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0392533250996, "mean_inference_ms": 0.2663970314443123, "mean_action_processing_ms": 0.06161253064865109, "mean_env_wait_ms": 1.9279117548631053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025408267974853516, "StateBufferConnector_ms": 0.0017728805541992188, "ViewRequirementAgentConnector_ms": 0.04712080955505371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25080, "num_agent_steps_trained": 25080, "num_env_steps_sampled": 25080, "num_env_steps_trained": 25080, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.09020414156973, "num_env_steps_trained_throughput_per_sec": 65.09020414156973, "timesteps_total": 25080, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 25080, "timers": {"training_iteration_time_ms": 1830.208, "sample_time_ms": 1827.628, "load_time_ms": 0.15, "load_throughput": 801587.004, "learn_time_ms": 1.867, "learn_throughput": 64263.286, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 25080, "num_env_steps_trained": 25080, "num_agent_steps_sampled": 25080, "num_agent_steps_trained": 25080}, "done": false, "episodes_total": 209, "training_iteration": 35, "trial_id": "487fa_00000", "date": "2023-07-24_21-02-01", "timestamp": 1690221721, "time_this_iter_s": 11.063612937927246, "time_total_s": 384.4033212661743, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 384.4033212661743, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.74375, "ram_util_percent": 76.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 242.31578063964844, "policy_loss": -66660.515625, "vf_loss": 2397940.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 215.0, "diff_num_grad_updates_vs_sampler_policy": 214.0}}, "num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800}, "sampler_results": {"episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -711.6545025686431, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.037881739388384, "mean_inference_ms": 0.26636947926912063, "mean_action_processing_ms": 0.061615416397082005, "mean_env_wait_ms": 1.9244106888637906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002567291259765625, "StateBufferConnector_ms": 0.0017862319946289062, "ViewRequirementAgentConnector_ms": 0.04763436317443848}}, "episode_reward_max": -423.01874593498155, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -711.6545025686431, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-885.559339256984, -653.8853582847946, -638.1022289253442, -566.4308721077095, -423.01874593498155, -900.4306306769275, -850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.037881739388384, "mean_inference_ms": 0.26636947926912063, "mean_action_processing_ms": 0.061615416397082005, "mean_env_wait_ms": 1.9244106888637906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002567291259765625, "StateBufferConnector_ms": 0.0017862319946289062, "ViewRequirementAgentConnector_ms": 0.04763436317443848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.09689989906533, "num_env_steps_trained_throughput_per_sec": 66.09689989906533, "timesteps_total": 25800, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 25800, "timers": {"training_iteration_time_ms": 1824.284, "sample_time_ms": 1821.691, "load_time_ms": 0.15, "load_throughput": 799676.644, "learn_time_ms": 1.88, "learn_throughput": 63813.533, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800}, "done": false, "episodes_total": 215, "training_iteration": 36, "trial_id": "487fa_00000", "date": "2023-07-24_21-02-12", "timestamp": 1690221732, "time_this_iter_s": 10.895055770874023, "time_total_s": 395.29837703704834, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 395.29837703704834, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 27.779999999999998, "ram_util_percent": 76.32666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.166666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 242.2456512451172, "policy_loss": -73734.65625, "vf_loss": 3464158.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 220.0}}, "num_env_steps_sampled": 26520, "num_env_steps_trained": 26520, "num_agent_steps_sampled": 26520, "num_agent_steps_trained": 26520}, "sampler_results": {"episode_reward_max": -502.5074423564387, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -710.9731562478383, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03657168424545, "mean_inference_ms": 0.2663560681460251, "mean_action_processing_ms": 0.06162026653491728, "mean_env_wait_ms": 1.9212699298807367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025713443756103516, "StateBufferConnector_ms": 0.001789093017578125, "ViewRequirementAgentConnector_ms": 0.04756498336791992}}, "episode_reward_max": -502.5074423564387, "episode_reward_min": -1018.7216524728988, "episode_reward_mean": -710.9731562478383, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-850.9524623314958, -835.6337884897982, -862.2863969902686, -694.2993558635666, -1018.7216524728988, -661.9573276136299, -747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03657168424545, "mean_inference_ms": 0.2663560681460251, "mean_action_processing_ms": 0.06162026653491728, "mean_env_wait_ms": 1.9212699298807367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025713443756103516, "StateBufferConnector_ms": 0.001789093017578125, "ViewRequirementAgentConnector_ms": 0.04756498336791992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26520, "num_agent_steps_trained": 26520, "num_env_steps_sampled": 26520, "num_env_steps_trained": 26520, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.45103420195225, "num_env_steps_trained_throughput_per_sec": 66.45103420195225, "timesteps_total": 26520, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 26520, "timers": {"training_iteration_time_ms": 1811.088, "sample_time_ms": 1808.502, "load_time_ms": 0.149, "load_throughput": 807243.753, "learn_time_ms": 1.876, "learn_throughput": 63972.505, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 26520, "num_env_steps_trained": 26520, "num_agent_steps_sampled": 26520, "num_agent_steps_trained": 26520}, "done": false, "episodes_total": 221, "training_iteration": 37, "trial_id": "487fa_00000", "date": "2023-07-24_21-02-23", "timestamp": 1690221743, "time_this_iter_s": 10.837099075317383, "time_total_s": 406.1354761123657, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 406.1354761123657, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 25.866666666666664, "ram_util_percent": 75.97333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 242.423583984375, "policy_loss": -92529.7421875, "vf_loss": 4626363.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 227.0, "diff_num_grad_updates_vs_sampler_policy": 226.0}}, "num_env_steps_sampled": 27240, "num_env_steps_trained": 27240, "num_agent_steps_sampled": 27240, "num_agent_steps_trained": 27240}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1007.0615920235803, "episode_reward_mean": -701.0017623542986, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03515843368782, "mean_inference_ms": 0.26636791048124125, "mean_action_processing_ms": 0.061628381687245215, "mean_env_wait_ms": 1.9184443782317444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025758743286132812, "StateBufferConnector_ms": 0.0018029212951660156, "ViewRequirementAgentConnector_ms": 0.047548770904541016}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1007.0615920235803, "episode_reward_mean": -701.0017623542986, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-747.1958456538828, -717.0420327913121, -579.0300290103511, -661.1125885325314, -682.1276103626609, -895.4695513616305, -802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.03515843368782, "mean_inference_ms": 0.26636791048124125, "mean_action_processing_ms": 0.061628381687245215, "mean_env_wait_ms": 1.9184443782317444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025758743286132812, "StateBufferConnector_ms": 0.0018029212951660156, "ViewRequirementAgentConnector_ms": 0.047548770904541016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27240, "num_agent_steps_trained": 27240, "num_env_steps_sampled": 27240, "num_env_steps_trained": 27240, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.01903208791984, "num_env_steps_trained_throughput_per_sec": 66.01903208791984, "timesteps_total": 27240, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 27240, "timers": {"training_iteration_time_ms": 1813.932, "sample_time_ms": 1811.205, "load_time_ms": 0.15, "load_throughput": 798154.9, "learn_time_ms": 1.93, "learn_throughput": 62167.77, "synch_weights_time_ms": 0.616}, "counters": {"num_env_steps_sampled": 27240, "num_env_steps_trained": 27240, "num_agent_steps_sampled": 27240, "num_agent_steps_trained": 27240}, "done": false, "episodes_total": 227, "training_iteration": 38, "trial_id": "487fa_00000", "date": "2023-07-24_21-02-34", "timestamp": 1690221754, "time_this_iter_s": 10.908110857009888, "time_total_s": 417.0435869693756, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 417.0435869693756, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 24.69375, "ram_util_percent": 76.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.166666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 242.4889373779297, "policy_loss": -99441.5625, "vf_loss": 5476455.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 27960, "num_env_steps_trained": 27960, "num_agent_steps_sampled": 27960, "num_agent_steps_trained": 27960}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -705.2813324666333, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.033693041598568, "mean_inference_ms": 0.2663750888596106, "mean_action_processing_ms": 0.06163584516880825, "mean_env_wait_ms": 1.9158650139920133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025784969329833984, "StateBufferConnector_ms": 0.0017938613891601562, "ViewRequirementAgentConnector_ms": 0.0476231575012207}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -705.2813324666333, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-802.3277731315961, -817.2275957791865, -656.2943995386644, -669.7665497676796, -680.8362930688028, -569.1673420460412, -706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.033693041598568, "mean_inference_ms": 0.2663750888596106, "mean_action_processing_ms": 0.06163584516880825, "mean_env_wait_ms": 1.9158650139920133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025784969329833984, "StateBufferConnector_ms": 0.0017938613891601562, "ViewRequirementAgentConnector_ms": 0.0476231575012207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27960, "num_agent_steps_trained": 27960, "num_env_steps_sampled": 27960, "num_env_steps_trained": 27960, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.01364482149553, "num_env_steps_trained_throughput_per_sec": 66.01364482149553, "timesteps_total": 27960, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 27960, "timers": {"training_iteration_time_ms": 1814.104, "sample_time_ms": 1811.538, "load_time_ms": 0.147, "load_throughput": 815747.942, "learn_time_ms": 1.859, "learn_throughput": 64563.346, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 27960, "num_env_steps_trained": 27960, "num_agent_steps_sampled": 27960, "num_agent_steps_trained": 27960}, "done": false, "episodes_total": 233, "training_iteration": 39, "trial_id": "487fa_00000", "date": "2023-07-24_21-02-45", "timestamp": 1690221765, "time_this_iter_s": 10.919968128204346, "time_total_s": 427.96355509757996, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 427.96355509757996, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 22.6375, "ram_util_percent": 76.35625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 242.62184143066406, "policy_loss": -91569.90625, "vf_loss": 4450279.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 238.0}}, "num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.4188527021576, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.032044294534437, "mean_inference_ms": 0.2663782346405911, "mean_action_processing_ms": 0.06164326571460068, "mean_env_wait_ms": 1.913388767196575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002554178237915039, "StateBufferConnector_ms": 0.0017993450164794922, "ViewRequirementAgentConnector_ms": 0.04716181755065918}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.4188527021576, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-706.8822543817316, -664.8667914851824, -831.9424523552236, -502.5074423564387, -776.5707018890657, -664.7870519918949, -780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.032044294534437, "mean_inference_ms": 0.2663782346405911, "mean_action_processing_ms": 0.06164326571460068, "mean_env_wait_ms": 1.913388767196575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002554178237915039, "StateBufferConnector_ms": 0.0017993450164794922, "ViewRequirementAgentConnector_ms": 0.04716181755065918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680, "num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.15330016021245, "num_env_steps_trained_throughput_per_sec": 66.15330016021245, "timesteps_total": 28680, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 28680, "timers": {"training_iteration_time_ms": 1815.554, "sample_time_ms": 1812.992, "load_time_ms": 0.148, "load_throughput": 809841.48, "learn_time_ms": 1.869, "learn_throughput": 64206.72, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 28680, "num_env_steps_trained": 28680, "num_agent_steps_sampled": 28680, "num_agent_steps_trained": 28680}, "done": false, "episodes_total": 239, "training_iteration": 40, "trial_id": "487fa_00000", "date": "2023-07-24_21-02-55", "timestamp": 1690221775, "time_this_iter_s": 10.88591718673706, "time_total_s": 438.849472284317, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 438.849472284317, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 26.513333333333335, "ram_util_percent": 76.58666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3e-06, "entropy_coeff": 0.1, "policy_entropy": 242.65013122558594, "policy_loss": -74314.328125, "vf_loss": 3329195.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 245.0, "diff_num_grad_updates_vs_sampler_policy": 244.0}}, "num_env_steps_sampled": 29400, "num_env_steps_trained": 29400, "num_agent_steps_sampled": 29400, "num_agent_steps_trained": 29400}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -708.3904268416844, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.030541789776139, "mean_inference_ms": 0.2664006046476172, "mean_action_processing_ms": 0.06165472176771199, "mean_env_wait_ms": 1.9111340579015574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025746822357177734, "StateBufferConnector_ms": 0.0018031597137451172, "ViewRequirementAgentConnector_ms": 0.047217369079589844}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -708.3904268416844, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-780.9033074031513, -668.56864767313, -731.914173919843, -699.8324002617816, -1007.0615920235803, -743.6446633750372, -759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.030541789776139, "mean_inference_ms": 0.2664006046476172, "mean_action_processing_ms": 0.06165472176771199, "mean_env_wait_ms": 1.9111340579015574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025746822357177734, "StateBufferConnector_ms": 0.0018031597137451172, "ViewRequirementAgentConnector_ms": 0.047217369079589844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29400, "num_agent_steps_trained": 29400, "num_env_steps_sampled": 29400, "num_env_steps_trained": 29400, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.65818863516101, "num_env_steps_trained_throughput_per_sec": 65.65818863516101, "timesteps_total": 29400, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 29400, "timers": {"training_iteration_time_ms": 1821.866, "sample_time_ms": 1819.308, "load_time_ms": 0.146, "load_throughput": 819600.195, "learn_time_ms": 1.865, "learn_throughput": 64356.96, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 29400, "num_env_steps_trained": 29400, "num_agent_steps_sampled": 29400, "num_agent_steps_trained": 29400}, "done": false, "episodes_total": 245, "training_iteration": 41, "trial_id": "487fa_00000", "date": "2023-07-24_21-03-06", "timestamp": 1690221786, "time_this_iter_s": 10.967966079711914, "time_total_s": 449.81743836402893, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 449.81743836402893, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 26.59375, "ram_util_percent": 76.73750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0000000000000003e-06, "entropy_coeff": 0.1, "policy_entropy": 242.654296875, "policy_loss": -82196.21875, "vf_loss": 3654456.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 250.0}}, "num_env_steps_sampled": 30120, "num_env_steps_trained": 30120, "num_agent_steps_sampled": 30120, "num_agent_steps_trained": 30120}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.7130426347711, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.029168644740226, "mean_inference_ms": 0.2664163400723154, "mean_action_processing_ms": 0.06166473070128116, "mean_env_wait_ms": 1.9089480043663185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00257110595703125, "StateBufferConnector_ms": 0.0018041133880615234, "ViewRequirementAgentConnector_ms": 0.04719400405883789}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.7130426347711, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-759.5733173008575, -714.2287355393843, -677.0471121305466, -807.3012880214911, -562.3592400607241, -696.1422347740205, -777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.029168644740226, "mean_inference_ms": 0.2664163400723154, "mean_action_processing_ms": 0.06166473070128116, "mean_env_wait_ms": 1.9089480043663185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00257110595703125, "StateBufferConnector_ms": 0.0018041133880615234, "ViewRequirementAgentConnector_ms": 0.04719400405883789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30120, "num_agent_steps_trained": 30120, "num_env_steps_sampled": 30120, "num_env_steps_trained": 30120, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.09381718691574, "num_env_steps_trained_throughput_per_sec": 66.09381718691574, "timesteps_total": 30120, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 30120, "timers": {"training_iteration_time_ms": 1814.91, "sample_time_ms": 1812.367, "load_time_ms": 0.147, "load_throughput": 816144.771, "learn_time_ms": 1.849, "learn_throughput": 64892.148, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 30120, "num_env_steps_trained": 30120, "num_agent_steps_sampled": 30120, "num_agent_steps_trained": 30120}, "done": false, "episodes_total": 251, "training_iteration": 42, "trial_id": "487fa_00000", "date": "2023-07-24_21-03-17", "timestamp": 1690221797, "time_this_iter_s": 10.895604848861694, "time_total_s": 460.7130432128906, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 460.7130432128906, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 28.753333333333334, "ram_util_percent": 76.85333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7000000000000002e-06, "entropy_coeff": 0.1, "policy_entropy": 242.57827758789062, "policy_loss": -95324.171875, "vf_loss": 4473940.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 257.0, "diff_num_grad_updates_vs_sampler_policy": 256.0}}, "num_env_steps_sampled": 30840, "num_env_steps_trained": 30840, "num_agent_steps_sampled": 30840, "num_agent_steps_trained": 30840}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -707.2573817510655, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.027658802149595, "mean_inference_ms": 0.2664063006258023, "mean_action_processing_ms": 0.06167044077541419, "mean_env_wait_ms": 1.906848613036732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025606155395507812, "StateBufferConnector_ms": 0.0018086433410644531, "ViewRequirementAgentConnector_ms": 0.04706907272338867}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -707.2573817510655, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-777.3693538263793, -720.6499996095434, -841.7913450072133, -764.6110784825815, -611.3366111379237, -718.1930197068408, -824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.027658802149595, "mean_inference_ms": 0.2664063006258023, "mean_action_processing_ms": 0.06167044077541419, "mean_env_wait_ms": 1.906848613036732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025606155395507812, "StateBufferConnector_ms": 0.0018086433410644531, "ViewRequirementAgentConnector_ms": 0.04706907272338867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30840, "num_agent_steps_trained": 30840, "num_env_steps_sampled": 30840, "num_env_steps_trained": 30840, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.39436327278537, "num_env_steps_trained_throughput_per_sec": 66.39436327278537, "timesteps_total": 30840, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 30840, "timers": {"training_iteration_time_ms": 1810.389, "sample_time_ms": 1807.811, "load_time_ms": 0.147, "load_throughput": 814164.478, "learn_time_ms": 1.871, "learn_throughput": 64150.254, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 30840, "num_env_steps_trained": 30840, "num_agent_steps_sampled": 30840, "num_agent_steps_trained": 30840}, "done": false, "episodes_total": 257, "training_iteration": 43, "trial_id": "487fa_00000", "date": "2023-07-24_21-03-28", "timestamp": 1690221808, "time_this_iter_s": 10.846477031707764, "time_total_s": 471.5595202445984, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 471.5595202445984, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 27.637500000000003, "ram_util_percent": 76.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4000000000000001e-06, "entropy_coeff": 0.1, "policy_entropy": 242.47552490234375, "policy_loss": -95916.609375, "vf_loss": 5118906.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 262.0}}, "num_env_steps_sampled": 31560, "num_env_steps_trained": 31560, "num_agent_steps_sampled": 31560, "num_agent_steps_trained": 31560}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.3638750255802, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02614406194874, "mean_inference_ms": 0.26639348215096054, "mean_action_processing_ms": 0.061676183655211485, "mean_env_wait_ms": 1.9048866976764167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0018091201782226562, "ViewRequirementAgentConnector_ms": 0.047081947326660156}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.3638750255802, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-824.4759926610066, -555.6828961071167, -678.8030721683837, -624.533965886693, -794.234432860992, -711.6837319674704, -619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02614406194874, "mean_inference_ms": 0.26639348215096054, "mean_action_processing_ms": 0.061676183655211485, "mean_env_wait_ms": 1.9048866976764167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0018091201782226562, "ViewRequirementAgentConnector_ms": 0.047081947326660156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31560, "num_agent_steps_trained": 31560, "num_env_steps_sampled": 31560, "num_env_steps_trained": 31560, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.14657103421327, "num_env_steps_trained_throughput_per_sec": 66.14657103421327, "timesteps_total": 31560, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 31560, "timers": {"training_iteration_time_ms": 1810.922, "sample_time_ms": 1808.343, "load_time_ms": 0.15, "load_throughput": 802481.633, "learn_time_ms": 1.868, "learn_throughput": 64238.68, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 31560, "num_env_steps_trained": 31560, "num_agent_steps_sampled": 31560, "num_agent_steps_trained": 31560}, "done": false, "episodes_total": 263, "training_iteration": 44, "trial_id": "487fa_00000", "date": "2023-07-24_21-03-39", "timestamp": 1690221819, "time_this_iter_s": 10.887157201766968, "time_total_s": 482.44667744636536, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 482.44667744636536, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.793333333333333, "ram_util_percent": 76.55333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0999999999999998e-06, "entropy_coeff": 0.1, "policy_entropy": 242.40977478027344, "policy_loss": -92552.5703125, "vf_loss": 4970050.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 269.0, "diff_num_grad_updates_vs_sampler_policy": 268.0}}, "num_env_steps_sampled": 32280, "num_env_steps_trained": 32280, "num_agent_steps_sampled": 32280, "num_agent_steps_trained": 32280}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.3896871890477, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024374532843806, "mean_inference_ms": 0.2663613258191708, "mean_action_processing_ms": 0.061679438281955365, "mean_env_wait_ms": 1.9030091107355938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025479793548583984, "StateBufferConnector_ms": 0.0017960071563720703, "ViewRequirementAgentConnector_ms": 0.047049522399902344}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.3896871890477, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-619.349072905677, -673.4617846878909, -719.1130280304243, -762.2132842105113, -622.0639466601447, -738.5720179544827, -769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024374532843806, "mean_inference_ms": 0.2663613258191708, "mean_action_processing_ms": 0.061679438281955365, "mean_env_wait_ms": 1.9030091107355938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025479793548583984, "StateBufferConnector_ms": 0.0017960071563720703, "ViewRequirementAgentConnector_ms": 0.047049522399902344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32280, "num_agent_steps_trained": 32280, "num_env_steps_sampled": 32280, "num_env_steps_trained": 32280, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.10962726757047, "num_env_steps_trained_throughput_per_sec": 66.10962726757047, "timesteps_total": 32280, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 32280, "timers": {"training_iteration_time_ms": 1814.258, "sample_time_ms": 1811.663, "load_time_ms": 0.15, "load_throughput": 797522.548, "learn_time_ms": 1.907, "learn_throughput": 62916.919, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 32280, "num_env_steps_trained": 32280, "num_agent_steps_sampled": 32280, "num_agent_steps_trained": 32280}, "done": false, "episodes_total": 269, "training_iteration": 45, "trial_id": "487fa_00000", "date": "2023-07-24_21-03-50", "timestamp": 1690221830, "time_this_iter_s": 10.892982006072998, "time_total_s": 493.33965945243835, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 493.33965945243835, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 23.456249999999997, "ram_util_percent": 76.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 242.3491668701172, "policy_loss": -68692.90625, "vf_loss": 2640549.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 274.0}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 33000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 33000}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -703.9288659522641, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02203703088448, "mean_inference_ms": 0.26629812021426286, "mean_action_processing_ms": 0.06167870545877438, "mean_env_wait_ms": 1.90117408641005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002526998519897461, "StateBufferConnector_ms": 0.0017883777618408203, "ViewRequirementAgentConnector_ms": 0.046837568283081055}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -703.9288659522641, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-769.7078482594067, -730.9155641048147, -679.9047005992351, -738.9055668308678, -755.3821529929785, -566.493198031827, -759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02203703088448, "mean_inference_ms": 0.26629812021426286, "mean_action_processing_ms": 0.06167870545877438, "mean_env_wait_ms": 1.90117408641005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002526998519897461, "StateBufferConnector_ms": 0.0017883777618408203, "ViewRequirementAgentConnector_ms": 0.046837568283081055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 33000, "num_env_steps_sampled": 33000, "num_env_steps_trained": 33000, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.73294777999777, "num_env_steps_trained_throughput_per_sec": 65.73294777999777, "timesteps_total": 33000, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 1821.075, "sample_time_ms": 1818.452, "load_time_ms": 0.149, "load_throughput": 803250.048, "learn_time_ms": 1.912, "learn_throughput": 62769.406, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 33000, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 33000}, "done": false, "episodes_total": 275, "training_iteration": 46, "trial_id": "487fa_00000", "date": "2023-07-24_21-04-01", "timestamp": 1690221841, "time_this_iter_s": 10.955417156219482, "time_total_s": 504.29507660865784, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 504.29507660865784, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.266666666666666, "ram_util_percent": 76.65333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.166666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 242.330078125, "policy_loss": -67617.96875, "vf_loss": 2743196.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 281.0, "diff_num_grad_updates_vs_sampler_policy": 280.0}}, "num_env_steps_sampled": 33720, "num_env_steps_trained": 33720, "num_agent_steps_sampled": 33720, "num_agent_steps_trained": 33720}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -702.847329640184, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.019759951111455, "mean_inference_ms": 0.26623974173398357, "mean_action_processing_ms": 0.06167828358196484, "mean_env_wait_ms": 1.8994387607050447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002560138702392578, "StateBufferConnector_ms": 0.0018186569213867188, "ViewRequirementAgentConnector_ms": 0.047307729721069336}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -702.847329640184, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-759.9891626152871, -753.9792906888772, -783.5565212283603, -727.3598078860108, -792.6287285009591, -743.1608311066451, -680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.019759951111455, "mean_inference_ms": 0.26623974173398357, "mean_action_processing_ms": 0.06167828358196484, "mean_env_wait_ms": 1.8994387607050447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002560138702392578, "StateBufferConnector_ms": 0.0018186569213867188, "ViewRequirementAgentConnector_ms": 0.047307729721069336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33720, "num_agent_steps_trained": 33720, "num_env_steps_sampled": 33720, "num_env_steps_trained": 33720, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.20521231646791, "num_env_steps_trained_throughput_per_sec": 65.20521231646791, "timesteps_total": 33720, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 33720, "timers": {"training_iteration_time_ms": 1836.5, "sample_time_ms": 1833.941, "load_time_ms": 0.147, "load_throughput": 818667.014, "learn_time_ms": 1.856, "learn_throughput": 64669.529, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 33720, "num_env_steps_trained": 33720, "num_agent_steps_sampled": 33720, "num_agent_steps_trained": 33720}, "done": false, "episodes_total": 281, "training_iteration": 47, "trial_id": "487fa_00000", "date": "2023-07-24_21-04-12", "timestamp": 1690221852, "time_this_iter_s": 11.04413890838623, "time_total_s": 515.3392155170441, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 515.3392155170441, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 25.4125, "ram_util_percent": 76.74375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 242.29347229003906, "policy_loss": -103036.625, "vf_loss": 6535385.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 287.0, "diff_num_grad_updates_vs_sampler_policy": 286.0}}, "num_env_steps_sampled": 34440, "num_env_steps_trained": 34440, "num_agent_steps_sampled": 34440, "num_agent_steps_trained": 34440}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -700.1896795957196, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.017833925946261, "mean_inference_ms": 0.26619914668575484, "mean_action_processing_ms": 0.06168024268682126, "mean_env_wait_ms": 1.8978438170470087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635478973388672, "StateBufferConnector_ms": 0.0018396377563476562, "ViewRequirementAgentConnector_ms": 0.04810643196105957}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -700.1896795957196, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-680.2766495914914, -631.6964035030317, -836.0466748312929, -626.0378574542007, -640.9689348801144, -658.2036131797755, -534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.017833925946261, "mean_inference_ms": 0.26619914668575484, "mean_action_processing_ms": 0.06168024268682126, "mean_env_wait_ms": 1.8978438170470087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635478973388672, "StateBufferConnector_ms": 0.0018396377563476562, "ViewRequirementAgentConnector_ms": 0.04810643196105957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34440, "num_agent_steps_trained": 34440, "num_env_steps_sampled": 34440, "num_env_steps_trained": 34440, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.63566992985399, "num_env_steps_trained_throughput_per_sec": 65.63566992985399, "timesteps_total": 34440, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 34440, "timers": {"training_iteration_time_ms": 1837.715, "sample_time_ms": 1834.996, "load_time_ms": 0.168, "load_throughput": 712610.052, "learn_time_ms": 1.979, "learn_throughput": 60626.661, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 34440, "num_env_steps_trained": 34440, "num_agent_steps_sampled": 34440, "num_agent_steps_trained": 34440}, "done": false, "episodes_total": 287, "training_iteration": 48, "trial_id": "487fa_00000", "date": "2023-07-24_21-04-23", "timestamp": 1690221863, "time_this_iter_s": 10.972126960754395, "time_total_s": 526.3113424777985, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 526.3113424777985, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 26.426666666666666, "ram_util_percent": 76.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.166666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 242.30752563476562, "policy_loss": -100878.09375, "vf_loss": 5482879.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 35160, "num_env_steps_trained": 35160, "num_agent_steps_sampled": 35160, "num_agent_steps_trained": 35160}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -699.749490088602, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.016146252655524, "mean_inference_ms": 0.26615104015728464, "mean_action_processing_ms": 0.06168027537583848, "mean_env_wait_ms": 1.8962444374295648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026378631591796875, "StateBufferConnector_ms": 0.0018439292907714844, "ViewRequirementAgentConnector_ms": 0.048117876052856445}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -699.749490088602, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-534.7174614355765, -756.9127632646017, -648.8215091176603, -726.3531456856991, -695.6317712509116, -720.5102039744838, -586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.016146252655524, "mean_inference_ms": 0.26615104015728464, "mean_action_processing_ms": 0.06168027537583848, "mean_env_wait_ms": 1.8962444374295648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026378631591796875, "StateBufferConnector_ms": 0.0018439292907714844, "ViewRequirementAgentConnector_ms": 0.048117876052856445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35160, "num_agent_steps_trained": 35160, "num_env_steps_sampled": 35160, "num_env_steps_trained": 35160, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.94546725576721, "num_env_steps_trained_throughput_per_sec": 65.94546725576721, "timesteps_total": 35160, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 35160, "timers": {"training_iteration_time_ms": 1819.184, "sample_time_ms": 1816.465, "load_time_ms": 0.168, "load_throughput": 712610.052, "learn_time_ms": 1.992, "learn_throughput": 60239.908, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 35160, "num_env_steps_trained": 35160, "num_agent_steps_sampled": 35160, "num_agent_steps_trained": 35160}, "done": false, "episodes_total": 293, "training_iteration": 49, "trial_id": "487fa_00000", "date": "2023-07-24_21-04-34", "timestamp": 1690221874, "time_this_iter_s": 10.920252323150635, "time_total_s": 537.2315948009491, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 537.2315948009491, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 23.7875, "ram_util_percent": 76.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.666666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 242.3083953857422, "policy_loss": -61173.2265625, "vf_loss": 2069844.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 299.0, "diff_num_grad_updates_vs_sampler_policy": 298.0}}, "num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -701.5465332139262, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.014572868282567, "mean_inference_ms": 0.2661138158421105, "mean_action_processing_ms": 0.06168177009978809, "mean_env_wait_ms": 1.8947624972770527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026464462280273438, "StateBufferConnector_ms": 0.0018515586853027344, "ViewRequirementAgentConnector_ms": 0.04825401306152344}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -701.5465332139262, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-586.4969615616802, -704.0992744661022, -624.9573510580926, -720.6168778939216, -811.4949886668761, -649.3579880820403, -775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.014572868282567, "mean_inference_ms": 0.2661138158421105, "mean_action_processing_ms": 0.06168177009978809, "mean_env_wait_ms": 1.8947624972770527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026464462280273438, "StateBufferConnector_ms": 0.0018515586853027344, "ViewRequirementAgentConnector_ms": 0.04825401306152344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880, "num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.69250155024268, "num_env_steps_trained_throughput_per_sec": 65.69250155024268, "timesteps_total": 35880, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 35880, "timers": {"training_iteration_time_ms": 1823.298, "sample_time_ms": 1820.699, "load_time_ms": 0.152, "load_throughput": 790632.234, "learn_time_ms": 1.899, "learn_throughput": 63206.892, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 35880, "num_env_steps_trained": 35880, "num_agent_steps_sampled": 35880, "num_agent_steps_trained": 35880}, "done": false, "episodes_total": 299, "training_iteration": 50, "trial_id": "487fa_00000", "date": "2023-07-24_21-04-45", "timestamp": 1690221885, "time_this_iter_s": 10.96228313446045, "time_total_s": 548.1938779354095, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 548.1938779354095, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.40625, "ram_util_percent": 76.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 242.32101440429688, "policy_loss": -114701.2578125, "vf_loss": 6980448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 305.0, "diff_num_grad_updates_vs_sampler_policy": 304.0}}, "num_env_steps_sampled": 36600, "num_env_steps_trained": 36600, "num_agent_steps_sampled": 36600, "num_agent_steps_trained": 36600}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -704.0029300474577, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.013154225824696, "mean_inference_ms": 0.26607982592777896, "mean_action_processing_ms": 0.06167882706663939, "mean_env_wait_ms": 1.8933772271405815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635955810546875, "StateBufferConnector_ms": 0.0018496513366699219, "ViewRequirementAgentConnector_ms": 0.04817008972167969}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -704.0029300474577, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-775.0182951761587, -578.4196166161762, -652.2955779560482, -732.9158757210712, -779.2546434945698, -647.860840079547, -851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.013154225824696, "mean_inference_ms": 0.26607982592777896, "mean_action_processing_ms": 0.06167882706663939, "mean_env_wait_ms": 1.8933772271405815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635955810546875, "StateBufferConnector_ms": 0.0018496513366699219, "ViewRequirementAgentConnector_ms": 0.04817008972167969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36600, "num_agent_steps_trained": 36600, "num_env_steps_sampled": 36600, "num_env_steps_trained": 36600, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.43707470706936, "num_env_steps_trained_throughput_per_sec": 65.43707470706936, "timesteps_total": 36600, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 36600, "timers": {"training_iteration_time_ms": 1836.442, "sample_time_ms": 1833.876, "load_time_ms": 0.15, "load_throughput": 801587.004, "learn_time_ms": 1.869, "learn_throughput": 64207.539, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 36600, "num_env_steps_trained": 36600, "num_agent_steps_sampled": 36600, "num_agent_steps_trained": 36600}, "done": false, "episodes_total": 305, "training_iteration": 51, "trial_id": "487fa_00000", "date": "2023-07-24_21-04-56", "timestamp": 1690221896, "time_this_iter_s": 11.005034923553467, "time_total_s": 559.198912858963, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 559.198912858963, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 27.2, "ram_util_percent": 77.00666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.666666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 242.32823181152344, "policy_loss": -89472.4453125, "vf_loss": 4544280.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 37320, "num_env_steps_trained": 37320, "num_agent_steps_sampled": 37320, "num_agent_steps_trained": 37320}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.9886151908228, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.011714156818863, "mean_inference_ms": 0.2660381119654888, "mean_action_processing_ms": 0.06166766665133771, "mean_env_wait_ms": 1.8920229008287845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002626657485961914, "StateBufferConnector_ms": 0.0018515586853027344, "ViewRequirementAgentConnector_ms": 0.04806923866271973}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -706.9886151908228, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-851.9952926963902, -571.9515762283385, -750.0477738429623, -547.3591515031119, -599.9773657308633, -557.4888500848709, -588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.011714156818863, "mean_inference_ms": 0.2660381119654888, "mean_action_processing_ms": 0.06166766665133771, "mean_env_wait_ms": 1.8920229008287845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002626657485961914, "StateBufferConnector_ms": 0.0018515586853027344, "ViewRequirementAgentConnector_ms": 0.04806923866271973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37320, "num_agent_steps_trained": 37320, "num_env_steps_sampled": 37320, "num_env_steps_trained": 37320, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.71519512615423, "num_env_steps_trained_throughput_per_sec": 65.71519512615423, "timesteps_total": 37320, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 37320, "timers": {"training_iteration_time_ms": 1827.92, "sample_time_ms": 1825.381, "load_time_ms": 0.147, "load_throughput": 814032.8, "learn_time_ms": 1.846, "learn_throughput": 65017.889, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 37320, "num_env_steps_trained": 37320, "num_agent_steps_sampled": 37320, "num_agent_steps_trained": 37320}, "done": false, "episodes_total": 311, "training_iteration": 52, "trial_id": "487fa_00000", "date": "2023-07-24_21-05-07", "timestamp": 1690221907, "time_this_iter_s": 10.958525896072388, "time_total_s": 570.1574387550354, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 570.1574387550354, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 24.61875, "ram_util_percent": 77.19375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 242.34703063964844, "policy_loss": -88869.609375, "vf_loss": 4339178.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 317.0, "diff_num_grad_updates_vs_sampler_policy": 316.0}}, "num_env_steps_sampled": 38040, "num_env_steps_trained": 38040, "num_agent_steps_sampled": 38040, "num_agent_steps_trained": 38040}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -711.4184055908477, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0103788358139, "mean_inference_ms": 0.2660050666462962, "mean_action_processing_ms": 0.06165759011978217, "mean_env_wait_ms": 1.8907346422748879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002611398696899414, "StateBufferConnector_ms": 0.0018486976623535156, "ViewRequirementAgentConnector_ms": 0.04792642593383789}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1018.1034322165827, "episode_reward_mean": -711.4184055908477, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-588.594869918127, -795.5319942773465, -799.9482843743413, -657.7511787207237, -652.048938713198, -617.7209762646966, -441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0103788358139, "mean_inference_ms": 0.2660050666462962, "mean_action_processing_ms": 0.06165759011978217, "mean_env_wait_ms": 1.8907346422748879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002611398696899414, "StateBufferConnector_ms": 0.0018486976623535156, "ViewRequirementAgentConnector_ms": 0.04792642593383789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38040, "num_agent_steps_trained": 38040, "num_env_steps_sampled": 38040, "num_env_steps_trained": 38040, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.15914071383415, "num_env_steps_trained_throughput_per_sec": 66.15914071383415, "timesteps_total": 38040, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 38040, "timers": {"training_iteration_time_ms": 1819.635, "sample_time_ms": 1817.09, "load_time_ms": 0.151, "load_throughput": 797269.888, "learn_time_ms": 1.861, "learn_throughput": 64473.2, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 38040, "num_env_steps_trained": 38040, "num_agent_steps_sampled": 38040, "num_agent_steps_trained": 38040}, "done": false, "episodes_total": 317, "training_iteration": 53, "trial_id": "487fa_00000", "date": "2023-07-24_21-05-18", "timestamp": 1690221918, "time_this_iter_s": 10.884957075119019, "time_total_s": 581.0423958301544, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 581.0423958301544, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 25.086666666666662, "ram_util_percent": 77.02666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 242.33123779296875, "policy_loss": -70662.328125, "vf_loss": 3177007.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 322.0}}, "num_env_steps_sampled": 38760, "num_env_steps_trained": 38760, "num_agent_steps_sampled": 38760, "num_agent_steps_trained": 38760}, "sampler_results": {"episode_reward_max": -441.72935331936327, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -715.4319340088226, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.009265040517194, "mean_inference_ms": 0.2659814134306573, "mean_action_processing_ms": 0.0616488948683835, "mean_env_wait_ms": 1.8894957566823773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025980472564697266, "StateBufferConnector_ms": 0.0018415451049804688, "ViewRequirementAgentConnector_ms": 0.04785513877868652}}, "episode_reward_max": -441.72935331936327, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -715.4319340088226, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-441.72935331936327, -732.98563848995, -688.8475998810467, -793.3790877394546, -749.4446048993713, -785.7478753182334, -568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.009265040517194, "mean_inference_ms": 0.2659814134306573, "mean_action_processing_ms": 0.0616488948683835, "mean_env_wait_ms": 1.8894957566823773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025980472564697266, "StateBufferConnector_ms": 0.0018415451049804688, "ViewRequirementAgentConnector_ms": 0.04785513877868652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38760, "num_agent_steps_trained": 38760, "num_env_steps_sampled": 38760, "num_env_steps_trained": 38760, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.88802191360627, "num_env_steps_trained_throughput_per_sec": 65.88802191360627, "timesteps_total": 38760, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 38760, "timers": {"training_iteration_time_ms": 1819.778, "sample_time_ms": 1817.254, "load_time_ms": 0.146, "load_throughput": 824298.198, "learn_time_ms": 1.832, "learn_throughput": 65486.544, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 38760, "num_env_steps_trained": 38760, "num_agent_steps_sampled": 38760, "num_agent_steps_trained": 38760}, "done": false, "episodes_total": 323, "training_iteration": 54, "trial_id": "487fa_00000", "date": "2023-07-24_21-05-29", "timestamp": 1690221929, "time_this_iter_s": 10.929616212844849, "time_total_s": 591.9720120429993, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 591.9720120429993, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 27.20625, "ram_util_percent": 76.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.166666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 242.34793090820312, "policy_loss": -69598.8046875, "vf_loss": 2626577.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 329.0, "diff_num_grad_updates_vs_sampler_policy": 328.0}}, "num_env_steps_sampled": 39480, "num_env_steps_trained": 39480, "num_agent_steps_sampled": 39480, "num_agent_steps_trained": 39480}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -716.4549412748257, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.008429614259661, "mean_inference_ms": 0.26594906682442826, "mean_action_processing_ms": 0.06163934882832374, "mean_env_wait_ms": 1.8882676815631003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025932788848876953, "StateBufferConnector_ms": 0.0018315315246582031, "ViewRequirementAgentConnector_ms": 0.047586917877197266}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -716.4549412748257, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-568.7306500641638, -1018.1034322165827, -785.1777594024586, -802.7303470450343, -569.8460068679259, -794.8190927633708, -588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.008429614259661, "mean_inference_ms": 0.26594906682442826, "mean_action_processing_ms": 0.06163934882832374, "mean_env_wait_ms": 1.8882676815631003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025932788848876953, "StateBufferConnector_ms": 0.0018315315246582031, "ViewRequirementAgentConnector_ms": 0.047586917877197266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39480, "num_agent_steps_trained": 39480, "num_env_steps_sampled": 39480, "num_env_steps_trained": 39480, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.44437219798773, "num_env_steps_trained_throughput_per_sec": 65.44437219798773, "timesteps_total": 39480, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 39480, "timers": {"training_iteration_time_ms": 1831.809, "sample_time_ms": 1829.254, "load_time_ms": 0.147, "load_throughput": 818533.875, "learn_time_ms": 1.854, "learn_throughput": 64738.569, "synch_weights_time_ms": 0.525}, "counters": {"num_env_steps_sampled": 39480, "num_env_steps_trained": 39480, "num_agent_steps_sampled": 39480, "num_agent_steps_trained": 39480}, "done": false, "episodes_total": 329, "training_iteration": 55, "trial_id": "487fa_00000", "date": "2023-07-24_21-05-40", "timestamp": 1690221940, "time_this_iter_s": 11.003768920898438, "time_total_s": 602.9757809638977, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 602.9757809638977, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 24.025, "ram_util_percent": 76.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.6666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 242.35914611816406, "policy_loss": -82247.3828125, "vf_loss": 3628646.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 335.0, "diff_num_grad_updates_vs_sampler_policy": 334.0}}, "num_env_steps_sampled": 40200, "num_env_steps_trained": 40200, "num_agent_steps_sampled": 40200, "num_agent_steps_trained": 40200}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -714.8820917133476, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.007779384047694, "mean_inference_ms": 0.2659285628101095, "mean_action_processing_ms": 0.06163124671891145, "mean_env_wait_ms": 1.887121618446929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002598285675048828, "StateBufferConnector_ms": 0.0018379688262939453, "ViewRequirementAgentConnector_ms": 0.04760098457336426}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -714.8820917133476, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-588.5644974045083, -756.8710543091133, -826.8413729540764, -772.429952585388, -751.5698660809869, -590.5420046380596, -763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.007779384047694, "mean_inference_ms": 0.2659285628101095, "mean_action_processing_ms": 0.06163124671891145, "mean_env_wait_ms": 1.887121618446929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002598285675048828, "StateBufferConnector_ms": 0.0018379688262939453, "ViewRequirementAgentConnector_ms": 0.04760098457336426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40200, "num_agent_steps_trained": 40200, "num_env_steps_sampled": 40200, "num_env_steps_trained": 40200, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.38397233186734, "num_env_steps_trained_throughput_per_sec": 65.38397233186734, "timesteps_total": 40200, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 40200, "timers": {"training_iteration_time_ms": 1825.195, "sample_time_ms": 1822.624, "load_time_ms": 0.15, "load_throughput": 799041.88, "learn_time_ms": 1.87, "learn_throughput": 64184.613, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 40200, "num_env_steps_trained": 40200, "num_agent_steps_sampled": 40200, "num_agent_steps_trained": 40200}, "done": false, "episodes_total": 335, "training_iteration": 56, "trial_id": "487fa_00000", "date": "2023-07-24_21-05-51", "timestamp": 1690221951, "time_this_iter_s": 11.01404595375061, "time_total_s": 613.9898269176483, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 613.9898269176483, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.86, "ram_util_percent": 76.42666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.1666666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 242.33999633789062, "policy_loss": -117088.1953125, "vf_loss": 6979227.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 341.0, "diff_num_grad_updates_vs_sampler_policy": 340.0}}, "num_env_steps_sampled": 40920, "num_env_steps_trained": 40920, "num_agent_steps_sampled": 40920, "num_agent_steps_trained": 40920}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -715.7776164253264, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.007282528612027, "mean_inference_ms": 0.26591198894946144, "mean_action_processing_ms": 0.061623758051732765, "mean_env_wait_ms": 1.8860488345416426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002627134323120117, "StateBufferConnector_ms": 0.0018427371978759766, "ViewRequirementAgentConnector_ms": 0.048120737075805664}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -715.7776164253264, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-763.4737986085023, -849.3042478977881, -671.3150595265608, -718.5091316603013, -716.8376179856956, -762.6563891987937, -812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.007282528612027, "mean_inference_ms": 0.26591198894946144, "mean_action_processing_ms": 0.061623758051732765, "mean_env_wait_ms": 1.8860488345416426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002627134323120117, "StateBufferConnector_ms": 0.0018427371978759766, "ViewRequirementAgentConnector_ms": 0.048120737075805664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40920, "num_agent_steps_trained": 40920, "num_env_steps_sampled": 40920, "num_env_steps_trained": 40920, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.4213663761868, "num_env_steps_trained_throughput_per_sec": 65.4213663761868, "timesteps_total": 40920, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 40920, "timers": {"training_iteration_time_ms": 1836.82, "sample_time_ms": 1834.237, "load_time_ms": 0.149, "load_throughput": 806209.322, "learn_time_ms": 1.878, "learn_throughput": 63902.655, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 40920, "num_env_steps_trained": 40920, "num_agent_steps_sampled": 40920, "num_agent_steps_trained": 40920}, "done": false, "episodes_total": 341, "training_iteration": 57, "trial_id": "487fa_00000", "date": "2023-07-24_21-06-02", "timestamp": 1690221962, "time_this_iter_s": 11.007729768753052, "time_total_s": 624.9975566864014, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 624.9975566864014, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 24.7, "ram_util_percent": 76.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 242.3411407470703, "policy_loss": -97508.28125, "vf_loss": 5162602.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 346.0}}, "num_env_steps_sampled": 41640, "num_env_steps_trained": 41640, "num_agent_steps_sampled": 41640, "num_agent_steps_trained": 41640}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -712.2621375060178, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.006702134199053, "mean_inference_ms": 0.26589084556774745, "mean_action_processing_ms": 0.061614439028022945, "mean_env_wait_ms": 1.8849943118684382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002615690231323242, "StateBufferConnector_ms": 0.0018467903137207031, "ViewRequirementAgentConnector_ms": 0.04814505577087402}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -712.2621375060178, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-812.2130031769218, -665.0708120856359, -809.995957582085, -697.4125839360894, -642.6978278227206, -912.7846462037152, -780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.006702134199053, "mean_inference_ms": 0.26589084556774745, "mean_action_processing_ms": 0.061614439028022945, "mean_env_wait_ms": 1.8849943118684382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002615690231323242, "StateBufferConnector_ms": 0.0018467903137207031, "ViewRequirementAgentConnector_ms": 0.04814505577087402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41640, "num_agent_steps_trained": 41640, "num_env_steps_sampled": 41640, "num_env_steps_trained": 41640, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.30456458321454, "num_env_steps_trained_throughput_per_sec": 66.30456458321454, "timesteps_total": 41640, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 41640, "timers": {"training_iteration_time_ms": 1816.547, "sample_time_ms": 1813.7, "load_time_ms": 0.151, "load_throughput": 795128.72, "learn_time_ms": 2.008, "learn_throughput": 59767.076, "synch_weights_time_ms": 0.658}, "counters": {"num_env_steps_sampled": 41640, "num_env_steps_trained": 41640, "num_agent_steps_sampled": 41640, "num_agent_steps_trained": 41640}, "done": false, "episodes_total": 347, "training_iteration": 58, "trial_id": "487fa_00000", "date": "2023-07-24_21-06-13", "timestamp": 1690221973, "time_this_iter_s": 10.86115312576294, "time_total_s": 635.8587098121643, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 635.8587098121643, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 22.886666666666667, "ram_util_percent": 76.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1666666666666667e-07, "entropy_coeff": 0.1, "policy_entropy": 242.31103515625, "policy_loss": -96551.0, "vf_loss": 5163545.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 42360, "num_env_steps_trained": 42360, "num_agent_steps_sampled": 42360, "num_agent_steps_trained": 42360}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -710.6277350825726, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.006238734596964, "mean_inference_ms": 0.2658788239185587, "mean_action_processing_ms": 0.061606748804856205, "mean_env_wait_ms": 1.8839938665144134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002603292465209961, "StateBufferConnector_ms": 0.0018265247344970703, "ViewRequirementAgentConnector_ms": 0.04801630973815918}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -710.6277350825726, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-780.5850829420209, -575.9572869551553, -551.8119492308174, -807.2490463020358, -707.7106576813275, -610.6636429913135, -788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.006238734596964, "mean_inference_ms": 0.2658788239185587, "mean_action_processing_ms": 0.061606748804856205, "mean_env_wait_ms": 1.8839938665144134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002603292465209961, "StateBufferConnector_ms": 0.0018265247344970703, "ViewRequirementAgentConnector_ms": 0.04801630973815918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42360, "num_agent_steps_trained": 42360, "num_env_steps_sampled": 42360, "num_env_steps_trained": 42360, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.84510332162166, "num_env_steps_trained_throughput_per_sec": 65.84510332162166, "timesteps_total": 42360, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 42360, "timers": {"training_iteration_time_ms": 1818.431, "sample_time_ms": 1815.785, "load_time_ms": 0.148, "load_throughput": 810754.639, "learn_time_ms": 1.936, "learn_throughput": 61967.999, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 42360, "num_env_steps_trained": 42360, "num_agent_steps_sampled": 42360, "num_agent_steps_trained": 42360}, "done": false, "episodes_total": 353, "training_iteration": 59, "trial_id": "487fa_00000", "date": "2023-07-24_21-06-24", "timestamp": 1690221984, "time_this_iter_s": 10.936789989471436, "time_total_s": 646.7954998016357, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 646.7954998016357, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 23.56875, "ram_util_percent": 76.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.666666666666666e-07, "entropy_coeff": 0.1, "policy_entropy": 242.3074951171875, "policy_loss": -104032.96875, "vf_loss": 6037815.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 359.0, "diff_num_grad_updates_vs_sampler_policy": 358.0}}, "num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -713.7284764791021, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0059406167722, "mean_inference_ms": 0.2658659321703129, "mean_action_processing_ms": 0.06159926239768989, "mean_env_wait_ms": 1.8829753210816178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002602815628051758, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.04804253578186035}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -713.7284764791021, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-788.6281805512172, -617.2607958073688, -853.9365546206034, -766.4009035701107, -720.5522153493457, -656.610269742488, -649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0059406167722, "mean_inference_ms": 0.2658659321703129, "mean_action_processing_ms": 0.06159926239768989, "mean_env_wait_ms": 1.8829753210816178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002602815628051758, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.04804253578186035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080, "num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.11931498533886, "num_env_steps_trained_throughput_per_sec": 66.11931498533886, "timesteps_total": 43080, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 43080, "timers": {"training_iteration_time_ms": 1816.693, "sample_time_ms": 1813.906, "load_time_ms": 0.152, "load_throughput": 791129.33, "learn_time_ms": 1.981, "learn_throughput": 60561.737, "synch_weights_time_ms": 0.618}, "counters": {"num_env_steps_sampled": 43080, "num_env_steps_trained": 43080, "num_agent_steps_sampled": 43080, "num_agent_steps_trained": 43080}, "done": false, "episodes_total": 359, "training_iteration": 60, "trial_id": "487fa_00000", "date": "2023-07-24_21-06-35", "timestamp": 1690221995, "time_this_iter_s": 10.891592025756836, "time_total_s": 657.6870918273926, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 657.6870918273926, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 23.446666666666673, "ram_util_percent": 76.99333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3e-07, "entropy_coeff": 0.1, "policy_entropy": 242.31350708007812, "policy_loss": -107469.6953125, "vf_loss": 5644088.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 364.0}}, "num_env_steps_sampled": 43800, "num_env_steps_trained": 43800, "num_agent_steps_sampled": 43800, "num_agent_steps_trained": 43800}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -710.4395104009895, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.005711802144493, "mean_inference_ms": 0.2658480670462831, "mean_action_processing_ms": 0.06159135381464665, "mean_env_wait_ms": 1.881963798038543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026035308837890625, "StateBufferConnector_ms": 0.001833200454711914, "ViewRequirementAgentConnector_ms": 0.04797506332397461}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -710.4395104009895, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-649.8838541531753, -692.5819102642776, -670.5549995442574, -801.8120589448871, -681.5630694389081, -526.5308826934319, -713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.005711802144493, "mean_inference_ms": 0.2658480670462831, "mean_action_processing_ms": 0.06159135381464665, "mean_env_wait_ms": 1.881963798038543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026035308837890625, "StateBufferConnector_ms": 0.001833200454711914, "ViewRequirementAgentConnector_ms": 0.04797506332397461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43800, "num_agent_steps_trained": 43800, "num_env_steps_sampled": 43800, "num_env_steps_trained": 43800, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.17043199257324, "num_env_steps_trained_throughput_per_sec": 66.17043199257324, "timesteps_total": 43800, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 43800, "timers": {"training_iteration_time_ms": 1810.504, "sample_time_ms": 1807.764, "load_time_ms": 0.151, "load_throughput": 794626.587, "learn_time_ms": 1.981, "learn_throughput": 60579.96, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 43800, "num_env_steps_trained": 43800, "num_agent_steps_sampled": 43800, "num_agent_steps_trained": 43800}, "done": false, "episodes_total": 365, "training_iteration": 61, "trial_id": "487fa_00000", "date": "2023-07-24_21-06-46", "timestamp": 1690222006, "time_this_iter_s": 10.890590190887451, "time_total_s": 668.57768201828, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 668.57768201828, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 23.49375, "ram_util_percent": 77.41250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2e-07, "entropy_coeff": 0.1, "policy_entropy": 242.30047607421875, "policy_loss": -65418.79296875, "vf_loss": 2461035.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 371.0, "diff_num_grad_updates_vs_sampler_policy": 370.0}}, "num_env_steps_sampled": 44520, "num_env_steps_trained": 44520, "num_agent_steps_sampled": 44520, "num_agent_steps_trained": 44520}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -713.7050776768733, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.005534501129414, "mean_inference_ms": 0.265829315111475, "mean_action_processing_ms": 0.0615835533847665, "mean_env_wait_ms": 1.8809588302907765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026133060455322266, "StateBufferConnector_ms": 0.001840353012084961, "ViewRequirementAgentConnector_ms": 0.04794716835021973}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -713.7050776768733, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-713.5168129492126, -662.4338767053899, -676.7903720495857, -627.8559969342507, -624.6903364970676, -884.6118607430244, -759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.005534501129414, "mean_inference_ms": 0.265829315111475, "mean_action_processing_ms": 0.0615835533847665, "mean_env_wait_ms": 1.8809588302907765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026133060455322266, "StateBufferConnector_ms": 0.001840353012084961, "ViewRequirementAgentConnector_ms": 0.04794716835021973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44520, "num_agent_steps_trained": 44520, "num_env_steps_sampled": 44520, "num_env_steps_trained": 44520, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.02455447948203, "num_env_steps_trained_throughput_per_sec": 66.02455447948203, "timesteps_total": 44520, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 44520, "timers": {"training_iteration_time_ms": 1814.455, "sample_time_ms": 1811.725, "load_time_ms": 0.153, "load_throughput": 782397.762, "learn_time_ms": 1.963, "learn_throughput": 61130.319, "synch_weights_time_ms": 0.582}, "counters": {"num_env_steps_sampled": 44520, "num_env_steps_trained": 44520, "num_agent_steps_sampled": 44520, "num_agent_steps_trained": 44520}, "done": false, "episodes_total": 371, "training_iteration": 62, "trial_id": "487fa_00000", "date": "2023-07-24_21-06-57", "timestamp": 1690222017, "time_this_iter_s": 10.907111883163452, "time_total_s": 679.4847939014435, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 679.4847939014435, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 26.63333333333333, "ram_util_percent": 77.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7e-07, "entropy_coeff": 0.1, "policy_entropy": 242.31590270996094, "policy_loss": -61373.45703125, "vf_loss": 2476481.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 377.0, "diff_num_grad_updates_vs_sampler_policy": 376.0}}, "num_env_steps_sampled": 45240, "num_env_steps_trained": 45240, "num_agent_steps_sampled": 45240, "num_agent_steps_trained": 45240}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -711.67369794659, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.005216247740414, "mean_inference_ms": 0.26580780668825815, "mean_action_processing_ms": 0.06157664665433381, "mean_env_wait_ms": 1.8799931870552513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026090145111083984, "StateBufferConnector_ms": 0.0018360614776611328, "ViewRequirementAgentConnector_ms": 0.04787135124206543}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -711.67369794659, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-759.3621956289815, -585.9993650783375, -606.5682139128563, -671.9234277507869, -684.6274531228793, -665.1145248334527, -708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.005216247740414, "mean_inference_ms": 0.26580780668825815, "mean_action_processing_ms": 0.06157664665433381, "mean_env_wait_ms": 1.8799931870552513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026090145111083984, "StateBufferConnector_ms": 0.0018360614776611328, "ViewRequirementAgentConnector_ms": 0.04787135124206543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45240, "num_agent_steps_trained": 45240, "num_env_steps_sampled": 45240, "num_env_steps_trained": 45240, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.14976154731488, "num_env_steps_trained_throughput_per_sec": 66.14976154731488, "timesteps_total": 45240, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 45240, "timers": {"training_iteration_time_ms": 1816.687, "sample_time_ms": 1814.095, "load_time_ms": 0.153, "load_throughput": 783128.178, "learn_time_ms": 1.883, "learn_throughput": 63741.607, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 45240, "num_env_steps_trained": 45240, "num_agent_steps_sampled": 45240, "num_agent_steps_trained": 45240}, "done": false, "episodes_total": 377, "training_iteration": 63, "trial_id": "487fa_00000", "date": "2023-07-24_21-07-07", "timestamp": 1690222027, "time_this_iter_s": 10.886482000350952, "time_total_s": 690.3712759017944, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 690.3712759017944, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 25.16875, "ram_util_percent": 77.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3999999999999998e-07, "entropy_coeff": 0.1, "policy_entropy": 242.308837890625, "policy_loss": -75605.6640625, "vf_loss": 2894578.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 382.0}}, "num_env_steps_sampled": 45960, "num_env_steps_trained": 45960, "num_agent_steps_sampled": 45960, "num_agent_steps_trained": 45960}, "sampler_results": {"episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -710.3254917401406, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004817864400803, "mean_inference_ms": 0.2657927037105823, "mean_action_processing_ms": 0.0615700776345543, "mean_env_wait_ms": 1.879061404800447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025632381439208984, "StateBufferConnector_ms": 0.001804351806640625, "ViewRequirementAgentConnector_ms": 0.04745817184448242}}, "episode_reward_max": -485.8593722471118, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -710.3254917401406, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-708.7129512848567, -626.8701932718456, -689.2151008188005, -920.3691142478879, -675.5915173868926, -787.5080658131402, -494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004817864400803, "mean_inference_ms": 0.2657927037105823, "mean_action_processing_ms": 0.0615700776345543, "mean_env_wait_ms": 1.879061404800447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025632381439208984, "StateBufferConnector_ms": 0.001804351806640625, "ViewRequirementAgentConnector_ms": 0.04745817184448242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45960, "num_agent_steps_trained": 45960, "num_env_steps_sampled": 45960, "num_env_steps_trained": 45960, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.57833274926128, "num_env_steps_trained_throughput_per_sec": 65.57833274926128, "timesteps_total": 45960, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 45960, "timers": {"training_iteration_time_ms": 1819.556, "sample_time_ms": 1816.959, "load_time_ms": 0.151, "load_throughput": 796512.866, "learn_time_ms": 1.886, "learn_throughput": 63610.298, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 45960, "num_env_steps_trained": 45960, "num_agent_steps_sampled": 45960, "num_agent_steps_trained": 45960}, "done": false, "episodes_total": 383, "training_iteration": 64, "trial_id": "487fa_00000", "date": "2023-07-24_21-07-18", "timestamp": 1690222038, "time_this_iter_s": 10.981362104415894, "time_total_s": 701.3526380062103, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 701.3526380062103, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.60625, "ram_util_percent": 77.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.3109893798828, "policy_loss": -72113.09375, "vf_loss": 3251432.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 389.0, "diff_num_grad_updates_vs_sampler_policy": 388.0}}, "num_env_steps_sampled": 46680, "num_env_steps_trained": 46680, "num_agent_steps_sampled": 46680, "num_agent_steps_trained": 46680}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -706.0598400209246, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004425409393239, "mean_inference_ms": 0.26577705799911994, "mean_action_processing_ms": 0.06156325751144691, "mean_env_wait_ms": 1.8781651608275738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024840831756591797, "StateBufferConnector_ms": 0.0017771720886230469, "ViewRequirementAgentConnector_ms": 0.04664874076843262}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -706.0598400209246, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-494.8796007543988, -596.3594442214364, -579.6502861135845, -895.2222684387024, -862.2419770784555, -672.4584287870001, -702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004425409393239, "mean_inference_ms": 0.26577705799911994, "mean_action_processing_ms": 0.06156325751144691, "mean_env_wait_ms": 1.8781651608275738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024840831756591797, "StateBufferConnector_ms": 0.0017771720886230469, "ViewRequirementAgentConnector_ms": 0.04664874076843262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46680, "num_agent_steps_trained": 46680, "num_env_steps_sampled": 46680, "num_env_steps_trained": 46680, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.75190396782699, "num_env_steps_trained_throughput_per_sec": 65.75190396782699, "timesteps_total": 46680, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 46680, "timers": {"training_iteration_time_ms": 1830.084, "sample_time_ms": 1827.51, "load_time_ms": 0.149, "load_throughput": 802865.656, "learn_time_ms": 1.878, "learn_throughput": 63891.298, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 46680, "num_env_steps_trained": 46680, "num_agent_steps_sampled": 46680, "num_agent_steps_trained": 46680}, "done": false, "episodes_total": 389, "training_iteration": 65, "trial_id": "487fa_00000", "date": "2023-07-24_21-07-29", "timestamp": 1690222049, "time_this_iter_s": 10.952252864837646, "time_total_s": 712.304890871048, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 712.304890871048, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 25.28666666666667, "ram_util_percent": 77.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.31195068359375, "policy_loss": -72116.421875, "vf_loss": 3067656.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 395.0, "diff_num_grad_updates_vs_sampler_policy": 394.0}}, "num_env_steps_sampled": 47400, "num_env_steps_trained": 47400, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47400}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -705.2872892441113, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004083715717792, "mean_inference_ms": 0.2657656403010727, "mean_action_processing_ms": 0.0615575122015439, "mean_env_wait_ms": 1.8773283934823946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002483367919921875, "StateBufferConnector_ms": 0.0017862319946289062, "ViewRequirementAgentConnector_ms": 0.046633243560791016}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -705.2872892441113, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-702.1338367459111, -833.2570204861972, -590.6683194532529, -601.8915847105375, -718.8514669799014, -774.1147018737018, -584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004083715717792, "mean_inference_ms": 0.2657656403010727, "mean_action_processing_ms": 0.0615575122015439, "mean_env_wait_ms": 1.8773283934823946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002483367919921875, "StateBufferConnector_ms": 0.0017862319946289062, "ViewRequirementAgentConnector_ms": 0.046633243560791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47400, "num_env_steps_sampled": 47400, "num_env_steps_trained": 47400, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.54435377581869, "num_env_steps_trained_throughput_per_sec": 65.54435377581869, "timesteps_total": 47400, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 47400, "timers": {"training_iteration_time_ms": 1830.618, "sample_time_ms": 1828.04, "load_time_ms": 0.15, "load_throughput": 801204.202, "learn_time_ms": 1.878, "learn_throughput": 63891.298, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 47400, "num_env_steps_trained": 47400, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47400}, "done": false, "episodes_total": 395, "training_iteration": 66, "trial_id": "487fa_00000", "date": "2023-07-24_21-07-40", "timestamp": 1690222060, "time_this_iter_s": 10.987364053726196, "time_total_s": 723.2922549247742, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 723.2922549247742, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 25.45, "ram_util_percent": 77.96875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.3075408935547, "policy_loss": -67602.8515625, "vf_loss": 2594370.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 400.0}}, "num_env_steps_sampled": 48120, "num_env_steps_trained": 48120, "num_agent_steps_sampled": 48120, "num_agent_steps_trained": 48120}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -704.5580029832744, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.003698192098286, "mean_inference_ms": 0.2657405796011803, "mean_action_processing_ms": 0.06154985632164292, "mean_env_wait_ms": 1.8764717321172126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024878978729248047, "StateBufferConnector_ms": 0.0017795562744140625, "ViewRequirementAgentConnector_ms": 0.046722412109375}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -704.5580029832744, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-584.0730036565768, -736.1153686582719, -613.0325037038564, -916.4760802095606, -806.430993253037, -716.1654695519408, -740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.003698192098286, "mean_inference_ms": 0.2657405796011803, "mean_action_processing_ms": 0.06154985632164292, "mean_env_wait_ms": 1.8764717321172126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024878978729248047, "StateBufferConnector_ms": 0.0017795562744140625, "ViewRequirementAgentConnector_ms": 0.046722412109375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48120, "num_agent_steps_trained": 48120, "num_env_steps_sampled": 48120, "num_env_steps_trained": 48120, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.12614571489213, "num_env_steps_trained_throughput_per_sec": 66.12614571489213, "timesteps_total": 48120, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 48120, "timers": {"training_iteration_time_ms": 1820.769, "sample_time_ms": 1818.214, "load_time_ms": 0.148, "load_throughput": 813506.514, "learn_time_ms": 1.859, "learn_throughput": 64554.238, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 48120, "num_env_steps_trained": 48120, "num_agent_steps_sampled": 48120, "num_agent_steps_trained": 48120}, "done": false, "episodes_total": 401, "training_iteration": 67, "trial_id": "487fa_00000", "date": "2023-07-24_21-07-51", "timestamp": 1690222071, "time_this_iter_s": 10.890431880950928, "time_total_s": 734.1826868057251, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 734.1826868057251, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 23.566666666666666, "ram_util_percent": 77.91333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.2971954345703, "policy_loss": -72252.7734375, "vf_loss": 2855418.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 407.0, "diff_num_grad_updates_vs_sampler_policy": 406.0}}, "num_env_steps_sampled": 48840, "num_env_steps_trained": 48840, "num_agent_steps_sampled": 48840, "num_agent_steps_trained": 48840}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -699.0531416619165, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.003340170358648, "mean_inference_ms": 0.2657047933754899, "mean_action_processing_ms": 0.06153999955788507, "mean_env_wait_ms": 1.8756155031286568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002488851547241211, "StateBufferConnector_ms": 0.0017728805541992188, "ViewRequirementAgentConnector_ms": 0.04676508903503418}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -699.0531416619165, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-740.5661160618552, -740.034777845593, -671.2956810863527, -789.8403255812974, -607.2830623024322, -800.5358218594191, -816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.003340170358648, "mean_inference_ms": 0.2657047933754899, "mean_action_processing_ms": 0.06153999955788507, "mean_env_wait_ms": 1.8756155031286568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002488851547241211, "StateBufferConnector_ms": 0.0017728805541992188, "ViewRequirementAgentConnector_ms": 0.04676508903503418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48840, "num_agent_steps_trained": 48840, "num_env_steps_sampled": 48840, "num_env_steps_trained": 48840, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.56821636255783, "num_env_steps_trained_throughput_per_sec": 65.56821636255783, "timesteps_total": 48840, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 48840, "timers": {"training_iteration_time_ms": 1825.252, "sample_time_ms": 1822.725, "load_time_ms": 0.146, "load_throughput": 824568.283, "learn_time_ms": 1.839, "learn_throughput": 65242.917, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 48840, "num_env_steps_trained": 48840, "num_agent_steps_sampled": 48840, "num_agent_steps_trained": 48840}, "done": false, "episodes_total": 407, "training_iteration": 68, "trial_id": "487fa_00000", "date": "2023-07-24_21-08-02", "timestamp": 1690222082, "time_this_iter_s": 10.982910871505737, "time_total_s": 745.1655976772308, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 745.1655976772308, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 24.9375, "ram_util_percent": 77.85624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.3000946044922, "policy_loss": -80935.125, "vf_loss": 3828319.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 412.0}}, "num_env_steps_sampled": 49560, "num_env_steps_trained": 49560, "num_agent_steps_sampled": 49560, "num_agent_steps_trained": 49560}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -697.1947654302218, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00309391286305, "mean_inference_ms": 0.2656603784645941, "mean_action_processing_ms": 0.061527244811747345, "mean_env_wait_ms": 1.8747654280938573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025000572204589844, "StateBufferConnector_ms": 0.0017778873443603516, "ViewRequirementAgentConnector_ms": 0.04687356948852539}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -1030.241895142363, "episode_reward_mean": -697.1947654302218, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-816.1341385661856, -575.3093946359861, -769.6453230687166, -752.8913096562899, -1030.241895142363, -802.606186218383, -688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00309391286305, "mean_inference_ms": 0.2656603784645941, "mean_action_processing_ms": 0.061527244811747345, "mean_env_wait_ms": 1.8747654280938573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025000572204589844, "StateBufferConnector_ms": 0.0017778873443603516, "ViewRequirementAgentConnector_ms": 0.04687356948852539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49560, "num_agent_steps_trained": 49560, "num_env_steps_sampled": 49560, "num_env_steps_trained": 49560, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.54229393773166, "num_env_steps_trained_throughput_per_sec": 65.54229393773166, "timesteps_total": 49560, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 49560, "timers": {"training_iteration_time_ms": 1821.792, "sample_time_ms": 1819.194, "load_time_ms": 0.148, "load_throughput": 809450.756, "learn_time_ms": 1.886, "learn_throughput": 63640.861, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 49560, "num_env_steps_trained": 49560, "num_agent_steps_sampled": 49560, "num_agent_steps_trained": 49560}, "done": false, "episodes_total": 413, "training_iteration": 69, "trial_id": "487fa_00000", "date": "2023-07-24_21-08-13", "timestamp": 1690222093, "time_this_iter_s": 10.987553119659424, "time_total_s": 756.1531507968903, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 756.1531507968903, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 25.386666666666663, "ram_util_percent": 78.05333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.3010711669922, "policy_loss": -73015.609375, "vf_loss": 3082614.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 418.0}}, "num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -967.7694432895312, "episode_reward_mean": -691.0207747617034, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00290760903068, "mean_inference_ms": 0.2656096771594951, "mean_action_processing_ms": 0.061513745564754904, "mean_env_wait_ms": 1.8739272073715996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024957656860351562, "StateBufferConnector_ms": 0.0017757415771484375, "ViewRequirementAgentConnector_ms": 0.046623945236206055}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -967.7694432895312, "episode_reward_mean": -691.0207747617034, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-688.8200319464034, -833.9100986349641, -485.8593722471118, -671.5114998766745, -652.5615500752688, -893.8769914705243, -545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00290760903068, "mean_inference_ms": 0.2656096771594951, "mean_action_processing_ms": 0.061513745564754904, "mean_env_wait_ms": 1.8739272073715996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024957656860351562, "StateBufferConnector_ms": 0.0017757415771484375, "ViewRequirementAgentConnector_ms": 0.046623945236206055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280, "num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.98574843651147, "num_env_steps_trained_throughput_per_sec": 65.98574843651147, "timesteps_total": 50280, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 50280, "timers": {"training_iteration_time_ms": 1827.14, "sample_time_ms": 1824.27, "load_time_ms": 0.157, "load_throughput": 766432.892, "learn_time_ms": 2.071, "learn_throughput": 57942.38, "synch_weights_time_ms": 0.61}, "counters": {"num_env_steps_sampled": 50280, "num_env_steps_trained": 50280, "num_agent_steps_sampled": 50280, "num_agent_steps_trained": 50280}, "done": false, "episodes_total": 419, "training_iteration": 70, "trial_id": "487fa_00000", "date": "2023-07-24_21-08-24", "timestamp": 1690222104, "time_this_iter_s": 10.91354513168335, "time_total_s": 767.0666959285736, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 767.0666959285736, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 25.331249999999997, "ram_util_percent": 77.89375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.30657958984375, "policy_loss": -93047.546875, "vf_loss": 4843867.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 425.0, "diff_num_grad_updates_vs_sampler_policy": 424.0}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 51000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 51000}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -967.7694432895312, "episode_reward_mean": -689.3723566504053, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.003396477756173, "mean_inference_ms": 0.2656184756255562, "mean_action_processing_ms": 0.06150825098123699, "mean_env_wait_ms": 1.873335155811966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002663135528564453, "StateBufferConnector_ms": 0.0018122196197509766, "ViewRequirementAgentConnector_ms": 0.04796314239501953}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -967.7694432895312, "episode_reward_mean": -689.3723566504053, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-545.0272980221242, -644.2898685924141, -967.7694432895312, -590.9097347978832, -552.413298994796, -783.7298498485281, -724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.003396477756173, "mean_inference_ms": 0.2656184756255562, "mean_action_processing_ms": 0.06150825098123699, "mean_env_wait_ms": 1.873335155811966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002663135528564453, "StateBufferConnector_ms": 0.0018122196197509766, "ViewRequirementAgentConnector_ms": 0.04796314239501953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 51000, "num_env_steps_sampled": 51000, "num_env_steps_trained": 51000, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 61.155373445945884, "num_env_steps_trained_throughput_per_sec": 61.155373445945884, "timesteps_total": 51000, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 1903.452, "sample_time_ms": 1900.369, "load_time_ms": 0.159, "load_throughput": 754145.16, "learn_time_ms": 2.273, "learn_throughput": 52785.653, "synch_weights_time_ms": 0.616}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 51000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 51000}, "done": false, "episodes_total": 425, "training_iteration": 71, "trial_id": "487fa_00000", "date": "2023-07-24_21-08-36", "timestamp": 1690222116, "time_this_iter_s": 11.775603294372559, "time_total_s": 778.8422992229462, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 778.8422992229462, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 30.46470588235294, "ram_util_percent": 78.48823529411766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.30130004882812, "policy_loss": -112590.2890625, "vf_loss": 5817155.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 431.0, "diff_num_grad_updates_vs_sampler_policy": 430.0}}, "num_env_steps_sampled": 51720, "num_env_steps_trained": 51720, "num_agent_steps_sampled": 51720, "num_agent_steps_trained": 51720}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -691.1283942464206, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004168050711446, "mean_inference_ms": 0.2656456039228557, "mean_action_processing_ms": 0.0615059883801558, "mean_env_wait_ms": 1.872836597709466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026760101318359375, "StateBufferConnector_ms": 0.0017995834350585938, "ViewRequirementAgentConnector_ms": 0.04826211929321289}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -691.1283942464206, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-724.0993067448157, -819.9015151002005, -816.6181231200611, -685.3602384033509, -841.3895445724302, -538.6778766952718, -846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.004168050711446, "mean_inference_ms": 0.2656456039228557, "mean_action_processing_ms": 0.0615059883801558, "mean_env_wait_ms": 1.872836597709466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026760101318359375, "StateBufferConnector_ms": 0.0017995834350585938, "ViewRequirementAgentConnector_ms": 0.04826211929321289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51720, "num_agent_steps_trained": 51720, "num_env_steps_sampled": 51720, "num_env_steps_trained": 51720, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 63.41919179403781, "num_env_steps_trained_throughput_per_sec": 63.41919179403781, "timesteps_total": 51720, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 51720, "timers": {"training_iteration_time_ms": 1944.978, "sample_time_ms": 1942.019, "load_time_ms": 0.156, "load_throughput": 770185.891, "learn_time_ms": 2.185, "learn_throughput": 54909.449, "synch_weights_time_ms": 0.585}, "counters": {"num_env_steps_sampled": 51720, "num_env_steps_trained": 51720, "num_agent_steps_sampled": 51720, "num_agent_steps_trained": 51720}, "done": false, "episodes_total": 431, "training_iteration": 72, "trial_id": "487fa_00000", "date": "2023-07-24_21-08-47", "timestamp": 1690222127, "time_this_iter_s": 11.355091094970703, "time_total_s": 790.1973903179169, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 790.1973903179169, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 33.04375, "ram_util_percent": 78.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.28392028808594, "policy_loss": -89861.6796875, "vf_loss": 4805341.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 437.0, "diff_num_grad_updates_vs_sampler_policy": 436.0}}, "num_env_steps_sampled": 52440, "num_env_steps_trained": 52440, "num_agent_steps_sampled": 52440, "num_agent_steps_trained": 52440}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -692.815897563648, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0052429454091, "mean_inference_ms": 0.2656926974075422, "mean_action_processing_ms": 0.061506694227742686, "mean_env_wait_ms": 1.8723697864850462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026884078979492188, "StateBufferConnector_ms": 0.0017995834350585938, "ViewRequirementAgentConnector_ms": 0.04827713966369629}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -692.815897563648, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-846.443913203525, -566.9708434046587, -721.2317998608916, -861.6572414332238, -588.5104487168932, -518.1527762791015, -593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.0052429454091, "mean_inference_ms": 0.2656926974075422, "mean_action_processing_ms": 0.061506694227742686, "mean_env_wait_ms": 1.8723697864850462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026884078979492188, "StateBufferConnector_ms": 0.0017995834350585938, "ViewRequirementAgentConnector_ms": 0.04827713966369629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52440, "num_agent_steps_trained": 52440, "num_env_steps_sampled": 52440, "num_env_steps_trained": 52440, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 63.515851332091884, "num_env_steps_trained_throughput_per_sec": 63.515851332091884, "timesteps_total": 52440, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 52440, "timers": {"training_iteration_time_ms": 1893.306, "sample_time_ms": 1890.399, "load_time_ms": 0.169, "load_throughput": 710297.036, "learn_time_ms": 2.068, "learn_throughput": 58037.923, "synch_weights_time_ms": 0.629}, "counters": {"num_env_steps_sampled": 52440, "num_env_steps_trained": 52440, "num_agent_steps_sampled": 52440, "num_agent_steps_trained": 52440}, "done": false, "episodes_total": 437, "training_iteration": 73, "trial_id": "487fa_00000", "date": "2023-07-24_21-08-59", "timestamp": 1690222139, "time_this_iter_s": 11.33810305595398, "time_total_s": 801.5354933738708, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 801.5354933738708, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 37.712500000000006, "ram_util_percent": 78.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.29647827148438, "policy_loss": -89911.578125, "vf_loss": 3862691.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 442.0}}, "num_env_steps_sampled": 53160, "num_env_steps_trained": 53160, "num_agent_steps_sampled": 53160, "num_agent_steps_trained": 53160}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -695.9690426828769, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.006321678703353, "mean_inference_ms": 0.26573620715826735, "mean_action_processing_ms": 0.06150702449143779, "mean_env_wait_ms": 1.8718974764823997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026705265045166016, "StateBufferConnector_ms": 0.0017862319946289062, "ViewRequirementAgentConnector_ms": 0.047902584075927734}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -695.9690426828769, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-593.7915635379237, -825.914817681628, -773.0806089141992, -831.0981378170368, -565.0385800334993, -701.211686015851, -702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.006321678703353, "mean_inference_ms": 0.26573620715826735, "mean_action_processing_ms": 0.06150702449143779, "mean_env_wait_ms": 1.8718974764823997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026705265045166016, "StateBufferConnector_ms": 0.0017862319946289062, "ViewRequirementAgentConnector_ms": 0.047902584075927734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53160, "num_agent_steps_trained": 53160, "num_env_steps_sampled": 53160, "num_env_steps_trained": 53160, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.7953934841163, "num_env_steps_trained_throughput_per_sec": 65.7953934841163, "timesteps_total": 53160, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 53160, "timers": {"training_iteration_time_ms": 1857.523, "sample_time_ms": 1854.58, "load_time_ms": 0.171, "load_throughput": 702955.978, "learn_time_ms": 2.119, "learn_throughput": 56624.944, "synch_weights_time_ms": 0.613}, "counters": {"num_env_steps_sampled": 53160, "num_env_steps_trained": 53160, "num_agent_steps_sampled": 53160, "num_agent_steps_trained": 53160}, "done": false, "episodes_total": 443, "training_iteration": 74, "trial_id": "487fa_00000", "date": "2023-07-24_21-09-10", "timestamp": 1690222150, "time_this_iter_s": 10.945172309875488, "time_total_s": 812.4806656837463, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 812.4806656837463, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 28.10666666666667, "ram_util_percent": 78.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.31015014648438, "policy_loss": -79902.515625, "vf_loss": 3724726.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 449.0, "diff_num_grad_updates_vs_sampler_policy": 448.0}}, "num_env_steps_sampled": 53880, "num_env_steps_trained": 53880, "num_agent_steps_sampled": 53880, "num_agent_steps_trained": 53880}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -690.0315719024073, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.007395041248563, "mean_inference_ms": 0.26577843341968566, "mean_action_processing_ms": 0.061507408420709224, "mean_env_wait_ms": 1.871475817305655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026814937591552734, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.04793405532836914}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -690.0315719024073, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-702.4084474701352, -759.5338410147929, -829.3327338243897, -819.2093001039543, -705.2062078906578, -572.8843324227837, -815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.007395041248563, "mean_inference_ms": 0.26577843341968566, "mean_action_processing_ms": 0.061507408420709224, "mean_env_wait_ms": 1.871475817305655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026814937591552734, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.04793405532836914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53880, "num_agent_steps_trained": 53880, "num_env_steps_sampled": 53880, "num_env_steps_trained": 53880, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.12679005959318, "num_env_steps_trained_throughput_per_sec": 66.12679005959318, "timesteps_total": 53880, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 53880, "timers": {"training_iteration_time_ms": 1809.61, "sample_time_ms": 1807.009, "load_time_ms": 0.149, "load_throughput": 806080.205, "learn_time_ms": 1.915, "learn_throughput": 62653.764, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 53880, "num_env_steps_trained": 53880, "num_agent_steps_sampled": 53880, "num_agent_steps_trained": 53880}, "done": false, "episodes_total": 449, "training_iteration": 75, "trial_id": "487fa_00000", "date": "2023-07-24_21-09-21", "timestamp": 1690222161, "time_this_iter_s": 10.890229940414429, "time_total_s": 823.3708956241608, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 823.3708956241608, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 24.56875, "ram_util_percent": 78.26249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.31236267089844, "policy_loss": -69480.296875, "vf_loss": 2653409.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 454.0}}, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -683.9432154766291, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00852459655065, "mean_inference_ms": 0.2658203482787666, "mean_action_processing_ms": 0.06150787250225145, "mean_env_wait_ms": 1.8710676316548427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002698183059692383, "StateBufferConnector_ms": 0.0018019676208496094, "ViewRequirementAgentConnector_ms": 0.04812479019165039}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -880.1927265177101, "episode_reward_mean": -683.9432154766291, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-815.9744484836051, -688.5719124735449, -732.4847866955171, -828.9301177895078, -509.4417163054911, -820.3531446317579, -842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.00852459655065, "mean_inference_ms": 0.2658203482787666, "mean_action_processing_ms": 0.06150787250225145, "mean_env_wait_ms": 1.8710676316548427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002698183059692383, "StateBufferConnector_ms": 0.0018019676208496094, "ViewRequirementAgentConnector_ms": 0.04812479019165039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600, "num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.63885985395082, "num_env_steps_trained_throughput_per_sec": 65.63885985395082, "timesteps_total": 54600, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 54600, "timers": {"training_iteration_time_ms": 1827.837, "sample_time_ms": 1825.237, "load_time_ms": 0.155, "load_throughput": 773618.936, "learn_time_ms": 1.901, "learn_throughput": 63123.657, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 54600, "num_env_steps_trained": 54600, "num_agent_steps_sampled": 54600, "num_agent_steps_trained": 54600}, "done": false, "episodes_total": 455, "training_iteration": 76, "trial_id": "487fa_00000", "date": "2023-07-24_21-09-32", "timestamp": 1690222172, "time_this_iter_s": 10.971164226531982, "time_total_s": 834.3420598506927, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 834.3420598506927, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 23.973333333333336, "ram_util_percent": 78.20666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.30215454101562, "policy_loss": -82499.953125, "vf_loss": 3833223.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 461.0, "diff_num_grad_updates_vs_sampler_policy": 460.0}}, "num_env_steps_sampled": 55320, "num_env_steps_trained": 55320, "num_agent_steps_sampled": 55320, "num_agent_steps_trained": 55320}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -680.7951632666633, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.009670391287402, "mean_inference_ms": 0.26586632824936784, "mean_action_processing_ms": 0.06150911932958042, "mean_env_wait_ms": 1.870689364675302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027158260345458984, "StateBufferConnector_ms": 0.001802206039428711, "ViewRequirementAgentConnector_ms": 0.0482943058013916}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -680.7951632666633, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-842.9052302160708, -567.8438534009189, -525.1282031967822, -808.8201640788634, -785.845748662715, -659.7260171113835, -792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.009670391287402, "mean_inference_ms": 0.26586632824936784, "mean_action_processing_ms": 0.06150911932958042, "mean_env_wait_ms": 1.870689364675302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027158260345458984, "StateBufferConnector_ms": 0.001802206039428711, "ViewRequirementAgentConnector_ms": 0.0482943058013916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55320, "num_agent_steps_trained": 55320, "num_env_steps_sampled": 55320, "num_env_steps_trained": 55320, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.99254438469539, "num_env_steps_trained_throughput_per_sec": 65.99254438469539, "timesteps_total": 55320, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 55320, "timers": {"training_iteration_time_ms": 1819.306, "sample_time_ms": 1816.752, "load_time_ms": 0.153, "load_throughput": 785818.08, "learn_time_ms": 1.872, "learn_throughput": 64117.566, "synch_weights_time_ms": 0.5}, "counters": {"num_env_steps_sampled": 55320, "num_env_steps_trained": 55320, "num_agent_steps_sampled": 55320, "num_agent_steps_trained": 55320}, "done": false, "episodes_total": 461, "training_iteration": 77, "trial_id": "487fa_00000", "date": "2023-07-24_21-09-43", "timestamp": 1690222183, "time_this_iter_s": 10.91235899925232, "time_total_s": 845.2544188499451, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 845.2544188499451, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 23.1125, "ram_util_percent": 78.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.29730224609375, "policy_loss": -104854.1953125, "vf_loss": 6357624.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 467.0, "diff_num_grad_updates_vs_sampler_policy": 466.0}}, "num_env_steps_sampled": 56040, "num_env_steps_trained": 56040, "num_agent_steps_sampled": 56040, "num_agent_steps_trained": 56040}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -679.7481981996883, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.010865388288549, "mean_inference_ms": 0.26591658693819786, "mean_action_processing_ms": 0.06151104734018707, "mean_env_wait_ms": 1.8703101327719776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00270843505859375, "StateBufferConnector_ms": 0.0018014907836914062, "ViewRequirementAgentConnector_ms": 0.04832911491394043}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -679.7481981996883, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-792.8260138463681, -741.8411692361602, -731.1463209600174, -638.0982328106899, -579.8434871351299, -793.7430463031902, -635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.010865388288549, "mean_inference_ms": 0.26591658693819786, "mean_action_processing_ms": 0.06151104734018707, "mean_env_wait_ms": 1.8703101327719776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00270843505859375, "StateBufferConnector_ms": 0.0018014907836914062, "ViewRequirementAgentConnector_ms": 0.04832911491394043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56040, "num_agent_steps_trained": 56040, "num_env_steps_sampled": 56040, "num_env_steps_trained": 56040, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.94487540062853, "num_env_steps_trained_throughput_per_sec": 65.94487540062853, "timesteps_total": 56040, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 56040, "timers": {"training_iteration_time_ms": 1817.696, "sample_time_ms": 1815.169, "load_time_ms": 0.147, "load_throughput": 818400.78, "learn_time_ms": 1.842, "learn_throughput": 65128.944, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 56040, "num_env_steps_trained": 56040, "num_agent_steps_sampled": 56040, "num_agent_steps_trained": 56040}, "done": false, "episodes_total": 467, "training_iteration": 78, "trial_id": "487fa_00000", "date": "2023-07-24_21-09-53", "timestamp": 1690222193, "time_this_iter_s": 10.920314073562622, "time_total_s": 856.1747329235077, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 856.1747329235077, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 29.218749999999996, "ram_util_percent": 77.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.2874755859375, "policy_loss": -73163.9921875, "vf_loss": 3082044.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 56760, "num_env_steps_trained": 56760, "num_agent_steps_sampled": 56760, "num_agent_steps_trained": 56760}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -679.0573057142601, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.012234126694597, "mean_inference_ms": 0.2659671154210932, "mean_action_processing_ms": 0.06151275071164484, "mean_env_wait_ms": 1.8699546957701747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027303695678710938, "StateBufferConnector_ms": 0.001806020736694336, "ViewRequirementAgentConnector_ms": 0.04847550392150879}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -679.0573057142601, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-635.8648023221352, -640.9153902711574, -721.956268293659, -614.4382885249164, -807.6643187197944, -572.5108303902907, -662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.012234126694597, "mean_inference_ms": 0.2659671154210932, "mean_action_processing_ms": 0.06151275071164484, "mean_env_wait_ms": 1.8699546957701747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027303695678710938, "StateBufferConnector_ms": 0.001806020736694336, "ViewRequirementAgentConnector_ms": 0.04847550392150879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56760, "num_agent_steps_trained": 56760, "num_env_steps_sampled": 56760, "num_env_steps_trained": 56760, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.0169410326332, "num_env_steps_trained_throughput_per_sec": 65.0169410326332, "timesteps_total": 56760, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 56760, "timers": {"training_iteration_time_ms": 1835.895, "sample_time_ms": 1833.177, "load_time_ms": 0.148, "load_throughput": 809841.48, "learn_time_ms": 1.892, "learn_throughput": 63411.548, "synch_weights_time_ms": 0.647}, "counters": {"num_env_steps_sampled": 56760, "num_env_steps_trained": 56760, "num_agent_steps_sampled": 56760, "num_agent_steps_trained": 56760}, "done": false, "episodes_total": 473, "training_iteration": 79, "trial_id": "487fa_00000", "date": "2023-07-24_21-10-05", "timestamp": 1690222205, "time_this_iter_s": 11.082588911056519, "time_total_s": 867.2573218345642, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 867.2573218345642, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 31.206666666666667, "ram_util_percent": 78.01333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.2896728515625, "policy_loss": -86082.5, "vf_loss": 4621470.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 479.0, "diff_num_grad_updates_vs_sampler_policy": 478.0}}, "num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -680.2846892176433, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.013661089715875, "mean_inference_ms": 0.2660117447310784, "mean_action_processing_ms": 0.06151323619332467, "mean_env_wait_ms": 1.8695804650475676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027341842651367188, "StateBufferConnector_ms": 0.0018191337585449219, "ViewRequirementAgentConnector_ms": 0.048464059829711914}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -680.2846892176433, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-662.3077603870349, -532.4542997237377, -600.7184807713986, -663.1188696901153, -880.1927265177101, -714.01346993932, -674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.013661089715875, "mean_inference_ms": 0.2660117447310784, "mean_action_processing_ms": 0.06151323619332467, "mean_env_wait_ms": 1.8695804650475676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027341842651367188, "StateBufferConnector_ms": 0.0018191337585449219, "ViewRequirementAgentConnector_ms": 0.048464059829711914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480, "num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.80953946445847, "num_env_steps_trained_throughput_per_sec": 65.80953946445847, "timesteps_total": 57480, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 57480, "timers": {"training_iteration_time_ms": 1836.946, "sample_time_ms": 1834.176, "load_time_ms": 0.151, "load_throughput": 792999.023, "learn_time_ms": 1.941, "learn_throughput": 61830.213, "synch_weights_time_ms": 0.647}, "counters": {"num_env_steps_sampled": 57480, "num_env_steps_trained": 57480, "num_agent_steps_sampled": 57480, "num_agent_steps_trained": 57480}, "done": false, "episodes_total": 479, "training_iteration": 80, "trial_id": "487fa_00000", "date": "2023-07-24_21-10-16", "timestamp": 1690222216, "time_this_iter_s": 10.942790031433105, "time_total_s": 878.2001118659973, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 878.2001118659973, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 29.08125, "ram_util_percent": 78.01875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.29339599609375, "policy_loss": -83298.5078125, "vf_loss": 3730613.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 485.0, "diff_num_grad_updates_vs_sampler_policy": 484.0}}, "num_env_steps_sampled": 58200, "num_env_steps_trained": 58200, "num_agent_steps_sampled": 58200, "num_agent_steps_trained": 58200}, "sampler_results": {"episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -682.1660008963293, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.015119690408902, "mean_inference_ms": 0.26604958796556744, "mean_action_processing_ms": 0.06151341652348824, "mean_env_wait_ms": 1.8691908121735379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002736806869506836, "StateBufferConnector_ms": 0.0018236637115478516, "ViewRequirementAgentConnector_ms": 0.04855823516845703}}, "episode_reward_max": -408.6038517169194, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -682.1660008963293, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-674.7896509181702, -650.0500931100883, -408.6038517169194, -654.051978699601, -670.1845604894736, -648.315202334507, -783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.015119690408902, "mean_inference_ms": 0.26604958796556744, "mean_action_processing_ms": 0.06151341652348824, "mean_env_wait_ms": 1.8691908121735379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002736806869506836, "StateBufferConnector_ms": 0.0018236637115478516, "ViewRequirementAgentConnector_ms": 0.04855823516845703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58200, "num_agent_steps_trained": 58200, "num_env_steps_sampled": 58200, "num_env_steps_trained": 58200, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.52100751945996, "num_env_steps_trained_throughput_per_sec": 65.52100751945996, "timesteps_total": 58200, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 58200, "timers": {"training_iteration_time_ms": 1825.251, "sample_time_ms": 1822.648, "load_time_ms": 0.151, "load_throughput": 795505.737, "learn_time_ms": 1.898, "learn_throughput": 63216.418, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 58200, "num_env_steps_trained": 58200, "num_agent_steps_sampled": 58200, "num_agent_steps_trained": 58200}, "done": false, "episodes_total": 485, "training_iteration": 81, "trial_id": "487fa_00000", "date": "2023-07-24_21-10-27", "timestamp": 1690222227, "time_this_iter_s": 10.990915775299072, "time_total_s": 889.1910276412964, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 889.1910276412964, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 25.5125, "ram_util_percent": 78.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.29457092285156, "policy_loss": -96084.8671875, "vf_loss": 5258499.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 490.0}}, "num_env_steps_sampled": 58920, "num_env_steps_trained": 58920, "num_agent_steps_sampled": 58920, "num_agent_steps_trained": 58920}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -686.8834201065162, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.01668575253549, "mean_inference_ms": 0.26608078618455044, "mean_action_processing_ms": 0.061512792700626685, "mean_env_wait_ms": 1.868790171265297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002750396728515625, "StateBufferConnector_ms": 0.0018229484558105469, "ViewRequirementAgentConnector_ms": 0.04861760139465332}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -686.8834201065162, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-783.9585022866813, -680.0720945122878, -647.450013915368, -593.5765541739227, -752.6055746064187, -783.46368901711, -570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.01668575253549, "mean_inference_ms": 0.26608078618455044, "mean_action_processing_ms": 0.061512792700626685, "mean_env_wait_ms": 1.868790171265297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002750396728515625, "StateBufferConnector_ms": 0.0018229484558105469, "ViewRequirementAgentConnector_ms": 0.04861760139465332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58920, "num_agent_steps_trained": 58920, "num_env_steps_sampled": 58920, "num_env_steps_trained": 58920, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.10337619736555, "num_env_steps_trained_throughput_per_sec": 65.10337619736555, "timesteps_total": 58920, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 58920, "timers": {"training_iteration_time_ms": 1836.132, "sample_time_ms": 1833.434, "load_time_ms": 0.163, "load_throughput": 734232.648, "learn_time_ms": 1.957, "learn_throughput": 61326.211, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 58920, "num_env_steps_trained": 58920, "num_agent_steps_sampled": 58920, "num_agent_steps_trained": 58920}, "done": false, "episodes_total": 491, "training_iteration": 82, "trial_id": "487fa_00000", "date": "2023-07-24_21-10-38", "timestamp": 1690222238, "time_this_iter_s": 11.061676025390625, "time_total_s": 900.252703666687, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 900.252703666687, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 28.393333333333327, "ram_util_percent": 78.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.29429626464844, "policy_loss": -88555.3359375, "vf_loss": 4203541.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 497.0, "diff_num_grad_updates_vs_sampler_policy": 496.0}}, "num_env_steps_sampled": 59640, "num_env_steps_trained": 59640, "num_agent_steps_sampled": 59640, "num_agent_steps_trained": 59640}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -683.7267788399805, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.018258576146186, "mean_inference_ms": 0.26611963765747715, "mean_action_processing_ms": 0.06151433609567354, "mean_env_wait_ms": 1.8684118228350466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00275421142578125, "StateBufferConnector_ms": 0.0018236637115478516, "ViewRequirementAgentConnector_ms": 0.04864668846130371}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -683.7267788399805, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-570.1887742358676, -691.2749793302261, -798.4021320080395, -552.053154968175, -552.5717416107826, -645.11996781771, -747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.018258576146186, "mean_inference_ms": 0.26611963765747715, "mean_action_processing_ms": 0.06151433609567354, "mean_env_wait_ms": 1.8684118228350466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00275421142578125, "StateBufferConnector_ms": 0.0018236637115478516, "ViewRequirementAgentConnector_ms": 0.04864668846130371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59640, "num_agent_steps_trained": 59640, "num_env_steps_sampled": 59640, "num_env_steps_trained": 59640, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.45608193086996, "num_env_steps_trained_throughput_per_sec": 65.45608193086996, "timesteps_total": 59640, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 59640, "timers": {"training_iteration_time_ms": 1842.683, "sample_time_ms": 1839.929, "load_time_ms": 0.166, "load_throughput": 722844.291, "learn_time_ms": 2.01, "learn_throughput": 59706.812, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 59640, "num_env_steps_trained": 59640, "num_agent_steps_sampled": 59640, "num_agent_steps_trained": 59640}, "done": false, "episodes_total": 497, "training_iteration": 83, "trial_id": "487fa_00000", "date": "2023-07-24_21-10-49", "timestamp": 1690222249, "time_this_iter_s": 11.00191593170166, "time_total_s": 911.2546195983887, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 911.2546195983887, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 34.44375, "ram_util_percent": 78.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.28225708007812, "policy_loss": -51813.02734375, "vf_loss": 1687233.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 503.0, "diff_num_grad_updates_vs_sampler_policy": 502.0}}, "num_env_steps_sampled": 60360, "num_env_steps_trained": 60360, "num_agent_steps_sampled": 60360, "num_agent_steps_trained": 60360}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -684.4100360719508, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.019821701212331, "mean_inference_ms": 0.2661767060194847, "mean_action_processing_ms": 0.06151693573348277, "mean_env_wait_ms": 1.8680675610271846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002751588821411133, "StateBufferConnector_ms": 0.0018236637115478516, "ViewRequirementAgentConnector_ms": 0.04839372634887695}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -684.4100360719508, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-747.190341203025, -616.5097225589134, -643.4990959714886, -616.9164177355115, -609.1947825396435, -796.0058547526977, -668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.019821701212331, "mean_inference_ms": 0.2661767060194847, "mean_action_processing_ms": 0.06151693573348277, "mean_env_wait_ms": 1.8680675610271846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002751588821411133, "StateBufferConnector_ms": 0.0018236637115478516, "ViewRequirementAgentConnector_ms": 0.04839372634887695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60360, "num_agent_steps_trained": 60360, "num_env_steps_sampled": 60360, "num_env_steps_trained": 60360, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.67444223731785, "num_env_steps_trained_throughput_per_sec": 65.67444223731785, "timesteps_total": 60360, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 60360, "timers": {"training_iteration_time_ms": 1827.667, "sample_time_ms": 1824.985, "load_time_ms": 0.161, "load_throughput": 743670.922, "learn_time_ms": 1.967, "learn_throughput": 60993.272, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 60360, "num_env_steps_trained": 60360, "num_agent_steps_sampled": 60360, "num_agent_steps_trained": 60360}, "done": false, "episodes_total": 503, "training_iteration": 84, "trial_id": "487fa_00000", "date": "2023-07-24_21-11-00", "timestamp": 1690222260, "time_this_iter_s": 10.965415954589844, "time_total_s": 922.2200355529785, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 922.2200355529785, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 33.03125, "ram_util_percent": 78.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.30746459960938, "policy_loss": -76489.9609375, "vf_loss": 3201791.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 509.0, "diff_num_grad_updates_vs_sampler_policy": 508.0}}, "num_env_steps_sampled": 61080, "num_env_steps_trained": 61080, "num_agent_steps_sampled": 61080, "num_agent_steps_trained": 61080}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -683.6944453595478, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.021324803771346, "mean_inference_ms": 0.26623962839288445, "mean_action_processing_ms": 0.06152103527602252, "mean_env_wait_ms": 1.867716355543713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027458667755126953, "StateBufferConnector_ms": 0.0018246173858642578, "ViewRequirementAgentConnector_ms": 0.04830312728881836}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -683.6944453595478, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-668.4714576611317, -660.2191384922588, -673.8814557013867, -755.9454724203563, -728.40742498573, -616.9881333457579, -722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.021324803771346, "mean_inference_ms": 0.26623962839288445, "mean_action_processing_ms": 0.06152103527602252, "mean_env_wait_ms": 1.867716355543713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027458667755126953, "StateBufferConnector_ms": 0.0018246173858642578, "ViewRequirementAgentConnector_ms": 0.04830312728881836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61080, "num_agent_steps_trained": 61080, "num_env_steps_sampled": 61080, "num_env_steps_trained": 61080, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.82968640281318, "num_env_steps_trained_throughput_per_sec": 65.82968640281318, "timesteps_total": 61080, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 61080, "timers": {"training_iteration_time_ms": 1825.071, "sample_time_ms": 1822.435, "load_time_ms": 0.157, "load_throughput": 765966.337, "learn_time_ms": 1.942, "learn_throughput": 61801.363, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 61080, "num_env_steps_trained": 61080, "num_agent_steps_sampled": 61080, "num_agent_steps_trained": 61080}, "done": false, "episodes_total": 509, "training_iteration": 85, "trial_id": "487fa_00000", "date": "2023-07-24_21-11-11", "timestamp": 1690222271, "time_this_iter_s": 10.939438104629517, "time_total_s": 933.159473657608, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 933.159473657608, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 25.046666666666667, "ram_util_percent": 78.88666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.2835235595703, "policy_loss": -81183.2421875, "vf_loss": 3867758.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 515.0, "diff_num_grad_updates_vs_sampler_policy": 514.0}}, "num_env_steps_sampled": 61800, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 61800, "num_agent_steps_trained": 61800}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -684.1129304493699, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.022723975897554, "mean_inference_ms": 0.2663032772315627, "mean_action_processing_ms": 0.06152561532068854, "mean_env_wait_ms": 1.8673943474924635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002759218215942383, "StateBufferConnector_ms": 0.0018100738525390625, "ViewRequirementAgentConnector_ms": 0.04820728302001953}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -684.1129304493699, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-722.7401035163589, -800.955443736214, -578.6063350746175, -681.731739777414, -589.7541646155779, -526.6578394478771, -597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.022723975897554, "mean_inference_ms": 0.2663032772315627, "mean_action_processing_ms": 0.06152561532068854, "mean_env_wait_ms": 1.8673943474924635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002759218215942383, "StateBufferConnector_ms": 0.0018100738525390625, "ViewRequirementAgentConnector_ms": 0.04820728302001953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61800, "num_agent_steps_trained": 61800, "num_env_steps_sampled": 61800, "num_env_steps_trained": 61800, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.09870684055878, "num_env_steps_trained_throughput_per_sec": 66.09870684055878, "timesteps_total": 61800, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 61800, "timers": {"training_iteration_time_ms": 1816.864, "sample_time_ms": 1814.262, "load_time_ms": 0.152, "load_throughput": 788156.091, "learn_time_ms": 1.911, "learn_throughput": 62797.599, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 61800, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 61800, "num_agent_steps_trained": 61800}, "done": false, "episodes_total": 515, "training_iteration": 86, "trial_id": "487fa_00000", "date": "2023-07-24_21-11-22", "timestamp": 1690222282, "time_this_iter_s": 10.894896984100342, "time_total_s": 944.0543706417084, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 944.0543706417084, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 22.700000000000003, "ram_util_percent": 78.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.2939910888672, "policy_loss": -56086.265625, "vf_loss": 1932759.875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 521.0, "diff_num_grad_updates_vs_sampler_policy": 520.0}}, "num_env_steps_sampled": 62520, "num_env_steps_trained": 62520, "num_agent_steps_sampled": 62520, "num_agent_steps_trained": 62520}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -688.8271376481276, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.023985665823266, "mean_inference_ms": 0.2663454451700764, "mean_action_processing_ms": 0.061527479476029046, "mean_env_wait_ms": 1.8670456962154587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002755880355834961, "StateBufferConnector_ms": 0.001821756362915039, "ViewRequirementAgentConnector_ms": 0.04827475547790527}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -688.8271376481276, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-597.8247945091964, -843.2554298794979, -762.227591825207, -741.9779128437652, -781.582473046087, -633.7525389663721, -594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.023985665823266, "mean_inference_ms": 0.2663454451700764, "mean_action_processing_ms": 0.061527479476029046, "mean_env_wait_ms": 1.8670456962154587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002755880355834961, "StateBufferConnector_ms": 0.001821756362915039, "ViewRequirementAgentConnector_ms": 0.04827475547790527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62520, "num_agent_steps_trained": 62520, "num_env_steps_sampled": 62520, "num_env_steps_trained": 62520, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.0926186895874, "num_env_steps_trained_throughput_per_sec": 65.0926186895874, "timesteps_total": 62520, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 62520, "timers": {"training_iteration_time_ms": 1834.81, "sample_time_ms": 1832.172, "load_time_ms": 0.153, "load_throughput": 783982.056, "learn_time_ms": 1.927, "learn_throughput": 62256.971, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 62520, "num_env_steps_trained": 62520, "num_agent_steps_sampled": 62520, "num_agent_steps_trained": 62520}, "done": false, "episodes_total": 521, "training_iteration": 87, "trial_id": "487fa_00000", "date": "2023-07-24_21-11-33", "timestamp": 1690222293, "time_this_iter_s": 11.063388109207153, "time_total_s": 955.1177587509155, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 955.1177587509155, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 29.593333333333337, "ram_util_percent": 78.71333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.31358337402344, "policy_loss": -81827.234375, "vf_loss": 3641700.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 526.0}}, "num_env_steps_sampled": 63240, "num_env_steps_trained": 63240, "num_agent_steps_sampled": 63240, "num_agent_steps_trained": 63240}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -686.2650878040281, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024594856494607, "mean_inference_ms": 0.26634246746344664, "mean_action_processing_ms": 0.0615236602429693, "mean_env_wait_ms": 1.8665463682159835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025985240936279297, "StateBufferConnector_ms": 0.001802682876586914, "ViewRequirementAgentConnector_ms": 0.047078609466552734}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -686.2650878040281, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-594.2568756733751, -742.9363006828715, -666.1602135380582, -841.0548512400768, -613.4006446348025, -804.0069088511045, -736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024594856494607, "mean_inference_ms": 0.26634246746344664, "mean_action_processing_ms": 0.0615236602429693, "mean_env_wait_ms": 1.8665463682159835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025985240936279297, "StateBufferConnector_ms": 0.001802682876586914, "ViewRequirementAgentConnector_ms": 0.047078609466552734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63240, "num_agent_steps_trained": 63240, "num_env_steps_sampled": 63240, "num_env_steps_trained": 63240, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.09910180569969, "num_env_steps_trained_throughput_per_sec": 66.09910180569969, "timesteps_total": 63240, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 63240, "timers": {"training_iteration_time_ms": 1827.354, "sample_time_ms": 1824.728, "load_time_ms": 0.154, "load_throughput": 780214.664, "learn_time_ms": 1.905, "learn_throughput": 62979.114, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 63240, "num_env_steps_trained": 63240, "num_agent_steps_sampled": 63240, "num_agent_steps_trained": 63240}, "done": false, "episodes_total": 527, "training_iteration": 88, "trial_id": "487fa_00000", "date": "2023-07-24_21-11-44", "timestamp": 1690222304, "time_this_iter_s": 10.894987106323242, "time_total_s": 966.0127458572388, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 966.0127458572388, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 23.525, "ram_util_percent": 78.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.32180786132812, "policy_loss": -68817.40625, "vf_loss": 2855623.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 532.0}}, "num_env_steps_sampled": 63960, "num_env_steps_trained": 63960, "num_agent_steps_sampled": 63960, "num_agent_steps_trained": 63960}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -683.6014770294299, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024827979983966, "mean_inference_ms": 0.26632178982531934, "mean_action_processing_ms": 0.06151694687431582, "mean_env_wait_ms": 1.8659975059025633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002583026885986328, "StateBufferConnector_ms": 0.0017948150634765625, "ViewRequirementAgentConnector_ms": 0.04681229591369629}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -903.0402392214551, "episode_reward_mean": -683.6014770294299, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-736.4789902753561, -812.6880246386776, -842.9412374845288, -785.2811304743902, -644.7081497847198, -675.3843440505257, -864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024827979983966, "mean_inference_ms": 0.26632178982531934, "mean_action_processing_ms": 0.06151694687431582, "mean_env_wait_ms": 1.8659975059025633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002583026885986328, "StateBufferConnector_ms": 0.0017948150634765625, "ViewRequirementAgentConnector_ms": 0.04681229591369629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63960, "num_agent_steps_trained": 63960, "num_env_steps_sampled": 63960, "num_env_steps_trained": 63960, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.74865151423018, "num_env_steps_trained_throughput_per_sec": 65.74865151423018, "timesteps_total": 63960, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 63960, "timers": {"training_iteration_time_ms": 1820.708, "sample_time_ms": 1818.131, "load_time_ms": 0.147, "load_throughput": 815880.175, "learn_time_ms": 1.87, "learn_throughput": 64168.247, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 63960, "num_env_steps_trained": 63960, "num_agent_steps_sampled": 63960, "num_agent_steps_trained": 63960}, "done": false, "episodes_total": 533, "training_iteration": 89, "trial_id": "487fa_00000", "date": "2023-07-24_21-11-55", "timestamp": 1690222315, "time_this_iter_s": 10.952842950820923, "time_total_s": 976.9655888080597, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 976.9655888080597, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 23.1625, "ram_util_percent": 78.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.31536865234375, "policy_loss": -75452.75, "vf_loss": 3368630.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 539.0, "diff_num_grad_updates_vs_sampler_policy": 538.0}}, "num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -964.9395713845561, "episode_reward_mean": -681.5173999112496, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007, -726.9020409183311, -594.6642199093867, -645.3791393926715, -964.9395713845561, -690.7708281741684, -666.4183651110548], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024794570614917, "mean_inference_ms": 0.26628418722617636, "mean_action_processing_ms": 0.06150772454723677, "mean_env_wait_ms": 1.8654173983583247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025756359100341797, "StateBufferConnector_ms": 0.0017991065979003906, "ViewRequirementAgentConnector_ms": 0.04692649841308594}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -964.9395713845561, "episode_reward_mean": -681.5173999112496, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-864.4026800168963, -787.6321338390426, -710.3530415410611, -735.8011855889323, -647.7033664733328, -596.6891139542281, -623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007, -726.9020409183311, -594.6642199093867, -645.3791393926715, -964.9395713845561, -690.7708281741684, -666.4183651110548], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024794570614917, "mean_inference_ms": 0.26628418722617636, "mean_action_processing_ms": 0.06150772454723677, "mean_env_wait_ms": 1.8654173983583247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025756359100341797, "StateBufferConnector_ms": 0.0017991065979003906, "ViewRequirementAgentConnector_ms": 0.04692649841308594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680, "num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.03293509475454, "num_env_steps_trained_throughput_per_sec": 66.03293509475454, "timesteps_total": 64680, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 64680, "timers": {"training_iteration_time_ms": 1820.611, "sample_time_ms": 1818.049, "load_time_ms": 0.146, "load_throughput": 820401.76, "learn_time_ms": 1.876, "learn_throughput": 63954.622, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 64680, "num_env_steps_trained": 64680, "num_agent_steps_sampled": 64680, "num_agent_steps_trained": 64680}, "done": false, "episodes_total": 539, "training_iteration": 90, "trial_id": "487fa_00000", "date": "2023-07-24_21-12-05", "timestamp": 1690222325, "time_this_iter_s": 10.905704259872437, "time_total_s": 987.8712930679321, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 987.8712930679321, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 21.553333333333338, "ram_util_percent": 78.80666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.31443786621094, "policy_loss": -94456.6796875, "vf_loss": 4924439.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 545.0, "diff_num_grad_updates_vs_sampler_policy": 544.0}}, "num_env_steps_sampled": 65400, "num_env_steps_trained": 65400, "num_agent_steps_sampled": 65400, "num_agent_steps_trained": 65400}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -964.9395713845561, "episode_reward_mean": -681.9155630696107, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007, -726.9020409183311, -594.6642199093867, -645.3791393926715, -964.9395713845561, -690.7708281741684, -666.4183651110548, -699.8795982494844, -668.703867963222, -674.2607385144901, -772.540169973336, -723.8468089624218, -843.1666535866451], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02475840236387, "mean_inference_ms": 0.26625343715499594, "mean_action_processing_ms": 0.06149931373049717, "mean_env_wait_ms": 1.8648802313106136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025877952575683594, "StateBufferConnector_ms": 0.001810312271118164, "ViewRequirementAgentConnector_ms": 0.0469975471496582}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -964.9395713845561, "episode_reward_mean": -681.9155630696107, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-623.627287684079, -613.1722645084149, -521.6560969215831, -693.5401864115346, -560.6664353693517, -625.8119235505832, -587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007, -726.9020409183311, -594.6642199093867, -645.3791393926715, -964.9395713845561, -690.7708281741684, -666.4183651110548, -699.8795982494844, -668.703867963222, -674.2607385144901, -772.540169973336, -723.8468089624218, -843.1666535866451], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02475840236387, "mean_inference_ms": 0.26625343715499594, "mean_action_processing_ms": 0.06149931373049717, "mean_env_wait_ms": 1.8648802313106136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025877952575683594, "StateBufferConnector_ms": 0.001810312271118164, "ViewRequirementAgentConnector_ms": 0.0469975471496582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65400, "num_agent_steps_trained": 65400, "num_env_steps_sampled": 65400, "num_env_steps_trained": 65400, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 65.7409353820288, "num_env_steps_trained_throughput_per_sec": 65.7409353820288, "timesteps_total": 65400, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 65400, "timers": {"training_iteration_time_ms": 1819.462, "sample_time_ms": 1816.844, "load_time_ms": 0.149, "load_throughput": 805693.101, "learn_time_ms": 1.911, "learn_throughput": 62792.115, "synch_weights_time_ms": 0.528}, "counters": {"num_env_steps_sampled": 65400, "num_env_steps_trained": 65400, "num_agent_steps_sampled": 65400, "num_agent_steps_trained": 65400}, "done": false, "episodes_total": 545, "training_iteration": 91, "trial_id": "487fa_00000", "date": "2023-07-24_21-12-16", "timestamp": 1690222336, "time_this_iter_s": 10.95417308807373, "time_total_s": 998.8254661560059, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 998.8254661560059, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 24.1, "ram_util_percent": 78.83125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.3131561279297, "policy_loss": -68010.7109375, "vf_loss": 2585143.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 551.0, "diff_num_grad_updates_vs_sampler_policy": 550.0}}, "num_env_steps_sampled": 66120, "num_env_steps_trained": 66120, "num_agent_steps_sampled": 66120, "num_agent_steps_trained": 66120}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -964.9395713845561, "episode_reward_mean": -684.0876633749119, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007, -726.9020409183311, -594.6642199093867, -645.3791393926715, -964.9395713845561, -690.7708281741684, -666.4183651110548, -699.8795982494844, -668.703867963222, -674.2607385144901, -772.540169973336, -723.8468089624218, -843.1666535866451, -709.6210018179444, -702.371297732608, -592.0271803264728, -620.7897326537541, -645.9230374859634, -584.9519749589291], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024720706956195, "mean_inference_ms": 0.2662239286193106, "mean_action_processing_ms": 0.061491057389045894, "mean_env_wait_ms": 1.8643471877782813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002577066421508789, "StateBufferConnector_ms": 0.001798868179321289, "ViewRequirementAgentConnector_ms": 0.04687070846557617}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -964.9395713845561, "episode_reward_mean": -684.0876633749119, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-587.7424100837471, -578.0307048360883, -760.2558550765912, -667.2318912325247, -527.4659550651857, -607.3337184277708, -903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007, -726.9020409183311, -594.6642199093867, -645.3791393926715, -964.9395713845561, -690.7708281741684, -666.4183651110548, -699.8795982494844, -668.703867963222, -674.2607385144901, -772.540169973336, -723.8468089624218, -843.1666535866451, -709.6210018179444, -702.371297732608, -592.0271803264728, -620.7897326537541, -645.9230374859634, -584.9519749589291], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.024720706956195, "mean_inference_ms": 0.2662239286193106, "mean_action_processing_ms": 0.061491057389045894, "mean_env_wait_ms": 1.8643471877782813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002577066421508789, "StateBufferConnector_ms": 0.001798868179321289, "ViewRequirementAgentConnector_ms": 0.04687070846557617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66120, "num_agent_steps_trained": 66120, "num_env_steps_sampled": 66120, "num_env_steps_trained": 66120, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.10066869193932, "num_env_steps_trained_throughput_per_sec": 66.10066869193932, "timesteps_total": 66120, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 66120, "timers": {"training_iteration_time_ms": 1818.832, "sample_time_ms": 1816.281, "load_time_ms": 0.148, "load_throughput": 809580.955, "learn_time_ms": 1.861, "learn_throughput": 64497.159, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 66120, "num_env_steps_trained": 66120, "num_agent_steps_sampled": 66120, "num_agent_steps_trained": 66120}, "done": false, "episodes_total": 551, "training_iteration": 92, "trial_id": "487fa_00000", "date": "2023-07-24_21-12-27", "timestamp": 1690222347, "time_this_iter_s": 10.89458680152893, "time_total_s": 1009.7200529575348, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1009.7200529575348, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 23.726666666666674, "ram_util_percent": 78.59333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.1, "policy_entropy": 242.30303955078125, "policy_loss": -80634.6015625, "vf_loss": 4329172.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 557.0, "diff_num_grad_updates_vs_sampler_policy": 556.0}}, "num_env_steps_sampled": 66840, "num_env_steps_trained": 66840, "num_agent_steps_sampled": 66840, "num_agent_steps_trained": 66840}, "sampler_results": {"episode_reward_max": -461.87599214348256, "episode_reward_min": -964.9395713845561, "episode_reward_mean": -686.2011899498394, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007, -726.9020409183311, -594.6642199093867, -645.3791393926715, -964.9395713845561, -690.7708281741684, -666.4183651110548, -699.8795982494844, -668.703867963222, -674.2607385144901, -772.540169973336, -723.8468089624218, -843.1666535866451, -709.6210018179444, -702.371297732608, -592.0271803264728, -620.7897326537541, -645.9230374859634, -584.9519749589291, -694.6384747481708, -540.0677516358328, -582.2154696720314, -740.5202592228668, -687.8435950249342, -694.1276419108167], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02462837469609, "mean_inference_ms": 0.2661948319465255, "mean_action_processing_ms": 0.06148291640789835, "mean_env_wait_ms": 1.8638406290389247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025708675384521484, "StateBufferConnector_ms": 0.0017910003662109375, "ViewRequirementAgentConnector_ms": 0.04679727554321289}}, "episode_reward_max": -461.87599214348256, "episode_reward_min": -964.9395713845561, "episode_reward_mean": -686.2011899498394, "episode_len_mean": 120.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-903.0402392214551, -818.0868568531482, -556.6673982917787, -668.3567375235087, -675.3590639269569, -602.658218863382, -726.0021264542096, -598.5313682314114, -656.8156045680373, -826.2063279252387, -686.659976946118, -607.1764237309355, -774.6211788638966, -664.0800136259143, -825.9530583087361, -649.918370273157, -829.493632403135, -461.87599214348256, -636.6783559968778, -689.750095349947, -670.5622315448468, -827.7279414219776, -535.1224501734591, -749.0263187949104, -883.9586807586995, -608.7791979766458, -746.456324491809, -717.5938027023828, -774.7563643607649, -714.8211992331887, -707.149434503532, -577.9273693153366, -534.1363282056476, -868.9465626689989, -616.1454839942368, -646.883843696043, -562.3141263124219, -645.7575864177328, -740.8809488283131, -713.4803126094552, -664.3261257589843, -754.0946409274982, -667.094531676077, -711.8322344096739, -613.3106480626743, -467.27829233292135, -537.4471334174215, -749.6455678641524, -733.0074534319023, -514.9488487792042, -748.460196104375, -674.2479439239073, -572.2775296289234, -866.9200368762336, -780.1736599623193, -576.8243607324041, -644.8998180816062, -704.6661863073397, -747.1557145053457, -779.3020165971342, -819.0449812566637, -724.4106507118644, -758.1928484813598, -543.7601344914808, -654.4570634344556, -713.4590609426397, -478.3104408263003, -817.1126143348, -696.3510534314121, -744.7255236905891, -775.0297959947289, -734.4169282995683, -516.6307153392224, -706.1085558593105, -646.286833279628, -616.981888388007, -726.9020409183311, -594.6642199093867, -645.3791393926715, -964.9395713845561, -690.7708281741684, -666.4183651110548, -699.8795982494844, -668.703867963222, -674.2607385144901, -772.540169973336, -723.8468089624218, -843.1666535866451, -709.6210018179444, -702.371297732608, -592.0271803264728, -620.7897326537541, -645.9230374859634, -584.9519749589291, -694.6384747481708, -540.0677516358328, -582.2154696720314, -740.5202592228668, -687.8435950249342, -694.1276419108167], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.02462837469609, "mean_inference_ms": 0.2661948319465255, "mean_action_processing_ms": 0.06148291640789835, "mean_env_wait_ms": 1.8638406290389247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025708675384521484, "StateBufferConnector_ms": 0.0017910003662109375, "ViewRequirementAgentConnector_ms": 0.04679727554321289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66840, "num_agent_steps_trained": 66840, "num_env_steps_sampled": 66840, "num_env_steps_trained": 66840, "num_env_steps_sampled_this_iter": 720, "num_env_steps_trained_this_iter": 720, "num_env_steps_sampled_throughput_per_sec": 66.05007108603535, "num_env_steps_trained_throughput_per_sec": 66.05007108603535, "timesteps_total": 66840, "num_steps_trained_this_iter": 720, "agent_timesteps_total": 66840, "timers": {"training_iteration_time_ms": 1814.483, "sample_time_ms": 1811.918, "load_time_ms": 0.146, "load_throughput": 820535.507, "learn_time_ms": 1.88, "learn_throughput": 63827.29, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 66840, "num_env_steps_trained": 66840, "num_agent_steps_sampled": 66840, "num_agent_steps_trained": 66840}, "done": false, "episodes_total": 557, "training_iteration": 93, "trial_id": "487fa_00000", "date": "2023-07-24_21-12-38", "timestamp": 1690222358, "time_this_iter_s": 10.902936935424805, "time_total_s": 1020.6229898929596, "pid": 39803, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.0005], [3600, 0.00025], [7200, 0.0001], [10800, 5e-05], [14400, 2.5e-05], [18000, 1e-05], [21600, 7.5e-06], [25200, 5e-06], [28800, 2.5e-06], [32400, 1e-06], [36000, 7.5e-07], [39600, 5e-07], [43200, 2.5e-07], [46800, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307536430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1020.6229898929596, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 23.200000000000003, "ram_util_percent": 78.44999999999999}}
