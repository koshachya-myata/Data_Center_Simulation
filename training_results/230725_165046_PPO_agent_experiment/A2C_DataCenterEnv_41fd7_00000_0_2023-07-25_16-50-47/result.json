{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0026, "entropy_coeff": 0.1, "policy_entropy": 321.87071533203124, "policy_loss": -1082450290371.3, "vf_loss": 615621315.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -19464.10253338826, "episode_reward_mean": -13087.291481709577, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.483913233675616, "mean_inference_ms": 0.2506596606940879, "mean_action_processing_ms": 0.05970242782899855, "mean_env_wait_ms": 2.6778647007833003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022530555725097656, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.04526972770690918}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -19464.10253338826, "episode_reward_mean": -13087.291481709577, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.483913233675616, "mean_inference_ms": 0.2506596606940879, "mean_action_processing_ms": 0.05970242782899855, "mean_env_wait_ms": 2.6778647007833003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022530555725097656, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.04526972770690918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440, "num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 132.84279912493255, "num_env_steps_trained_throughput_per_sec": 132.84279912493255, "timesteps_total": 1440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 1440, "timers": {"training_iteration_time_ms": 2709.959, "sample_time_ms": 2699.708, "load_time_ms": 0.322, "load_throughput": 1119310.185, "learn_time_ms": 9.314, "learn_throughput": 38650.006, "synch_weights_time_ms": 0.582}, "counters": {"num_env_steps_sampled": 1440, "num_env_steps_trained": 1440, "num_agent_steps_sampled": 1440, "num_agent_steps_trained": 1440}, "done": false, "episodes_total": 4, "training_iteration": 1, "trial_id": "41fd7_00000", "date": "2023-07-25_16-51-02", "timestamp": 1690293062, "time_this_iter_s": 10.841723203659058, "time_total_s": 10.841723203659058, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.841723203659058, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.7875, "ram_util_percent": 77.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0019333333333333333, "entropy_coeff": 0.1, "policy_entropy": -201.51224060058593, "policy_loss": -8.865146266731436e+19, "vf_loss": 588453216.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -19577.998925769785, "episode_reward_mean": -16429.612344292073, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5313266297530195, "mean_inference_ms": 0.25525119141193303, "mean_action_processing_ms": 0.060190101784105284, "mean_env_wait_ms": 2.3291438929906083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025139914618598092, "StateBufferConnector_ms": 0.0017987357245551215, "ViewRequirementAgentConnector_ms": 0.045310126410590276}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -19577.998925769785, "episode_reward_mean": -16429.612344292073, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5313266297530195, "mean_inference_ms": 0.25525119141193303, "mean_action_processing_ms": 0.060190101784105284, "mean_env_wait_ms": 2.3291438929906083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025139914618598092, "StateBufferConnector_ms": 0.0017987357245551215, "ViewRequirementAgentConnector_ms": 0.045310126410590276}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240, "num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 152.57366644735743, "num_env_steps_trained_throughput_per_sec": 152.57366644735743, "timesteps_total": 3240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 3240, "timers": {"training_iteration_time_ms": 2515.262, "sample_time_ms": 2506.56, "load_time_ms": 0.289, "load_throughput": 1247204.934, "learn_time_ms": 7.799, "learn_throughput": 46161.394, "synch_weights_time_ms": 0.576}, "counters": {"num_env_steps_sampled": 3240, "num_env_steps_trained": 3240, "num_agent_steps_sampled": 3240, "num_agent_steps_trained": 3240}, "done": false, "episodes_total": 9, "training_iteration": 2, "trial_id": "41fd7_00000", "date": "2023-07-25_16-51-14", "timestamp": 1690293074, "time_this_iter_s": 11.79968523979187, "time_total_s": 22.641408443450928, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.641408443450928, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.03529411764706, "ram_util_percent": 78.40588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0012666666666666666, "entropy_coeff": 0.1, "policy_entropy": -269.2488159179687, "policy_loss": -2.7058198658987622e+19, "vf_loss": 609249462.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -19577.998925769785, "episode_reward_mean": -17297.13112003963, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5348977014974725, "mean_inference_ms": 0.25679970764204635, "mean_action_processing_ms": 0.06036436007127755, "mean_env_wait_ms": 2.157713820400044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026277133396693637, "StateBufferConnector_ms": 0.0017983572823660715, "ViewRequirementAgentConnector_ms": 0.0457831791469029}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -19577.998925769785, "episode_reward_mean": -17297.13112003963, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5348977014974725, "mean_inference_ms": 0.25679970764204635, "mean_action_processing_ms": 0.06036436007127755, "mean_env_wait_ms": 2.157713820400044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026277133396693637, "StateBufferConnector_ms": 0.0017983572823660715, "ViewRequirementAgentConnector_ms": 0.0457831791469029}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.69833103834543, "num_env_steps_trained_throughput_per_sec": 157.69833103834543, "timesteps_total": 5040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 2321.166, "sample_time_ms": 2313.723, "load_time_ms": 0.239, "load_throughput": 1507386.882, "learn_time_ms": 6.574, "learn_throughput": 54757.317, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 14, "training_iteration": 3, "trial_id": "41fd7_00000", "date": "2023-07-25_16-51-25", "timestamp": 1690293085, "time_this_iter_s": 11.416082859039307, "time_total_s": 34.057491302490234, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 34.057491302490234, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.55625, "ram_util_percent": 80.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00095, "entropy_coeff": 0.1, "policy_entropy": -273.06939086914065, "policy_loss": -2.84087702211275e+19, "vf_loss": 612362236.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 6840, "num_env_steps_trained": 6840, "num_agent_steps_sampled": 6840, "num_agent_steps_trained": 6840}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -19577.998925769785, "episode_reward_mean": -17757.375775173827, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.533920922601292, "mean_inference_ms": 0.25732554208249564, "mean_action_processing_ms": 0.06041368686195456, "mean_env_wait_ms": 2.0509578902198107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025573529695209706, "StateBufferConnector_ms": 0.0017768458316200658, "ViewRequirementAgentConnector_ms": 0.04570358677914268}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -19577.998925769785, "episode_reward_mean": -17757.375775173827, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.533920922601292, "mean_inference_ms": 0.25732554208249564, "mean_action_processing_ms": 0.06041368686195456, "mean_env_wait_ms": 2.0509578902198107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025573529695209706, "StateBufferConnector_ms": 0.0017768458316200658, "ViewRequirementAgentConnector_ms": 0.04570358677914268}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6840, "num_agent_steps_trained": 6840, "num_env_steps_sampled": 6840, "num_env_steps_trained": 6840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 157.69324858133984, "num_env_steps_trained_throughput_per_sec": 157.69324858133984, "timesteps_total": 6840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 6840, "timers": {"training_iteration_time_ms": 2282.865, "sample_time_ms": 2275.347, "load_time_ms": 0.223, "load_throughput": 1611644.188, "learn_time_ms": 6.68, "learn_throughput": 53890.967, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 6840, "num_env_steps_trained": 6840, "num_agent_steps_sampled": 6840, "num_agent_steps_trained": 6840}, "done": false, "episodes_total": 19, "training_iteration": 4, "trial_id": "41fd7_00000", "date": "2023-07-25_16-51-36", "timestamp": 1690293096, "time_this_iter_s": 11.416396141052246, "time_total_s": 45.47388744354248, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 45.47388744354248, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.54375, "ram_util_percent": 79.85624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0008666666666666666, "entropy_coeff": 0.1, "policy_entropy": -273.33619995117186, "policy_loss": -9.484079712817906e+17, "vf_loss": 649696076.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 118.0, "diff_num_grad_updates_vs_sampler_policy": 117.0}}, "num_env_steps_sampled": 8640, "num_env_steps_trained": 8640, "num_agent_steps_sampled": 8640, "num_agent_steps_trained": 8640}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -19955.35158449209, "episode_reward_mean": -18169.11456087617, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.530162066971761, "mean_inference_ms": 0.25733823018577945, "mean_action_processing_ms": 0.06038748008139994, "mean_env_wait_ms": 1.9760927700317896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002603729565938314, "StateBufferConnector_ms": 0.0017543633778889973, "ViewRequirementAgentConnector_ms": 0.045459469159444175}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -19955.35158449209, "episode_reward_mean": -18169.11456087617, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.530162066971761, "mean_inference_ms": 0.25733823018577945, "mean_action_processing_ms": 0.06038748008139994, "mean_env_wait_ms": 1.9760927700317896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002603729565938314, "StateBufferConnector_ms": 0.0017543633778889973, "ViewRequirementAgentConnector_ms": 0.045459469159444175}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8640, "num_agent_steps_trained": 8640, "num_env_steps_sampled": 8640, "num_env_steps_trained": 8640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.47364078599523, "num_env_steps_trained_throughput_per_sec": 159.47364078599523, "timesteps_total": 8640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 8640, "timers": {"training_iteration_time_ms": 2270.16, "sample_time_ms": 2262.798, "load_time_ms": 0.227, "load_throughput": 1588250.174, "learn_time_ms": 6.565, "learn_throughput": 54833.476, "synch_weights_time_ms": 0.537}, "counters": {"num_env_steps_sampled": 8640, "num_env_steps_trained": 8640, "num_agent_steps_sampled": 8640, "num_agent_steps_trained": 8640}, "done": false, "episodes_total": 24, "training_iteration": 5, "trial_id": "41fd7_00000", "date": "2023-07-25_16-51-48", "timestamp": 1690293108, "time_this_iter_s": 11.289244174957275, "time_total_s": 56.763131618499756, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 56.763131618499756, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.55625, "ram_util_percent": 79.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007833333333333335, "entropy_coeff": 0.1, "policy_entropy": -273.35706787109376, "policy_loss": -4.945016690292797e+19, "vf_loss": 641281081.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -19955.35158449209, "episode_reward_mean": -18368.42767515622, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5298372355072924, "mean_inference_ms": 0.257280992943199, "mean_action_processing_ms": 0.06036226926027911, "mean_env_wait_ms": 1.9218327052923638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002754967788170124, "StateBufferConnector_ms": 0.001973119275323276, "ViewRequirementAgentConnector_ms": 0.047453518571524786}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -19955.35158449209, "episode_reward_mean": -18368.42767515622, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5298372355072924, "mean_inference_ms": 0.257280992943199, "mean_action_processing_ms": 0.06036226926027911, "mean_env_wait_ms": 1.9218327052923638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002754967788170124, "StateBufferConnector_ms": 0.001973119275323276, "ViewRequirementAgentConnector_ms": 0.047453518571524786}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 154.70675827444018, "num_env_steps_trained_throughput_per_sec": 154.70675827444018, "timesteps_total": 10440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 10440, "timers": {"training_iteration_time_ms": 2292.192, "sample_time_ms": 2284.54, "load_time_ms": 0.244, "load_throughput": 1472403.159, "learn_time_ms": 6.774, "learn_throughput": 53145.152, "synch_weights_time_ms": 0.589}, "counters": {"num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "done": false, "episodes_total": 29, "training_iteration": 6, "trial_id": "41fd7_00000", "date": "2023-07-25_16-51-59", "timestamp": 1690293119, "time_this_iter_s": 11.636919975280762, "time_total_s": 68.40005159378052, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 68.40005159378052, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.947058823529414, "ram_util_percent": 77.2470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007, "entropy_coeff": 0.1, "policy_entropy": -273.36000366210936, "policy_loss": -1.5056442960366901e+19, "vf_loss": 579331833.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 168.0, "diff_num_grad_updates_vs_sampler_policy": 167.0}}, "num_env_steps_sampled": 12240, "num_env_steps_trained": 12240, "num_agent_steps_sampled": 12240, "num_agent_steps_trained": 12240}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -19955.35158449209, "episode_reward_mean": -18486.610744309488, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.526796191292983, "mean_inference_ms": 0.25713413879821206, "mean_action_processing_ms": 0.060331972947252205, "mean_env_wait_ms": 1.8792608728355753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002698337330537684, "StateBufferConnector_ms": 0.0019389040329877067, "ViewRequirementAgentConnector_ms": 0.04714306663064396}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -19955.35158449209, "episode_reward_mean": -18486.610744309488, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.526796191292983, "mean_inference_ms": 0.25713413879821206, "mean_action_processing_ms": 0.060331972947252205, "mean_env_wait_ms": 1.8792608728355753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002698337330537684, "StateBufferConnector_ms": 0.0019389040329877067, "ViewRequirementAgentConnector_ms": 0.04714306663064396}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12240, "num_agent_steps_trained": 12240, "num_env_steps_sampled": 12240, "num_env_steps_trained": 12240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.9285483162047, "num_env_steps_trained_throughput_per_sec": 160.9285483162047, "timesteps_total": 12240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 12240, "timers": {"training_iteration_time_ms": 2281.988, "sample_time_ms": 2274.34, "load_time_ms": 0.241, "load_throughput": 1495888.092, "learn_time_ms": 6.778, "learn_throughput": 53114.307, "synch_weights_time_ms": 0.585}, "counters": {"num_env_steps_sampled": 12240, "num_env_steps_trained": 12240, "num_agent_steps_sampled": 12240, "num_agent_steps_trained": 12240}, "done": false, "episodes_total": 34, "training_iteration": 7, "trial_id": "41fd7_00000", "date": "2023-07-25_16-52-11", "timestamp": 1690293131, "time_this_iter_s": 11.18699598312378, "time_total_s": 79.5870475769043, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 79.5870475769043, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.612500000000004, "ram_util_percent": 64.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0006166666666666666, "entropy_coeff": 0.1, "policy_entropy": -273.3638122558594, "policy_loss": -5.4115570473617375e+19, "vf_loss": 591014243.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 192.0}}, "num_env_steps_sampled": 14040, "num_env_steps_trained": 14040, "num_agent_steps_sampled": 14040, "num_agent_steps_trained": 14040}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18592.39668895473, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.522453141758871, "mean_inference_ms": 0.256895517534227, "mean_action_processing_ms": 0.06029216539116349, "mean_env_wait_ms": 1.8451069671934124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002648280217097356, "StateBufferConnector_ms": 0.00191346192971254, "ViewRequirementAgentConnector_ms": 0.04671170161320613}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18592.39668895473, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.522453141758871, "mean_inference_ms": 0.256895517534227, "mean_action_processing_ms": 0.06029216539116349, "mean_env_wait_ms": 1.8451069671934124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002648280217097356, "StateBufferConnector_ms": 0.00191346192971254, "ViewRequirementAgentConnector_ms": 0.04671170161320613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14040, "num_agent_steps_trained": 14040, "num_env_steps_sampled": 14040, "num_env_steps_trained": 14040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.00707561288328, "num_env_steps_trained_throughput_per_sec": 161.00707561288328, "timesteps_total": 14040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 14040, "timers": {"training_iteration_time_ms": 2236.463, "sample_time_ms": 2229.23, "load_time_ms": 0.212, "load_throughput": 1695239.07, "learn_time_ms": 6.466, "learn_throughput": 55675.165, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 14040, "num_env_steps_trained": 14040, "num_agent_steps_sampled": 14040, "num_agent_steps_trained": 14040}, "done": false, "episodes_total": 39, "training_iteration": 8, "trial_id": "41fd7_00000", "date": "2023-07-25_16-52-22", "timestamp": 1690293142, "time_this_iter_s": 11.181511163711548, "time_total_s": 90.76855874061584, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 90.76855874061584, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.81875, "ram_util_percent": 65.01875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0005333333333333334, "entropy_coeff": 0.1, "policy_entropy": -273.406201171875, "policy_loss": -2.5358606933103632e+19, "vf_loss": 633595500.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 217.0}}, "num_env_steps_sampled": 15840, "num_env_steps_trained": 15840, "num_agent_steps_sampled": 15840, "num_agent_steps_trained": 15840}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18682.43992076527, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.518188828540383, "mean_inference_ms": 0.2565709739311497, "mean_action_processing_ms": 0.06023987057036115, "mean_env_wait_ms": 1.8168174547868672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027271834286776457, "StateBufferConnector_ms": 0.0018802556124600496, "ViewRequirementAgentConnector_ms": 0.04630739038640803}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18682.43992076527, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.518188828540383, "mean_inference_ms": 0.2565709739311497, "mean_action_processing_ms": 0.06023987057036115, "mean_env_wait_ms": 1.8168174547868672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027271834286776457, "StateBufferConnector_ms": 0.0018802556124600496, "ViewRequirementAgentConnector_ms": 0.04630739038640803}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15840, "num_agent_steps_trained": 15840, "num_env_steps_sampled": 15840, "num_env_steps_trained": 15840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.46471798306055, "num_env_steps_trained_throughput_per_sec": 160.46471798306055, "timesteps_total": 15840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 15840, "timers": {"training_iteration_time_ms": 2239.695, "sample_time_ms": 2232.353, "load_time_ms": 0.223, "load_throughput": 1616648.223, "learn_time_ms": 6.552, "learn_throughput": 54942.416, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 15840, "num_env_steps_trained": 15840, "num_agent_steps_sampled": 15840, "num_agent_steps_trained": 15840}, "done": false, "episodes_total": 44, "training_iteration": 9, "trial_id": "41fd7_00000", "date": "2023-07-25_16-52-33", "timestamp": 1690293153, "time_this_iter_s": 11.219827890396118, "time_total_s": 101.98838663101196, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 101.98838663101196, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 32.1, "ram_util_percent": 73.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00045, "entropy_coeff": 0.1, "policy_entropy": -273.4180908203125, "policy_loss": -6.810141248802438e+18, "vf_loss": 669794809.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 243.0, "diff_num_grad_updates_vs_sampler_policy": 242.0}}, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18755.965156581286, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.514904928775996, "mean_inference_ms": 0.25625769719536695, "mean_action_processing_ms": 0.06019067663700403, "mean_env_wait_ms": 1.7929692038442848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002720404644401706, "StateBufferConnector_ms": 0.0018616111911073023, "ViewRequirementAgentConnector_ms": 0.046098475553551496}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18755.965156581286, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.514904928775996, "mean_inference_ms": 0.25625769719536695, "mean_action_processing_ms": 0.06019067663700403, "mean_env_wait_ms": 1.7929692038442848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002720404644401706, "StateBufferConnector_ms": 0.0018616111911073023, "ViewRequirementAgentConnector_ms": 0.046098475553551496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.35932733165646, "num_env_steps_trained_throughput_per_sec": 158.35932733165646, "timesteps_total": 17640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 17640, "timers": {"training_iteration_time_ms": 2258.387, "sample_time_ms": 2250.861, "load_time_ms": 0.247, "load_throughput": 1457198.842, "learn_time_ms": 6.693, "learn_throughput": 53786.153, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "done": false, "episodes_total": 49, "training_iteration": 10, "trial_id": "41fd7_00000", "date": "2023-07-25_16-52-44", "timestamp": 1690293164, "time_this_iter_s": 11.368857145309448, "time_total_s": 113.35724377632141, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 113.35724377632141, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.175, "ram_util_percent": 75.83125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00036666666666666667, "entropy_coeff": 0.1, "policy_entropy": -273.4248474121094, "policy_loss": -2.5251778404359963e+19, "vf_loss": 590789190.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 268.0, "diff_num_grad_updates_vs_sampler_policy": 267.0}}, "num_env_steps_sampled": 19440, "num_env_steps_trained": 19440, "num_agent_steps_sampled": 19440, "num_agent_steps_trained": 19440}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18746.12658132662, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.512142488479982, "mean_inference_ms": 0.2559318656846257, "mean_action_processing_ms": 0.06013949057218283, "mean_env_wait_ms": 1.7725669832737898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026914808485243055, "StateBufferConnector_ms": 0.001861430980541088, "ViewRequirementAgentConnector_ms": 0.04611059471412941}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18746.12658132662, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.512142488479982, "mean_inference_ms": 0.2559318656846257, "mean_action_processing_ms": 0.06013949057218283, "mean_env_wait_ms": 1.7725669832737898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026914808485243055, "StateBufferConnector_ms": 0.001861430980541088, "ViewRequirementAgentConnector_ms": 0.04611059471412941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19440, "num_agent_steps_trained": 19440, "num_env_steps_sampled": 19440, "num_env_steps_trained": 19440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 158.99517748320403, "num_env_steps_trained_throughput_per_sec": 158.99517748320403, "timesteps_total": 19440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 19440, "timers": {"training_iteration_time_ms": 2268.755, "sample_time_ms": 2261.283, "load_time_ms": 0.243, "load_throughput": 1478603.055, "learn_time_ms": 6.657, "learn_throughput": 54077.797, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 19440, "num_env_steps_trained": 19440, "num_agent_steps_sampled": 19440, "num_agent_steps_trained": 19440}, "done": false, "episodes_total": 54, "training_iteration": 11, "trial_id": "41fd7_00000", "date": "2023-07-25_16-52-56", "timestamp": 1690293176, "time_this_iter_s": 11.322993040084839, "time_total_s": 124.68023681640625, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 124.68023681640625, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.543750000000003, "ram_util_percent": 75.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00028333333333333335, "entropy_coeff": 0.1, "policy_entropy": -273.42506103515626, "policy_loss": -7.045020775935967e+17, "vf_loss": 547661385.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 21240, "num_env_steps_trained": 21240, "num_agent_steps_sampled": 21240, "num_agent_steps_trained": 21240}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18766.067485441024, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.509324941166871, "mean_inference_ms": 0.25561767814218367, "mean_action_processing_ms": 0.060090414929344346, "mean_env_wait_ms": 1.7548372354310509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027050406245862023, "StateBufferConnector_ms": 0.0018778493848897644, "ViewRequirementAgentConnector_ms": 0.046435857223252115}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18766.067485441024, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.509324941166871, "mean_inference_ms": 0.25561767814218367, "mean_action_processing_ms": 0.060090414929344346, "mean_env_wait_ms": 1.7548372354310509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027050406245862023, "StateBufferConnector_ms": 0.0018778493848897644, "ViewRequirementAgentConnector_ms": 0.046435857223252115}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21240, "num_agent_steps_trained": 21240, "num_env_steps_sampled": 21240, "num_env_steps_trained": 21240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.7525943250092, "num_env_steps_trained_throughput_per_sec": 160.7525943250092, "timesteps_total": 21240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 21240, "timers": {"training_iteration_time_ms": 2251.833, "sample_time_ms": 2244.639, "load_time_ms": 0.222, "load_throughput": 1624824.535, "learn_time_ms": 6.42, "learn_throughput": 56078.373, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 21240, "num_env_steps_trained": 21240, "num_agent_steps_sampled": 21240, "num_agent_steps_trained": 21240}, "done": false, "episodes_total": 59, "training_iteration": 12, "trial_id": "41fd7_00000", "date": "2023-07-25_16-53-07", "timestamp": 1690293187, "time_this_iter_s": 11.199331998825073, "time_total_s": 135.87956881523132, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 135.87956881523132, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.6375, "ram_util_percent": 75.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00022, "entropy_coeff": 0.1, "policy_entropy": -273.4247802734375, "policy_loss": -1.0658679201799492e+19, "vf_loss": 605702630.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 318.0, "diff_num_grad_updates_vs_sampler_policy": 317.0}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18787.496141571526, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.506464341223479, "mean_inference_ms": 0.2553048575433329, "mean_action_processing_ms": 0.06004248438068836, "mean_env_wait_ms": 1.7391989657213234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026989728212356567, "StateBufferConnector_ms": 0.0018674880266189575, "ViewRequirementAgentConnector_ms": 0.04624314606189728}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18787.496141571526, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.506464341223479, "mean_inference_ms": 0.2553048575433329, "mean_action_processing_ms": 0.06004248438068836, "mean_env_wait_ms": 1.7391989657213234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026989728212356567, "StateBufferConnector_ms": 0.0018674880266189575, "ViewRequirementAgentConnector_ms": 0.04624314606189728}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.42730290653924, "num_env_steps_trained_throughput_per_sec": 161.42730290653924, "timesteps_total": 23040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 2234.776, "sample_time_ms": 2227.547, "load_time_ms": 0.217, "load_throughput": 1659102.78, "learn_time_ms": 6.44, "learn_throughput": 55904.176, "synch_weights_time_ms": 0.541}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 64, "training_iteration": 13, "trial_id": "41fd7_00000", "date": "2023-07-25_16-53-18", "timestamp": 1690293198, "time_this_iter_s": 11.152581930160522, "time_total_s": 147.03215074539185, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 147.03215074539185, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.075000000000003, "ram_util_percent": 75.98750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00017, "entropy_coeff": 0.1, "policy_entropy": -273.4248107910156, "policy_loss": -1.1264859411552387e+18, "vf_loss": 600587619.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.0, "diff_num_grad_updates_vs_sampler_policy": 342.0}}, "num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18797.29439741582, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.503811855775773, "mean_inference_ms": 0.2549988952702723, "mean_action_processing_ms": 0.05999701117564759, "mean_env_wait_ms": 1.7252705149874517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026903290679489355, "StateBufferConnector_ms": 0.0018593193828195765, "ViewRequirementAgentConnector_ms": 0.0460821649302607}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18797.29439741582, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.503811855775773, "mean_inference_ms": 0.2549988952702723, "mean_action_processing_ms": 0.05999701117564759, "mean_env_wait_ms": 1.7252705149874517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026903290679489355, "StateBufferConnector_ms": 0.0018593193828195765, "ViewRequirementAgentConnector_ms": 0.0460821649302607}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840, "num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.65192051119408, "num_env_steps_trained_throughput_per_sec": 160.65192051119408, "timesteps_total": 24840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 24840, "timers": {"training_iteration_time_ms": 2235.478, "sample_time_ms": 2228.283, "load_time_ms": 0.217, "load_throughput": 1660562.455, "learn_time_ms": 6.409, "learn_throughput": 56175.177, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 24840, "num_env_steps_trained": 24840, "num_agent_steps_sampled": 24840, "num_agent_steps_trained": 24840}, "done": false, "episodes_total": 69, "training_iteration": 14, "trial_id": "41fd7_00000", "date": "2023-07-25_16-53-29", "timestamp": 1690293209, "time_this_iter_s": 11.206355333328247, "time_total_s": 158.2385060787201, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 158.2385060787201, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.53125, "ram_util_percent": 75.88125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00011999999999999999, "entropy_coeff": 0.1, "policy_entropy": -273.42450561523435, "policy_loss": -1.0265516536099078e+18, "vf_loss": 558614192.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 368.0, "diff_num_grad_updates_vs_sampler_policy": 367.0}}, "num_env_steps_sampled": 26640, "num_env_steps_trained": 26640, "num_agent_steps_sampled": 26640, "num_agent_steps_trained": 26640}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18811.82561434463, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.501323372798967, "mean_inference_ms": 0.25475088204033275, "mean_action_processing_ms": 0.05995970694307469, "mean_env_wait_ms": 1.7130191764890612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026557896588299728, "StateBufferConnector_ms": 0.0018416224299250422, "ViewRequirementAgentConnector_ms": 0.04592360676945867}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18811.82561434463, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.501323372798967, "mean_inference_ms": 0.25475088204033275, "mean_action_processing_ms": 0.05995970694307469, "mean_env_wait_ms": 1.7130191764890612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026557896588299728, "StateBufferConnector_ms": 0.0018416224299250422, "ViewRequirementAgentConnector_ms": 0.04592360676945867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26640, "num_agent_steps_trained": 26640, "num_env_steps_sampled": 26640, "num_env_steps_trained": 26640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.02768356037456, "num_env_steps_trained_throughput_per_sec": 159.02768356037456, "timesteps_total": 26640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 26640, "timers": {"training_iteration_time_ms": 2252.301, "sample_time_ms": 2244.961, "load_time_ms": 0.22, "load_throughput": 1639467.362, "learn_time_ms": 6.5, "learn_throughput": 55386.801, "synch_weights_time_ms": 0.586}, "counters": {"num_env_steps_sampled": 26640, "num_env_steps_trained": 26640, "num_agent_steps_sampled": 26640, "num_agent_steps_trained": 26640}, "done": false, "episodes_total": 74, "training_iteration": 15, "trial_id": "41fd7_00000", "date": "2023-07-25_16-53-41", "timestamp": 1690293221, "time_this_iter_s": 11.320847988128662, "time_total_s": 169.55935406684875, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 169.55935406684875, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 27.74375, "ram_util_percent": 75.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-05, "entropy_coeff": 0.1, "policy_entropy": -273.42498779296875, "policy_loss": -5.3937508619943936e+17, "vf_loss": 586372204.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 392.0}}, "num_env_steps_sampled": 28440, "num_env_steps_trained": 28440, "num_agent_steps_sampled": 28440, "num_agent_steps_trained": 28440}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18808.793127561035, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.498930513502723, "mean_inference_ms": 0.2545426998595788, "mean_action_processing_ms": 0.05992940458384581, "mean_env_wait_ms": 1.702117229836518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002642824679990358, "StateBufferConnector_ms": 0.0018418589724770076, "ViewRequirementAgentConnector_ms": 0.04590825189518023}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18808.793127561035, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.498930513502723, "mean_inference_ms": 0.2545426998595788, "mean_action_processing_ms": 0.05992940458384581, "mean_env_wait_ms": 1.702117229836518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002642824679990358, "StateBufferConnector_ms": 0.0018418589724770076, "ViewRequirementAgentConnector_ms": 0.04590825189518023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28440, "num_agent_steps_trained": 28440, "num_env_steps_sampled": 28440, "num_env_steps_trained": 28440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.7177196242425, "num_env_steps_trained_throughput_per_sec": 159.7177196242425, "timesteps_total": 28440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 28440, "timers": {"training_iteration_time_ms": 2258.855, "sample_time_ms": 2251.49, "load_time_ms": 0.223, "load_throughput": 1615091.924, "learn_time_ms": 6.516, "learn_throughput": 55248.386, "synch_weights_time_ms": 0.591}, "counters": {"num_env_steps_sampled": 28440, "num_env_steps_trained": 28440, "num_agent_steps_sampled": 28440, "num_agent_steps_trained": 28440}, "done": false, "episodes_total": 79, "training_iteration": 16, "trial_id": "41fd7_00000", "date": "2023-07-25_16-53-52", "timestamp": 1690293232, "time_this_iter_s": 11.272018909454346, "time_total_s": 180.8313729763031, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 180.8313729763031, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.91875, "ram_util_percent": 76.41874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -273.4243469238281, "policy_loss": -1.4837459690936074e+17, "vf_loss": 626599644.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 418.0, "diff_num_grad_updates_vs_sampler_policy": 417.0}}, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18836.814041608806, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.496633801995212, "mean_inference_ms": 0.2543535166393264, "mean_action_processing_ms": 0.059902592805258885, "mean_env_wait_ms": 1.6922924053603974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002653825850713821, "StateBufferConnector_ms": 0.001837242217290969, "ViewRequirementAgentConnector_ms": 0.045870883124215264}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18836.814041608806, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.496633801995212, "mean_inference_ms": 0.2543535166393264, "mean_action_processing_ms": 0.059902592805258885, "mean_env_wait_ms": 1.6922924053603974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002653825850713821, "StateBufferConnector_ms": 0.001837242217290969, "ViewRequirementAgentConnector_ms": 0.045870883124215264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.3003811242635, "num_env_steps_trained_throughput_per_sec": 160.3003811242635, "timesteps_total": 30240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 30240, "timers": {"training_iteration_time_ms": 2249.871, "sample_time_ms": 2242.716, "load_time_ms": 0.222, "load_throughput": 1620291.276, "learn_time_ms": 6.377, "learn_throughput": 56456.628, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "done": false, "episodes_total": 84, "training_iteration": 17, "trial_id": "41fd7_00000", "date": "2023-07-25_16-54-03", "timestamp": 1690293243, "time_this_iter_s": 11.23098111152649, "time_total_s": 192.0623540878296, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 192.0623540878296, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 22.9375, "ram_util_percent": 77.69375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.833333333333333e-05, "entropy_coeff": 0.1, "policy_entropy": -273.424951171875, "policy_loss": -3.752712697664798e+16, "vf_loss": 631780710.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 443.0, "diff_num_grad_updates_vs_sampler_policy": 442.0}}, "num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18864.638320381087, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.494412886662773, "mean_inference_ms": 0.2541759781183884, "mean_action_processing_ms": 0.05987762803290338, "mean_env_wait_ms": 1.683362853576322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026775210091237274, "StateBufferConnector_ms": 0.0018468063868833393, "ViewRequirementAgentConnector_ms": 0.045974334973967475}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18864.638320381087, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.494412886662773, "mean_inference_ms": 0.2541759781183884, "mean_action_processing_ms": 0.05987762803290338, "mean_env_wait_ms": 1.683362853576322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026775210091237274, "StateBufferConnector_ms": 0.0018468063868833393, "ViewRequirementAgentConnector_ms": 0.045974334973967475}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040, "num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.76614639651058, "num_env_steps_trained_throughput_per_sec": 160.76614639651058, "timesteps_total": 32040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 32040, "timers": {"training_iteration_time_ms": 2242.521, "sample_time_ms": 2235.466, "load_time_ms": 0.218, "load_throughput": 1648956.47, "learn_time_ms": 6.293, "learn_throughput": 57204.805, "synch_weights_time_ms": 0.511}, "counters": {"num_env_steps_sampled": 32040, "num_env_steps_trained": 32040, "num_agent_steps_sampled": 32040, "num_agent_steps_trained": 32040}, "done": false, "episodes_total": 89, "training_iteration": 18, "trial_id": "41fd7_00000", "date": "2023-07-25_16-54-14", "timestamp": 1690293254, "time_this_iter_s": 11.198398113250732, "time_total_s": 203.26075220108032, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 203.26075220108032, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 25.60625, "ram_util_percent": 77.71249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-05, "entropy_coeff": 0.1, "policy_entropy": -273.4233703613281, "policy_loss": -4.43359484549487e+17, "vf_loss": 621024672.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 468.0, "diff_num_grad_updates_vs_sampler_policy": 467.0}}, "num_env_steps_sampled": 33840, "num_env_steps_trained": 33840, "num_agent_steps_sampled": 33840, "num_agent_steps_trained": 33840}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18890.86670536733, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.492334220459952, "mean_inference_ms": 0.2540102603750441, "mean_action_processing_ms": 0.05985368423941923, "mean_env_wait_ms": 1.6752338648208722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026639471662805434, "StateBufferConnector_ms": 0.0018439394362429356, "ViewRequirementAgentConnector_ms": 0.045941231098580865}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18890.86670536733, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.492334220459952, "mean_inference_ms": 0.2540102603750441, "mean_action_processing_ms": 0.05985368423941923, "mean_env_wait_ms": 1.6752338648208722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026639471662805434, "StateBufferConnector_ms": 0.0018439394362429356, "ViewRequirementAgentConnector_ms": 0.045941231098580865}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33840, "num_agent_steps_trained": 33840, "num_env_steps_sampled": 33840, "num_env_steps_trained": 33840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 159.9592795718253, "num_env_steps_trained_throughput_per_sec": 159.9592795718253, "timesteps_total": 33840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 33840, "timers": {"training_iteration_time_ms": 2244.916, "sample_time_ms": 2237.884, "load_time_ms": 0.216, "load_throughput": 1665507.876, "learn_time_ms": 6.279, "learn_throughput": 57332.958, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 33840, "num_env_steps_trained": 33840, "num_agent_steps_sampled": 33840, "num_agent_steps_trained": 33840}, "done": false, "episodes_total": 94, "training_iteration": 19, "trial_id": "41fd7_00000", "date": "2023-07-25_16-54-26", "timestamp": 1690293266, "time_this_iter_s": 11.254959106445312, "time_total_s": 214.51571130752563, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 214.51571130752563, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 25.606250000000003, "ram_util_percent": 78.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -273.4254943847656, "policy_loss": -3.101170644122436e+17, "vf_loss": 636661737.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 492.0}}, "num_env_steps_sampled": 35640, "num_env_steps_trained": 35640, "num_agent_steps_sampled": 35640, "num_agent_steps_trained": 35640}, "sampler_results": {"episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18896.091462996006, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.490598230348319, "mean_inference_ms": 0.2538988632491624, "mean_action_processing_ms": 0.05983795873228009, "mean_env_wait_ms": 1.6679548756807823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026454829206370343, "StateBufferConnector_ms": 0.001840639596033578, "ViewRequirementAgentConnector_ms": 0.045916287585942434}}, "episode_reward_max": -6377.451881447555, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -18896.091462996006, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6377.451881447555, -7109.0990623892685, -19464.10253338826, -19398.512449613216, -18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.490598230348319, "mean_inference_ms": 0.2538988632491624, "mean_action_processing_ms": 0.05983795873228009, "mean_env_wait_ms": 1.6679548756807823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026454829206370343, "StateBufferConnector_ms": 0.001840639596033578, "ViewRequirementAgentConnector_ms": 0.045916287585942434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35640, "num_agent_steps_trained": 35640, "num_env_steps_sampled": 35640, "num_env_steps_trained": 35640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 155.77248936425138, "num_env_steps_trained_throughput_per_sec": 155.77248936425138, "timesteps_total": 35640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 35640, "timers": {"training_iteration_time_ms": 2280.807, "sample_time_ms": 2273.414, "load_time_ms": 0.223, "load_throughput": 1617687.422, "learn_time_ms": 6.58, "learn_throughput": 54714.459, "synch_weights_time_ms": 0.552}, "counters": {"num_env_steps_sampled": 35640, "num_env_steps_trained": 35640, "num_agent_steps_sampled": 35640, "num_agent_steps_trained": 35640}, "done": false, "episodes_total": 99, "training_iteration": 20, "trial_id": "41fd7_00000", "date": "2023-07-25_16-54-37", "timestamp": 1690293277, "time_this_iter_s": 11.557824850082397, "time_total_s": 226.07353615760803, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 226.07353615760803, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 26.36875, "ram_util_percent": 79.18125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.333333333333333e-05, "entropy_coeff": 0.1, "policy_entropy": -273.42540283203124, "policy_loss": -4.610677371805565e+17, "vf_loss": 594260000.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 517.0}}, "num_env_steps_sampled": 37440, "num_env_steps_trained": 37440, "num_agent_steps_sampled": 37440, "num_agent_steps_trained": 37440}, "sampler_results": {"episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19127.923972471413, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4890043222710645, "mean_inference_ms": 0.25393674155782586, "mean_action_processing_ms": 0.059831063794942414, "mean_env_wait_ms": 1.6205887627370514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002639293670654297, "StateBufferConnector_ms": 0.0018379688262939453, "ViewRequirementAgentConnector_ms": 0.045839786529541016}}, "episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19127.923972471413, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-18726.875225731746, -19255.75584207298, -19577.998925769785, -18947.188628231434, -19009.526549984403, -18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4890043222710645, "mean_inference_ms": 0.25393674155782586, "mean_action_processing_ms": 0.059831063794942414, "mean_env_wait_ms": 1.6205887627370514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002639293670654297, "StateBufferConnector_ms": 0.0018379688262939453, "ViewRequirementAgentConnector_ms": 0.045839786529541016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37440, "num_agent_steps_trained": 37440, "num_env_steps_sampled": 37440, "num_env_steps_trained": 37440, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.324682821314, "num_env_steps_trained_throughput_per_sec": 161.324682821314, "timesteps_total": 37440, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 37440, "timers": {"training_iteration_time_ms": 2271.283, "sample_time_ms": 2263.815, "load_time_ms": 0.224, "load_throughput": 1603940.344, "learn_time_ms": 6.634, "learn_throughput": 54267.293, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 37440, "num_env_steps_trained": 37440, "num_agent_steps_sampled": 37440, "num_agent_steps_trained": 37440}, "done": false, "episodes_total": 104, "training_iteration": 21, "trial_id": "41fd7_00000", "date": "2023-07-25_16-54-48", "timestamp": 1690293288, "time_this_iter_s": 11.159633874893188, "time_total_s": 237.23317003250122, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 237.23317003250122, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.09375, "ram_util_percent": 76.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-05, "entropy_coeff": 0.1, "policy_entropy": -273.42559204101565, "policy_loss": -4.856473043987661e+17, "vf_loss": 611124921.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 543.0, "diff_num_grad_updates_vs_sampler_policy": 542.0}}, "num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240}, "sampler_results": {"episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19131.442440828752, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445, -19885.73984733588, -18476.80582808132, -19296.705344094073, -18914.699083586755, -19295.241904426428], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.483503354703122, "mean_inference_ms": 0.2535855346372942, "mean_action_processing_ms": 0.059780269570770185, "mean_env_wait_ms": 1.5944229122342954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002650022506713867, "StateBufferConnector_ms": 0.0018384456634521484, "ViewRequirementAgentConnector_ms": 0.045949459075927734}}, "episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19131.442440828752, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-18773.400064154725, -18932.871470148144, -18842.974632183556, -18553.122837052135, -19190.9555783876, -18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445, -19885.73984733588, -18476.80582808132, -19296.705344094073, -18914.699083586755, -19295.241904426428], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.483503354703122, "mean_inference_ms": 0.2535855346372942, "mean_action_processing_ms": 0.059780269570770185, "mean_env_wait_ms": 1.5944229122342954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002650022506713867, "StateBufferConnector_ms": 0.0018384456634521484, "ViewRequirementAgentConnector_ms": 0.045949459075927734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240, "num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 155.73987385142897, "num_env_steps_trained_throughput_per_sec": 155.73987385142897, "timesteps_total": 39240, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 39240, "timers": {"training_iteration_time_ms": 2271.525, "sample_time_ms": 2264.222, "load_time_ms": 0.225, "load_throughput": 1597661.031, "learn_time_ms": 6.495, "learn_throughput": 55427.057, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 39240, "num_env_steps_trained": 39240, "num_agent_steps_sampled": 39240, "num_agent_steps_trained": 39240}, "done": false, "episodes_total": 109, "training_iteration": 22, "trial_id": "41fd7_00000", "date": "2023-07-25_16-55-00", "timestamp": 1690293300, "time_this_iter_s": 11.560084342956543, "time_total_s": 248.79325437545776, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 248.79325437545776, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.488235294117647, "ram_util_percent": 76.05882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -273.4252563476563, "policy_loss": -2.188785783259603e+17, "vf_loss": 614258380.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 568.0, "diff_num_grad_updates_vs_sampler_policy": 567.0}}, "num_env_steps_sampled": 41040, "num_env_steps_trained": 41040, "num_agent_steps_sampled": 41040, "num_agent_steps_trained": 41040}, "sampler_results": {"episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19147.10199804336, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445, -19885.73984733588, -18476.80582808132, -19296.705344094073, -18914.699083586755, -19295.241904426428, -19025.258975516, -19130.95431120568, -19235.20865808711, -19239.59142484659, -19228.266933731367], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.479209270504717, "mean_inference_ms": 0.2531991981609913, "mean_action_processing_ms": 0.05972442324272951, "mean_env_wait_ms": 1.5782220996819571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002637624740600586, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.04580497741699219}}, "episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19147.10199804336, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-18458.405976733862, -18900.09945582464, -19395.33878911646, -19075.669137121567, -19400.790688951307, -19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445, -19885.73984733588, -18476.80582808132, -19296.705344094073, -18914.699083586755, -19295.241904426428, -19025.258975516, -19130.95431120568, -19235.20865808711, -19239.59142484659, -19228.266933731367], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.479209270504717, "mean_inference_ms": 0.2531991981609913, "mean_action_processing_ms": 0.05972442324272951, "mean_env_wait_ms": 1.5782220996819571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002637624740600586, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.04580497741699219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41040, "num_agent_steps_trained": 41040, "num_env_steps_sampled": 41040, "num_env_steps_trained": 41040, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 161.0032712055286, "num_env_steps_trained_throughput_per_sec": 161.0032712055286, "timesteps_total": 41040, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 41040, "timers": {"training_iteration_time_ms": 2273.752, "sample_time_ms": 2266.47, "load_time_ms": 0.225, "load_throughput": 1597323.009, "learn_time_ms": 6.483, "learn_throughput": 55526.32, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 41040, "num_env_steps_trained": 41040, "num_agent_steps_sampled": 41040, "num_agent_steps_trained": 41040}, "done": false, "episodes_total": 114, "training_iteration": 23, "trial_id": "41fd7_00000", "date": "2023-07-25_16-55-11", "timestamp": 1690293311, "time_this_iter_s": 11.181928873062134, "time_total_s": 259.9751832485199, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 259.9751832485199, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 27.826666666666664, "ram_util_percent": 67.50666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8333333333333335e-05, "entropy_coeff": 0.1, "policy_entropy": -273.4252685546875, "policy_loss": -2.1525219150409565e+17, "vf_loss": 608317337.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 592.0}}, "num_env_steps_sampled": 42840, "num_env_steps_trained": 42840, "num_agent_steps_sampled": 42840, "num_agent_steps_trained": 42840}, "sampler_results": {"episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19145.788348275753, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445, -19885.73984733588, -18476.80582808132, -19296.705344094073, -18914.699083586755, -19295.241904426428, -19025.258975516, -19130.95431120568, -19235.20865808711, -19239.59142484659, -19228.266933731367, -19094.519929398648, -18100.523971720995, -19672.694338722453, -19213.70361610527, -19017.497215039737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.475378145747829, "mean_inference_ms": 0.25287909970243944, "mean_action_processing_ms": 0.059679089727898135, "mean_env_wait_ms": 1.566938859084439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002632617950439453, "StateBufferConnector_ms": 0.001833200454711914, "ViewRequirementAgentConnector_ms": 0.04578828811645508}}, "episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19145.788348275753, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19634.611543103645, -19750.703104079483, -19955.35158449209, -19539.88341539301, -19788.060085657144, -19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445, -19885.73984733588, -18476.80582808132, -19296.705344094073, -18914.699083586755, -19295.241904426428, -19025.258975516, -19130.95431120568, -19235.20865808711, -19239.59142484659, -19228.266933731367, -19094.519929398648, -18100.523971720995, -19672.694338722453, -19213.70361610527, -19017.497215039737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.475378145747829, "mean_inference_ms": 0.25287909970243944, "mean_action_processing_ms": 0.059679089727898135, "mean_env_wait_ms": 1.566938859084439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002632617950439453, "StateBufferConnector_ms": 0.001833200454711914, "ViewRequirementAgentConnector_ms": 0.04578828811645508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42840, "num_agent_steps_trained": 42840, "num_env_steps_sampled": 42840, "num_env_steps_trained": 42840, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 156.34984812329893, "num_env_steps_trained_throughput_per_sec": 156.34984812329893, "timesteps_total": 42840, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 42840, "timers": {"training_iteration_time_ms": 2269.243, "sample_time_ms": 2255.292, "load_time_ms": 0.227, "load_throughput": 1587582.21, "learn_time_ms": 13.101, "learn_throughput": 27478.557, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 42840, "num_env_steps_trained": 42840, "num_agent_steps_sampled": 42840, "num_agent_steps_trained": 42840}, "done": false, "episodes_total": 119, "training_iteration": 24, "trial_id": "41fd7_00000", "date": "2023-07-25_16-55-23", "timestamp": 1690293323, "time_this_iter_s": 11.515155792236328, "time_total_s": 271.4903390407562, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 271.4903390407562, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.470588235294116, "ram_util_percent": 70.39411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2e-05, "entropy_coeff": 0.1, "policy_entropy": -273.4291564941406, "policy_loss": -2.0353903857183456e+17, "vf_loss": 678413510.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 618.0, "diff_num_grad_updates_vs_sampler_policy": 617.0}}, "num_env_steps_sampled": 44640, "num_env_steps_trained": 44640, "num_agent_steps_sampled": 44640, "num_agent_steps_trained": 44640}, "sampler_results": {"episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19125.603956179522, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445, -19885.73984733588, -18476.80582808132, -19296.705344094073, -18914.699083586755, -19295.241904426428, -19025.258975516, -19130.95431120568, -19235.20865808711, -19239.59142484659, -19228.266933731367, -19094.519929398648, -18100.523971720995, -19672.694338722453, -19213.70361610527, -19017.497215039737, -18852.01800959372, -18877.202958058504, -19475.548543173492, -19306.821359566402, -20138.57965270989], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.472212826681234, "mean_inference_ms": 0.2526154736644537, "mean_action_processing_ms": 0.05964510216204896, "mean_env_wait_ms": 1.558582500035604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026366710662841797, "StateBufferConnector_ms": 0.001840353012084961, "ViewRequirementAgentConnector_ms": 0.045907020568847656}}, "episode_reward_max": -17836.90595773361, "episode_reward_min": -20290.00944351614, "episode_reward_mean": -19125.603956179522, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19578.07030660908, -19600.49577208559, -18418.99029642554, -19338.192524795322, -19689.904218586908, -19876.321784882217, -18977.520091524, -19042.288140073273, -19405.920415042216, -18558.312295470463, -18562.808547536042, -20290.00944351614, -19315.67062493697, -19553.60290395464, -18836.614042768113, -19354.419531798914, -19671.18488637887, -19186.694321374904, -19173.38657916551, -19538.20032571928, -19593.6055742555, -19385.717156967276, -18820.185496771544, -19190.19025600897, -20025.237674807617, -18972.781641158726, -18731.489373482582, -18634.514723492743, -18345.628610534077, -18564.128370486473, -19111.61350984422, -19638.369827771672, -18421.525946708975, -19475.19741789173, -18260.439547166137, -18819.826715537314, -18979.47237782404, -19066.35717907528, -18886.79437783476, -19449.320769286034, -19532.280491588393, -19116.844301852685, -18236.259586360626, -18646.64363637714, -19081.53234493515, -19117.619032104067, -19865.52263833299, -19257.813030872992, -18388.449139175947, -18432.37819932491, -18701.959848582977, -18148.12801055743, -18502.422917368, -19671.37968124245, -18795.671158068457, -19030.659643473664, -18935.954997048455, -19323.884262249943, -19588.10815053134, -19519.115364514408, -19624.983293832527, -19297.520747030154, -18627.641865647412, -19506.241353959384, -19604.04375830739, -19763.16549438886, -19053.572113525923, -19691.266394030965, -19022.07548839062, -19258.580300276055, -18326.897561890437, -19054.547130422805, -18771.646307136074, -19154.610754890906, -19663.88277773551, -19617.432783708013, -17836.90595773361, -19004.615219608713, -19356.024041930177, -18613.53033439445, -19885.73984733588, -18476.80582808132, -19296.705344094073, -18914.699083586755, -19295.241904426428, -19025.258975516, -19130.95431120568, -19235.20865808711, -19239.59142484659, -19228.266933731367, -19094.519929398648, -18100.523971720995, -19672.694338722453, -19213.70361610527, -19017.497215039737, -18852.01800959372, -18877.202958058504, -19475.548543173492, -19306.821359566402, -20138.57965270989], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.472212826681234, "mean_inference_ms": 0.2526154736644537, "mean_action_processing_ms": 0.05964510216204896, "mean_env_wait_ms": 1.558582500035604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026366710662841797, "StateBufferConnector_ms": 0.001840353012084961, "ViewRequirementAgentConnector_ms": 0.045907020568847656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44640, "num_agent_steps_trained": 44640, "num_env_steps_sampled": 44640, "num_env_steps_trained": 44640, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 160.55009238106462, "num_env_steps_trained_throughput_per_sec": 160.55009238106462, "timesteps_total": 44640, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 44640, "timers": {"training_iteration_time_ms": 2272.399, "sample_time_ms": 2258.434, "load_time_ms": 0.222, "load_throughput": 1622031.84, "learn_time_ms": 13.099, "learn_throughput": 27482.308, "synch_weights_time_ms": 0.607}, "counters": {"num_env_steps_sampled": 44640, "num_env_steps_trained": 44640, "num_agent_steps_sampled": 44640, "num_agent_steps_trained": 44640}, "done": false, "episodes_total": 124, "training_iteration": 25, "trial_id": "41fd7_00000", "date": "2023-07-25_16-55-34", "timestamp": 1690293334, "time_this_iter_s": 11.213741779327393, "time_total_s": 282.7040808200836, "pid": 71560, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[0, 0.003], [5400, 0.001], [10800, 0.00075], [16200, 0.0005], [21600, 0.00025], [27000, 0.0001], [32400, 7.5e-05], [37800, 5e-05], [43200, 2.5e-05], [48600, 1e-05], [54000, 7.5e-06], [59400, 5e-06], [64800, 2.5e-06], [70200, 1e-06], [75600, 5e-07], [81000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x177896310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 282.7040808200836, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.84375, "ram_util_percent": 78.18125}}
