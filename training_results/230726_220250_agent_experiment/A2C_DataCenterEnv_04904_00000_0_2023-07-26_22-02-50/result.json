{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -346.2022644042969, "policy_loss": -10842640.3, "vf_loss": 2686217.075}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 130560, "num_env_steps_trained": 130560, "num_agent_steps_sampled": 130560, "num_agent_steps_trained": 130560}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -1357.518857687471, "episode_reward_mean": -1290.8018913680667, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.355719115533397, "mean_inference_ms": 0.3775332836394614, "mean_action_processing_ms": 0.09197134534922273, "mean_env_wait_ms": 3.6676563012390417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512700398763021, "StateBufferConnector_ms": 0.0027577082316080728, "ViewRequirementAgentConnector_ms": 0.06878376007080078}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -1357.518857687471, "episode_reward_mean": -1290.8018913680667, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.355719115533397, "mean_inference_ms": 0.3775332836394614, "mean_action_processing_ms": 0.09197134534922273, "mean_env_wait_ms": 3.6676563012390417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512700398763021, "StateBufferConnector_ms": 0.0027577082316080728, "ViewRequirementAgentConnector_ms": 0.06878376007080078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130560, "num_agent_steps_trained": 130560, "num_env_steps_sampled": 130560, "num_env_steps_trained": 130560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 86.38195707679847, "num_env_steps_trained_throughput_per_sec": 86.38195707679847, "timesteps_total": 130560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 130560, "timers": {"training_iteration_time_ms": 4167.521, "sample_time_ms": 4152.096, "load_time_ms": 0.441, "load_throughput": 816188.886, "learn_time_ms": 14.169, "learn_throughput": 25408.19, "synch_weights_time_ms": 0.767}, "counters": {"num_env_steps_sampled": 130560, "num_env_steps_trained": 130560, "num_agent_steps_sampled": 130560, "num_agent_steps_trained": 130560}, "done": false, "episodes_total": 896, "training_iteration": 181, "trial_id": "04904_00000", "date": "2023-07-26_22-03-09", "timestamp": 1690398189, "time_this_iter_s": 12.505100011825562, "time_total_s": 1981.456966161728, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.505100011825562, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.927777777777774, "ram_util_percent": 63.20555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.600555555555556e-05, "entropy_coeff": 0.05, "policy_entropy": -387.7222595214844, "policy_loss": -34000204.4, "vf_loss": 4439358.1}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -1576.7484358038387, "episode_reward_mean": -1384.4839311715314, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.370212196196774, "mean_inference_ms": 0.3772082939542614, "mean_action_processing_ms": 0.09172106052466754, "mean_env_wait_ms": 2.8215251622840722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038010733468191965, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06722722734723773}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -1576.7484358038387, "episode_reward_mean": -1384.4839311715314, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.370212196196774, "mean_inference_ms": 0.3772082939542614, "mean_action_processing_ms": 0.09172106052466754, "mean_env_wait_ms": 2.8215251622840722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038010733468191965, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06722722734723773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.07247523074425, "num_env_steps_trained_throughput_per_sec": 111.07247523074425, "timesteps_total": 132000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 3638.146, "sample_time_ms": 3625.13, "load_time_ms": 0.368, "load_throughput": 978761.559, "learn_time_ms": 11.849, "learn_throughput": 30383.46, "synch_weights_time_ms": 0.754}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 900, "training_iteration": 182, "trial_id": "04904_00000", "date": "2023-07-26_22-03-22", "timestamp": 1690398202, "time_this_iter_s": 12.96692705154419, "time_total_s": 1994.423893213272, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 25.47202706336975, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.84736842105263, "ram_util_percent": 63.2421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.400555555555556e-05, "entropy_coeff": 0.05, "policy_entropy": -442.4335144042969, "policy_loss": -57402105.2, "vf_loss": 166521536.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 133440, "num_env_steps_trained": 133440, "num_agent_steps_sampled": 133440, "num_agent_steps_trained": 133440}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -10070.702745493545, "episode_reward_mean": -2576.7621552828855, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.40136696227847, "mean_inference_ms": 0.3771468307450519, "mean_action_processing_ms": 0.09161198234777665, "mean_env_wait_ms": 2.4434515270593398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003946911204944958, "StateBufferConnector_ms": 0.0027331438931551847, "ViewRequirementAgentConnector_ms": 0.06693709980357777}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -10070.702745493545, "episode_reward_mean": -2576.7621552828855, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.40136696227847, "mean_inference_ms": 0.3771468307450519, "mean_action_processing_ms": 0.09161198234777665, "mean_env_wait_ms": 2.4434515270593398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003946911204944958, "StateBufferConnector_ms": 0.0027331438931551847, "ViewRequirementAgentConnector_ms": 0.06693709980357777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133440, "num_agent_steps_trained": 133440, "num_env_steps_sampled": 133440, "num_env_steps_trained": 133440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.87032976160602, "num_env_steps_trained_throughput_per_sec": 108.87032976160602, "timesteps_total": 133440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 133440, "timers": {"training_iteration_time_ms": 3259.557, "sample_time_ms": 3248.71, "load_time_ms": 0.306, "load_throughput": 1177440.299, "learn_time_ms": 9.78, "learn_throughput": 36808.823, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 133440, "num_env_steps_trained": 133440, "num_agent_steps_sampled": 133440, "num_agent_steps_trained": 133440}, "done": false, "episodes_total": 904, "training_iteration": 183, "trial_id": "04904_00000", "date": "2023-07-26_22-03-35", "timestamp": 1690398215, "time_this_iter_s": 13.229356050491333, "time_total_s": 2007.6532492637634, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 38.701383113861084, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.810526315789478, "ram_util_percent": 63.31578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.000555555555556e-05, "entropy_coeff": 0.05, "policy_entropy": -488.16553955078126, "policy_loss": -378130636.8, "vf_loss": 207590766.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 134520, "num_env_steps_trained": 134520, "num_agent_steps_sampled": 134520, "num_agent_steps_trained": 134520}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11576.801458057842, "episode_reward_mean": -4463.609759458778, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.422518520042627, "mean_inference_ms": 0.37686772847016664, "mean_action_processing_ms": 0.09152128867522588, "mean_env_wait_ms": 2.2724517592529625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037772314889090402, "StateBufferConnector_ms": 0.00272648675101144, "ViewRequirementAgentConnector_ms": 0.06649494171142578}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11576.801458057842, "episode_reward_mean": -4463.609759458778, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.422518520042627, "mean_inference_ms": 0.37686772847016664, "mean_action_processing_ms": 0.09152128867522588, "mean_env_wait_ms": 2.2724517592529625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037772314889090402, "StateBufferConnector_ms": 0.00272648675101144, "ViewRequirementAgentConnector_ms": 0.06649494171142578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134520, "num_agent_steps_trained": 134520, "num_env_steps_sampled": 134520, "num_env_steps_trained": 134520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.21591836207219, "num_env_steps_trained_throughput_per_sec": 107.21591836207219, "timesteps_total": 134520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 134520, "timers": {"training_iteration_time_ms": 3299.223, "sample_time_ms": 3288.424, "load_time_ms": 0.297, "load_throughput": 1213980.897, "learn_time_ms": 9.734, "learn_throughput": 36982.097, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 134520, "num_env_steps_trained": 134520, "num_agent_steps_sampled": 134520, "num_agent_steps_trained": 134520}, "done": false, "episodes_total": 907, "training_iteration": 184, "trial_id": "04904_00000", "date": "2023-07-26_22-03-46", "timestamp": 1690398226, "time_this_iter_s": 10.075536727905273, "time_total_s": 2017.7287859916687, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 48.77691984176636, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.62857142857143, "ram_util_percent": 63.16428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.600555555555555e-05, "entropy_coeff": 0.05, "policy_entropy": -543.1723754882812, "policy_loss": -1693931520.0, "vf_loss": 225595702.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 135600, "num_env_steps_trained": 135600, "num_agent_steps_sampled": 135600, "num_agent_steps_trained": 135600}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -5689.865974967755, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.440148082682004, "mean_inference_ms": 0.3765478174943824, "mean_action_processing_ms": 0.09144371436262536, "mean_env_wait_ms": 2.1480747494921597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003698292900534237, "StateBufferConnector_ms": 0.0027235816506778494, "ViewRequirementAgentConnector_ms": 0.06632243885713465}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -5689.865974967755, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.440148082682004, "mean_inference_ms": 0.3765478174943824, "mean_action_processing_ms": 0.09144371436262536, "mean_env_wait_ms": 2.1480747494921597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003698292900534237, "StateBufferConnector_ms": 0.0027235816506778494, "ViewRequirementAgentConnector_ms": 0.06632243885713465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135600, "num_agent_steps_trained": 135600, "num_env_steps_sampled": 135600, "num_env_steps_trained": 135600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.9444577047421, "num_env_steps_trained_throughput_per_sec": 106.9444577047421, "timesteps_total": 135600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 135600, "timers": {"training_iteration_time_ms": 3339.845, "sample_time_ms": 3329.218, "load_time_ms": 0.291, "load_throughput": 1237055.088, "learn_time_ms": 9.59, "learn_throughput": 37539.267, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 135600, "num_env_steps_trained": 135600, "num_agent_steps_sampled": 135600, "num_agent_steps_trained": 135600}, "done": false, "episodes_total": 910, "training_iteration": 185, "trial_id": "04904_00000", "date": "2023-07-26_22-03-56", "timestamp": 1690398236, "time_this_iter_s": 10.101168155670166, "time_total_s": 2027.8299541473389, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.87808799743652, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.207142857142856, "ram_util_percent": 63.15714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.265648148148149e-05, "entropy_coeff": 0.05, "policy_entropy": -622.4275268554687, "policy_loss": -2484578534.4, "vf_loss": 214337040.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 137040, "num_env_steps_trained": 137040, "num_agent_steps_sampled": 137040, "num_agent_steps_trained": 137040}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -6764.3652796998285, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.45651782929895, "mean_inference_ms": 0.3760858977233188, "mean_action_processing_ms": 0.09134914255212101, "mean_env_wait_ms": 2.018892116847566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036432629539853052, "StateBufferConnector_ms": 0.0026805060250418527, "ViewRequirementAgentConnector_ms": 0.06608622414725167}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -6764.3652796998285, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.45651782929895, "mean_inference_ms": 0.3760858977233188, "mean_action_processing_ms": 0.09134914255212101, "mean_env_wait_ms": 2.018892116847566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036432629539853052, "StateBufferConnector_ms": 0.0026805060250418527, "ViewRequirementAgentConnector_ms": 0.06608622414725167}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137040, "num_agent_steps_trained": 137040, "num_env_steps_sampled": 137040, "num_env_steps_trained": 137040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.71809643337396, "num_env_steps_trained_throughput_per_sec": 109.71809643337396, "timesteps_total": 137040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 137040, "timers": {"training_iteration_time_ms": 3329.625, "sample_time_ms": 3318.954, "load_time_ms": 0.295, "load_throughput": 1219471.362, "learn_time_ms": 9.614, "learn_throughput": 37443.849, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 137040, "num_env_steps_trained": 137040, "num_agent_steps_sampled": 137040, "num_agent_steps_trained": 137040}, "done": false, "episodes_total": 914, "training_iteration": 186, "trial_id": "04904_00000", "date": "2023-07-26_22-04-09", "timestamp": 1690398249, "time_this_iter_s": 13.12716293334961, "time_total_s": 2040.9571170806885, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 72.00525093078613, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.66315789473684, "ram_util_percent": 63.20526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.165648148148148e-05, "entropy_coeff": 0.05, "policy_entropy": -673.5978759765625, "policy_loss": -7664888704.0, "vf_loss": 213878032.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 118.0, "diff_num_grad_updates_vs_sampler_policy": 117.0}}, "num_env_steps_sampled": 138120, "num_env_steps_trained": 138120, "num_agent_steps_sampled": 138120, "num_agent_steps_trained": 138120}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -7329.862640209577, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.467324914995079, "mean_inference_ms": 0.37578516709794024, "mean_action_processing_ms": 0.09128666415965896, "mean_env_wait_ms": 1.94423515279081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741184870402018, "StateBufferConnector_ms": 0.0026494264602661133, "ViewRequirementAgentConnector_ms": 0.06601810455322266}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -7329.862640209577, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.467324914995079, "mean_inference_ms": 0.37578516709794024, "mean_action_processing_ms": 0.09128666415965896, "mean_env_wait_ms": 1.94423515279081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741184870402018, "StateBufferConnector_ms": 0.0026494264602661133, "ViewRequirementAgentConnector_ms": 0.06601810455322266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138120, "num_agent_steps_trained": 138120, "num_env_steps_sampled": 138120, "num_env_steps_trained": 138120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.94357950464534, "num_env_steps_trained_throughput_per_sec": 107.94357950464534, "timesteps_total": 138120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 138120, "timers": {"training_iteration_time_ms": 3322.834, "sample_time_ms": 3312.152, "load_time_ms": 0.297, "load_throughput": 1213785.723, "learn_time_ms": 9.643, "learn_throughput": 37331.833, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 138120, "num_env_steps_trained": 138120, "num_agent_steps_sampled": 138120, "num_agent_steps_trained": 138120}, "done": false, "episodes_total": 917, "training_iteration": 187, "trial_id": "04904_00000", "date": "2023-07-26_22-04-19", "timestamp": 1690398259, "time_this_iter_s": 10.007872104644775, "time_total_s": 2050.9649891853333, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 82.01312303543091, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.53571428571429, "ram_util_percent": 63.30714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.6989814814814816e-05, "entropy_coeff": 0.05, "policy_entropy": -730.420068359375, "policy_loss": -17512342540.89375, "vf_loss": 207871364.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 138.0, "diff_num_grad_updates_vs_sampler_policy": 137.0}}, "num_env_steps_sampled": 139560, "num_env_steps_trained": 139560, "num_agent_steps_sampled": 139560, "num_agent_steps_trained": 139560}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -7891.333423033604, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4770300370980225, "mean_inference_ms": 0.37544235941159965, "mean_action_processing_ms": 0.0912229610479637, "mean_env_wait_ms": 1.8640841202479863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037789344787597656, "StateBufferConnector_ms": 0.002649000712803432, "ViewRequirementAgentConnector_ms": 0.06586313247680664}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -7891.333423033604, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4770300370980225, "mean_inference_ms": 0.37544235941159965, "mean_action_processing_ms": 0.0912229610479637, "mean_env_wait_ms": 1.8640841202479863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037789344787597656, "StateBufferConnector_ms": 0.002649000712803432, "ViewRequirementAgentConnector_ms": 0.06586313247680664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139560, "num_agent_steps_trained": 139560, "num_env_steps_sampled": 139560, "num_env_steps_trained": 139560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.15147106230745, "num_env_steps_trained_throughput_per_sec": 109.15147106230745, "timesteps_total": 139560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 139560, "timers": {"training_iteration_time_ms": 3306.534, "sample_time_ms": 3295.838, "load_time_ms": 0.297, "load_throughput": 1210574.393, "learn_time_ms": 9.654, "learn_throughput": 37289.331, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 139560, "num_env_steps_trained": 139560, "num_agent_steps_sampled": 139560, "num_agent_steps_trained": 139560}, "done": false, "episodes_total": 921, "training_iteration": 188, "trial_id": "04904_00000", "date": "2023-07-26_22-04-32", "timestamp": 1690398272, "time_this_iter_s": 13.195172786712646, "time_total_s": 2064.160161972046, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 95.20829582214355, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.37368421052631, "ram_util_percent": 63.27368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.598981481481481e-05, "entropy_coeff": 0.05, "policy_entropy": -759.4218994140625, "policy_loss": -22224618496.0, "vf_loss": 214751899.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 152.0}}, "num_env_steps_sampled": 140640, "num_env_steps_trained": 140640, "num_agent_steps_sampled": 140640, "num_agent_steps_trained": 140640}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -8207.22495539491, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.484097853530441, "mean_inference_ms": 0.375240920564024, "mean_action_processing_ms": 0.09118687598604587, "mean_env_wait_ms": 1.814560717067801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037500935216103833, "StateBufferConnector_ms": 0.002651060781171245, "ViewRequirementAgentConnector_ms": 0.06593581168882308}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -8207.22495539491, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.484097853530441, "mean_inference_ms": 0.375240920564024, "mean_action_processing_ms": 0.09118687598604587, "mean_env_wait_ms": 1.814560717067801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037500935216103833, "StateBufferConnector_ms": 0.002651060781171245, "ViewRequirementAgentConnector_ms": 0.06593581168882308}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140640, "num_agent_steps_trained": 140640, "num_env_steps_sampled": 140640, "num_env_steps_trained": 140640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.82058710489721, "num_env_steps_trained_throughput_per_sec": 107.82058710489721, "timesteps_total": 140640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 140640, "timers": {"training_iteration_time_ms": 3321.442, "sample_time_ms": 3310.781, "load_time_ms": 0.3, "load_throughput": 1201232.649, "learn_time_ms": 9.618, "learn_throughput": 37431.04, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 140640, "num_env_steps_trained": 140640, "num_agent_steps_sampled": 140640, "num_agent_steps_trained": 140640}, "done": false, "episodes_total": 924, "training_iteration": 189, "trial_id": "04904_00000", "date": "2023-07-26_22-04-42", "timestamp": 1690398282, "time_this_iter_s": 10.019130229949951, "time_total_s": 2074.179292201996, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 105.2274260520935, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.66428571428571, "ram_util_percent": 63.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -782.1456787109375, "policy_loss": -29559378329.6, "vf_loss": 218979912.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 168.0, "diff_num_grad_updates_vs_sampler_policy": 167.0}}, "num_env_steps_sampled": 141720, "num_env_steps_trained": 141720, "num_agent_steps_sampled": 141720, "num_agent_steps_trained": 141720}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -8481.878370940563, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.49109073417138, "mean_inference_ms": 0.3750569385968827, "mean_action_processing_ms": 0.09115294136435313, "mean_env_wait_ms": 1.772247611150174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037109150606043197, "StateBufferConnector_ms": 0.002659769619212431, "ViewRequirementAgentConnector_ms": 0.06590871249928194}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -8481.878370940563, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.49109073417138, "mean_inference_ms": 0.3750569385968827, "mean_action_processing_ms": 0.09115294136435313, "mean_env_wait_ms": 1.772247611150174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037109150606043197, "StateBufferConnector_ms": 0.002659769619212431, "ViewRequirementAgentConnector_ms": 0.06590871249928194}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141720, "num_agent_steps_trained": 141720, "num_env_steps_sampled": 141720, "num_env_steps_trained": 141720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.65751469026893, "num_env_steps_trained_throughput_per_sec": 106.65751469026893, "timesteps_total": 141720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 141720, "timers": {"training_iteration_time_ms": 3333.506, "sample_time_ms": 3322.896, "load_time_ms": 0.303, "load_throughput": 1187814.223, "learn_time_ms": 9.563, "learn_throughput": 37646.056, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 141720, "num_env_steps_trained": 141720, "num_agent_steps_sampled": 141720, "num_agent_steps_trained": 141720}, "done": false, "episodes_total": 927, "training_iteration": 190, "trial_id": "04904_00000", "date": "2023-07-26_22-04-52", "timestamp": 1690398292, "time_this_iter_s": 10.128382921218872, "time_total_s": 2084.3076751232147, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 115.35580897331238, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.08666666666667, "ram_util_percent": 63.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -807.8131958007813, "policy_loss": -15109912166.4, "vf_loss": 214506883.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 188.0, "diff_num_grad_updates_vs_sampler_policy": 187.0}}, "num_env_steps_sampled": 143160, "num_env_steps_trained": 143160, "num_agent_steps_sampled": 143160, "num_agent_steps_trained": 143160}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -8788.012205382127, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.498641606825949, "mean_inference_ms": 0.3748393642506579, "mean_action_processing_ms": 0.09111327943949181, "mean_env_wait_ms": 1.7236058178763434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036678816142835117, "StateBufferConnector_ms": 0.0026684058339972246, "ViewRequirementAgentConnector_ms": 0.0658047826666581}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -8788.012205382127, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.498641606825949, "mean_inference_ms": 0.3748393642506579, "mean_action_processing_ms": 0.09111327943949181, "mean_env_wait_ms": 1.7236058178763434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036678816142835117, "StateBufferConnector_ms": 0.0026684058339972246, "ViewRequirementAgentConnector_ms": 0.0658047826666581}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143160, "num_agent_steps_trained": 143160, "num_env_steps_sampled": 143160, "num_env_steps_trained": 143160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.96729785501516, "num_env_steps_trained_throughput_per_sec": 108.96729785501516, "timesteps_total": 143160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 143160, "timers": {"training_iteration_time_ms": 3335.735, "sample_time_ms": 3325.153, "load_time_ms": 0.304, "load_throughput": 1184274.071, "learn_time_ms": 9.537, "learn_throughput": 37747.415, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 143160, "num_env_steps_trained": 143160, "num_agent_steps_sampled": 143160, "num_agent_steps_trained": 143160}, "done": false, "episodes_total": 931, "training_iteration": 191, "trial_id": "04904_00000", "date": "2023-07-26_22-05-05", "timestamp": 1690398305, "time_this_iter_s": 13.217494010925293, "time_total_s": 2097.52516913414, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 128.57330298423767, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 23.19473684210526, "ram_util_percent": 63.26315789473683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -832.808740234375, "policy_loss": -55151096627.2, "vf_loss": 223532905.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 208.0, "diff_num_grad_updates_vs_sampler_policy": 207.0}}, "num_env_steps_sampled": 144600, "num_env_steps_trained": 144600, "num_agent_steps_sampled": 144600, "num_agent_steps_trained": 144600}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9029.452158412696, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.505696813723331, "mean_inference_ms": 0.37463515459476315, "mean_action_processing_ms": 0.09107679543310414, "mean_env_wait_ms": 1.6824996948190272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037670135498046875, "StateBufferConnector_ms": 0.0026674497695196244, "ViewRequirementAgentConnector_ms": 0.06566672098068964}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9029.452158412696, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.505696813723331, "mean_inference_ms": 0.37463515459476315, "mean_action_processing_ms": 0.09107679543310414, "mean_env_wait_ms": 1.6824996948190272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037670135498046875, "StateBufferConnector_ms": 0.0026674497695196244, "ViewRequirementAgentConnector_ms": 0.06566672098068964}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144600, "num_agent_steps_trained": 144600, "num_env_steps_sampled": 144600, "num_env_steps_trained": 144600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.48185533418811, "num_env_steps_trained_throughput_per_sec": 107.48185533418811, "timesteps_total": 144600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 144600, "timers": {"training_iteration_time_ms": 3339.084, "sample_time_ms": 3328.509, "load_time_ms": 0.303, "load_throughput": 1188281.609, "learn_time_ms": 9.533, "learn_throughput": 37761.953, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 144600, "num_env_steps_trained": 144600, "num_agent_steps_sampled": 144600, "num_agent_steps_trained": 144600}, "done": false, "episodes_total": 935, "training_iteration": 192, "trial_id": "04904_00000", "date": "2023-07-26_22-05-19", "timestamp": 1690398319, "time_this_iter_s": 13.400261878967285, "time_total_s": 2110.9254310131073, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 141.97356486320496, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 20.568421052631578, "ram_util_percent": 63.45789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -852.19287109375, "policy_loss": -49924716544.0, "vf_loss": 212240009.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 223.0, "diff_num_grad_updates_vs_sampler_policy": 222.0}}, "num_env_steps_sampled": 145680, "num_env_steps_trained": 145680, "num_agent_steps_sampled": 145680, "num_agent_steps_trained": 145680}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9191.463834861304, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.510227326234345, "mean_inference_ms": 0.37449711118564566, "mean_action_processing_ms": 0.09105187679861791, "mean_env_wait_ms": 1.6559149218284122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003746880425347222, "StateBufferConnector_ms": 0.0026856528388129342, "ViewRequirementAgentConnector_ms": 0.06583425733778211}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9191.463834861304, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.510227326234345, "mean_inference_ms": 0.37449711118564566, "mean_action_processing_ms": 0.09105187679861791, "mean_env_wait_ms": 1.6559149218284122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003746880425347222, "StateBufferConnector_ms": 0.0026856528388129342, "ViewRequirementAgentConnector_ms": 0.06583425733778211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145680, "num_agent_steps_trained": 145680, "num_env_steps_sampled": 145680, "num_env_steps_trained": 145680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.83716585487717, "num_env_steps_trained_throughput_per_sec": 107.83716585487717, "timesteps_total": 145680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 145680, "timers": {"training_iteration_time_ms": 3327.734, "sample_time_ms": 3317.142, "load_time_ms": 0.3, "load_throughput": 1201806.304, "learn_time_ms": 9.562, "learn_throughput": 37647.746, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 145680, "num_env_steps_trained": 145680, "num_agent_steps_sampled": 145680, "num_agent_steps_trained": 145680}, "done": false, "episodes_total": 938, "training_iteration": 193, "trial_id": "04904_00000", "date": "2023-07-26_22-05-29", "timestamp": 1690398329, "time_this_iter_s": 10.017843961715698, "time_total_s": 2120.943274974823, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 151.99140882492065, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 20.78571428571428, "ram_util_percent": 63.435714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -871.5486938476563, "policy_loss": -78380927385.6, "vf_loss": 215194099.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 238.0, "diff_num_grad_updates_vs_sampler_policy": 237.0}}, "num_env_steps_sampled": 146760, "num_env_steps_trained": 146760, "num_agent_steps_sampled": 146760, "num_agent_steps_trained": 146760}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9323.999339776257, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514300802060066, "mean_inference_ms": 0.3743751412760523, "mean_action_processing_ms": 0.09102983422282211, "mean_env_wait_ms": 1.6321988186143033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037784377733866372, "StateBufferConnector_ms": 0.002683699131011963, "ViewRequirementAgentConnector_ms": 0.06575932105382283}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9323.999339776257, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.514300802060066, "mean_inference_ms": 0.3743751412760523, "mean_action_processing_ms": 0.09102983422282211, "mean_env_wait_ms": 1.6321988186143033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037784377733866372, "StateBufferConnector_ms": 0.002683699131011963, "ViewRequirementAgentConnector_ms": 0.06575932105382283}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146760, "num_agent_steps_trained": 146760, "num_env_steps_sampled": 146760, "num_env_steps_trained": 146760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.64311732644325, "num_env_steps_trained_throughput_per_sec": 107.64311732644325, "timesteps_total": 146760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 146760, "timers": {"training_iteration_time_ms": 3344.573, "sample_time_ms": 3333.89, "load_time_ms": 0.298, "load_throughput": 1208056.196, "learn_time_ms": 9.638, "learn_throughput": 37350.948, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 146760, "num_env_steps_trained": 146760, "num_agent_steps_sampled": 146760, "num_agent_steps_trained": 146760}, "done": false, "episodes_total": 941, "training_iteration": 194, "trial_id": "04904_00000", "date": "2023-07-26_22-05-39", "timestamp": 1690398339, "time_this_iter_s": 10.035668134689331, "time_total_s": 2130.9789431095123, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 162.02707695960999, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.3, "ram_util_percent": 63.521428571428565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -890.622216796875, "policy_loss": -71228081766.4, "vf_loss": 218677451.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 252.0}}, "num_env_steps_sampled": 147840, "num_env_steps_trained": 147840, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 147840}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9444.163186171312, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5183633091900814, "mean_inference_ms": 0.3742590269939723, "mean_action_processing_ms": 0.09100826175945739, "mean_env_wait_ms": 1.610744880662991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037506514904545804, "StateBufferConnector_ms": 0.0026964673808976716, "ViewRequirementAgentConnector_ms": 0.06576379140218098}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9444.163186171312, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5183633091900814, "mean_inference_ms": 0.3742590269939723, "mean_action_processing_ms": 0.09100826175945739, "mean_env_wait_ms": 1.610744880662991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037506514904545804, "StateBufferConnector_ms": 0.0026964673808976716, "ViewRequirementAgentConnector_ms": 0.06576379140218098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 147840, "num_env_steps_sampled": 147840, "num_env_steps_trained": 147840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.92423760465826, "num_env_steps_trained_throughput_per_sec": 106.92423760465826, "timesteps_total": 147840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 147840, "timers": {"training_iteration_time_ms": 3359.968, "sample_time_ms": 3349.237, "load_time_ms": 0.297, "load_throughput": 1212810.795, "learn_time_ms": 9.686, "learn_throughput": 37166.705, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 147840, "num_env_steps_trained": 147840, "num_agent_steps_sampled": 147840, "num_agent_steps_trained": 147840}, "done": false, "episodes_total": 944, "training_iteration": 195, "trial_id": "04904_00000", "date": "2023-07-26_22-05-49", "timestamp": 1690398349, "time_this_iter_s": 10.1033296585083, "time_total_s": 2141.0822727680206, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 172.1304066181183, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 21.48, "ram_util_percent": 63.373333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -909.2770751953125, "policy_loss": -105587451494.4, "vf_loss": 211867699.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 268.0, "diff_num_grad_updates_vs_sampler_policy": 267.0}}, "num_env_steps_sampled": 148920, "num_env_steps_trained": 148920, "num_agent_steps_sampled": 148920, "num_agent_steps_trained": 148920}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9544.939989949946, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5220377100100855, "mean_inference_ms": 0.37414889284176706, "mean_action_processing_ms": 0.09098804715921517, "mean_env_wait_ms": 1.5913350148222933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037210958975332754, "StateBufferConnector_ms": 0.002689714784975405, "ViewRequirementAgentConnector_ms": 0.06570197917796948}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9544.939989949946, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5220377100100855, "mean_inference_ms": 0.37414889284176706, "mean_action_processing_ms": 0.09098804715921517, "mean_env_wait_ms": 1.5913350148222933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037210958975332754, "StateBufferConnector_ms": 0.002689714784975405, "ViewRequirementAgentConnector_ms": 0.06570197917796948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148920, "num_agent_steps_trained": 148920, "num_env_steps_sampled": 148920, "num_env_steps_trained": 148920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.77091219450384, "num_env_steps_trained_throughput_per_sec": 107.77091219450384, "timesteps_total": 148920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 148920, "timers": {"training_iteration_time_ms": 3344.239, "sample_time_ms": 3333.563, "load_time_ms": 0.297, "load_throughput": 1211740.181, "learn_time_ms": 9.633, "learn_throughput": 37370.269, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 148920, "num_env_steps_trained": 148920, "num_agent_steps_sampled": 148920, "num_agent_steps_trained": 148920}, "done": false, "episodes_total": 947, "training_iteration": 196, "trial_id": "04904_00000", "date": "2023-07-26_22-05-59", "timestamp": 1690398359, "time_this_iter_s": 10.02380108833313, "time_total_s": 2151.1060738563538, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 182.15420770645142, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.814285714285713, "ram_util_percent": 63.19285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -927.5594604492187, "policy_loss": -143765960294.4, "vf_loss": 217960283.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 283.0, "diff_num_grad_updates_vs_sampler_policy": 282.0}}, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9640.53093656242, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525374458736445, "mean_inference_ms": 0.374048960264206, "mean_action_processing_ms": 0.09096961591251738, "mean_env_wait_ms": 1.5737745430564691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696742810701069, "StateBufferConnector_ms": 0.002685764379668654, "ViewRequirementAgentConnector_ms": 0.06571067006964433}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9640.53093656242, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525374458736445, "mean_inference_ms": 0.374048960264206, "mean_action_processing_ms": 0.09096961591251738, "mean_env_wait_ms": 1.5737745430564691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696742810701069, "StateBufferConnector_ms": 0.002685764379668654, "ViewRequirementAgentConnector_ms": 0.06571067006964433}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.3693773419989, "num_env_steps_trained_throughput_per_sec": 107.3693773419989, "timesteps_total": 150000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 3351.873, "sample_time_ms": 3341.188, "load_time_ms": 0.296, "load_throughput": 1214859.957, "learn_time_ms": 9.638, "learn_throughput": 37352.427, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "done": false, "episodes_total": 950, "training_iteration": 197, "trial_id": "04904_00000", "date": "2023-07-26_22-06-09", "timestamp": 1690398369, "time_this_iter_s": 10.061315774917603, "time_total_s": 2161.1673896312714, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 192.21552348136902, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 20.07857142857143, "ram_util_percent": 63.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -946.5009643554688, "policy_loss": -175982569062.4, "vf_loss": 216948284.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 298.0, "diff_num_grad_updates_vs_sampler_policy": 297.0}}, "num_env_steps_sampled": 151080, "num_env_steps_trained": 151080, "num_agent_steps_sampled": 151080, "num_agent_steps_trained": 151080}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9727.210085535658, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528739604535275, "mean_inference_ms": 0.37395437982024154, "mean_action_processing_ms": 0.09095192916864894, "mean_env_wait_ms": 1.5577770508267457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036760171254475913, "StateBufferConnector_ms": 0.0026837984720865884, "ViewRequirementAgentConnector_ms": 0.0656425952911377}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9727.210085535658, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528739604535275, "mean_inference_ms": 0.37395437982024154, "mean_action_processing_ms": 0.09095192916864894, "mean_env_wait_ms": 1.5577770508267457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036760171254475913, "StateBufferConnector_ms": 0.0026837984720865884, "ViewRequirementAgentConnector_ms": 0.0656425952911377}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151080, "num_agent_steps_trained": 151080, "num_env_steps_sampled": 151080, "num_env_steps_trained": 151080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.06118080672273, "num_env_steps_trained_throughput_per_sec": 106.06118080672273, "timesteps_total": 151080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 151080, "timers": {"training_iteration_time_ms": 3365.742, "sample_time_ms": 3355.163, "load_time_ms": 0.299, "load_throughput": 1205355.983, "learn_time_ms": 9.538, "learn_throughput": 37741.942, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 151080, "num_env_steps_trained": 151080, "num_agent_steps_sampled": 151080, "num_agent_steps_trained": 151080}, "done": false, "episodes_total": 953, "training_iteration": 198, "trial_id": "04904_00000", "date": "2023-07-26_22-06-19", "timestamp": 1690398379, "time_this_iter_s": 10.185450792312622, "time_total_s": 2171.352840423584, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 202.40097427368164, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.64666666666667, "ram_util_percent": 63.25333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -967.922607421875, "policy_loss": -158427447296.0, "vf_loss": 211965856.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 318.0, "diff_num_grad_updates_vs_sampler_policy": 317.0}}, "num_env_steps_sampled": 152520, "num_env_steps_trained": 152520, "num_agent_steps_sampled": 152520, "num_agent_steps_trained": 152520}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9818.494088725009, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53247076552768, "mean_inference_ms": 0.3738404447646251, "mean_action_processing_ms": 0.09092970734782743, "mean_env_wait_ms": 1.5380173762341003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037003308534622192, "StateBufferConnector_ms": 0.0026769936084747314, "ViewRequirementAgentConnector_ms": 0.06564110517501831}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9818.494088725009, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.53247076552768, "mean_inference_ms": 0.3738404447646251, "mean_action_processing_ms": 0.09092970734782743, "mean_env_wait_ms": 1.5380173762341003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037003308534622192, "StateBufferConnector_ms": 0.0026769936084747314, "ViewRequirementAgentConnector_ms": 0.06564110517501831}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152520, "num_agent_steps_trained": 152520, "num_env_steps_sampled": 152520, "num_env_steps_trained": 152520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.84753288456932, "num_env_steps_trained_throughput_per_sec": 109.84753288456932, "timesteps_total": 152520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 152520, "timers": {"training_iteration_time_ms": 3335.048, "sample_time_ms": 3324.41, "load_time_ms": 0.298, "load_throughput": 1209701.522, "learn_time_ms": 9.594, "learn_throughput": 37521.73, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 152520, "num_env_steps_trained": 152520, "num_agent_steps_sampled": 152520, "num_agent_steps_trained": 152520}, "done": false, "episodes_total": 957, "training_iteration": 199, "trial_id": "04904_00000", "date": "2023-07-26_22-06-33", "timestamp": 1690398393, "time_this_iter_s": 13.111906051635742, "time_total_s": 2184.4647464752197, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 215.51288032531738, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 22.79444444444444, "ram_util_percent": 63.24444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -984.4094970703125, "policy_loss": -118229795635.2, "vf_loss": 203091987.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 333.0, "diff_num_grad_updates_vs_sampler_policy": 332.0}}, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9878.0688552327, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5351075704611175, "mean_inference_ms": 0.37376114895401497, "mean_action_processing_ms": 0.09091408745656825, "mean_env_wait_ms": 1.5244385517038954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036780513934235076, "StateBufferConnector_ms": 0.002674202420818272, "ViewRequirementAgentConnector_ms": 0.06564126085879197}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9878.0688552327, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5351075704611175, "mean_inference_ms": 0.37376114895401497, "mean_action_processing_ms": 0.09091408745656825, "mean_env_wait_ms": 1.5244385517038954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036780513934235076, "StateBufferConnector_ms": 0.002674202420818272, "ViewRequirementAgentConnector_ms": 0.06564126085879197}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.98439823500385, "num_env_steps_trained_throughput_per_sec": 107.98439823500385, "timesteps_total": 153600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 153600, "timers": {"training_iteration_time_ms": 3329.319, "sample_time_ms": 3318.712, "load_time_ms": 0.297, "load_throughput": 1211448.524, "learn_time_ms": 9.563, "learn_throughput": 37644.93, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "done": false, "episodes_total": 960, "training_iteration": 200, "trial_id": "04904_00000", "date": "2023-07-26_22-06-43", "timestamp": 1690398403, "time_this_iter_s": 10.004023790359497, "time_total_s": 2194.468770265579, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 225.51690411567688, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.219999999999995, "ram_util_percent": 63.533333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -1006.116845703125, "policy_loss": -197257987686.4, "vf_loss": 219045481.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 155040, "num_env_steps_trained": 155040, "num_agent_steps_sampled": 155040, "num_agent_steps_trained": 155040}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9963.148919989959, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538540360512868, "mean_inference_ms": 0.3736549403442275, "mean_action_processing_ms": 0.09089361056808462, "mean_env_wait_ms": 1.507586568490474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711942216040383, "StateBufferConnector_ms": 0.002673310293278224, "ViewRequirementAgentConnector_ms": 0.065693049363687}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -9963.148919989959, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538540360512868, "mean_inference_ms": 0.3736549403442275, "mean_action_processing_ms": 0.09089361056808462, "mean_env_wait_ms": 1.507586568490474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711942216040383, "StateBufferConnector_ms": 0.002673310293278224, "ViewRequirementAgentConnector_ms": 0.065693049363687}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155040, "num_agent_steps_trained": 155040, "num_env_steps_sampled": 155040, "num_env_steps_trained": 155040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.01836166176935, "num_env_steps_trained_throughput_per_sec": 108.01836166176935, "timesteps_total": 155040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 155040, "timers": {"training_iteration_time_ms": 3316.337, "sample_time_ms": 3305.747, "load_time_ms": 0.296, "load_throughput": 1217014.137, "learn_time_ms": 9.552, "learn_throughput": 37690.41, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 155040, "num_env_steps_trained": 155040, "num_agent_steps_sampled": 155040, "num_agent_steps_trained": 155040}, "done": false, "episodes_total": 964, "training_iteration": 201, "trial_id": "04904_00000", "date": "2023-07-26_22-06-56", "timestamp": 1690398416, "time_this_iter_s": 13.334015846252441, "time_total_s": 2207.8027861118317, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 238.85091996192932, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.121052631578948, "ram_util_percent": 63.53157894736843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -1026.9041015625, "policy_loss": -429815853875.2, "vf_loss": 211978798.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 372.0}}, "num_env_steps_sampled": 156480, "num_env_steps_trained": 156480, "num_agent_steps_sampled": 156480, "num_agent_steps_trained": 156480}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -10028.476412148242, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5416161652801685, "mean_inference_ms": 0.3735579605247966, "mean_action_processing_ms": 0.09087506054070114, "mean_env_wait_ms": 1.492182259113877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036904017130533853, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.06565475463867188}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -10028.476412148242, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5416161652801685, "mean_inference_ms": 0.3735579605247966, "mean_action_processing_ms": 0.09087506054070114, "mean_env_wait_ms": 1.492182259113877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036904017130533853, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.06565475463867188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156480, "num_agent_steps_trained": 156480, "num_env_steps_sampled": 156480, "num_env_steps_trained": 156480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.45142997190457, "num_env_steps_trained_throughput_per_sec": 108.45142997190457, "timesteps_total": 156480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 156480, "timers": {"training_iteration_time_ms": 3328.857, "sample_time_ms": 3318.328, "load_time_ms": 0.296, "load_throughput": 1216916.054, "learn_time_ms": 9.491, "learn_throughput": 37931.661, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 156480, "num_env_steps_trained": 156480, "num_agent_steps_sampled": 156480, "num_agent_steps_trained": 156480}, "done": false, "episodes_total": 968, "training_iteration": 202, "trial_id": "04904_00000", "date": "2023-07-26_22-07-09", "timestamp": 1690398429, "time_this_iter_s": 13.280483961105347, "time_total_s": 2221.083270072937, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.13140392303467, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 21.438888888888886, "ram_util_percent": 63.53888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -1042.84541015625, "policy_loss": -467109851955.2, "vf_loss": 214363136.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 388.0, "diff_num_grad_updates_vs_sampler_policy": 387.0}}, "num_env_steps_sampled": 157560, "num_env_steps_trained": 157560, "num_agent_steps_sampled": 157560, "num_agent_steps_trained": 157560}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -10082.536702344209, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.543952836230253, "mean_inference_ms": 0.3734914895358404, "mean_action_processing_ms": 0.09086250018563602, "mean_env_wait_ms": 1.4815918528003917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036719517830090644, "StateBufferConnector_ms": 0.002685876993032602, "ViewRequirementAgentConnector_ms": 0.06568706952608548}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -10082.536702344209, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.543952836230253, "mean_inference_ms": 0.3734914895358404, "mean_action_processing_ms": 0.09086250018563602, "mean_env_wait_ms": 1.4815918528003917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036719517830090644, "StateBufferConnector_ms": 0.002685876993032602, "ViewRequirementAgentConnector_ms": 0.06568706952608548}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157560, "num_agent_steps_trained": 157560, "num_env_steps_sampled": 157560, "num_env_steps_trained": 157560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.88747085571839, "num_env_steps_trained_throughput_per_sec": 105.88747085571839, "timesteps_total": 157560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 157560, "timers": {"training_iteration_time_ms": 3345.853, "sample_time_ms": 3335.382, "load_time_ms": 0.295, "load_throughput": 1221049.199, "learn_time_ms": 9.449, "learn_throughput": 38100.307, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 157560, "num_env_steps_trained": 157560, "num_agent_steps_sampled": 157560, "num_agent_steps_trained": 157560}, "done": false, "episodes_total": 971, "training_iteration": 203, "trial_id": "04904_00000", "date": "2023-07-26_22-07-20", "timestamp": 1690398440, "time_this_iter_s": 10.202178716659546, "time_total_s": 2231.2854487895966, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 262.3335826396942, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.313333333333333, "ram_util_percent": 63.33333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1997222222222225e-05, "entropy_coeff": 0.05, "policy_entropy": -1060.16796875, "policy_loss": -638092987389.6, "vf_loss": 208844564.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 408.0, "diff_num_grad_updates_vs_sampler_policy": 407.0}}, "num_env_steps_sampled": 159000, "num_env_steps_trained": 159000, "num_agent_steps_sampled": 159000, "num_agent_steps_trained": 159000}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -10133.511542799613, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.546830922814106, "mean_inference_ms": 0.37340998955179483, "mean_action_processing_ms": 0.09084759375005826, "mean_env_wait_ms": 1.468312959864493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003691998923697123, "StateBufferConnector_ms": 0.0026897686283762863, "ViewRequirementAgentConnector_ms": 0.0656834462793862}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11632.042059848014, "episode_reward_mean": -10133.511542799613, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.546830922814106, "mean_inference_ms": 0.37340998955179483, "mean_action_processing_ms": 0.09084759375005826, "mean_env_wait_ms": 1.468312959864493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003691998923697123, "StateBufferConnector_ms": 0.0026897686283762863, "ViewRequirementAgentConnector_ms": 0.0656834462793862}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159000, "num_agent_steps_trained": 159000, "num_env_steps_sampled": 159000, "num_env_steps_trained": 159000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.70753393273507, "num_env_steps_trained_throughput_per_sec": 108.70753393273507, "timesteps_total": 159000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 159000, "timers": {"training_iteration_time_ms": 3345.333, "sample_time_ms": 3334.723, "load_time_ms": 0.302, "load_throughput": 1194013.475, "learn_time_ms": 9.57, "learn_throughput": 37618.295, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 159000, "num_env_steps_trained": 159000, "num_agent_steps_sampled": 159000, "num_agent_steps_trained": 159000}, "done": false, "episodes_total": 975, "training_iteration": 204, "trial_id": "04904_00000", "date": "2023-07-26_22-07-33", "timestamp": 1690398453, "time_this_iter_s": 13.249349117279053, "time_total_s": 2244.5347979068756, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 275.58293175697327, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 21.378947368421052, "ram_util_percent": 63.215789473684204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7997222222222222e-05, "entropy_coeff": 0.05, "policy_entropy": -1073.8298095703126, "policy_loss": -644127295078.4, "vf_loss": 208326499.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 427.0}}, "num_env_steps_sampled": 160440, "num_env_steps_trained": 160440, "num_agent_steps_sampled": 160440, "num_agent_steps_trained": 160440}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10187.178367209457, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5495101771636195, "mean_inference_ms": 0.37333251791038585, "mean_action_processing_ms": 0.09083321096411988, "mean_env_wait_ms": 1.4560282877504236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003672755041787791, "StateBufferConnector_ms": 0.002686090247575627, "ViewRequirementAgentConnector_ms": 0.06567239761352539}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10187.178367209457, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5495101771636195, "mean_inference_ms": 0.37333251791038585, "mean_action_processing_ms": 0.09083321096411988, "mean_env_wait_ms": 1.4560282877504236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003672755041787791, "StateBufferConnector_ms": 0.002686090247575627, "ViewRequirementAgentConnector_ms": 0.06567239761352539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160440, "num_agent_steps_trained": 160440, "num_env_steps_sampled": 160440, "num_env_steps_trained": 160440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.09363054493255, "num_env_steps_trained_throughput_per_sec": 108.09363054493255, "timesteps_total": 160440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 160440, "timers": {"training_iteration_time_ms": 3330.99, "sample_time_ms": 3320.286, "load_time_ms": 0.303, "load_throughput": 1189311.153, "learn_time_ms": 9.624, "learn_throughput": 37407.394, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 160440, "num_env_steps_trained": 160440, "num_agent_steps_sampled": 160440, "num_agent_steps_trained": 160440}, "done": false, "episodes_total": 979, "training_iteration": 205, "trial_id": "04904_00000", "date": "2023-07-26_22-07-46", "timestamp": 1690398466, "time_this_iter_s": 13.324511051177979, "time_total_s": 2257.8593089580536, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 288.90744280815125, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.831578947368417, "ram_util_percent": 63.136842105263156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3997222222222222e-05, "entropy_coeff": 0.05, "policy_entropy": -1082.692626953125, "policy_loss": -936123252736.0, "vf_loss": 208924686.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 448.0, "diff_num_grad_updates_vs_sampler_policy": 447.0}}, "num_env_steps_sampled": 161880, "num_env_steps_trained": 161880, "num_agent_steps_sampled": 161880, "num_agent_steps_trained": 161880}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10226.776574970901, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.55203610979775, "mean_inference_ms": 0.37326072662038223, "mean_action_processing_ms": 0.09081989328563597, "mean_env_wait_ms": 1.4445790278198418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003684096866183811, "StateBufferConnector_ms": 0.0026954544915093314, "ViewRequirementAgentConnector_ms": 0.06566656960381402}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10226.776574970901, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.55203610979775, "mean_inference_ms": 0.37326072662038223, "mean_action_processing_ms": 0.09081989328563597, "mean_env_wait_ms": 1.4445790278198418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003684096866183811, "StateBufferConnector_ms": 0.0026954544915093314, "ViewRequirementAgentConnector_ms": 0.06566656960381402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161880, "num_agent_steps_trained": 161880, "num_env_steps_sampled": 161880, "num_env_steps_trained": 161880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.21677068157581, "num_env_steps_trained_throughput_per_sec": 108.21677068157581, "timesteps_total": 161880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 161880, "timers": {"training_iteration_time_ms": 3326.869, "sample_time_ms": 3316.076, "load_time_ms": 0.303, "load_throughput": 1189592.248, "learn_time_ms": 9.71, "learn_throughput": 37076.265, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 161880, "num_env_steps_trained": 161880, "num_agent_steps_sampled": 161880, "num_agent_steps_trained": 161880}, "done": false, "episodes_total": 983, "training_iteration": 206, "trial_id": "04904_00000", "date": "2023-07-26_22-07-59", "timestamp": 1690398479, "time_this_iter_s": 13.309468984603882, "time_total_s": 2271.1687779426575, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 302.2169117927551, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 21.042105263157897, "ram_util_percent": 63.231578947368426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0997222222222223e-05, "entropy_coeff": 0.05, "policy_entropy": -1088.7044677734375, "policy_loss": -1226010014515.2, "vf_loss": 220034049.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 463.0, "diff_num_grad_updates_vs_sampler_policy": 462.0}}, "num_env_steps_sampled": 162960, "num_env_steps_trained": 162960, "num_agent_steps_sampled": 162960, "num_agent_steps_trained": 162960}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10263.965861313312, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.553860390649396, "mean_inference_ms": 0.3732168631878103, "mean_action_processing_ms": 0.09081103784914629, "mean_env_wait_ms": 1.4365544414297349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037024098057900708, "StateBufferConnector_ms": 0.002723099083028814, "ViewRequirementAgentConnector_ms": 0.06631651232319494}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10263.965861313312, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.553860390649396, "mean_inference_ms": 0.3732168631878103, "mean_action_processing_ms": 0.09081103784914629, "mean_env_wait_ms": 1.4365544414297349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037024098057900708, "StateBufferConnector_ms": 0.002723099083028814, "ViewRequirementAgentConnector_ms": 0.06631651232319494}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162960, "num_agent_steps_trained": 162960, "num_env_steps_sampled": 162960, "num_env_steps_trained": 162960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.29584594131346, "num_env_steps_trained_throughput_per_sec": 107.29584594131346, "timesteps_total": 162960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 162960, "timers": {"training_iteration_time_ms": 3342.685, "sample_time_ms": 3331.995, "load_time_ms": 0.302, "load_throughput": 1192693.081, "learn_time_ms": 9.635, "learn_throughput": 37362.871, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 162960, "num_env_steps_trained": 162960, "num_agent_steps_sampled": 162960, "num_agent_steps_trained": 162960}, "done": false, "episodes_total": 986, "training_iteration": 207, "trial_id": "04904_00000", "date": "2023-07-26_22-08-10", "timestamp": 1690398490, "time_this_iter_s": 10.068418979644775, "time_total_s": 2281.2371969223022, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 312.2853307723999, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 22.178571428571427, "ram_util_percent": 63.292857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -1093.77724609375, "policy_loss": -2017120144588.8, "vf_loss": 220368371.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 478.0, "diff_num_grad_updates_vs_sampler_policy": 477.0}}, "num_env_steps_sampled": 164040, "num_env_steps_trained": 164040, "num_agent_steps_sampled": 164040, "num_agent_steps_trained": 164040}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10296.490290615524, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.555654889148678, "mean_inference_ms": 0.37317648928733793, "mean_action_processing_ms": 0.0908027119884723, "mean_env_wait_ms": 1.4290001443606173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036892791589101157, "StateBufferConnector_ms": 0.0027261674404144287, "ViewRequirementAgentConnector_ms": 0.06631736954053243}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10296.490290615524, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.555654889148678, "mean_inference_ms": 0.37317648928733793, "mean_action_processing_ms": 0.0908027119884723, "mean_env_wait_ms": 1.4290001443606173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036892791589101157, "StateBufferConnector_ms": 0.0027261674404144287, "ViewRequirementAgentConnector_ms": 0.06631736954053243}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164040, "num_agent_steps_trained": 164040, "num_env_steps_sampled": 164040, "num_env_steps_trained": 164040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.61466144722175, "num_env_steps_trained_throughput_per_sec": 106.61466144722175, "timesteps_total": 164040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 164040, "timers": {"training_iteration_time_ms": 3350.206, "sample_time_ms": 3339.545, "load_time_ms": 0.301, "load_throughput": 1195904.831, "learn_time_ms": 9.623, "learn_throughput": 37409.154, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 164040, "num_env_steps_trained": 164040, "num_agent_steps_sampled": 164040, "num_agent_steps_trained": 164040}, "done": false, "episodes_total": 989, "training_iteration": 208, "trial_id": "04904_00000", "date": "2023-07-26_22-08-20", "timestamp": 1690398500, "time_this_iter_s": 10.132750034332275, "time_total_s": 2291.3699469566345, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 322.4180808067322, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.119999999999997, "ram_util_percent": 63.43333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -1099.0205322265624, "policy_loss": -1294712648499.2, "vf_loss": 211964048.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 492.0}}, "num_env_steps_sampled": 165120, "num_env_steps_trained": 165120, "num_agent_steps_sampled": 165120, "num_agent_steps_trained": 165120}, "sampler_results": {"episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10330.003507782247, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5573484579122585, "mean_inference_ms": 0.3731405226270735, "mean_action_processing_ms": 0.09079496079212429, "mean_env_wait_ms": 1.4218432608478253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036757401745728772, "StateBufferConnector_ms": 0.0027239924729472458, "ViewRequirementAgentConnector_ms": 0.06629336964000355}}, "episode_reward_max": -1223.4058812571177, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10330.003507782247, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1223.4058812571177, -1357.518857687471, -1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5573484579122585, "mean_inference_ms": 0.3731405226270735, "mean_action_processing_ms": 0.09079496079212429, "mean_env_wait_ms": 1.4218432608478253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036757401745728772, "StateBufferConnector_ms": 0.0027239924729472458, "ViewRequirementAgentConnector_ms": 0.06629336964000355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165120, "num_agent_steps_trained": 165120, "num_env_steps_sampled": 165120, "num_env_steps_trained": 165120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.86725882139048, "num_env_steps_trained_throughput_per_sec": 107.86725882139048, "timesteps_total": 165120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 165120, "timers": {"training_iteration_time_ms": 3351.737, "sample_time_ms": 3341.137, "load_time_ms": 0.3, "load_throughput": 1199133.926, "learn_time_ms": 9.563, "learn_throughput": 37644.93, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 165120, "num_env_steps_trained": 165120, "num_agent_steps_sampled": 165120, "num_agent_steps_trained": 165120}, "done": false, "episodes_total": 992, "training_iteration": 209, "trial_id": "04904_00000", "date": "2023-07-26_22-08-30", "timestamp": 1690398510, "time_this_iter_s": 10.01514196395874, "time_total_s": 2301.3850889205933, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 332.4332227706909, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 20.599999999999998, "ram_util_percent": 63.40714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -1103.6380859375, "policy_loss": -1897979838464.0, "vf_loss": 214468512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 508.0, "diff_num_grad_updates_vs_sampler_policy": 507.0}}, "num_env_steps_sampled": 166200, "num_env_steps_trained": 166200, "num_agent_steps_sampled": 166200, "num_agent_steps_trained": 166200}, "sampler_results": {"episode_reward_max": -1270.8946667049738, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10540.81631639092, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.56299087306408, "mean_inference_ms": 0.3730190610359814, "mean_action_processing_ms": 0.09076416125140231, "mean_env_wait_ms": 1.3700142826815724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036695003509521484, "StateBufferConnector_ms": 0.002724170684814453, "ViewRequirementAgentConnector_ms": 0.06621170043945312}}, "episode_reward_max": -1270.8946667049738, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10540.81631639092, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1291.4809351596114, -1440.2958227809245, -1531.0429188067826, -1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.56299087306408, "mean_inference_ms": 0.3730190610359814, "mean_action_processing_ms": 0.09076416125140231, "mean_env_wait_ms": 1.3700142826815724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036695003509521484, "StateBufferConnector_ms": 0.002724170684814453, "ViewRequirementAgentConnector_ms": 0.06621170043945312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166200, "num_agent_steps_trained": 166200, "num_env_steps_sampled": 166200, "num_env_steps_trained": 166200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.98789408021057, "num_env_steps_trained_throughput_per_sec": 107.98789408021057, "timesteps_total": 166200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 166200, "timers": {"training_iteration_time_ms": 3353.133, "sample_time_ms": 3342.51, "load_time_ms": 0.298, "load_throughput": 1206993.957, "learn_time_ms": 9.589, "learn_throughput": 37541.227, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 166200, "num_env_steps_trained": 166200, "num_agent_steps_sampled": 166200, "num_agent_steps_trained": 166200}, "done": false, "episodes_total": 995, "training_iteration": 210, "trial_id": "04904_00000", "date": "2023-07-26_22-08-40", "timestamp": 1690398520, "time_this_iter_s": 10.003865957260132, "time_total_s": 2311.3889548778534, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 342.43708872795105, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 22.435714285714283, "ram_util_percent": 63.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -1108.4383544921875, "policy_loss": -1568674729164.8, "vf_loss": 222733107.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 523.0, "diff_num_grad_updates_vs_sampler_policy": 522.0}}, "num_env_steps_sampled": 167280, "num_env_steps_trained": 167280, "num_agent_steps_sampled": 167280, "num_agent_steps_trained": 167280}, "sampler_results": {"episode_reward_max": -1270.8946667049738, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10838.434459601249, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.570218585629664, "mean_inference_ms": 0.3728644370886763, "mean_action_processing_ms": 0.090730593902215, "mean_env_wait_ms": 1.3252686209940785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003665924072265625, "StateBufferConnector_ms": 0.002721071243286133, "ViewRequirementAgentConnector_ms": 0.0661461353302002}}, "episode_reward_max": -1270.8946667049738, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -10838.434459601249, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1270.8946667049738, -1576.7484358038387, -1605.3794023129813, -2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.570218585629664, "mean_inference_ms": 0.3728644370886763, "mean_action_processing_ms": 0.090730593902215, "mean_env_wait_ms": 1.3252686209940785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003665924072265625, "StateBufferConnector_ms": 0.002721071243286133, "ViewRequirementAgentConnector_ms": 0.0661461353302002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167280, "num_agent_steps_trained": 167280, "num_env_steps_sampled": 167280, "num_env_steps_trained": 167280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.23971682274396, "num_env_steps_trained_throughput_per_sec": 107.23971682274396, "timesteps_total": 167280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 167280, "timers": {"training_iteration_time_ms": 3348.221, "sample_time_ms": 3337.666, "load_time_ms": 0.298, "load_throughput": 1207090.447, "learn_time_ms": 9.522, "learn_throughput": 37805.35, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 167280, "num_env_steps_trained": 167280, "num_agent_steps_sampled": 167280, "num_agent_steps_trained": 167280}, "done": false, "episodes_total": 998, "training_iteration": 211, "trial_id": "04904_00000", "date": "2023-07-26_22-08-50", "timestamp": 1690398530, "time_this_iter_s": 10.073660135269165, "time_total_s": 2321.4626150131226, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 352.5107488632202, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.8, "ram_util_percent": 63.54285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -1112.68876953125, "policy_loss": -1091933064396.8, "vf_loss": 202560934.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 538.0, "diff_num_grad_updates_vs_sampler_policy": 537.0}}, "num_env_steps_sampled": 168360, "num_env_steps_trained": 168360, "num_agent_steps_sampled": 168360, "num_agent_steps_trained": 168360}, "sampler_results": {"episode_reward_max": -2451.469772430143, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11129.756278796023, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.576497652333153, "mean_inference_ms": 0.37271608412503626, "mean_action_processing_ms": 0.09070271263733132, "mean_env_wait_ms": 1.299289997914805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674030303955078, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.06618046760559082}}, "episode_reward_max": -2451.469772430143, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11129.756278796023, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2451.469772430143, -4525.4442696743545, -10070.702745493545, -11373.094694517302, -11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.576497652333153, "mean_inference_ms": 0.37271608412503626, "mean_action_processing_ms": 0.09070271263733132, "mean_env_wait_ms": 1.299289997914805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674030303955078, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.06618046760559082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168360, "num_agent_steps_trained": 168360, "num_env_steps_sampled": 168360, "num_env_steps_trained": 168360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.77879453304809, "num_env_steps_trained_throughput_per_sec": 107.77879453304809, "timesteps_total": 168360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 168360, "timers": {"training_iteration_time_ms": 3336.998, "sample_time_ms": 3326.467, "load_time_ms": 0.298, "load_throughput": 1206222.591, "learn_time_ms": 9.495, "learn_throughput": 37912.899, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 168360, "num_env_steps_trained": 168360, "num_agent_steps_sampled": 168360, "num_agent_steps_trained": 168360}, "done": false, "episodes_total": 1001, "training_iteration": 212, "trial_id": "04904_00000", "date": "2023-07-26_22-09-00", "timestamp": 1690398540, "time_this_iter_s": 10.023276090621948, "time_total_s": 2331.4858911037445, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 362.53402495384216, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 20.278571428571432, "ram_util_percent": 63.59285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -1118.514013671875, "policy_loss": -3883125650227.2, "vf_loss": 210806028.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 558.0, "diff_num_grad_updates_vs_sampler_policy": 557.0}}, "num_env_steps_sampled": 169800, "num_env_steps_trained": 169800, "num_agent_steps_sampled": 169800, "num_agent_steps_trained": 169800}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11301.608077190253, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5824489100422525, "mean_inference_ms": 0.3725282645955591, "mean_action_processing_ms": 0.09067085551431861, "mean_env_wait_ms": 1.2767204209512117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674745559692383, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.06615304946899414}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11301.608077190253, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11576.801458057842, -11196.256771736009, -11415.996921966014, -11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5824489100422525, "mean_inference_ms": 0.3725282645955591, "mean_action_processing_ms": 0.09067085551431861, "mean_env_wait_ms": 1.2767204209512117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674745559692383, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.06615304946899414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169800, "num_agent_steps_trained": 169800, "num_env_steps_sampled": 169800, "num_env_steps_trained": 169800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.94068582232397, "num_env_steps_trained_throughput_per_sec": 107.94068582232397, "timesteps_total": 169800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 169800, "timers": {"training_iteration_time_ms": 3343.195, "sample_time_ms": 3332.659, "load_time_ms": 0.299, "load_throughput": 1204298.485, "learn_time_ms": 9.494, "learn_throughput": 37919.754, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 169800, "num_env_steps_trained": 169800, "num_agent_steps_sampled": 169800, "num_agent_steps_trained": 169800}, "done": false, "episodes_total": 1005, "training_iteration": 213, "trial_id": "04904_00000", "date": "2023-07-26_22-09-13", "timestamp": 1690398553, "time_this_iter_s": 13.34334683418274, "time_total_s": 2344.8292379379272, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 375.8773717880249, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 19.13157894736842, "ram_util_percent": 63.55263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -1122.8247802734375, "policy_loss": -3740269936640.0, "vf_loss": 218511009.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 573.0, "diff_num_grad_updates_vs_sampler_policy": 572.0}}, "num_env_steps_sampled": 170880, "num_env_steps_trained": 170880, "num_agent_steps_sampled": 170880, "num_agent_steps_trained": 170880}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11300.00533028449, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.585759134564106, "mean_inference_ms": 0.37242139634591104, "mean_action_processing_ms": 0.0906532399429477, "mean_env_wait_ms": 1.2636541906810073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003683805465698242, "StateBufferConnector_ms": 0.002719879150390625, "ViewRequirementAgentConnector_ms": 0.06624293327331543}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11300.00533028449, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11189.145960214932, -11632.042059848014, -11309.63140126034, -11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.585759134564106, "mean_inference_ms": 0.37242139634591104, "mean_action_processing_ms": 0.0906532399429477, "mean_env_wait_ms": 1.2636541906810073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003683805465698242, "StateBufferConnector_ms": 0.002719879150390625, "ViewRequirementAgentConnector_ms": 0.06624293327331543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170880, "num_agent_steps_trained": 170880, "num_env_steps_sampled": 170880, "num_env_steps_trained": 170880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.16266352058429, "num_env_steps_trained_throughput_per_sec": 106.16266352058429, "timesteps_total": 170880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 170880, "timers": {"training_iteration_time_ms": 3353.412, "sample_time_ms": 3342.831, "load_time_ms": 0.297, "load_throughput": 1210574.393, "learn_time_ms": 9.539, "learn_throughput": 37741.754, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 170880, "num_env_steps_trained": 170880, "num_agent_steps_sampled": 170880, "num_agent_steps_trained": 170880}, "done": false, "episodes_total": 1008, "training_iteration": 214, "trial_id": "04904_00000", "date": "2023-07-26_22-09-23", "timestamp": 1690398563, "time_this_iter_s": 10.176043033599854, "time_total_s": 2355.005280971527, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 386.05341482162476, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 19.96666666666666, "ram_util_percent": 63.320000000000014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -1126.9525390625, "policy_loss": -3640445816012.8, "vf_loss": 218593384.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 588.0, "diff_num_grad_updates_vs_sampler_policy": 587.0}}, "num_env_steps_sampled": 171960, "num_env_steps_trained": 171960, "num_agent_steps_sampled": 171960, "num_agent_steps_trained": 171960}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11300.867322379183, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.588623191675132, "mean_inference_ms": 0.37233871117548084, "mean_action_processing_ms": 0.09063918596207658, "mean_env_wait_ms": 1.2530395715564235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036818981170654297, "StateBufferConnector_ms": 0.0027227401733398438, "ViewRequirementAgentConnector_ms": 0.06628799438476562}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11300.867322379183, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11585.396932742273, -11098.759418047375, -11330.161547194566, -11125.040497707698, -11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.588623191675132, "mean_inference_ms": 0.37233871117548084, "mean_action_processing_ms": 0.09063918596207658, "mean_env_wait_ms": 1.2530395715564235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036818981170654297, "StateBufferConnector_ms": 0.0027227401733398438, "ViewRequirementAgentConnector_ms": 0.06628799438476562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171960, "num_agent_steps_trained": 171960, "num_env_steps_sampled": 171960, "num_env_steps_trained": 171960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.9651391058228, "num_env_steps_trained_throughput_per_sec": 107.9651391058228, "timesteps_total": 171960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 171960, "timers": {"training_iteration_time_ms": 3351.682, "sample_time_ms": 3341.056, "load_time_ms": 0.298, "load_throughput": 1207090.447, "learn_time_ms": 9.578, "learn_throughput": 37586.644, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 171960, "num_env_steps_trained": 171960, "num_agent_steps_sampled": 171960, "num_agent_steps_trained": 171960}, "done": false, "episodes_total": 1011, "training_iteration": 215, "trial_id": "04904_00000", "date": "2023-07-26_22-09-34", "timestamp": 1690398574, "time_this_iter_s": 10.00611400604248, "time_total_s": 2365.0113949775696, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 396.05952882766724, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.6, "ram_util_percent": 63.32142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -1131.9690673828125, "policy_loss": -5646279966720.0, "vf_loss": 223353529.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 607.0}}, "num_env_steps_sampled": 173400, "num_env_steps_trained": 173400, "num_agent_steps_sampled": 173400, "num_agent_steps_trained": 173400}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11299.535348138083, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.592196210118395, "mean_inference_ms": 0.37225689058008826, "mean_action_processing_ms": 0.09062482703419276, "mean_env_wait_ms": 1.2419029433030189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036787986755371094, "StateBufferConnector_ms": 0.002730846405029297, "ViewRequirementAgentConnector_ms": 0.06630468368530273}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11299.535348138083, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11365.547059293287, -11374.444934332449, -11165.030402228469, -11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.592196210118395, "mean_inference_ms": 0.37225689058008826, "mean_action_processing_ms": 0.09062482703419276, "mean_env_wait_ms": 1.2419029433030189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036787986755371094, "StateBufferConnector_ms": 0.002730846405029297, "ViewRequirementAgentConnector_ms": 0.06630468368530273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173400, "num_agent_steps_trained": 173400, "num_env_steps_sampled": 173400, "num_env_steps_trained": 173400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.76158193447188, "num_env_steps_trained_throughput_per_sec": 107.76158193447188, "timesteps_total": 173400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 173400, "timers": {"training_iteration_time_ms": 3353.9, "sample_time_ms": 3343.304, "load_time_ms": 0.302, "load_throughput": 1193258.606, "learn_time_ms": 9.545, "learn_throughput": 37717.431, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 173400, "num_env_steps_trained": 173400, "num_agent_steps_sampled": 173400, "num_agent_steps_trained": 173400}, "done": false, "episodes_total": 1015, "training_iteration": 216, "trial_id": "04904_00000", "date": "2023-07-26_22-09-47", "timestamp": 1690398587, "time_this_iter_s": 13.36586594581604, "time_total_s": 2378.3772609233856, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 409.4253947734833, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 20.647368421052633, "ram_util_percent": 63.29473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.665740740740742e-06, "entropy_coeff": 0.05, "policy_entropy": -1135.703857421875, "policy_loss": -3201519604113.1, "vf_loss": 219467518.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 623.0, "diff_num_grad_updates_vs_sampler_policy": 622.0}}, "num_env_steps_sampled": 174480, "num_env_steps_trained": 174480, "num_agent_steps_sampled": 174480, "num_agent_steps_trained": 174480}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11299.474631130717, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.594629200653416, "mean_inference_ms": 0.37220935504227626, "mean_action_processing_ms": 0.09061643142408439, "mean_env_wait_ms": 1.2349634429598133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681182861328125, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06632590293884277}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11633.387733342517, "episode_reward_mean": -11299.474631130717, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11436.548771701708, -11287.925658484204, -11151.127647496689, -11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.594629200653416, "mean_inference_ms": 0.37220935504227626, "mean_action_processing_ms": 0.09061643142408439, "mean_env_wait_ms": 1.2349634429598133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681182861328125, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06632590293884277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174480, "num_agent_steps_trained": 174480, "num_env_steps_sampled": 174480, "num_env_steps_trained": 174480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.29714972276615, "num_env_steps_trained_throughput_per_sec": 107.29714972276615, "timesteps_total": 174480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 174480, "timers": {"training_iteration_time_ms": 3343.144, "sample_time_ms": 3332.496, "load_time_ms": 0.302, "load_throughput": 1191563.636, "learn_time_ms": 9.601, "learn_throughput": 37495.361, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 174480, "num_env_steps_trained": 174480, "num_agent_steps_sampled": 174480, "num_agent_steps_trained": 174480}, "done": false, "episodes_total": 1018, "training_iteration": 217, "trial_id": "04904_00000", "date": "2023-07-26_22-09-57", "timestamp": 1690398597, "time_this_iter_s": 10.068229913711548, "time_total_s": 2388.445490837097, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 419.4936246871948, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 19.921428571428574, "ram_util_percent": 63.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.665740740740741e-06, "entropy_coeff": 0.05, "policy_entropy": -1139.102099609375, "policy_loss": -5811074079129.6, "vf_loss": 223594342.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 638.0, "diff_num_grad_updates_vs_sampler_policy": 637.0}}, "num_env_steps_sampled": 175560, "num_env_steps_trained": 175560, "num_agent_steps_sampled": 175560, "num_agent_steps_trained": 175560}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11306.454583871036, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.597189173757527, "mean_inference_ms": 0.3721686840327132, "mean_action_processing_ms": 0.09060851833287645, "mean_env_wait_ms": 1.2288023138673607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916732788085938, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06650900840759277}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11306.454583871036, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11117.558056902588, -11007.386576229681, -11341.693139169058, -11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.597189173757527, "mean_inference_ms": 0.3721686840327132, "mean_action_processing_ms": 0.09060851833287645, "mean_env_wait_ms": 1.2288023138673607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916732788085938, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06650900840759277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175560, "num_agent_steps_trained": 175560, "num_env_steps_sampled": 175560, "num_env_steps_trained": 175560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.57706094330572, "num_env_steps_trained_throughput_per_sec": 107.57706094330572, "timesteps_total": 175560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 175560, "timers": {"training_iteration_time_ms": 3346.752, "sample_time_ms": 3336.117, "load_time_ms": 0.302, "load_throughput": 1193919.064, "learn_time_ms": 9.592, "learn_throughput": 37533.108, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 175560, "num_env_steps_trained": 175560, "num_agent_steps_sampled": 175560, "num_agent_steps_trained": 175560}, "done": false, "episodes_total": 1021, "training_iteration": 218, "trial_id": "04904_00000", "date": "2023-07-26_22-10-07", "timestamp": 1690398607, "time_this_iter_s": 10.042197227478027, "time_total_s": 2398.487688064575, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 429.53582191467285, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.893333333333334, "ram_util_percent": 63.29333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.66574074074074e-06, "entropy_coeff": 0.05, "policy_entropy": -1142.4181640625, "policy_loss": -6358316666060.8, "vf_loss": 213432790.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 652.0}}, "num_env_steps_sampled": 176640, "num_env_steps_trained": 176640, "num_agent_steps_sampled": 176640, "num_agent_steps_trained": 176640}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11306.169028091188, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.599322275015783, "mean_inference_ms": 0.37212711396403286, "mean_action_processing_ms": 0.0906000164254397, "mean_env_wait_ms": 1.2235352953523024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.06646609306335449}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11306.169028091188, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11253.157477989762, -11375.719533190098, -11331.013983557097, -11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.599322275015783, "mean_inference_ms": 0.37212711396403286, "mean_action_processing_ms": 0.0906000164254397, "mean_env_wait_ms": 1.2235352953523024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.06646609306335449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176640, "num_agent_steps_trained": 176640, "num_env_steps_sampled": 176640, "num_env_steps_trained": 176640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.5613103970748, "num_env_steps_trained_throughput_per_sec": 107.5613103970748, "timesteps_total": 176640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 176640, "timers": {"training_iteration_time_ms": 3353.315, "sample_time_ms": 3342.637, "load_time_ms": 0.303, "load_throughput": 1189217.484, "learn_time_ms": 9.632, "learn_throughput": 37375.726, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 176640, "num_env_steps_trained": 176640, "num_agent_steps_sampled": 176640, "num_agent_steps_trained": 176640}, "done": false, "episodes_total": 1024, "training_iteration": 219, "trial_id": "04904_00000", "date": "2023-07-26_22-10-17", "timestamp": 1690398617, "time_this_iter_s": 10.043674945831299, "time_total_s": 2408.5313630104065, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 439.57949686050415, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 20.142857142857142, "ram_util_percent": 63.26428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.665740740740742e-06, "entropy_coeff": 0.05, "policy_entropy": -1145.4440673828126, "policy_loss": -3953056704102.4, "vf_loss": 215310555.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 668.0, "diff_num_grad_updates_vs_sampler_policy": 667.0}}, "num_env_steps_sampled": 177720, "num_env_steps_trained": 177720, "num_agent_steps_sampled": 177720, "num_agent_steps_trained": 177720}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11309.329866931557, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.601111521719248, "mean_inference_ms": 0.3720910869863337, "mean_action_processing_ms": 0.09059290423702718, "mean_env_wait_ms": 1.218776721830111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036885738372802734, "StateBufferConnector_ms": 0.0027425289154052734, "ViewRequirementAgentConnector_ms": 0.06644916534423828}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11309.329866931557, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11567.575536606348, -11484.648050532298, -11184.01070563553, -11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.601111521719248, "mean_inference_ms": 0.3720910869863337, "mean_action_processing_ms": 0.09059290423702718, "mean_env_wait_ms": 1.218776721830111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036885738372802734, "StateBufferConnector_ms": 0.0027425289154052734, "ViewRequirementAgentConnector_ms": 0.06644916534423828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177720, "num_agent_steps_trained": 177720, "num_env_steps_sampled": 177720, "num_env_steps_trained": 177720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.58799440631947, "num_env_steps_trained_throughput_per_sec": 106.58799440631947, "timesteps_total": 177720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 177720, "timers": {"training_iteration_time_ms": 3352.333, "sample_time_ms": 3341.7, "load_time_ms": 0.3, "load_throughput": 1200659.542, "learn_time_ms": 9.592, "learn_throughput": 37532.642, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 177720, "num_env_steps_trained": 177720, "num_agent_steps_sampled": 177720, "num_agent_steps_trained": 177720}, "done": false, "episodes_total": 1027, "training_iteration": 220, "trial_id": "04904_00000", "date": "2023-07-26_22-10-27", "timestamp": 1690398627, "time_this_iter_s": 10.13524317741394, "time_total_s": 2418.6666061878204, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 449.7147400379181, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 20.066666666666663, "ram_util_percent": 63.379999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.665740740740741e-06, "entropy_coeff": 0.05, "policy_entropy": -1147.37236328125, "policy_loss": -3420730314653.7, "vf_loss": 209151552.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 683.0, "diff_num_grad_updates_vs_sampler_policy": 682.0}}, "num_env_steps_sampled": 178800, "num_env_steps_trained": 178800, "num_agent_steps_sampled": 178800, "num_agent_steps_trained": 178800}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11307.254910611504, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.60294846726464, "mean_inference_ms": 0.37205895616948736, "mean_action_processing_ms": 0.09058651988977173, "mean_env_wait_ms": 1.2147409811966663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036902427673339844, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.06647396087646484}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11307.254910611504, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11324.364899767483, -11187.64017983964, -11109.044849496977, -11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.60294846726464, "mean_inference_ms": 0.37205895616948736, "mean_action_processing_ms": 0.09058651988977173, "mean_env_wait_ms": 1.2147409811966663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036902427673339844, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.06647396087646484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178800, "num_agent_steps_trained": 178800, "num_env_steps_sampled": 178800, "num_env_steps_trained": 178800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.16939518121401, "num_env_steps_trained_throughput_per_sec": 107.16939518121401, "timesteps_total": 178800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 178800, "timers": {"training_iteration_time_ms": 3357.595, "sample_time_ms": 3346.978, "load_time_ms": 0.3, "load_throughput": 1198753.128, "learn_time_ms": 9.581, "learn_throughput": 37573.269, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 178800, "num_env_steps_trained": 178800, "num_agent_steps_sampled": 178800, "num_agent_steps_trained": 178800}, "done": false, "episodes_total": 1030, "training_iteration": 221, "trial_id": "04904_00000", "date": "2023-07-26_22-10-37", "timestamp": 1690398637, "time_this_iter_s": 10.080299854278564, "time_total_s": 2428.746906042099, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 459.79503989219666, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 20.314285714285713, "ram_util_percent": 63.48571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1149.4365234375, "policy_loss": -4514275917824.0, "vf_loss": 208257390.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 697.0}}, "num_env_steps_sampled": 179880, "num_env_steps_trained": 179880, "num_agent_steps_sampled": 179880, "num_agent_steps_trained": 179880}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11310.161825468283, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.604595486622006, "mean_inference_ms": 0.3720321134379743, "mean_action_processing_ms": 0.09058123301284499, "mean_env_wait_ms": 1.2110346906792904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690958023071289, "StateBufferConnector_ms": 0.002744436264038086, "ViewRequirementAgentConnector_ms": 0.06648111343383789}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11310.161825468283, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11439.756243405776, -11556.08557606997, -11563.013947819663, -11477.651523431008, -11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.604595486622006, "mean_inference_ms": 0.3720321134379743, "mean_action_processing_ms": 0.09058123301284499, "mean_env_wait_ms": 1.2110346906792904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690958023071289, "StateBufferConnector_ms": 0.002744436264038086, "ViewRequirementAgentConnector_ms": 0.06648111343383789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179880, "num_agent_steps_trained": 179880, "num_env_steps_sampled": 179880, "num_env_steps_trained": 179880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.76173638945701, "num_env_steps_trained_throughput_per_sec": 107.76173638945701, "timesteps_total": 179880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 179880, "timers": {"training_iteration_time_ms": 3362.946, "sample_time_ms": 3352.382, "load_time_ms": 0.298, "load_throughput": 1207090.447, "learn_time_ms": 9.53, "learn_throughput": 37776.88, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 179880, "num_env_steps_trained": 179880, "num_agent_steps_sampled": 179880, "num_agent_steps_trained": 179880}, "done": false, "episodes_total": 1033, "training_iteration": 222, "trial_id": "04904_00000", "date": "2023-07-26_22-10-47", "timestamp": 1690398647, "time_this_iter_s": 10.024943113327026, "time_total_s": 2438.771849155426, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 469.8199830055237, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 20.892857142857146, "ram_util_percent": 63.64285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1151.7054931640625, "policy_loss": -4518843410022.4, "vf_loss": 217443708.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 718.0, "diff_num_grad_updates_vs_sampler_policy": 717.0}}, "num_env_steps_sampled": 181320, "num_env_steps_trained": 181320, "num_agent_steps_sampled": 181320, "num_agent_steps_trained": 181320}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11305.301954671673, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.606660937670285, "mean_inference_ms": 0.37200171218570316, "mean_action_processing_ms": 0.09057507748640671, "mean_env_wait_ms": 1.2063850299541037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036973953247070312, "StateBufferConnector_ms": 0.0027391910552978516, "ViewRequirementAgentConnector_ms": 0.066497802734375}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11305.301954671673, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11338.216444174803, -11439.473422650395, -11113.747637361525, -11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.606660937670285, "mean_inference_ms": 0.37200171218570316, "mean_action_processing_ms": 0.09057507748640671, "mean_env_wait_ms": 1.2063850299541037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036973953247070312, "StateBufferConnector_ms": 0.0027391910552978516, "ViewRequirementAgentConnector_ms": 0.066497802734375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181320, "num_agent_steps_trained": 181320, "num_env_steps_sampled": 181320, "num_env_steps_trained": 181320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.3172200394356, "num_env_steps_trained_throughput_per_sec": 108.3172200394356, "timesteps_total": 181320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 181320, "timers": {"training_iteration_time_ms": 3339.377, "sample_time_ms": 3328.764, "load_time_ms": 0.3, "load_throughput": 1201137.093, "learn_time_ms": 9.579, "learn_throughput": 37582.621, "synch_weights_time_ms": 0.689}, "counters": {"num_env_steps_sampled": 181320, "num_env_steps_trained": 181320, "num_agent_steps_sampled": 181320, "num_agent_steps_trained": 181320}, "done": false, "episodes_total": 1037, "training_iteration": 223, "trial_id": "04904_00000", "date": "2023-07-26_22-11-01", "timestamp": 1690398661, "time_this_iter_s": 13.297137260437012, "time_total_s": 2452.068986415863, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 483.1171202659607, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 20.142105263157898, "ram_util_percent": 63.61052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1153.3623779296875, "policy_loss": -5914929502617.6, "vf_loss": 216072785.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 733.0, "diff_num_grad_updates_vs_sampler_policy": 732.0}}, "num_env_steps_sampled": 182400, "num_env_steps_trained": 182400, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182400}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11305.426255418164, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.608164157713563, "mean_inference_ms": 0.3719801361067262, "mean_action_processing_ms": 0.09057096681408329, "mean_env_wait_ms": 1.2031474130596622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002727031707763672, "ViewRequirementAgentConnector_ms": 0.06641530990600586}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11305.426255418164, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11382.87468048977, -11307.632512939585, -11371.934256837974, -11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.608164157713563, "mean_inference_ms": 0.3719801361067262, "mean_action_processing_ms": 0.09057096681408329, "mean_env_wait_ms": 1.2031474130596622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002727031707763672, "ViewRequirementAgentConnector_ms": 0.06641530990600586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182400, "num_env_steps_sampled": 182400, "num_env_steps_trained": 182400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.66385335321387, "num_env_steps_trained_throughput_per_sec": 107.66385335321387, "timesteps_total": 182400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 182400, "timers": {"training_iteration_time_ms": 3334.749, "sample_time_ms": 3324.056, "load_time_ms": 0.3, "load_throughput": 1199419.684, "learn_time_ms": 9.646, "learn_throughput": 37320.299, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 182400, "num_env_steps_trained": 182400, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182400}, "done": false, "episodes_total": 1040, "training_iteration": 224, "trial_id": "04904_00000", "date": "2023-07-26_22-11-11", "timestamp": 1690398671, "time_this_iter_s": 10.033854961395264, "time_total_s": 2462.1028413772583, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 493.15097522735596, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 21.207142857142856, "ram_util_percent": 63.68571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1155.21943359375, "policy_loss": -9794550313779.2, "vf_loss": 221188414.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 748.0, "diff_num_grad_updates_vs_sampler_policy": 747.0}}, "num_env_steps_sampled": 183480, "num_env_steps_trained": 183480, "num_agent_steps_sampled": 183480, "num_agent_steps_trained": 183480}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11306.55140563917, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.609520691983068, "mean_inference_ms": 0.3719610321487312, "mean_action_processing_ms": 0.0905675832720843, "mean_env_wait_ms": 1.2001700334968362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036978721618652344, "StateBufferConnector_ms": 0.0027158260345458984, "ViewRequirementAgentConnector_ms": 0.06638097763061523}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11306.55140563917, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11420.787415699006, -11338.657217671933, -11139.44152997942, -11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.609520691983068, "mean_inference_ms": 0.3719610321487312, "mean_action_processing_ms": 0.0905675832720843, "mean_env_wait_ms": 1.2001700334968362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036978721618652344, "StateBufferConnector_ms": 0.0027158260345458984, "ViewRequirementAgentConnector_ms": 0.06638097763061523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183480, "num_agent_steps_trained": 183480, "num_env_steps_sampled": 183480, "num_env_steps_trained": 183480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.62669232289649, "num_env_steps_trained_throughput_per_sec": 106.62669232289649, "timesteps_total": 183480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 183480, "timers": {"training_iteration_time_ms": 3345.417, "sample_time_ms": 3334.74, "load_time_ms": 0.3, "load_throughput": 1201806.304, "learn_time_ms": 9.641, "learn_throughput": 37341.342, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 183480, "num_env_steps_trained": 183480, "num_agent_steps_sampled": 183480, "num_agent_steps_trained": 183480}, "done": false, "episodes_total": 1043, "training_iteration": 225, "trial_id": "04904_00000", "date": "2023-07-26_22-11-21", "timestamp": 1690398681, "time_this_iter_s": 10.131539106369019, "time_total_s": 2472.2343804836273, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 503.282514333725, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 19.326666666666668, "ram_util_percent": 63.39333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1157.267822265625, "policy_loss": -6907054218485.0, "vf_loss": 209651430.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 763.0, "diff_num_grad_updates_vs_sampler_policy": 762.0}}, "num_env_steps_sampled": 184560, "num_env_steps_trained": 184560, "num_agent_steps_sampled": 184560, "num_agent_steps_trained": 184560}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11308.26422457468, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.610808048330657, "mean_inference_ms": 0.3719439803880816, "mean_action_processing_ms": 0.09056471804043235, "mean_env_wait_ms": 1.1973913794589044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003700733184814453, "StateBufferConnector_ms": 0.0027151107788085938, "ViewRequirementAgentConnector_ms": 0.0663905143737793}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11308.26422457468, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11296.338214908836, -11435.409812169086, -11211.97249191358, -11436.121622678078, -11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.610808048330657, "mean_inference_ms": 0.3719439803880816, "mean_action_processing_ms": 0.09056471804043235, "mean_env_wait_ms": 1.1973913794589044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003700733184814453, "StateBufferConnector_ms": 0.0027151107788085938, "ViewRequirementAgentConnector_ms": 0.0663905143737793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184560, "num_agent_steps_trained": 184560, "num_env_steps_sampled": 184560, "num_env_steps_trained": 184560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.98726825409756, "num_env_steps_trained_throughput_per_sec": 106.98726825409756, "timesteps_total": 184560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 184560, "timers": {"training_iteration_time_ms": 3360.226, "sample_time_ms": 3349.564, "load_time_ms": 0.3, "load_throughput": 1199514.967, "learn_time_ms": 9.623, "learn_throughput": 37410.359, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 184560, "num_env_steps_trained": 184560, "num_agent_steps_sampled": 184560, "num_agent_steps_trained": 184560}, "done": false, "episodes_total": 1046, "training_iteration": 226, "trial_id": "04904_00000", "date": "2023-07-26_22-11-31", "timestamp": 1690398691, "time_this_iter_s": 10.097412109375, "time_total_s": 2482.3317925930023, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 513.3799264431, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 19.87142857142857, "ram_util_percent": 63.392857142857125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1159.3218017578124, "policy_loss": -6763875768729.6, "vf_loss": 215384595.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 783.0, "diff_num_grad_updates_vs_sampler_policy": 782.0}}, "num_env_steps_sampled": 186000, "num_env_steps_trained": 186000, "num_agent_steps_sampled": 186000, "num_agent_steps_trained": 186000}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11304.217976586497, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6123903122789, "mean_inference_ms": 0.3719352300799939, "mean_action_processing_ms": 0.09056289010629452, "mean_env_wait_ms": 1.1938087097185486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.002711772918701172, "ViewRequirementAgentConnector_ms": 0.06638193130493164}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11304.217976586497, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11502.668806377535, -11312.680524668003, -11306.992417036045, -10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6123903122789, "mean_inference_ms": 0.3719352300799939, "mean_action_processing_ms": 0.09056289010629452, "mean_env_wait_ms": 1.1938087097185486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.002711772918701172, "ViewRequirementAgentConnector_ms": 0.06638193130493164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186000, "num_agent_steps_trained": 186000, "num_env_steps_sampled": 186000, "num_env_steps_trained": 186000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.99977894321212, "num_env_steps_trained_throughput_per_sec": 108.99977894321212, "timesteps_total": 186000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 186000, "timers": {"training_iteration_time_ms": 3343.436, "sample_time_ms": 3332.718, "load_time_ms": 0.3, "load_throughput": 1199514.967, "learn_time_ms": 9.669, "learn_throughput": 37231.222, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 186000, "num_env_steps_trained": 186000, "num_agent_steps_sampled": 186000, "num_agent_steps_trained": 186000}, "done": false, "episodes_total": 1050, "training_iteration": 227, "trial_id": "04904_00000", "date": "2023-07-26_22-11-44", "timestamp": 1690398704, "time_this_iter_s": 13.213862895965576, "time_total_s": 2495.545655488968, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 526.5937893390656, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 22.00526315789474, "ram_util_percent": 63.48947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1160.8245849609375, "policy_loss": -12040233707110.4, "vf_loss": 220326769.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 798.0, "diff_num_grad_updates_vs_sampler_policy": 797.0}}, "num_env_steps_sampled": 187080, "num_env_steps_trained": 187080, "num_agent_steps_sampled": 187080, "num_agent_steps_trained": 187080}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11301.616446004795, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.613355022037527, "mean_inference_ms": 0.37193066972937067, "mean_action_processing_ms": 0.09056211763327549, "mean_env_wait_ms": 1.1912346032582457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710508346557617, "StateBufferConnector_ms": 0.002716064453125, "ViewRequirementAgentConnector_ms": 0.06644082069396973}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11301.616446004795, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10996.701044755346, -11317.292531040068, -11100.973952227294, -11336.049018238424, -11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.613355022037527, "mean_inference_ms": 0.37193066972937067, "mean_action_processing_ms": 0.09056211763327549, "mean_env_wait_ms": 1.1912346032582457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710508346557617, "StateBufferConnector_ms": 0.002716064453125, "ViewRequirementAgentConnector_ms": 0.06644082069396973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187080, "num_agent_steps_trained": 187080, "num_env_steps_sampled": 187080, "num_env_steps_trained": 187080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.96422303352492, "num_env_steps_trained_throughput_per_sec": 107.96422303352492, "timesteps_total": 187080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 187080, "timers": {"training_iteration_time_ms": 3330.887, "sample_time_ms": 3320.12, "load_time_ms": 0.3, "load_throughput": 1199610.265, "learn_time_ms": 9.719, "learn_throughput": 37039.522, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 187080, "num_env_steps_trained": 187080, "num_agent_steps_sampled": 187080, "num_agent_steps_trained": 187080}, "done": false, "episodes_total": 1053, "training_iteration": 228, "trial_id": "04904_00000", "date": "2023-07-26_22-11-54", "timestamp": 1690398714, "time_this_iter_s": 10.006050825119019, "time_total_s": 2505.551706314087, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 536.5998401641846, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 22.107142857142858, "ram_util_percent": 63.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1162.9497802734375, "policy_loss": -6520938063462.4, "vf_loss": 211051790.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 818.0, "diff_num_grad_updates_vs_sampler_policy": 817.0}}, "num_env_steps_sampled": 188520, "num_env_steps_trained": 188520, "num_agent_steps_sampled": 188520, "num_agent_steps_trained": 188520}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11307.128623129818, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.61483288268857, "mean_inference_ms": 0.3719251788031044, "mean_action_processing_ms": 0.09056184330632258, "mean_env_wait_ms": 1.1882376284202256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003709554672241211, "StateBufferConnector_ms": 0.0027239322662353516, "ViewRequirementAgentConnector_ms": 0.0664064884185791}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11307.128623129818, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11151.328361849459, -11189.86520905575, -11105.798051285152, -11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.61483288268857, "mean_inference_ms": 0.3719251788031044, "mean_action_processing_ms": 0.09056184330632258, "mean_env_wait_ms": 1.1882376284202256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003709554672241211, "StateBufferConnector_ms": 0.0027239322662353516, "ViewRequirementAgentConnector_ms": 0.0664064884185791}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188520, "num_agent_steps_trained": 188520, "num_env_steps_sampled": 188520, "num_env_steps_trained": 188520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.74257773722272, "num_env_steps_trained_throughput_per_sec": 107.74257773722272, "timesteps_total": 188520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 188520, "timers": {"training_iteration_time_ms": 3324.421, "sample_time_ms": 3313.617, "load_time_ms": 0.301, "load_throughput": 1196473.407, "learn_time_ms": 9.748, "learn_throughput": 36929.185, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 188520, "num_env_steps_trained": 188520, "num_agent_steps_sampled": 188520, "num_agent_steps_trained": 188520}, "done": false, "episodes_total": 1057, "training_iteration": 229, "trial_id": "04904_00000", "date": "2023-07-26_22-12-08", "timestamp": 1690398728, "time_this_iter_s": 13.368039846420288, "time_total_s": 2518.919746160507, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 549.9678800106049, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 20.268421052631577, "ram_util_percent": 63.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1164.72373046875, "policy_loss": -8181321197158.4, "vf_loss": 218640355.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 832.0}}, "num_env_steps_sampled": 189600, "num_env_steps_trained": 189600, "num_agent_steps_sampled": 189600, "num_agent_steps_trained": 189600}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11318.120621970038, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.615921809331404, "mean_inference_ms": 0.371923035323587, "mean_action_processing_ms": 0.09056204301392841, "mean_env_wait_ms": 1.186193255316103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037124156951904297, "StateBufferConnector_ms": 0.0027246475219726562, "ViewRequirementAgentConnector_ms": 0.06637382507324219}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11318.120621970038, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11469.118032324532, -11549.296926612678, -11171.01979193216, -11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.615921809331404, "mean_inference_ms": 0.371923035323587, "mean_action_processing_ms": 0.09056204301392841, "mean_env_wait_ms": 1.186193255316103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037124156951904297, "StateBufferConnector_ms": 0.0027246475219726562, "ViewRequirementAgentConnector_ms": 0.06637382507324219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189600, "num_agent_steps_trained": 189600, "num_env_steps_sampled": 189600, "num_env_steps_trained": 189600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.99846243262964, "num_env_steps_trained_throughput_per_sec": 105.99846243262964, "timesteps_total": 189600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 189600, "timers": {"training_iteration_time_ms": 3355.72, "sample_time_ms": 3345.019, "load_time_ms": 0.299, "load_throughput": 1202955.258, "learn_time_ms": 9.65, "learn_throughput": 37306.007, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 189600, "num_env_steps_trained": 189600, "num_agent_steps_sampled": 189600, "num_agent_steps_trained": 189600}, "done": false, "episodes_total": 1060, "training_iteration": 230, "trial_id": "04904_00000", "date": "2023-07-26_22-12-18", "timestamp": 1690398738, "time_this_iter_s": 10.191553115844727, "time_total_s": 2529.111299276352, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 560.1594331264496, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 20.506666666666668, "ram_util_percent": 63.40666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1166.2205322265625, "policy_loss": -13599036512665.6, "vf_loss": 223692640.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 848.0, "diff_num_grad_updates_vs_sampler_policy": 847.0}}, "num_env_steps_sampled": 190680, "num_env_steps_trained": 190680, "num_agent_steps_sampled": 190680, "num_agent_steps_trained": 190680}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11313.591896900658, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.616876254790526, "mean_inference_ms": 0.37192633739216363, "mean_action_processing_ms": 0.09056291178539233, "mean_env_wait_ms": 1.1844231741178568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711223602294922, "StateBufferConnector_ms": 0.002727985382080078, "ViewRequirementAgentConnector_ms": 0.06639885902404785}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11313.591896900658, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11363.525267826719, -11078.584818119762, -11280.09104922144, -11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.616876254790526, "mean_inference_ms": 0.37192633739216363, "mean_action_processing_ms": 0.09056291178539233, "mean_env_wait_ms": 1.1844231741178568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711223602294922, "StateBufferConnector_ms": 0.002727985382080078, "ViewRequirementAgentConnector_ms": 0.06639885902404785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190680, "num_agent_steps_trained": 190680, "num_env_steps_sampled": 190680, "num_env_steps_trained": 190680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.43760974478943, "num_env_steps_trained_throughput_per_sec": 107.43760974478943, "timesteps_total": 190680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 190680, "timers": {"training_iteration_time_ms": 3360.623, "sample_time_ms": 3349.955, "load_time_ms": 0.3, "load_throughput": 1201423.806, "learn_time_ms": 9.622, "learn_throughput": 37416.2, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 190680, "num_env_steps_trained": 190680, "num_agent_steps_sampled": 190680, "num_agent_steps_trained": 190680}, "done": false, "episodes_total": 1063, "training_iteration": 231, "trial_id": "04904_00000", "date": "2023-07-26_22-12-28", "timestamp": 1690398748, "time_this_iter_s": 10.055064916610718, "time_total_s": 2539.1663641929626, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 570.2144980430603, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 20.25714285714286, "ram_util_percent": 63.41428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1167.9077392578124, "policy_loss": -6637477901915.95, "vf_loss": 212567512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 863.0, "diff_num_grad_updates_vs_sampler_policy": 862.0}}, "num_env_steps_sampled": 191760, "num_env_steps_trained": 191760, "num_agent_steps_sampled": 191760, "num_agent_steps_trained": 191760}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11315.693120440368, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.617857934317685, "mean_inference_ms": 0.3719324662558455, "mean_action_processing_ms": 0.09056409747068786, "mean_env_wait_ms": 1.1827356214722569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037114620208740234, "StateBufferConnector_ms": 0.002718687057495117, "ViewRequirementAgentConnector_ms": 0.06640338897705078}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11315.693120440368, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11171.976590464854, -11221.505134025094, -11551.433427498225, -11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.617857934317685, "mean_inference_ms": 0.3719324662558455, "mean_action_processing_ms": 0.09056409747068786, "mean_env_wait_ms": 1.1827356214722569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037114620208740234, "StateBufferConnector_ms": 0.002718687057495117, "ViewRequirementAgentConnector_ms": 0.06640338897705078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191760, "num_agent_steps_trained": 191760, "num_env_steps_sampled": 191760, "num_env_steps_trained": 191760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.70786423561164, "num_env_steps_trained_throughput_per_sec": 107.70786423561164, "timesteps_total": 191760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 191760, "timers": {"training_iteration_time_ms": 3364.765, "sample_time_ms": 3354.109, "load_time_ms": 0.3, "load_throughput": 1201423.806, "learn_time_ms": 9.612, "learn_throughput": 37452.673, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 191760, "num_env_steps_trained": 191760, "num_agent_steps_sampled": 191760, "num_agent_steps_trained": 191760}, "done": false, "episodes_total": 1066, "training_iteration": 232, "trial_id": "04904_00000", "date": "2023-07-26_22-12-38", "timestamp": 1690398758, "time_this_iter_s": 10.029873847961426, "time_total_s": 2549.196238040924, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 580.2443718910217, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 21.650000000000002, "ram_util_percent": 63.61428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1169.429150390625, "policy_loss": -11939389636608.0, "vf_loss": 219280880.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 877.0}}, "num_env_steps_sampled": 192840, "num_env_steps_trained": 192840, "num_agent_steps_sampled": 192840, "num_agent_steps_trained": 192840}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11318.213516573289, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.618792988657525, "mean_inference_ms": 0.3719384607023835, "mean_action_processing_ms": 0.0905653755824894, "mean_env_wait_ms": 1.1811377739183488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003702402114868164, "StateBufferConnector_ms": 0.002724170684814453, "ViewRequirementAgentConnector_ms": 0.06644487380981445}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11318.213516573289, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11383.197074800952, -11367.501369430869, -11159.121525928864, -11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.618792988657525, "mean_inference_ms": 0.3719384607023835, "mean_action_processing_ms": 0.0905653755824894, "mean_env_wait_ms": 1.1811377739183488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003702402114868164, "StateBufferConnector_ms": 0.002724170684814453, "ViewRequirementAgentConnector_ms": 0.06644487380981445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192840, "num_agent_steps_trained": 192840, "num_env_steps_sampled": 192840, "num_env_steps_trained": 192840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.89248653274753, "num_env_steps_trained_throughput_per_sec": 106.89248653274753, "timesteps_total": 192840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 192840, "timers": {"training_iteration_time_ms": 3358.877, "sample_time_ms": 3348.203, "load_time_ms": 0.303, "load_throughput": 1186787.267, "learn_time_ms": 9.633, "learn_throughput": 37372.673, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 192840, "num_env_steps_trained": 192840, "num_agent_steps_sampled": 192840, "num_agent_steps_trained": 192840}, "done": false, "episodes_total": 1069, "training_iteration": 233, "trial_id": "04904_00000", "date": "2023-07-26_22-12-48", "timestamp": 1690398768, "time_this_iter_s": 10.106335163116455, "time_total_s": 2559.3025732040405, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 590.3507070541382, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 19.426666666666666, "ram_util_percent": 63.65333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1171.178173828125, "policy_loss": -8668693534940.9, "vf_loss": 215160545.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 892.0}}, "num_env_steps_sampled": 193920, "num_env_steps_trained": 193920, "num_agent_steps_sampled": 193920, "num_agent_steps_trained": 193920}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11318.490024532197, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.619605060606111, "mean_inference_ms": 0.3719470997524704, "mean_action_processing_ms": 0.09056699606617491, "mean_env_wait_ms": 1.1796475691600232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037078857421875, "StateBufferConnector_ms": 0.002720355987548828, "ViewRequirementAgentConnector_ms": 0.06650185585021973}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11318.490024532197, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11004.838609702134, -11196.600216046287, -11149.523375042872, -10896.793704665015, -11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.619605060606111, "mean_inference_ms": 0.3719470997524704, "mean_action_processing_ms": 0.09056699606617491, "mean_env_wait_ms": 1.1796475691600232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037078857421875, "StateBufferConnector_ms": 0.002720355987548828, "ViewRequirementAgentConnector_ms": 0.06650185585021973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193920, "num_agent_steps_trained": 193920, "num_env_steps_sampled": 193920, "num_env_steps_trained": 193920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.26842050486755, "num_env_steps_trained_throughput_per_sec": 107.26842050486755, "timesteps_total": 193920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 193920, "timers": {"training_iteration_time_ms": 3351.762, "sample_time_ms": 3341.106, "load_time_ms": 0.306, "load_throughput": 1176522.861, "learn_time_ms": 9.607, "learn_throughput": 37474.423, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 193920, "num_env_steps_trained": 193920, "num_agent_steps_sampled": 193920, "num_agent_steps_trained": 193920}, "done": false, "episodes_total": 1072, "training_iteration": 234, "trial_id": "04904_00000", "date": "2023-07-26_22-12-58", "timestamp": 1690398778, "time_this_iter_s": 10.071076154708862, "time_total_s": 2569.3736493587494, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 600.421783208847, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 20.54285714285714, "ram_util_percent": 63.364285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -1173.3853515625, "policy_loss": -16490568561459.2, "vf_loss": 222882315.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 913.0, "diff_num_grad_updates_vs_sampler_policy": 912.0}}, "num_env_steps_sampled": 195360, "num_env_steps_trained": 195360, "num_agent_steps_sampled": 195360, "num_agent_steps_trained": 195360}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11332.366140971084, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6206519055250945, "mean_inference_ms": 0.37196117822760255, "mean_action_processing_ms": 0.09056940708156928, "mean_env_wait_ms": 1.1778489745301255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037026405334472656, "StateBufferConnector_ms": 0.0027205944061279297, "ViewRequirementAgentConnector_ms": 0.06650781631469727}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11332.366140971084, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11633.387733342517, -11386.038669172385, -11233.17296326499, -10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6206519055250945, "mean_inference_ms": 0.37196117822760255, "mean_action_processing_ms": 0.09056940708156928, "mean_env_wait_ms": 1.1778489745301255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037026405334472656, "StateBufferConnector_ms": 0.0027205944061279297, "ViewRequirementAgentConnector_ms": 0.06650781631469727}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195360, "num_agent_steps_trained": 195360, "num_env_steps_sampled": 195360, "num_env_steps_trained": 195360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.23524427801225, "num_env_steps_trained_throughput_per_sec": 108.23524427801225, "timesteps_total": 195360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 195360, "timers": {"training_iteration_time_ms": 3347.603, "sample_time_ms": 3336.995, "load_time_ms": 0.305, "load_throughput": 1178451.136, "learn_time_ms": 9.551, "learn_throughput": 37693.797, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 195360, "num_env_steps_trained": 195360, "num_agent_steps_sampled": 195360, "num_agent_steps_trained": 195360}, "done": false, "episodes_total": 1076, "training_iteration": 235, "trial_id": "04904_00000", "date": "2023-07-26_22-13-12", "timestamp": 1690398792, "time_this_iter_s": 13.3072829246521, "time_total_s": 2582.6809322834015, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 613.7290661334991, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 20.489473684210527, "ram_util_percent": 63.45263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.465925925925926e-06, "entropy_coeff": 0.05, "policy_entropy": -1174.842724609375, "policy_loss": -13227025183539.2, "vf_loss": 215004305.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 928.0, "diff_num_grad_updates_vs_sampler_policy": 927.0}}, "num_env_steps_sampled": 196440, "num_env_steps_trained": 196440, "num_agent_steps_sampled": 196440, "num_agent_steps_trained": 196440}, "sampler_results": {"episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11330.41737220325, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.621459642942888, "mean_inference_ms": 0.3719730738553274, "mean_action_processing_ms": 0.0905715041959088, "mean_env_wait_ms": 1.176620584565548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037107467651367188, "StateBufferConnector_ms": 0.002721071243286133, "ViewRequirementAgentConnector_ms": 0.06655192375183105}}, "episode_reward_max": -10769.553438939662, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11330.41737220325, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10769.553438939662, -11315.434390632432, -11010.602989677158, -11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.621459642942888, "mean_inference_ms": 0.3719730738553274, "mean_action_processing_ms": 0.0905715041959088, "mean_env_wait_ms": 1.176620584565548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037107467651367188, "StateBufferConnector_ms": 0.002721071243286133, "ViewRequirementAgentConnector_ms": 0.06655192375183105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196440, "num_agent_steps_trained": 196440, "num_env_steps_sampled": 196440, "num_env_steps_trained": 196440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.98380550660691, "num_env_steps_trained_throughput_per_sec": 105.98380550660691, "timesteps_total": 196440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 196440, "timers": {"training_iteration_time_ms": 3356.266, "sample_time_ms": 3345.675, "load_time_ms": 0.301, "load_throughput": 1194580.253, "learn_time_ms": 9.551, "learn_throughput": 37690.692, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 196440, "num_env_steps_trained": 196440, "num_agent_steps_sampled": 196440, "num_agent_steps_trained": 196440}, "done": false, "episodes_total": 1079, "training_iteration": 236, "trial_id": "04904_00000", "date": "2023-07-26_22-13-22", "timestamp": 1690398802, "time_this_iter_s": 10.193176984786987, "time_total_s": 2592.8741092681885, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 623.9222431182861, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 19.5, "ram_util_percent": 63.29333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.665925925925926e-06, "entropy_coeff": 0.05, "policy_entropy": -1176.4121826171875, "policy_loss": -12509338979532.8, "vf_loss": 215308284.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 943.0, "diff_num_grad_updates_vs_sampler_policy": 942.0}}, "num_env_steps_sampled": 197520, "num_env_steps_trained": 197520, "num_agent_steps_sampled": 197520, "num_agent_steps_trained": 197520}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11337.06202336212, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.622210000900607, "mean_inference_ms": 0.37198713312339626, "mean_action_processing_ms": 0.0905739406758055, "mean_env_wait_ms": 1.1755409747627243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.002712726593017578, "ViewRequirementAgentConnector_ms": 0.0665283203125}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11337.06202336212, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11216.961348118633, -11290.805829565583, -11365.198543833078, -11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.622210000900607, "mean_inference_ms": 0.37198713312339626, "mean_action_processing_ms": 0.0905739406758055, "mean_env_wait_ms": 1.1755409747627243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.002712726593017578, "ViewRequirementAgentConnector_ms": 0.0665283203125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197520, "num_agent_steps_trained": 197520, "num_env_steps_sampled": 197520, "num_env_steps_trained": 197520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.90673715761422, "num_env_steps_trained_throughput_per_sec": 107.90673715761422, "timesteps_total": 197520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 197520, "timers": {"training_iteration_time_ms": 3350.31, "sample_time_ms": 3339.753, "load_time_ms": 0.298, "load_throughput": 1206318.958, "learn_time_ms": 9.528, "learn_throughput": 37783.875, "synch_weights_time_ms": 0.686}, "counters": {"num_env_steps_sampled": 197520, "num_env_steps_trained": 197520, "num_agent_steps_sampled": 197520, "num_agent_steps_trained": 197520}, "done": false, "episodes_total": 1082, "training_iteration": 237, "trial_id": "04904_00000", "date": "2023-07-26_22-13-32", "timestamp": 1690398812, "time_this_iter_s": 10.011506080627441, "time_total_s": 2602.885615348816, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 633.9337491989136, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 21.414285714285718, "ram_util_percent": 63.157142857142865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.865925925925926e-06, "entropy_coeff": 0.05, "policy_entropy": -1177.4473388671875, "policy_loss": -14457638066585.6, "vf_loss": 217141224.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 958.0, "diff_num_grad_updates_vs_sampler_policy": 957.0}}, "num_env_steps_sampled": 198600, "num_env_steps_trained": 198600, "num_agent_steps_sampled": 198600, "num_agent_steps_trained": 198600}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11335.152472131107, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.622919793768292, "mean_inference_ms": 0.3719971633113663, "mean_action_processing_ms": 0.09057617380958813, "mean_env_wait_ms": 1.1744844202059135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037169456481933594, "StateBufferConnector_ms": 0.002710580825805664, "ViewRequirementAgentConnector_ms": 0.06654214859008789}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11335.152472131107, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11482.92898135825, -11255.978745116758, -11165.847375053763, -11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.622919793768292, "mean_inference_ms": 0.3719971633113663, "mean_action_processing_ms": 0.09057617380958813, "mean_env_wait_ms": 1.1744844202059135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037169456481933594, "StateBufferConnector_ms": 0.002710580825805664, "ViewRequirementAgentConnector_ms": 0.06654214859008789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198600, "num_agent_steps_trained": 198600, "num_env_steps_sampled": 198600, "num_env_steps_trained": 198600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.9669507102926, "num_env_steps_trained_throughput_per_sec": 107.9669507102926, "timesteps_total": 198600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 198600, "timers": {"training_iteration_time_ms": 3351.352, "sample_time_ms": 3340.692, "load_time_ms": 0.299, "load_throughput": 1202955.258, "learn_time_ms": 9.615, "learn_throughput": 37440.878, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 198600, "num_env_steps_trained": 198600, "num_agent_steps_sampled": 198600, "num_agent_steps_trained": 198600}, "done": false, "episodes_total": 1085, "training_iteration": 238, "trial_id": "04904_00000", "date": "2023-07-26_22-13-42", "timestamp": 1690398822, "time_this_iter_s": 10.00582218170166, "time_total_s": 2612.8914375305176, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 643.9395713806152, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.900000000000002, "ram_util_percent": 63.22142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0659259259259255e-06, "entropy_coeff": 0.05, "policy_entropy": -1178.166845703125, "policy_loss": -11393266614272.0, "vf_loss": 212933761.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 973.0, "diff_num_grad_updates_vs_sampler_policy": 972.0}}, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11336.551650891362, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.623581616615844, "mean_inference_ms": 0.3720059390355182, "mean_action_processing_ms": 0.09057837378993852, "mean_env_wait_ms": 1.1735101695946304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036897659301757812, "StateBufferConnector_ms": 0.0026862621307373047, "ViewRequirementAgentConnector_ms": 0.06592416763305664}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11336.551650891362, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11492.416676781602, -11272.520088166428, -11597.874114363418, -11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.623581616615844, "mean_inference_ms": 0.3720059390355182, "mean_action_processing_ms": 0.09057837378993852, "mean_env_wait_ms": 1.1735101695946304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036897659301757812, "StateBufferConnector_ms": 0.0026862621307373047, "ViewRequirementAgentConnector_ms": 0.06592416763305664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.75193579797445, "num_env_steps_trained_throughput_per_sec": 105.75193579797445, "timesteps_total": 199680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 199680, "timers": {"training_iteration_time_ms": 3361.254, "sample_time_ms": 3350.556, "load_time_ms": 0.314, "load_throughput": 1146158.676, "learn_time_ms": 9.644, "learn_throughput": 37327.126, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "done": false, "episodes_total": 1088, "training_iteration": 239, "trial_id": "04904_00000", "date": "2023-07-26_22-13-52", "timestamp": 1690398832, "time_this_iter_s": 10.215441942214966, "time_total_s": 2623.1068794727325, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 654.1550133228302, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 19.353333333333335, "ram_util_percent": 63.24666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2659259259259255e-06, "entropy_coeff": 0.05, "policy_entropy": -1178.7757080078125, "policy_loss": -13855616442056.75, "vf_loss": 213850512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 988.0, "diff_num_grad_updates_vs_sampler_policy": 987.0}}, "num_env_steps_sampled": 200760, "num_env_steps_trained": 200760, "num_agent_steps_sampled": 200760, "num_agent_steps_trained": 200760}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11333.077490544332, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6242062446987475, "mean_inference_ms": 0.3720150224180934, "mean_action_processing_ms": 0.09058087757242662, "mean_env_wait_ms": 1.172588916290815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036911964416503906, "StateBufferConnector_ms": 0.002690553665161133, "ViewRequirementAgentConnector_ms": 0.06599545478820801}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11333.077490544332, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11336.885168822233, -11334.856378781395, -11392.182024868509, -11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6242062446987475, "mean_inference_ms": 0.3720150224180934, "mean_action_processing_ms": 0.09058087757242662, "mean_env_wait_ms": 1.172588916290815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036911964416503906, "StateBufferConnector_ms": 0.002690553665161133, "ViewRequirementAgentConnector_ms": 0.06599545478820801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200760, "num_agent_steps_trained": 200760, "num_env_steps_sampled": 200760, "num_env_steps_trained": 200760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.33565478351676, "num_env_steps_trained_throughput_per_sec": 107.33565478351676, "timesteps_total": 200760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 200760, "timers": {"training_iteration_time_ms": 3367.421, "sample_time_ms": 3356.729, "load_time_ms": 0.314, "load_throughput": 1145202.457, "learn_time_ms": 9.639, "learn_throughput": 37347.9, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 200760, "num_env_steps_trained": 200760, "num_agent_steps_sampled": 200760, "num_agent_steps_trained": 200760}, "done": false, "episodes_total": 1091, "training_iteration": 240, "trial_id": "04904_00000", "date": "2023-07-26_22-14-02", "timestamp": 1690398842, "time_this_iter_s": 10.064712047576904, "time_total_s": 2633.1715915203094, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 664.2197253704071, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 20.407142857142862, "ram_util_percent": 63.17142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1179.197216796875, "policy_loss": -13033257461350.4, "vf_loss": 214565115.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1003.0, "diff_num_grad_updates_vs_sampler_policy": 1002.0}}, "num_env_steps_sampled": 201840, "num_env_steps_trained": 201840, "num_agent_steps_sampled": 201840, "num_agent_steps_trained": 201840}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11331.339571448374, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624838947215582, "mean_inference_ms": 0.37202307791924916, "mean_action_processing_ms": 0.09058326608576034, "mean_env_wait_ms": 1.1716919134480641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003685474395751953, "StateBufferConnector_ms": 0.0026886463165283203, "ViewRequirementAgentConnector_ms": 0.06595325469970703}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11331.339571448374, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11265.170703944248, -11220.05555583643, -11232.798333488518, -11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624838947215582, "mean_inference_ms": 0.37202307791924916, "mean_action_processing_ms": 0.09058326608576034, "mean_env_wait_ms": 1.1716919134480641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003685474395751953, "StateBufferConnector_ms": 0.0026886463165283203, "ViewRequirementAgentConnector_ms": 0.06595325469970703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201840, "num_agent_steps_trained": 201840, "num_env_steps_sampled": 201840, "num_env_steps_trained": 201840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.95879125004022, "num_env_steps_trained_throughput_per_sec": 107.95879125004022, "timesteps_total": 201840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 201840, "timers": {"training_iteration_time_ms": 3364.644, "sample_time_ms": 3354.007, "load_time_ms": 0.314, "load_throughput": 1145289.32, "learn_time_ms": 9.582, "learn_throughput": 37570.184, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 201840, "num_env_steps_trained": 201840, "num_agent_steps_sampled": 201840, "num_agent_steps_trained": 201840}, "done": false, "episodes_total": 1094, "training_iteration": 241, "trial_id": "04904_00000", "date": "2023-07-26_22-14-12", "timestamp": 1690398852, "time_this_iter_s": 10.006646871566772, "time_total_s": 2643.178238391876, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 674.2263722419739, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 20.749999999999996, "ram_util_percent": 63.228571428571435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1179.464892578125, "policy_loss": -10061910756033.3, "vf_loss": 207395614.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1018.0, "diff_num_grad_updates_vs_sampler_policy": 1017.0}}, "num_env_steps_sampled": 202920, "num_env_steps_trained": 202920, "num_agent_steps_sampled": 202920, "num_agent_steps_trained": 202920}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11333.923677528217, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625454694229396, "mean_inference_ms": 0.37203182719001, "mean_action_processing_ms": 0.09058558049395997, "mean_env_wait_ms": 1.1708627200470287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036923885345458984, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06598138809204102}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11333.923677528217, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11571.780108455383, -11203.1922740396, -11376.593856825624, -11005.418293433924, -11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625454694229396, "mean_inference_ms": 0.37203182719001, "mean_action_processing_ms": 0.09058558049395997, "mean_env_wait_ms": 1.1708627200470287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036923885345458984, "StateBufferConnector_ms": 0.002683877944946289, "ViewRequirementAgentConnector_ms": 0.06598138809204102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202920, "num_agent_steps_trained": 202920, "num_env_steps_sampled": 202920, "num_env_steps_trained": 202920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.43615660971868, "num_env_steps_trained_throughput_per_sec": 106.43615660971868, "timesteps_total": 202920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 202920, "timers": {"training_iteration_time_ms": 3359.335, "sample_time_ms": 3348.467, "load_time_ms": 0.31, "load_throughput": 1160963.74, "learn_time_ms": 9.789, "learn_throughput": 36774.488, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 202920, "num_env_steps_trained": 202920, "num_agent_steps_sampled": 202920, "num_agent_steps_trained": 202920}, "done": false, "episodes_total": 1097, "training_iteration": 242, "trial_id": "04904_00000", "date": "2023-07-26_22-14-23", "timestamp": 1690398863, "time_this_iter_s": 10.149971961975098, "time_total_s": 2653.3282103538513, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 684.376344203949, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 18.033333333333335, "ram_util_percent": 63.12}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1179.837451171875, "policy_loss": -14371454189568.0, "vf_loss": 211451625.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1038.0, "diff_num_grad_updates_vs_sampler_policy": 1037.0}}, "num_env_steps_sampled": 204360, "num_env_steps_trained": 204360, "num_agent_steps_sampled": 204360, "num_agent_steps_trained": 204360}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11337.66750037049, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.626179046232403, "mean_inference_ms": 0.3720420220009453, "mean_action_processing_ms": 0.09058808725655425, "mean_env_wait_ms": 1.1698453668629427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675222396850586, "StateBufferConnector_ms": 0.0026853084564208984, "ViewRequirementAgentConnector_ms": 0.06593155860900879}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11337.66750037049, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11477.475608005465, -11390.623544665094, -11454.407276930368, -11283.38489193779, -11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.626179046232403, "mean_inference_ms": 0.3720420220009453, "mean_action_processing_ms": 0.09058808725655425, "mean_env_wait_ms": 1.1698453668629427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675222396850586, "StateBufferConnector_ms": 0.0026853084564208984, "ViewRequirementAgentConnector_ms": 0.06593155860900879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204360, "num_agent_steps_trained": 204360, "num_env_steps_sampled": 204360, "num_env_steps_trained": 204360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.02767203589329, "num_env_steps_trained_throughput_per_sec": 108.02767203589329, "timesteps_total": 204360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 204360, "timers": {"training_iteration_time_ms": 3348.053, "sample_time_ms": 3337.197, "load_time_ms": 0.299, "load_throughput": 1204298.485, "learn_time_ms": 9.791, "learn_throughput": 36767.593, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 204360, "num_env_steps_trained": 204360, "num_agent_steps_sampled": 204360, "num_agent_steps_trained": 204360}, "done": false, "episodes_total": 1101, "training_iteration": 243, "trial_id": "04904_00000", "date": "2023-07-26_22-14-36", "timestamp": 1690398876, "time_this_iter_s": 13.332704067230225, "time_total_s": 2666.6609144210815, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 697.7090482711792, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 21.673684210526318, "ram_util_percent": 63.284210526315796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1180.224951171875, "policy_loss": -9541939700608.79, "vf_loss": 209062420.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 1057.0}}, "num_env_steps_sampled": 205800, "num_env_steps_trained": 205800, "num_agent_steps_sampled": 205800, "num_agent_steps_trained": 205800}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11335.622236607449, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6269003843471435, "mean_inference_ms": 0.3720497963813457, "mean_action_processing_ms": 0.09058997812886098, "mean_env_wait_ms": 1.1688738482314611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036776065826416016, "StateBufferConnector_ms": 0.00267791748046875, "ViewRequirementAgentConnector_ms": 0.06592226028442383}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11335.622236607449, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11414.244543943458, -11154.23871757007, -11460.297199669814, -11372.340978969385, -11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6269003843471435, "mean_inference_ms": 0.3720497963813457, "mean_action_processing_ms": 0.09058997812886098, "mean_env_wait_ms": 1.1688738482314611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036776065826416016, "StateBufferConnector_ms": 0.00267791748046875, "ViewRequirementAgentConnector_ms": 0.06592226028442383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 205800, "num_agent_steps_trained": 205800, "num_env_steps_sampled": 205800, "num_env_steps_trained": 205800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.1915566273327, "num_env_steps_trained_throughput_per_sec": 108.1915566273327, "timesteps_total": 205800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 205800, "timers": {"training_iteration_time_ms": 3338.52, "sample_time_ms": 3327.635, "load_time_ms": 0.299, "load_throughput": 1203722.449, "learn_time_ms": 9.836, "learn_throughput": 36600.931, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 205800, "num_env_steps_trained": 205800, "num_agent_steps_sampled": 205800, "num_agent_steps_trained": 205800}, "done": false, "episodes_total": 1105, "training_iteration": 244, "trial_id": "04904_00000", "date": "2023-07-26_22-14-49", "timestamp": 1690398889, "time_this_iter_s": 13.312621116638184, "time_total_s": 2679.9735355377197, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 711.0216693878174, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 20.383333333333333, "ram_util_percent": 63.4388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1180.6192626953125, "policy_loss": -21383113762406.4, "vf_loss": 223405950.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1078.0, "diff_num_grad_updates_vs_sampler_policy": 1077.0}}, "num_env_steps_sampled": 207240, "num_env_steps_trained": 207240, "num_agent_steps_sampled": 207240, "num_agent_steps_trained": 207240}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11339.689912603782, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627513957363593, "mean_inference_ms": 0.37206028596917645, "mean_action_processing_ms": 0.0905922328166783, "mean_env_wait_ms": 1.167898921142112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675222396850586, "StateBufferConnector_ms": 0.0026857852935791016, "ViewRequirementAgentConnector_ms": 0.06590080261230469}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11339.689912603782, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11365.546873587962, -11479.130778235674, -11114.068281297927, -11286.507584678324, -11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627513957363593, "mean_inference_ms": 0.37206028596917645, "mean_action_processing_ms": 0.0905922328166783, "mean_env_wait_ms": 1.167898921142112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675222396850586, "StateBufferConnector_ms": 0.0026857852935791016, "ViewRequirementAgentConnector_ms": 0.06590080261230469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207240, "num_agent_steps_trained": 207240, "num_env_steps_sampled": 207240, "num_env_steps_trained": 207240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.65273216989154, "num_env_steps_trained_throughput_per_sec": 107.65273216989154, "timesteps_total": 207240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 207240, "timers": {"training_iteration_time_ms": 3337.524, "sample_time_ms": 3326.848, "load_time_ms": 0.304, "load_throughput": 1186041.505, "learn_time_ms": 9.627, "learn_throughput": 37395.813, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 207240, "num_env_steps_trained": 207240, "num_agent_steps_sampled": 207240, "num_agent_steps_trained": 207240}, "done": false, "episodes_total": 1109, "training_iteration": 245, "trial_id": "04904_00000", "date": "2023-07-26_22-15-03", "timestamp": 1690398903, "time_this_iter_s": 13.379188776016235, "time_total_s": 2693.352724313736, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 724.4008581638336, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 23.57894736842105, "ram_util_percent": 63.42631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1181.0786376953124, "policy_loss": -17229320237875.2, "vf_loss": 214518145.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1098.0, "diff_num_grad_updates_vs_sampler_policy": 1097.0}}, "num_env_steps_sampled": 208680, "num_env_steps_trained": 208680, "num_agent_steps_sampled": 208680, "num_agent_steps_trained": 208680}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11344.627932919313, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628098300413273, "mean_inference_ms": 0.3720707557958069, "mean_action_processing_ms": 0.0905942117909957, "mean_env_wait_ms": 1.1670244201713622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036695003509521484, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.0658109188079834}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11344.627932919313, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11061.79029332379, -11543.794812281272, -11244.365176806554, -11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628098300413273, "mean_inference_ms": 0.3720707557958069, "mean_action_processing_ms": 0.0905942117909957, "mean_env_wait_ms": 1.1670244201713622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036695003509521484, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.0658109188079834}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208680, "num_agent_steps_trained": 208680, "num_env_steps_sampled": 208680, "num_env_steps_trained": 208680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.4028537111347, "num_env_steps_trained_throughput_per_sec": 107.4028537111347, "timesteps_total": 208680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 208680, "timers": {"training_iteration_time_ms": 3348.392, "sample_time_ms": 3337.77, "load_time_ms": 0.301, "load_throughput": 1194202.341, "learn_time_ms": 9.574, "learn_throughput": 37602.275, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 208680, "num_env_steps_trained": 208680, "num_agent_steps_sampled": 208680, "num_agent_steps_trained": 208680}, "done": false, "episodes_total": 1113, "training_iteration": 246, "trial_id": "04904_00000", "date": "2023-07-26_22-15-16", "timestamp": 1690398916, "time_this_iter_s": 13.410179138183594, "time_total_s": 2706.7629034519196, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 737.8110373020172, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 20.695, "ram_util_percent": 63.39499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1181.4741943359375, "policy_loss": -21137936980377.6, "vf_loss": 221229014.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1113.0, "diff_num_grad_updates_vs_sampler_policy": 1112.0}}, "num_env_steps_sampled": 209760, "num_env_steps_trained": 209760, "num_agent_steps_sampled": 209760, "num_agent_steps_trained": 209760}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11345.488852816936, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628535263321164, "mean_inference_ms": 0.3720778951899191, "mean_action_processing_ms": 0.09059549046958379, "mean_env_wait_ms": 1.1664136127098903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036635398864746094, "StateBufferConnector_ms": 0.0026743412017822266, "ViewRequirementAgentConnector_ms": 0.06580400466918945}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11765.48083902782, "episode_reward_mean": -11345.488852816936, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11297.129973814297, -11357.455544496737, -11765.48083902782, -11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628535263321164, "mean_inference_ms": 0.3720778951899191, "mean_action_processing_ms": 0.09059549046958379, "mean_env_wait_ms": 1.1664136127098903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036635398864746094, "StateBufferConnector_ms": 0.0026743412017822266, "ViewRequirementAgentConnector_ms": 0.06580400466918945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209760, "num_agent_steps_trained": 209760, "num_env_steps_sampled": 209760, "num_env_steps_trained": 209760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.72915502738013, "num_env_steps_trained_throughput_per_sec": 106.72915502738013, "timesteps_total": 209760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 209760, "timers": {"training_iteration_time_ms": 3349.646, "sample_time_ms": 3339.047, "load_time_ms": 0.298, "load_throughput": 1207862.923, "learn_time_ms": 9.552, "learn_throughput": 37688.529, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 209760, "num_env_steps_trained": 209760, "num_agent_steps_sampled": 209760, "num_agent_steps_trained": 209760}, "done": false, "episodes_total": 1116, "training_iteration": 247, "trial_id": "04904_00000", "date": "2023-07-26_22-15-26", "timestamp": 1690398926, "time_this_iter_s": 10.121786117553711, "time_total_s": 2716.8846895694733, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 747.9328234195709, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 19.792857142857144, "ram_util_percent": 62.99285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1181.699755859375, "policy_loss": -24831110991052.8, "vf_loss": 220274083.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1128.0, "diff_num_grad_updates_vs_sampler_policy": 1127.0}}, "num_env_steps_sampled": 210840, "num_env_steps_trained": 210840, "num_agent_steps_sampled": 210840, "num_agent_steps_trained": 210840}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11346.028934950325, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628956515542327, "mean_inference_ms": 0.3720838450222596, "mean_action_processing_ms": 0.0905965427915458, "mean_env_wait_ms": 1.1658570364325687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003662109375, "StateBufferConnector_ms": 0.002666473388671875, "ViewRequirementAgentConnector_ms": 0.06563758850097656}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11346.028934950325, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11302.448960102603, -11505.66755258417, -11198.201281767344, -10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628956515542327, "mean_inference_ms": 0.3720838450222596, "mean_action_processing_ms": 0.0905965427915458, "mean_env_wait_ms": 1.1658570364325687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003662109375, "StateBufferConnector_ms": 0.002666473388671875, "ViewRequirementAgentConnector_ms": 0.06563758850097656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210840, "num_agent_steps_trained": 210840, "num_env_steps_sampled": 210840, "num_env_steps_trained": 210840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.45303529621444, "num_env_steps_trained_throughput_per_sec": 106.45303529621444, "timesteps_total": 210840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 210840, "timers": {"training_iteration_time_ms": 3367.173, "sample_time_ms": 3356.502, "load_time_ms": 0.297, "load_throughput": 1210283.296, "learn_time_ms": 9.627, "learn_throughput": 37393.22, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 210840, "num_env_steps_trained": 210840, "num_agent_steps_sampled": 210840, "num_agent_steps_trained": 210840}, "done": false, "episodes_total": 1119, "training_iteration": 248, "trial_id": "04904_00000", "date": "2023-07-26_22-15-36", "timestamp": 1690398936, "time_this_iter_s": 10.148099660873413, "time_total_s": 2727.0327892303467, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 758.0809230804443, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 19.828571428571426, "ram_util_percent": 63.107142857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1182.0739501953126, "policy_loss": -21376672884326.4, "vf_loss": 218826768.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1143.0, "diff_num_grad_updates_vs_sampler_policy": 1142.0}}, "num_env_steps_sampled": 211920, "num_env_steps_trained": 211920, "num_agent_steps_sampled": 211920, "num_agent_steps_trained": 211920}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11347.231025812973, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629405221477364, "mean_inference_ms": 0.3720887860625488, "mean_action_processing_ms": 0.09059724868436207, "mean_env_wait_ms": 1.1653155908890083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036535263061523438, "StateBufferConnector_ms": 0.002665996551513672, "ViewRequirementAgentConnector_ms": 0.06562423706054688}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11347.231025812973, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10949.295884999967, -11290.585027549403, -11486.936980447585, -11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629405221477364, "mean_inference_ms": 0.3720887860625488, "mean_action_processing_ms": 0.09059724868436207, "mean_env_wait_ms": 1.1653155908890083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036535263061523438, "StateBufferConnector_ms": 0.002665996551513672, "ViewRequirementAgentConnector_ms": 0.06562423706054688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211920, "num_agent_steps_trained": 211920, "num_env_steps_sampled": 211920, "num_env_steps_trained": 211920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.63188295071176, "num_env_steps_trained_throughput_per_sec": 106.63188295071176, "timesteps_total": 211920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 211920, "timers": {"training_iteration_time_ms": 3380.12, "sample_time_ms": 3369.409, "load_time_ms": 0.297, "load_throughput": 1211545.727, "learn_time_ms": 9.662, "learn_throughput": 37260.53, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 211920, "num_env_steps_trained": 211920, "num_agent_steps_sampled": 211920, "num_agent_steps_trained": 211920}, "done": false, "episodes_total": 1122, "training_iteration": 249, "trial_id": "04904_00000", "date": "2023-07-26_22-15-47", "timestamp": 1690398947, "time_this_iter_s": 10.13100790977478, "time_total_s": 2737.1637971401215, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 768.2119309902191, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 20.206666666666663, "ram_util_percent": 63.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1182.3163330078125, "policy_loss": -14702536482917.2, "vf_loss": 210507321.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1158.0, "diff_num_grad_updates_vs_sampler_policy": 1157.0}}, "num_env_steps_sampled": 213000, "num_env_steps_trained": 213000, "num_agent_steps_sampled": 213000, "num_agent_steps_trained": 213000}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11354.670269808727, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629855321752169, "mean_inference_ms": 0.3720951059364055, "mean_action_processing_ms": 0.09059821052644836, "mean_env_wait_ms": 1.1647959199409494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003652334213256836, "StateBufferConnector_ms": 0.0026650428771972656, "ViewRequirementAgentConnector_ms": 0.06564855575561523}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11354.670269808727, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11409.464013205836, -11379.57388512023, -11460.307183004308, -11462.760537140532, -11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629855321752169, "mean_inference_ms": 0.3720951059364055, "mean_action_processing_ms": 0.09059821052644836, "mean_env_wait_ms": 1.1647959199409494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003652334213256836, "StateBufferConnector_ms": 0.0026650428771972656, "ViewRequirementAgentConnector_ms": 0.06564855575561523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 213000, "num_agent_steps_trained": 213000, "num_env_steps_sampled": 213000, "num_env_steps_trained": 213000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.50628524509152, "num_env_steps_trained_throughput_per_sec": 106.50628524509152, "timesteps_total": 213000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 213000, "timers": {"training_iteration_time_ms": 3380.732, "sample_time_ms": 3370.025, "load_time_ms": 0.296, "load_throughput": 1215642.412, "learn_time_ms": 9.666, "learn_throughput": 37243.711, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 213000, "num_env_steps_trained": 213000, "num_agent_steps_sampled": 213000, "num_agent_steps_trained": 213000}, "done": false, "episodes_total": 1125, "training_iteration": 250, "trial_id": "04904_00000", "date": "2023-07-26_22-15-57", "timestamp": 1690398957, "time_this_iter_s": 10.14303994178772, "time_total_s": 2747.306837081909, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 778.3549709320068, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 19.857142857142858, "ram_util_percent": 63.135714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1182.557763671875, "policy_loss": -18332840676556.8, "vf_loss": 218078817.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 214440, "num_env_steps_trained": 214440, "num_agent_steps_sampled": 214440, "num_agent_steps_trained": 214440}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11348.641350642656, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630384356511992, "mean_inference_ms": 0.372105330859289, "mean_action_processing_ms": 0.09059972333839289, "mean_env_wait_ms": 1.1640985447929957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036568641662597656, "StateBufferConnector_ms": 0.002658843994140625, "ViewRequirementAgentConnector_ms": 0.06568551063537598}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11348.641350642656, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11105.67094062417, -11217.521393353783, -11514.881803824863, -11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630384356511992, "mean_inference_ms": 0.372105330859289, "mean_action_processing_ms": 0.09059972333839289, "mean_env_wait_ms": 1.1640985447929957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036568641662597656, "StateBufferConnector_ms": 0.002658843994140625, "ViewRequirementAgentConnector_ms": 0.06568551063537598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214440, "num_agent_steps_trained": 214440, "num_env_steps_sampled": 214440, "num_env_steps_trained": 214440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.85969869205735, "num_env_steps_trained_throughput_per_sec": 107.85969869205735, "timesteps_total": 214440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 214440, "timers": {"training_iteration_time_ms": 3361.906, "sample_time_ms": 3351.358, "load_time_ms": 0.298, "load_throughput": 1207476.561, "learn_time_ms": 9.496, "learn_throughput": 37909.567, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 214440, "num_env_steps_trained": 214440, "num_agent_steps_sampled": 214440, "num_agent_steps_trained": 214440}, "done": false, "episodes_total": 1129, "training_iteration": 251, "trial_id": "04904_00000", "date": "2023-07-26_22-16-10", "timestamp": 1690398970, "time_this_iter_s": 13.353417158126831, "time_total_s": 2760.660254240036, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 791.7083880901337, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 21.247368421052627, "ram_util_percent": 63.18421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1182.9870361328126, "policy_loss": -19284468789671.273, "vf_loss": 212286147.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 1192.0}}, "num_env_steps_sampled": 215520, "num_env_steps_trained": 215520, "num_agent_steps_sampled": 215520, "num_agent_steps_trained": 215520}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11351.007937097482, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630779899397154, "mean_inference_ms": 0.3721129155180434, "mean_action_processing_ms": 0.09060051746269467, "mean_env_wait_ms": 1.163603988678066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654956817626953, "StateBufferConnector_ms": 0.0026543140411376953, "ViewRequirementAgentConnector_ms": 0.06569051742553711}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11351.007937097482, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11179.338217603561, -11171.039519396996, -11332.161617445548, -11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630779899397154, "mean_inference_ms": 0.3721129155180434, "mean_action_processing_ms": 0.09060051746269467, "mean_env_wait_ms": 1.163603988678066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654956817626953, "StateBufferConnector_ms": 0.0026543140411376953, "ViewRequirementAgentConnector_ms": 0.06569051742553711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215520, "num_agent_steps_trained": 215520, "num_env_steps_sampled": 215520, "num_env_steps_trained": 215520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.94706339736726, "num_env_steps_trained_throughput_per_sec": 106.94706339736726, "timesteps_total": 215520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 215520, "timers": {"training_iteration_time_ms": 3358.921, "sample_time_ms": 3348.421, "load_time_ms": 0.298, "load_throughput": 1206993.957, "learn_time_ms": 9.465, "learn_throughput": 38035.715, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 215520, "num_env_steps_trained": 215520, "num_agent_steps_sampled": 215520, "num_agent_steps_trained": 215520}, "done": false, "episodes_total": 1132, "training_iteration": 252, "trial_id": "04904_00000", "date": "2023-07-26_22-16-20", "timestamp": 1690398980, "time_this_iter_s": 10.101231098175049, "time_total_s": 2770.761485338211, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 801.8096191883087, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 20.692857142857143, "ram_util_percent": 63.142857142857146}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -1183.24951171875, "policy_loss": -12080457449472.0, "vf_loss": 211085304.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1208.0, "diff_num_grad_updates_vs_sampler_policy": 1207.0}}, "num_env_steps_sampled": 216600, "num_env_steps_trained": 216600, "num_agent_steps_sampled": 216600, "num_agent_steps_trained": 216600}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11353.941447142493, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631160252183105, "mean_inference_ms": 0.372122246741905, "mean_action_processing_ms": 0.09060155762652085, "mean_env_wait_ms": 1.1631696909901839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036623477935791016, "StateBufferConnector_ms": 0.002657175064086914, "ViewRequirementAgentConnector_ms": 0.06571149826049805}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11632.30085349893, "episode_reward_mean": -11353.941447142493, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11632.30085349893, -11415.018220723423, -11194.663938789354, -11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631160252183105, "mean_inference_ms": 0.372122246741905, "mean_action_processing_ms": 0.09060155762652085, "mean_env_wait_ms": 1.1631696909901839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036623477935791016, "StateBufferConnector_ms": 0.002657175064086914, "ViewRequirementAgentConnector_ms": 0.06571149826049805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216600, "num_agent_steps_trained": 216600, "num_env_steps_sampled": 216600, "num_env_steps_trained": 216600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.64758365976635, "num_env_steps_trained_throughput_per_sec": 107.64758365976635, "timesteps_total": 216600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 216600, "timers": {"training_iteration_time_ms": 3348.17, "sample_time_ms": 3337.663, "load_time_ms": 0.3, "load_throughput": 1201997.644, "learn_time_ms": 9.467, "learn_throughput": 38025.179, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 216600, "num_env_steps_trained": 216600, "num_agent_steps_sampled": 216600, "num_agent_steps_trained": 216600}, "done": false, "episodes_total": 1135, "training_iteration": 253, "trial_id": "04904_00000", "date": "2023-07-26_22-16-30", "timestamp": 1690398990, "time_this_iter_s": 10.035513877868652, "time_total_s": 2780.7969992160797, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 811.8451330661774, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 20.200000000000006, "ram_util_percent": 63.12857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.66574074074074e-07, "entropy_coeff": 0.05, "policy_entropy": -1183.5997314453125, "policy_loss": -19081479376076.8, "vf_loss": 214011795.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1223.0, "diff_num_grad_updates_vs_sampler_policy": 1222.0}}, "num_env_steps_sampled": 217680, "num_env_steps_trained": 217680, "num_agent_steps_sampled": 217680, "num_agent_steps_trained": 217680}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11348.872618382682, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631538309232743, "mean_inference_ms": 0.3721324276235564, "mean_action_processing_ms": 0.09060268405872707, "mean_env_wait_ms": 1.1627598023306964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003660917282104492, "StateBufferConnector_ms": 0.002655029296875, "ViewRequirementAgentConnector_ms": 0.0657351016998291}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11348.872618382682, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11373.442215692536, -11335.761424354276, -11194.658373397275, -11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631538309232743, "mean_inference_ms": 0.3721324276235564, "mean_action_processing_ms": 0.09060268405872707, "mean_env_wait_ms": 1.1627598023306964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003660917282104492, "StateBufferConnector_ms": 0.002655029296875, "ViewRequirementAgentConnector_ms": 0.0657351016998291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217680, "num_agent_steps_trained": 217680, "num_env_steps_sampled": 217680, "num_env_steps_trained": 217680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.56062336341506, "num_env_steps_trained_throughput_per_sec": 107.56062336341506, "timesteps_total": 217680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 217680, "timers": {"training_iteration_time_ms": 3355.98, "sample_time_ms": 3345.384, "load_time_ms": 0.297, "load_throughput": 1210089.309, "learn_time_ms": 9.545, "learn_throughput": 37717.242, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 217680, "num_env_steps_trained": 217680, "num_agent_steps_sampled": 217680, "num_agent_steps_trained": 217680}, "done": false, "episodes_total": 1138, "training_iteration": 254, "trial_id": "04904_00000", "date": "2023-07-26_22-16-40", "timestamp": 1690399000, "time_this_iter_s": 10.043505191802979, "time_total_s": 2790.8405044078827, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 821.8886382579803, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 20.866666666666664, "ram_util_percent": 63.38666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.665740740740742e-07, "entropy_coeff": 0.05, "policy_entropy": -1183.695947265625, "policy_loss": -13067227758592.0, "vf_loss": 206933030.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1238.0, "diff_num_grad_updates_vs_sampler_policy": 1237.0}}, "num_env_steps_sampled": 218760, "num_env_steps_trained": 218760, "num_agent_steps_sampled": 218760, "num_agent_steps_trained": 218760}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11347.827069181682, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631905568642694, "mean_inference_ms": 0.3721429153940402, "mean_action_processing_ms": 0.09060368949701117, "mean_env_wait_ms": 1.162354412887312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003667116165161133, "StateBufferConnector_ms": 0.0026569366455078125, "ViewRequirementAgentConnector_ms": 0.06577086448669434}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11347.827069181682, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11492.236103511226, -11488.061995459331, -11375.75860485072, -11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631905568642694, "mean_inference_ms": 0.3721429153940402, "mean_action_processing_ms": 0.09060368949701117, "mean_env_wait_ms": 1.162354412887312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003667116165161133, "StateBufferConnector_ms": 0.0026569366455078125, "ViewRequirementAgentConnector_ms": 0.06577086448669434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218760, "num_agent_steps_trained": 218760, "num_env_steps_sampled": 218760, "num_env_steps_trained": 218760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.51843741854256, "num_env_steps_trained_throughput_per_sec": 107.51843741854256, "timesteps_total": 218760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 218760, "timers": {"training_iteration_time_ms": 3347.521, "sample_time_ms": 3336.845, "load_time_ms": 0.297, "load_throughput": 1211157.006, "learn_time_ms": 9.625, "learn_throughput": 37401.0, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 218760, "num_env_steps_trained": 218760, "num_agent_steps_sampled": 218760, "num_agent_steps_trained": 218760}, "done": false, "episodes_total": 1141, "training_iteration": 255, "trial_id": "04904_00000", "date": "2023-07-26_22-16-50", "timestamp": 1690399010, "time_this_iter_s": 10.047388076782227, "time_total_s": 2800.887892484665, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 831.9360263347626, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 20.80714285714286, "ram_util_percent": 63.30714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.665740740740741e-07, "entropy_coeff": 0.05, "policy_entropy": -1183.8083740234374, "policy_loss": -19998735282995.2, "vf_loss": 215111636.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1253.0, "diff_num_grad_updates_vs_sampler_policy": 1252.0}}, "num_env_steps_sampled": 219840, "num_env_steps_trained": 219840, "num_agent_steps_sampled": 219840, "num_agent_steps_trained": 219840}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11342.550831337441, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632238137582319, "mean_inference_ms": 0.3721544463562511, "mean_action_processing_ms": 0.09060481438740639, "mean_env_wait_ms": 1.1619434039614474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003664731979370117, "StateBufferConnector_ms": 0.002678394317626953, "ViewRequirementAgentConnector_ms": 0.06582927703857422}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11342.550831337441, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11403.975528813378, -11290.43392323735, -11281.3236118415, -11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632238137582319, "mean_inference_ms": 0.3721544463562511, "mean_action_processing_ms": 0.09060481438740639, "mean_env_wait_ms": 1.1619434039614474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003664731979370117, "StateBufferConnector_ms": 0.002678394317626953, "ViewRequirementAgentConnector_ms": 0.06582927703857422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219840, "num_agent_steps_trained": 219840, "num_env_steps_sampled": 219840, "num_env_steps_trained": 219840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.62153527236929, "num_env_steps_trained_throughput_per_sec": 107.62153527236929, "timesteps_total": 219840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 219840, "timers": {"training_iteration_time_ms": 3341.733, "sample_time_ms": 3331.048, "load_time_ms": 0.298, "load_throughput": 1208733.141, "learn_time_ms": 9.635, "learn_throughput": 37364.258, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 219840, "num_env_steps_trained": 219840, "num_agent_steps_sampled": 219840, "num_agent_steps_trained": 219840}, "done": false, "episodes_total": 1144, "training_iteration": 256, "trial_id": "04904_00000", "date": "2023-07-26_22-17-01", "timestamp": 1690399021, "time_this_iter_s": 10.037861108779907, "time_total_s": 2810.925753593445, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 841.9738874435425, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 19.235714285714288, "ram_util_percent": 63.507142857142846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.665740740740741e-07, "entropy_coeff": 0.05, "policy_entropy": -1184.29140625, "policy_loss": -24663036212019.2, "vf_loss": 219625854.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1268.0, "diff_num_grad_updates_vs_sampler_policy": 1267.0}}, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11344.232410134025, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632605061534824, "mean_inference_ms": 0.37216391077814687, "mean_action_processing_ms": 0.09060564149245633, "mean_env_wait_ms": 1.1615593071367438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036656856536865234, "StateBufferConnector_ms": 0.002685070037841797, "ViewRequirementAgentConnector_ms": 0.06588530540466309}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11344.232410134025, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11069.405456305658, -11232.248369728753, -11392.239904975371, -11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632605061534824, "mean_inference_ms": 0.37216391077814687, "mean_action_processing_ms": 0.09060564149245633, "mean_env_wait_ms": 1.1615593071367438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036656856536865234, "StateBufferConnector_ms": 0.002685070037841797, "ViewRequirementAgentConnector_ms": 0.06588530540466309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.25835320075304, "num_env_steps_trained_throughput_per_sec": 106.25835320075304, "timesteps_total": 220920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 220920, "timers": {"training_iteration_time_ms": 3362.423, "sample_time_ms": 3351.776, "load_time_ms": 0.3, "load_throughput": 1200659.542, "learn_time_ms": 9.592, "learn_throughput": 37533.015, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "done": false, "episodes_total": 1147, "training_iteration": 257, "trial_id": "04904_00000", "date": "2023-07-26_22-17-11", "timestamp": 1690399031, "time_this_iter_s": 10.166635751724243, "time_total_s": 2821.092389345169, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 852.1405231952667, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 19.860000000000003, "ram_util_percent": 63.466666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.665740740740741e-07, "entropy_coeff": 0.05, "policy_entropy": -1184.3599365234375, "policy_loss": -16860562196714.15, "vf_loss": 212426297.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 1282.0}}, "num_env_steps_sampled": 222000, "num_env_steps_trained": 222000, "num_agent_steps_sampled": 222000, "num_agent_steps_trained": 222000}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11346.902216302431, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6330112107218255, "mean_inference_ms": 0.37216794043641277, "mean_action_processing_ms": 0.09060568157845252, "mean_env_wait_ms": 1.1612125993411027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663778305053711, "StateBufferConnector_ms": 0.0026841163635253906, "ViewRequirementAgentConnector_ms": 0.0658729076385498}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11346.902216302431, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11042.125936474606, -11361.617380766524, -11458.44537267023, -11213.745698061959, -11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6330112107218255, "mean_inference_ms": 0.37216794043641277, "mean_action_processing_ms": 0.09060568157845252, "mean_env_wait_ms": 1.1612125993411027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663778305053711, "StateBufferConnector_ms": 0.0026841163635253906, "ViewRequirementAgentConnector_ms": 0.0658729076385498}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222000, "num_agent_steps_trained": 222000, "num_env_steps_sampled": 222000, "num_env_steps_trained": 222000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.4538873955145, "num_env_steps_trained_throughput_per_sec": 107.4538873955145, "timesteps_total": 222000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 222000, "timers": {"training_iteration_time_ms": 3357.941, "sample_time_ms": 3347.389, "load_time_ms": 0.301, "load_throughput": 1197707.179, "learn_time_ms": 9.513, "learn_throughput": 37843.913, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 222000, "num_env_steps_trained": 222000, "num_agent_steps_sampled": 222000, "num_agent_steps_trained": 222000}, "done": false, "episodes_total": 1150, "training_iteration": 258, "trial_id": "04904_00000", "date": "2023-07-26_22-17-21", "timestamp": 1690399041, "time_this_iter_s": 10.05353331565857, "time_total_s": 2831.1459226608276, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 862.1940565109253, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 20.764285714285712, "ram_util_percent": 63.26428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -1184.548388671875, "policy_loss": -15727052193792.0, "vf_loss": 211250179.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1303.0, "diff_num_grad_updates_vs_sampler_policy": 1302.0}}, "num_env_steps_sampled": 223440, "num_env_steps_trained": 223440, "num_agent_steps_sampled": 223440, "num_agent_steps_trained": 223440}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11352.169988003376, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.633550793421282, "mean_inference_ms": 0.37217470623449705, "mean_action_processing_ms": 0.09060574376456133, "mean_env_wait_ms": 1.1607835954920653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003661632537841797, "StateBufferConnector_ms": 0.0026824474334716797, "ViewRequirementAgentConnector_ms": 0.06583261489868164}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11614.511915682628, "episode_reward_mean": -11352.169988003376, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11320.389109312946, -11495.628114996794, -11272.471336391809, -11530.911344778577, -11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.633550793421282, "mean_inference_ms": 0.37217470623449705, "mean_action_processing_ms": 0.09060574376456133, "mean_env_wait_ms": 1.1607835954920653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003661632537841797, "StateBufferConnector_ms": 0.0026824474334716797, "ViewRequirementAgentConnector_ms": 0.06583261489868164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223440, "num_agent_steps_trained": 223440, "num_env_steps_sampled": 223440, "num_env_steps_trained": 223440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.60939645356015, "num_env_steps_trained_throughput_per_sec": 107.60939645356015, "timesteps_total": 223440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 223440, "timers": {"training_iteration_time_ms": 3359.633, "sample_time_ms": 3349.06, "load_time_ms": 0.299, "load_throughput": 1202476.26, "learn_time_ms": 9.529, "learn_throughput": 37780.755, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 223440, "num_env_steps_trained": 223440, "num_agent_steps_sampled": 223440, "num_agent_steps_trained": 223440}, "done": false, "episodes_total": 1154, "training_iteration": 259, "trial_id": "04904_00000", "date": "2023-07-26_22-17-34", "timestamp": 1690399054, "time_this_iter_s": 13.384383916854858, "time_total_s": 2844.5303065776825, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 875.5784404277802, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 19.963157894736845, "ram_util_percent": 63.20526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -1184.92177734375, "policy_loss": -13959350714368.0, "vf_loss": 214161337.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1323.0, "diff_num_grad_updates_vs_sampler_policy": 1322.0}}, "num_env_steps_sampled": 224880, "num_env_steps_trained": 224880, "num_agent_steps_sampled": 224880, "num_agent_steps_trained": 224880}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11354.026979953735, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63403440186602, "mean_inference_ms": 0.37218178797284907, "mean_action_processing_ms": 0.09060574935012973, "mean_env_wait_ms": 1.1603569011531933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663778305053711, "StateBufferConnector_ms": 0.0026731491088867188, "ViewRequirementAgentConnector_ms": 0.06586503982543945}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11354.026979953735, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11535.536990472652, -11479.74317096127, -11107.915892543735, -11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63403440186602, "mean_inference_ms": 0.37218178797284907, "mean_action_processing_ms": 0.09060574935012973, "mean_env_wait_ms": 1.1603569011531933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663778305053711, "StateBufferConnector_ms": 0.0026731491088867188, "ViewRequirementAgentConnector_ms": 0.06586503982543945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224880, "num_agent_steps_trained": 224880, "num_env_steps_sampled": 224880, "num_env_steps_trained": 224880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.4064877568272, "num_env_steps_trained_throughput_per_sec": 108.4064877568272, "timesteps_total": 224880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 224880, "timers": {"training_iteration_time_ms": 3338.176, "sample_time_ms": 3327.654, "load_time_ms": 0.298, "load_throughput": 1206222.591, "learn_time_ms": 9.474, "learn_throughput": 37998.672, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 224880, "num_env_steps_trained": 224880, "num_agent_steps_sampled": 224880, "num_agent_steps_trained": 224880}, "done": false, "episodes_total": 1158, "training_iteration": 260, "trial_id": "04904_00000", "date": "2023-07-26_22-17-47", "timestamp": 1690399067, "time_this_iter_s": 13.286171913146973, "time_total_s": 2857.8164784908295, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 888.8646123409271, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 21.11052631578947, "ram_util_percent": 63.152631578947364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -1185.06875, "policy_loss": -18707124427161.6, "vf_loss": 219162988.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1338.0, "diff_num_grad_updates_vs_sampler_policy": 1337.0}}, "num_env_steps_sampled": 225960, "num_env_steps_trained": 225960, "num_agent_steps_sampled": 225960, "num_agent_steps_trained": 225960}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11353.850110539188, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634353139485383, "mean_inference_ms": 0.3721869561251541, "mean_action_processing_ms": 0.09060576578639826, "mean_env_wait_ms": 1.1600322218844143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036611557006835938, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06578969955444336}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11353.850110539188, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11106.995659372484, -11521.650692014975, -11404.162860154815, -11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634353139485383, "mean_inference_ms": 0.3721869561251541, "mean_action_processing_ms": 0.09060576578639826, "mean_env_wait_ms": 1.1600322218844143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036611557006835938, "StateBufferConnector_ms": 0.002673625946044922, "ViewRequirementAgentConnector_ms": 0.06578969955444336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225960, "num_agent_steps_trained": 225960, "num_env_steps_sampled": 225960, "num_env_steps_trained": 225960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.38009514574279, "num_env_steps_trained_throughput_per_sec": 107.38009514574279, "timesteps_total": 225960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 225960, "timers": {"training_iteration_time_ms": 3337.986, "sample_time_ms": 3327.379, "load_time_ms": 0.3, "load_throughput": 1198277.47, "learn_time_ms": 9.554, "learn_throughput": 37679.876, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 225960, "num_env_steps_trained": 225960, "num_agent_steps_sampled": 225960, "num_agent_steps_trained": 225960}, "done": false, "episodes_total": 1161, "training_iteration": 261, "trial_id": "04904_00000", "date": "2023-07-26_22-17-58", "timestamp": 1690399078, "time_this_iter_s": 10.060529947280884, "time_total_s": 2867.8770084381104, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 898.925142288208, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 20.65, "ram_util_percent": 63.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -1184.956591796875, "policy_loss": -20831426471526.4, "vf_loss": 214958913.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1353.0, "diff_num_grad_updates_vs_sampler_policy": 1352.0}}, "num_env_steps_sampled": 227040, "num_env_steps_trained": 227040, "num_agent_steps_sampled": 227040, "num_agent_steps_trained": 227040}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11354.018477013993, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634685587142176, "mean_inference_ms": 0.37219182038767573, "mean_action_processing_ms": 0.09060583487738645, "mean_env_wait_ms": 1.1597195010708965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036559104919433594, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.06575775146484375}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11354.018477013993, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11303.172474043718, -11224.988154940214, -11330.116739063935, -11478.662756978702, -11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634685587142176, "mean_inference_ms": 0.37219182038767573, "mean_action_processing_ms": 0.09060583487738645, "mean_env_wait_ms": 1.1597195010708965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036559104919433594, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.06575775146484375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227040, "num_agent_steps_trained": 227040, "num_env_steps_sampled": 227040, "num_env_steps_trained": 227040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.7581999229477, "num_env_steps_trained_throughput_per_sec": 106.7581999229477, "timesteps_total": 227040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 227040, "timers": {"training_iteration_time_ms": 3345.726, "sample_time_ms": 3335.182, "load_time_ms": 0.3, "load_throughput": 1198657.966, "learn_time_ms": 9.504, "learn_throughput": 37878.375, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 227040, "num_env_steps_trained": 227040, "num_agent_steps_sampled": 227040, "num_agent_steps_trained": 227040}, "done": false, "episodes_total": 1164, "training_iteration": 262, "trial_id": "04904_00000", "date": "2023-07-26_22-18-08", "timestamp": 1690399088, "time_this_iter_s": 10.119070053100586, "time_total_s": 2877.996078491211, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 909.0442123413086, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.957142857142856, "ram_util_percent": 63.23571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.83287037037037e-07, "entropy_coeff": 0.05, "policy_entropy": -1185.3958251953125, "policy_loss": -20151537552588.8, "vf_loss": 219212280.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 1372.0}}, "num_env_steps_sampled": 228480, "num_env_steps_trained": 228480, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 228480}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11351.676619222746, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635071494706954, "mean_inference_ms": 0.3721967593076394, "mean_action_processing_ms": 0.09060548907759529, "mean_env_wait_ms": 1.1593207654658462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.0026683807373046875, "ViewRequirementAgentConnector_ms": 0.06573915481567383}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11351.676619222746, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11388.175269237521, -11490.533004959007, -11179.435339529253, -11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635071494706954, "mean_inference_ms": 0.3721967593076394, "mean_action_processing_ms": 0.09060548907759529, "mean_env_wait_ms": 1.1593207654658462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.0026683807373046875, "ViewRequirementAgentConnector_ms": 0.06573915481567383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 228480, "num_env_steps_sampled": 228480, "num_env_steps_trained": 228480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.17033142350189, "num_env_steps_trained_throughput_per_sec": 108.17033142350189, "timesteps_total": 228480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 228480, "timers": {"training_iteration_time_ms": 3348.626, "sample_time_ms": 3338.039, "load_time_ms": 0.298, "load_throughput": 1206993.957, "learn_time_ms": 9.551, "learn_throughput": 37691.539, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 228480, "num_env_steps_trained": 228480, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 228480}, "done": false, "episodes_total": 1168, "training_iteration": 263, "trial_id": "04904_00000", "date": "2023-07-26_22-18-21", "timestamp": 1690399101, "time_this_iter_s": 13.315087080001831, "time_total_s": 2891.3111655712128, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 922.3592994213104, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 21.88421052631579, "ram_util_percent": 63.321052631578944}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.332870370370371e-07, "entropy_coeff": 0.05, "policy_entropy": -1185.4277587890624, "policy_loss": -12429419741184.0, "vf_loss": 220632793.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1388.0, "diff_num_grad_updates_vs_sampler_policy": 1387.0}}, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11353.80134207776, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635368543410537, "mean_inference_ms": 0.37219983600175754, "mean_action_processing_ms": 0.09060480670067576, "mean_env_wait_ms": 1.159030900477012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036695003509521484, "StateBufferConnector_ms": 0.002667665481567383, "ViewRequirementAgentConnector_ms": 0.06576871871948242}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11353.80134207776, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11267.502421562911, -11215.78880057655, -11398.366577971658, -11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635368543410537, "mean_inference_ms": 0.37219983600175754, "mean_action_processing_ms": 0.09060480670067576, "mean_env_wait_ms": 1.159030900477012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036695003509521484, "StateBufferConnector_ms": 0.002667665481567383, "ViewRequirementAgentConnector_ms": 0.06576871871948242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.36168970664018, "num_env_steps_trained_throughput_per_sec": 106.36168970664018, "timesteps_total": 229560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 229560, "timers": {"training_iteration_time_ms": 3358.256, "sample_time_ms": 3347.747, "load_time_ms": 0.293, "load_throughput": 1226603.932, "learn_time_ms": 9.478, "learn_throughput": 37984.62, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "done": false, "episodes_total": 1171, "training_iteration": 264, "trial_id": "04904_00000", "date": "2023-07-26_22-18-31", "timestamp": 1690399111, "time_this_iter_s": 10.156736135482788, "time_total_s": 2901.4679017066956, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 932.5160355567932, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 19.660000000000004, "ram_util_percent": 63.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.8328703703703703e-07, "entropy_coeff": 0.05, "policy_entropy": -1185.665087890625, "policy_loss": -10261135766693.7, "vf_loss": 200729632.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1403.0, "diff_num_grad_updates_vs_sampler_policy": 1402.0}}, "num_env_steps_sampled": 230640, "num_env_steps_trained": 230640, "num_agent_steps_sampled": 230640, "num_agent_steps_trained": 230640}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11351.735752696328, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635695023359796, "mean_inference_ms": 0.37220152076593105, "mean_action_processing_ms": 0.09060379985613252, "mean_env_wait_ms": 1.1587557227785894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668546676635742, "StateBufferConnector_ms": 0.0026700496673583984, "ViewRequirementAgentConnector_ms": 0.0657341480255127}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11351.735752696328, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11482.836442070726, -11538.375728726662, -11244.237633850293, -11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635695023359796, "mean_inference_ms": 0.37220152076593105, "mean_action_processing_ms": 0.09060379985613252, "mean_env_wait_ms": 1.1587557227785894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668546676635742, "StateBufferConnector_ms": 0.0026700496673583984, "ViewRequirementAgentConnector_ms": 0.0657341480255127}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230640, "num_agent_steps_trained": 230640, "num_env_steps_sampled": 230640, "num_env_steps_trained": 230640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.97972359339684, "num_env_steps_trained_throughput_per_sec": 106.97972359339684, "timesteps_total": 230640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 230640, "timers": {"training_iteration_time_ms": 3356.161, "sample_time_ms": 3345.633, "load_time_ms": 0.293, "load_throughput": 1227900.659, "learn_time_ms": 9.485, "learn_throughput": 37956.644, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 230640, "num_env_steps_trained": 230640, "num_agent_steps_sampled": 230640, "num_agent_steps_trained": 230640}, "done": false, "episodes_total": 1174, "training_iteration": 265, "trial_id": "04904_00000", "date": "2023-07-26_22-18-41", "timestamp": 1690399121, "time_this_iter_s": 10.098119974136353, "time_total_s": 2911.566021680832, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 942.6141555309296, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 21.378571428571426, "ram_util_percent": 63.38571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.3328703703703703e-07, "entropy_coeff": 0.05, "policy_entropy": -1185.7169921875, "policy_loss": -22902200703385.6, "vf_loss": 216566177.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 1417.0}}, "num_env_steps_sampled": 231720, "num_env_steps_trained": 231720, "num_agent_steps_sampled": 231720, "num_agent_steps_trained": 231720}, "sampler_results": {"episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11346.808511369258, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635997804142805, "mean_inference_ms": 0.3722025657602206, "mean_action_processing_ms": 0.09060267904798706, "mean_env_wait_ms": 1.1584901559629328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036649703979492188, "StateBufferConnector_ms": 0.002669811248779297, "ViewRequirementAgentConnector_ms": 0.06575918197631836}}, "episode_reward_max": -10802.980821029558, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11346.808511369258, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11527.915711931268, -11285.569143215047, -10802.980821029558, -11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635997804142805, "mean_inference_ms": 0.3722025657602206, "mean_action_processing_ms": 0.09060267904798706, "mean_env_wait_ms": 1.1584901559629328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036649703979492188, "StateBufferConnector_ms": 0.002669811248779297, "ViewRequirementAgentConnector_ms": 0.06575918197631836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231720, "num_agent_steps_trained": 231720, "num_env_steps_sampled": 231720, "num_env_steps_trained": 231720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.77726618212066, "num_env_steps_trained_throughput_per_sec": 107.77726618212066, "timesteps_total": 231720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 231720, "timers": {"training_iteration_time_ms": 3366.788, "sample_time_ms": 3356.253, "load_time_ms": 0.294, "load_throughput": 1225210.516, "learn_time_ms": 9.498, "learn_throughput": 37903.096, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 231720, "num_env_steps_trained": 231720, "num_agent_steps_sampled": 231720, "num_agent_steps_trained": 231720}, "done": false, "episodes_total": 1177, "training_iteration": 266, "trial_id": "04904_00000", "date": "2023-07-26_22-18-51", "timestamp": 1690399131, "time_this_iter_s": 10.02347207069397, "time_total_s": 2921.589493751526, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 952.6376276016235, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 20.80714285714286, "ram_util_percent": 63.33571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8328703703703703e-07, "entropy_coeff": 0.05, "policy_entropy": -1185.7884033203125, "policy_loss": -13590252853657.6, "vf_loss": 210704008.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1433.0, "diff_num_grad_updates_vs_sampler_policy": 1432.0}}, "num_env_steps_sampled": 232800, "num_env_steps_trained": 232800, "num_agent_steps_sampled": 232800, "num_agent_steps_trained": 232800}, "sampler_results": {"episode_reward_max": -11011.849575887514, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11349.83841149502, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.636276759294123, "mean_inference_ms": 0.372204666777951, "mean_action_processing_ms": 0.09060176111650736, "mean_env_wait_ms": 1.1582189002444971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036630630493164062, "StateBufferConnector_ms": 0.0026750564575195312, "ViewRequirementAgentConnector_ms": 0.06573939323425293}}, "episode_reward_max": -11011.849575887514, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11349.83841149502, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11547.164435313562, -11409.910678792923, -11135.199522827024, -11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.636276759294123, "mean_inference_ms": 0.372204666777951, "mean_action_processing_ms": 0.09060176111650736, "mean_env_wait_ms": 1.1582189002444971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036630630493164062, "StateBufferConnector_ms": 0.0026750564575195312, "ViewRequirementAgentConnector_ms": 0.06573939323425293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232800, "num_agent_steps_trained": 232800, "num_env_steps_sampled": 232800, "num_env_steps_trained": 232800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.22379840171541, "num_env_steps_trained_throughput_per_sec": 107.22379840171541, "timesteps_total": 232800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 232800, "timers": {"training_iteration_time_ms": 3355.173, "sample_time_ms": 3344.657, "load_time_ms": 0.294, "load_throughput": 1223126.318, "learn_time_ms": 9.476, "learn_throughput": 37991.215, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 232800, "num_env_steps_trained": 232800, "num_agent_steps_sampled": 232800, "num_agent_steps_trained": 232800}, "done": false, "episodes_total": 1180, "training_iteration": 267, "trial_id": "04904_00000", "date": "2023-07-26_22-19-02", "timestamp": 1690399142, "time_this_iter_s": 10.075157880783081, "time_total_s": 2931.664651632309, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 962.7127854824066, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 19.98571428571429, "ram_util_percent": 63.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.05, "policy_entropy": -1185.86357421875, "policy_loss": -11856695977844.85, "vf_loss": 212241283.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1448.0, "diff_num_grad_updates_vs_sampler_policy": 1447.0}}, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "sampler_results": {"episode_reward_max": -11011.849575887514, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11350.58736635797, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.636593248028935, "mean_inference_ms": 0.37220645543318476, "mean_action_processing_ms": 0.09060054332681963, "mean_env_wait_ms": 1.1579687925786435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036613941192626953, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06574010848999023}}, "episode_reward_max": -11011.849575887514, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11350.58736635797, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11210.604589833854, -11336.206485755069, -11488.442209424997, -11245.954684309418, -11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.636593248028935, "mean_inference_ms": 0.37220645543318476, "mean_action_processing_ms": 0.09060054332681963, "mean_env_wait_ms": 1.1579687925786435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036613941192626953, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06574010848999023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.09591616820995, "num_env_steps_trained_throughput_per_sec": 106.09591616820995, "timesteps_total": 233880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 233880, "timers": {"training_iteration_time_ms": 3361.161, "sample_time_ms": 3350.634, "load_time_ms": 0.296, "load_throughput": 1216034.018, "learn_time_ms": 9.476, "learn_throughput": 37991.693, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "done": false, "episodes_total": 1183, "training_iteration": 268, "trial_id": "04904_00000", "date": "2023-07-26_22-19-12", "timestamp": 1690399152, "time_this_iter_s": 10.182199001312256, "time_total_s": 2941.846850633621, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 972.8949844837189, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 19.499999999999996, "ram_util_percent": 63.313333333333325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.05, "policy_entropy": -1185.94755859375, "policy_loss": -19164979370393.6, "vf_loss": 217421753.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1468.0, "diff_num_grad_updates_vs_sampler_policy": 1467.0}}, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11347.858455649188, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.637006202134407, "mean_inference_ms": 0.3722085793940144, "mean_action_processing_ms": 0.09059849567604981, "mean_env_wait_ms": 1.1576098564031785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003665924072265625, "StateBufferConnector_ms": 0.0026710033416748047, "ViewRequirementAgentConnector_ms": 0.06572437286376953}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11347.858455649188, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11310.276083819736, -11336.33182924196, -11365.298678731166, -11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.637006202134407, "mean_inference_ms": 0.3722085793940144, "mean_action_processing_ms": 0.09059849567604981, "mean_env_wait_ms": 1.1576098564031785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003665924072265625, "StateBufferConnector_ms": 0.0026710033416748047, "ViewRequirementAgentConnector_ms": 0.06572437286376953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.62237777938306, "num_env_steps_trained_throughput_per_sec": 107.62237777938306, "timesteps_total": 235320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 235320, "timers": {"training_iteration_time_ms": 3363.185, "sample_time_ms": 3352.598, "load_time_ms": 0.297, "load_throughput": 1212713.388, "learn_time_ms": 9.538, "learn_throughput": 37742.792, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "done": false, "episodes_total": 1187, "training_iteration": 269, "trial_id": "04904_00000", "date": "2023-07-26_22-19-25", "timestamp": 1690399165, "time_this_iter_s": 13.382997035980225, "time_total_s": 2955.2298476696014, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 986.2779815196991, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 20.042105263157897, "ram_util_percent": 63.07368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.05, "policy_entropy": -1186.0357666015625, "policy_loss": -21624668343500.8, "vf_loss": 214987265.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1483.0, "diff_num_grad_updates_vs_sampler_policy": 1482.0}}, "num_env_steps_sampled": 236400, "num_env_steps_trained": 236400, "num_agent_steps_sampled": 236400, "num_agent_steps_trained": 236400}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11345.29846829426, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.637311833629623, "mean_inference_ms": 0.3722089572548456, "mean_action_processing_ms": 0.09059680202427355, "mean_env_wait_ms": 1.157307050531509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003664731979370117, "StateBufferConnector_ms": 0.002665281295776367, "ViewRequirementAgentConnector_ms": 0.0656278133392334}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11345.29846829426, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11313.764336635568, -11253.115243803713, -11268.282090053523, -11368.734329018916, -11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.637311833629623, "mean_inference_ms": 0.3722089572548456, "mean_action_processing_ms": 0.09059680202427355, "mean_env_wait_ms": 1.157307050531509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003664731979370117, "StateBufferConnector_ms": 0.002665281295776367, "ViewRequirementAgentConnector_ms": 0.0656278133392334}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236400, "num_agent_steps_trained": 236400, "num_env_steps_sampled": 236400, "num_env_steps_trained": 236400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.57279460847047, "num_env_steps_trained_throughput_per_sec": 107.57279460847047, "timesteps_total": 236400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 236400, "timers": {"training_iteration_time_ms": 3359.917, "sample_time_ms": 3349.239, "load_time_ms": 0.297, "load_throughput": 1211837.432, "learn_time_ms": 9.626, "learn_throughput": 37397.017, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 236400, "num_env_steps_trained": 236400, "num_agent_steps_sampled": 236400, "num_agent_steps_trained": 236400}, "done": false, "episodes_total": 1190, "training_iteration": 270, "trial_id": "04904_00000", "date": "2023-07-26_22-19-35", "timestamp": 1690399175, "time_this_iter_s": 10.042710065841675, "time_total_s": 2965.272557735443, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 996.3206915855408, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 20.45714285714286, "ram_util_percent": 63.09285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.05, "policy_entropy": -1186.011572265625, "policy_loss": -18594918930841.6, "vf_loss": 220574214.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1503.0, "diff_num_grad_updates_vs_sampler_policy": 1502.0}}, "num_env_steps_sampled": 237840, "num_env_steps_trained": 237840, "num_agent_steps_sampled": 237840, "num_agent_steps_trained": 237840}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11347.174474029422, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.637733511000388, "mean_inference_ms": 0.37220862482885325, "mean_action_processing_ms": 0.09059434332782354, "mean_env_wait_ms": 1.156911971460268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003669261932373047, "StateBufferConnector_ms": 0.002669811248779297, "ViewRequirementAgentConnector_ms": 0.06572651863098145}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11347.174474029422, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11422.149825276054, -11341.208318353014, -11213.077057624494, -11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.637733511000388, "mean_inference_ms": 0.37220862482885325, "mean_action_processing_ms": 0.09059434332782354, "mean_env_wait_ms": 1.156911971460268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003669261932373047, "StateBufferConnector_ms": 0.002669811248779297, "ViewRequirementAgentConnector_ms": 0.06572651863098145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237840, "num_agent_steps_trained": 237840, "num_env_steps_sampled": 237840, "num_env_steps_trained": 237840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.3753410992364, "num_env_steps_trained_throughput_per_sec": 107.3753410992364, "timesteps_total": 237840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 237840, "timers": {"training_iteration_time_ms": 3353.319, "sample_time_ms": 3342.554, "load_time_ms": 0.297, "load_throughput": 1213688.16, "learn_time_ms": 9.71, "learn_throughput": 37075.264, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 237840, "num_env_steps_trained": 237840, "num_agent_steps_sampled": 237840, "num_agent_steps_trained": 237840}, "done": false, "episodes_total": 1194, "training_iteration": 271, "trial_id": "04904_00000", "date": "2023-07-26_22-19-49", "timestamp": 1690399189, "time_this_iter_s": 13.413686037063599, "time_total_s": 2978.6862437725067, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1009.7343776226044, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 19.4421052631579, "ram_util_percent": 63.16842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4995555555555554e-07, "entropy_coeff": 0.05, "policy_entropy": -1186.1968994140625, "policy_loss": -22849398838763.15, "vf_loss": 212150561.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1518.0, "diff_num_grad_updates_vs_sampler_policy": 1517.0}}, "num_env_steps_sampled": 238920, "num_env_steps_trained": 238920, "num_agent_steps_sampled": 238920, "num_agent_steps_trained": 238920}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11347.891143632587, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63802760163523, "mean_inference_ms": 0.3722078671849255, "mean_action_processing_ms": 0.09059227826048334, "mean_env_wait_ms": 1.1566345914469007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663301467895508, "StateBufferConnector_ms": 0.0026733875274658203, "ViewRequirementAgentConnector_ms": 0.06569981575012207}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11347.891143632587, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11389.798502671163, -11451.672505730277, -11341.71734678433, -11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63802760163523, "mean_inference_ms": 0.3722078671849255, "mean_action_processing_ms": 0.09059227826048334, "mean_env_wait_ms": 1.1566345914469007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663301467895508, "StateBufferConnector_ms": 0.0026733875274658203, "ViewRequirementAgentConnector_ms": 0.06569981575012207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238920, "num_agent_steps_trained": 238920, "num_env_steps_sampled": 238920, "num_env_steps_trained": 238920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.40051335151536, "num_env_steps_trained_throughput_per_sec": 106.40051335151536, "timesteps_total": 238920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 238920, "timers": {"training_iteration_time_ms": 3360.081, "sample_time_ms": 3349.364, "load_time_ms": 0.296, "load_throughput": 1216621.9, "learn_time_ms": 9.669, "learn_throughput": 37233.609, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 238920, "num_env_steps_trained": 238920, "num_agent_steps_sampled": 238920, "num_agent_steps_trained": 238920}, "done": false, "episodes_total": 1197, "training_iteration": 272, "trial_id": "04904_00000", "date": "2023-07-26_22-19-59", "timestamp": 1690399199, "time_this_iter_s": 10.153283834457397, "time_total_s": 2988.839527606964, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1019.8876614570618, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 19.807142857142857, "ram_util_percent": 63.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0195555555555558e-07, "entropy_coeff": 0.05, "policy_entropy": -1186.3842529296876, "policy_loss": -15327351642521.6, "vf_loss": 212797984.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1533.0, "diff_num_grad_updates_vs_sampler_policy": 1532.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11343.744208516531, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.638366844671384, "mean_inference_ms": 0.3722076691245082, "mean_action_processing_ms": 0.09059036625235702, "mean_env_wait_ms": 1.1563975603740344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003665924072265625, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.06575822830200195}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11343.744208516531, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11348.178461795856, -11517.713219565558, -11122.775614497812, -11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.638366844671384, "mean_inference_ms": 0.3722076691245082, "mean_action_processing_ms": 0.09059036625235702, "mean_env_wait_ms": 1.1563975603740344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003665924072265625, "StateBufferConnector_ms": 0.0026760101318359375, "ViewRequirementAgentConnector_ms": 0.06575822830200195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.34342828481574, "num_env_steps_trained_throughput_per_sec": 105.34342828481574, "timesteps_total": 240000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 3381.328, "sample_time_ms": 3370.658, "load_time_ms": 0.296, "load_throughput": 1215936.093, "learn_time_ms": 9.625, "learn_throughput": 37403.224, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 1200, "training_iteration": 273, "trial_id": "04904_00000", "date": "2023-07-26_22-20-09", "timestamp": 1690399209, "time_this_iter_s": 10.254980325698853, "time_total_s": 2999.094507932663, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1030.1426417827606, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 19.473333333333333, "ram_util_percent": 63.053333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5395555555555555e-07, "entropy_coeff": 0.05, "policy_entropy": -1186.2935302734375, "policy_loss": -20923419983872.0, "vf_loss": 209380955.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1548.0, "diff_num_grad_updates_vs_sampler_policy": 1547.0}}, "num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11344.083326497337, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.638716933482403, "mean_inference_ms": 0.3722088088050233, "mean_action_processing_ms": 0.09058874421825996, "mean_env_wait_ms": 1.1562080898480263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036649703979492188, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06578516960144043}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11344.083326497337, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11571.763072036685, -11189.113039134938, -11442.785465517709, -11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.638716933482403, "mean_inference_ms": 0.3722088088050233, "mean_action_processing_ms": 0.09058874421825996, "mean_env_wait_ms": 1.1562080898480263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036649703979492188, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06578516960144043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080, "num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.0381780186405, "num_env_steps_trained_throughput_per_sec": 106.0381780186405, "timesteps_total": 241080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 241080, "timers": {"training_iteration_time_ms": 3400.714, "sample_time_ms": 3390.175, "load_time_ms": 0.296, "load_throughput": 1215642.412, "learn_time_ms": 9.515, "learn_throughput": 37833.673, "synch_weights_time_ms": 0.683}, "counters": {"num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080}, "done": false, "episodes_total": 1203, "training_iteration": 274, "trial_id": "04904_00000", "date": "2023-07-26_22-20-19", "timestamp": 1690399219, "time_this_iter_s": 10.187845945358276, "time_total_s": 3009.2823538780212, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1040.330487728119, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 19.707142857142856, "ram_util_percent": 63.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0595555555555556e-07, "entropy_coeff": 0.05, "policy_entropy": -1186.050732421875, "policy_loss": -23241905852313.7, "vf_loss": 213694840.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1563.0, "diff_num_grad_updates_vs_sampler_policy": 1562.0}}, "num_env_steps_sampled": 242160, "num_env_steps_trained": 242160, "num_agent_steps_sampled": 242160, "num_agent_steps_trained": 242160}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11339.90945935334, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63909211390912, "mean_inference_ms": 0.372209989327523, "mean_action_processing_ms": 0.09058716831771824, "mean_env_wait_ms": 1.1560296695719283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036592483520507812, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.06572318077087402}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11339.90945935334, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11245.31821135351, -11559.20607725892, -11560.57928565536, -11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63909211390912, "mean_inference_ms": 0.372209989327523, "mean_action_processing_ms": 0.09058716831771824, "mean_env_wait_ms": 1.1560296695719283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036592483520507812, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.06572318077087402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242160, "num_agent_steps_trained": 242160, "num_env_steps_sampled": 242160, "num_env_steps_trained": 242160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.58962715958874, "num_env_steps_trained_throughput_per_sec": 106.58962715958874, "timesteps_total": 242160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 242160, "timers": {"training_iteration_time_ms": 3391.9, "sample_time_ms": 3381.3, "load_time_ms": 0.296, "load_throughput": 1216425.876, "learn_time_ms": 9.576, "learn_throughput": 37593.475, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 242160, "num_env_steps_trained": 242160, "num_agent_steps_sampled": 242160, "num_agent_steps_trained": 242160}, "done": false, "episodes_total": 1206, "training_iteration": 275, "trial_id": "04904_00000", "date": "2023-07-26_22-20-29", "timestamp": 1690399229, "time_this_iter_s": 10.135000705718994, "time_total_s": 3019.4173545837402, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1050.465488433838, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 20.293333333333333, "ram_util_percent": 63.06000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.795555555555556e-08, "entropy_coeff": 0.05, "policy_entropy": -1186.3810546875, "policy_loss": -15920258455961.6, "vf_loss": 210003598.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1578.0, "diff_num_grad_updates_vs_sampler_policy": 1577.0}}, "num_env_steps_sampled": 243240, "num_env_steps_trained": 243240, "num_agent_steps_sampled": 243240, "num_agent_steps_trained": 243240}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11338.303264702097, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639482047035488, "mean_inference_ms": 0.37220985265638595, "mean_action_processing_ms": 0.09058532736459397, "mean_env_wait_ms": 1.1558402017530491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003657817840576172, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06569099426269531}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11338.303264702097, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11612.676580522791, -11395.815288650365, -11382.603211409783, -11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639482047035488, "mean_inference_ms": 0.37220985265638595, "mean_action_processing_ms": 0.09058532736459397, "mean_env_wait_ms": 1.1558402017530491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003657817840576172, "StateBufferConnector_ms": 0.002676725387573242, "ViewRequirementAgentConnector_ms": 0.06569099426269531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243240, "num_agent_steps_trained": 243240, "num_env_steps_sampled": 243240, "num_env_steps_trained": 243240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.59656776833327, "num_env_steps_trained_throughput_per_sec": 107.59656776833327, "timesteps_total": 243240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 243240, "timers": {"training_iteration_time_ms": 3373.106, "sample_time_ms": 3362.411, "load_time_ms": 0.297, "load_throughput": 1211837.432, "learn_time_ms": 9.651, "learn_throughput": 37302.781, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 243240, "num_env_steps_trained": 243240, "num_agent_steps_sampled": 243240, "num_agent_steps_trained": 243240}, "done": false, "episodes_total": 1209, "training_iteration": 276, "trial_id": "04904_00000", "date": "2023-07-26_22-20-40", "timestamp": 1690399240, "time_this_iter_s": 10.040428876876831, "time_total_s": 3029.457783460617, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1060.5059173107147, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 21.142857142857142, "ram_util_percent": 63.25714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -1186.497119140625, "policy_loss": -16231120555212.8, "vf_loss": 209946076.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1593.0, "diff_num_grad_updates_vs_sampler_policy": 1592.0}}, "num_env_steps_sampled": 244320, "num_env_steps_trained": 244320, "num_agent_steps_sampled": 244320, "num_agent_steps_trained": 244320}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11337.46404789265, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639856073818335, "mean_inference_ms": 0.3722107725858173, "mean_action_processing_ms": 0.09058367947439029, "mean_env_wait_ms": 1.1556686967950518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003657102584838867, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.0657346248626709}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11337.46404789265, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11347.960468770334, -11096.45614097263, -11342.472831852661, -11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639856073818335, "mean_inference_ms": 0.3722107725858173, "mean_action_processing_ms": 0.09058367947439029, "mean_env_wait_ms": 1.1556686967950518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003657102584838867, "StateBufferConnector_ms": 0.0026803016662597656, "ViewRequirementAgentConnector_ms": 0.0657346248626709}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244320, "num_agent_steps_trained": 244320, "num_env_steps_sampled": 244320, "num_env_steps_trained": 244320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.21246978157959, "num_env_steps_trained_throughput_per_sec": 107.21246978157959, "timesteps_total": 244320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 244320, "timers": {"training_iteration_time_ms": 3365.089, "sample_time_ms": 3354.399, "load_time_ms": 0.297, "load_throughput": 1213493.08, "learn_time_ms": 9.631, "learn_throughput": 37378.409, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 244320, "num_env_steps_trained": 244320, "num_agent_steps_sampled": 244320, "num_agent_steps_trained": 244320}, "done": false, "episodes_total": 1212, "training_iteration": 277, "trial_id": "04904_00000", "date": "2023-07-26_22-20-50", "timestamp": 1690399250, "time_this_iter_s": 10.07658076286316, "time_total_s": 3039.53436422348, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1070.5824980735779, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 20.571428571428573, "ram_util_percent": 63.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -1186.429931640625, "policy_loss": -10436392989491.2, "vf_loss": 202372761.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1608.0, "diff_num_grad_updates_vs_sampler_policy": 1607.0}}, "num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11339.420182075432, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640220936451326, "mean_inference_ms": 0.3722122567943725, "mean_action_processing_ms": 0.09058217450513602, "mean_env_wait_ms": 1.1555024199571653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06572866439819336}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11339.420182075432, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11497.11329934866, -11354.103997720373, -11582.958201751113, -11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640220936451326, "mean_inference_ms": 0.3722122567943725, "mean_action_processing_ms": 0.09058217450513602, "mean_env_wait_ms": 1.1555024199571653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06572866439819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400, "num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.80552761870045, "num_env_steps_trained_throughput_per_sec": 106.80552761870045, "timesteps_total": 245400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 245400, "timers": {"training_iteration_time_ms": 3356.8, "sample_time_ms": 3346.121, "load_time_ms": 0.297, "load_throughput": 1212323.918, "learn_time_ms": 9.61, "learn_throughput": 37459.084, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400}, "done": false, "episodes_total": 1215, "training_iteration": 278, "trial_id": "04904_00000", "date": "2023-07-26_22-21-00", "timestamp": 1690399260, "time_this_iter_s": 10.114640235900879, "time_total_s": 3049.649004459381, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1080.6971383094788, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 20.253333333333334, "ram_util_percent": 63.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -1186.4116455078124, "policy_loss": -20619761392025.6, "vf_loss": 214364504.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1623.0, "diff_num_grad_updates_vs_sampler_policy": 1622.0}}, "num_env_steps_sampled": 246480, "num_env_steps_trained": 246480, "num_agent_steps_sampled": 246480, "num_agent_steps_trained": 246480}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11334.432517478535, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640598032963546, "mean_inference_ms": 0.37221390662133425, "mean_action_processing_ms": 0.09058069065111994, "mean_env_wait_ms": 1.1553270041781654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003658771514892578, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06572747230529785}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11334.432517478535, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11537.012371206401, -11285.229341034381, -11373.790595435035, -11467.50694424936, -11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640598032963546, "mean_inference_ms": 0.37221390662133425, "mean_action_processing_ms": 0.09058069065111994, "mean_env_wait_ms": 1.1553270041781654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003658771514892578, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06572747230529785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246480, "num_agent_steps_trained": 246480, "num_env_steps_sampled": 246480, "num_env_steps_trained": 246480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.97957534410475, "num_env_steps_trained_throughput_per_sec": 105.97957534410475, "timesteps_total": 246480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 246480, "timers": {"training_iteration_time_ms": 3370.661, "sample_time_ms": 3360.034, "load_time_ms": 0.297, "load_throughput": 1211157.006, "learn_time_ms": 9.559, "learn_throughput": 37661.831, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 246480, "num_env_steps_trained": 246480, "num_agent_steps_sampled": 246480, "num_agent_steps_trained": 246480}, "done": false, "episodes_total": 1218, "training_iteration": 279, "trial_id": "04904_00000", "date": "2023-07-26_22-21-10", "timestamp": 1690399270, "time_this_iter_s": 10.193443059921265, "time_total_s": 3059.8424475193024, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1090.8905813694, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 19.014285714285712, "ram_util_percent": 63.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -1186.2707275390626, "policy_loss": -15627937696972.8, "vf_loss": 216008723.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 1642.0}}, "num_env_steps_sampled": 247920, "num_env_steps_trained": 247920, "num_agent_steps_sampled": 247920, "num_agent_steps_trained": 247920}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11333.107287896495, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.641071780434663, "mean_inference_ms": 0.37221708918256097, "mean_action_processing_ms": 0.09057892047797894, "mean_env_wait_ms": 1.155041747026938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036551952362060547, "StateBufferConnector_ms": 0.002708911895751953, "ViewRequirementAgentConnector_ms": 0.06572747230529785}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11333.107287896495, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11555.649806883446, -11614.511915682628, -11300.580570006205, -11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.641071780434663, "mean_inference_ms": 0.37221708918256097, "mean_action_processing_ms": 0.09057892047797894, "mean_env_wait_ms": 1.155041747026938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036551952362060547, "StateBufferConnector_ms": 0.002708911895751953, "ViewRequirementAgentConnector_ms": 0.06572747230529785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247920, "num_agent_steps_trained": 247920, "num_env_steps_sampled": 247920, "num_env_steps_trained": 247920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.2399131270343, "num_env_steps_trained_throughput_per_sec": 108.2399131270343, "timesteps_total": 247920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 247920, "timers": {"training_iteration_time_ms": 3360.613, "sample_time_ms": 3350.005, "load_time_ms": 0.294, "load_throughput": 1222532.135, "learn_time_ms": 9.573, "learn_throughput": 37605.834, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 247920, "num_env_steps_trained": 247920, "num_agent_steps_sampled": 247920, "num_agent_steps_trained": 247920}, "done": false, "episodes_total": 1222, "training_iteration": 280, "trial_id": "04904_00000", "date": "2023-07-26_22-21-23", "timestamp": 1690399283, "time_this_iter_s": 13.306586980819702, "time_total_s": 3073.149034500122, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1104.1971683502197, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 21.105263157894736, "ram_util_percent": 63.09473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -1186.4693603515625, "policy_loss": -13777666048000.0, "vf_loss": 223484897.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1658.0, "diff_num_grad_updates_vs_sampler_policy": 1657.0}}, "num_env_steps_sampled": 249000, "num_env_steps_trained": 249000, "num_agent_steps_sampled": 249000, "num_agent_steps_trained": 249000}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11327.872838532585, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.641417542752305, "mean_inference_ms": 0.37222027597671614, "mean_action_processing_ms": 0.0905776735514794, "mean_env_wait_ms": 1.1548210515638302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00365447998046875, "StateBufferConnector_ms": 0.002712249755859375, "ViewRequirementAgentConnector_ms": 0.06576037406921387}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11327.872838532585, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11446.44222154423, -11081.90472446339, -11138.80622534664, -11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.641417542752305, "mean_inference_ms": 0.37222027597671614, "mean_action_processing_ms": 0.0905776735514794, "mean_env_wait_ms": 1.1548210515638302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00365447998046875, "StateBufferConnector_ms": 0.002712249755859375, "ViewRequirementAgentConnector_ms": 0.06576037406921387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249000, "num_agent_steps_trained": 249000, "num_env_steps_sampled": 249000, "num_env_steps_trained": 249000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.49063136695129, "num_env_steps_trained_throughput_per_sec": 106.49063136695129, "timesteps_total": 249000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 249000, "timers": {"training_iteration_time_ms": 3363.603, "sample_time_ms": 3353.059, "load_time_ms": 0.295, "load_throughput": 1220358.393, "learn_time_ms": 9.521, "learn_throughput": 37811.503, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 249000, "num_env_steps_trained": 249000, "num_agent_steps_sampled": 249000, "num_agent_steps_trained": 249000}, "done": false, "episodes_total": 1225, "training_iteration": 281, "trial_id": "04904_00000", "date": "2023-07-26_22-21-34", "timestamp": 1690399294, "time_this_iter_s": 10.144495964050293, "time_total_s": 3083.2935304641724, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1114.34166431427, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 20.342857142857145, "ram_util_percent": 63.135714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.665740740740742e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.419970703125, "policy_loss": -16667366339379.2, "vf_loss": 211154918.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1673.0, "diff_num_grad_updates_vs_sampler_policy": 1672.0}}, "num_env_steps_sampled": 250080, "num_env_steps_trained": 250080, "num_agent_steps_sampled": 250080, "num_agent_steps_trained": 250080}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11328.131801675405, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64178898302367, "mean_inference_ms": 0.3722225934316709, "mean_action_processing_ms": 0.0905762175564437, "mean_env_wait_ms": 1.1546097266074602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036468505859375, "StateBufferConnector_ms": 0.0027103424072265625, "ViewRequirementAgentConnector_ms": 0.06568336486816406}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11328.131801675405, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11442.060530509623, -11494.426738805556, -11324.019828983965, -11256.2862154957, -11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64178898302367, "mean_inference_ms": 0.3722225934316709, "mean_action_processing_ms": 0.0905762175564437, "mean_env_wait_ms": 1.1546097266074602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036468505859375, "StateBufferConnector_ms": 0.0027103424072265625, "ViewRequirementAgentConnector_ms": 0.06568336486816406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250080, "num_agent_steps_trained": 250080, "num_env_steps_sampled": 250080, "num_env_steps_trained": 250080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.81448588749468, "num_env_steps_trained_throughput_per_sec": 106.81448588749468, "timesteps_total": 250080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 250080, "timers": {"training_iteration_time_ms": 3355.637, "sample_time_ms": 3345.093, "load_time_ms": 0.295, "load_throughput": 1222136.333, "learn_time_ms": 9.51, "learn_throughput": 37855.014, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 250080, "num_env_steps_trained": 250080, "num_agent_steps_sampled": 250080, "num_agent_steps_trained": 250080}, "done": false, "episodes_total": 1228, "training_iteration": 282, "trial_id": "04904_00000", "date": "2023-07-26_22-21-44", "timestamp": 1690399304, "time_this_iter_s": 10.113830804824829, "time_total_s": 3093.407361268997, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1124.4554951190948, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 18.05333333333333, "ram_util_percent": 63.06000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.332407407407408e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.20556640625, "policy_loss": -14278652917036.45, "vf_loss": 223157150.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1693.0, "diff_num_grad_updates_vs_sampler_policy": 1692.0}}, "num_env_steps_sampled": 251520, "num_env_steps_trained": 251520, "num_agent_steps_sampled": 251520, "num_agent_steps_trained": 251520}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11327.230766993565, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6422454284111465, "mean_inference_ms": 0.372229245867886, "mean_action_processing_ms": 0.09057483215487887, "mean_env_wait_ms": 1.154330690888535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036475658416748047, "StateBufferConnector_ms": 0.0027151107788085938, "ViewRequirementAgentConnector_ms": 0.06571054458618164}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11327.230766993565, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11285.443789934361, -11565.014124469086, -11125.432444543796, -11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6422454284111465, "mean_inference_ms": 0.372229245867886, "mean_action_processing_ms": 0.09057483215487887, "mean_env_wait_ms": 1.154330690888535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036475658416748047, "StateBufferConnector_ms": 0.0027151107788085938, "ViewRequirementAgentConnector_ms": 0.06571054458618164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251520, "num_agent_steps_trained": 251520, "num_env_steps_sampled": 251520, "num_env_steps_trained": 251520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.73991391756425, "num_env_steps_trained_throughput_per_sec": 107.73991391756425, "timesteps_total": 251520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 251520, "timers": {"training_iteration_time_ms": 3361.811, "sample_time_ms": 3351.317, "load_time_ms": 0.296, "load_throughput": 1216131.959, "learn_time_ms": 9.462, "learn_throughput": 38047.983, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 251520, "num_env_steps_trained": 251520, "num_agent_steps_sampled": 251520, "num_agent_steps_trained": 251520}, "done": false, "episodes_total": 1232, "training_iteration": 283, "trial_id": "04904_00000", "date": "2023-07-26_22-21-57", "timestamp": 1690399317, "time_this_iter_s": 13.368514776229858, "time_total_s": 3106.775876045227, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1137.8240098953247, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 19.826315789473682, "ram_util_percent": 63.07894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.332407407407407e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4031982421875, "policy_loss": -15197490223513.6, "vf_loss": 207964190.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1708.0, "diff_num_grad_updates_vs_sampler_policy": 1707.0}}, "num_env_steps_sampled": 252600, "num_env_steps_trained": 252600, "num_agent_steps_sampled": 252600, "num_agent_steps_trained": 252600}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11328.210518090298, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.642596334680555, "mean_inference_ms": 0.37223392700830027, "mean_action_processing_ms": 0.09057365886431747, "mean_env_wait_ms": 1.1541206311463006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036420822143554688, "StateBufferConnector_ms": 0.0027132034301757812, "ViewRequirementAgentConnector_ms": 0.06569170951843262}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11328.210518090298, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11285.704551870076, -11234.66088928311, -11214.73469587754, -11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.642596334680555, "mean_inference_ms": 0.37223392700830027, "mean_action_processing_ms": 0.09057365886431747, "mean_env_wait_ms": 1.1541206311463006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036420822143554688, "StateBufferConnector_ms": 0.0027132034301757812, "ViewRequirementAgentConnector_ms": 0.06569170951843262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252600, "num_agent_steps_trained": 252600, "num_env_steps_sampled": 252600, "num_env_steps_trained": 252600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.2605135871655, "num_env_steps_trained_throughput_per_sec": 107.2605135871655, "timesteps_total": 252600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 252600, "timers": {"training_iteration_time_ms": 3354.532, "sample_time_ms": 3344.034, "load_time_ms": 0.295, "load_throughput": 1218683.971, "learn_time_ms": 9.467, "learn_throughput": 38027.956, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 252600, "num_env_steps_trained": 252600, "num_agent_steps_sampled": 252600, "num_agent_steps_trained": 252600}, "done": false, "episodes_total": 1235, "training_iteration": 284, "trial_id": "04904_00000", "date": "2023-07-26_22-22-07", "timestamp": 1690399327, "time_this_iter_s": 10.071875095367432, "time_total_s": 3116.8477511405945, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1147.8958849906921, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 19.071428571428573, "ram_util_percent": 63.121428571428574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.332407407407407e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4741455078124, "policy_loss": -14472407888691.2, "vf_loss": 209658224.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1723.0, "diff_num_grad_updates_vs_sampler_policy": 1722.0}}, "num_env_steps_sampled": 253680, "num_env_steps_trained": 253680, "num_agent_steps_sampled": 253680, "num_agent_steps_trained": 253680}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11328.665434354793, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.642954656924651, "mean_inference_ms": 0.3722381143165062, "mean_action_processing_ms": 0.0905722871753564, "mean_env_wait_ms": 1.1539131312228863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036420822143554688, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.06565022468566895}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11328.665434354793, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11378.025337574642, -11342.05844064527, -11079.22331512424, -11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.642954656924651, "mean_inference_ms": 0.3722381143165062, "mean_action_processing_ms": 0.0905722871753564, "mean_env_wait_ms": 1.1539131312228863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036420822143554688, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.06565022468566895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253680, "num_agent_steps_trained": 253680, "num_env_steps_sampled": 253680, "num_env_steps_trained": 253680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.18918815313944, "num_env_steps_trained_throughput_per_sec": 107.18918815313944, "timesteps_total": 253680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 253680, "timers": {"training_iteration_time_ms": 3350.998, "sample_time_ms": 3340.48, "load_time_ms": 0.295, "load_throughput": 1220161.164, "learn_time_ms": 9.492, "learn_throughput": 37927.469, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 253680, "num_env_steps_trained": 253680, "num_agent_steps_sampled": 253680, "num_agent_steps_trained": 253680}, "done": false, "episodes_total": 1238, "training_iteration": 285, "trial_id": "04904_00000", "date": "2023-07-26_22-22-17", "timestamp": 1690399337, "time_this_iter_s": 10.078340768814087, "time_total_s": 3126.9260919094086, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1157.9742257595062, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 20.042857142857144, "ram_util_percent": 63.15714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.3324074074074075e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.43203125, "policy_loss": -26296492595609.6, "vf_loss": 222550331.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1738.0, "diff_num_grad_updates_vs_sampler_policy": 1737.0}}, "num_env_steps_sampled": 254760, "num_env_steps_trained": 254760, "num_agent_steps_sampled": 254760, "num_agent_steps_trained": 254760}, "sampler_results": {"episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11331.61525982882, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643320344787704, "mean_inference_ms": 0.372242600351095, "mean_action_processing_ms": 0.09057099016655848, "mean_env_wait_ms": 1.153719568122843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036427974700927734, "StateBufferConnector_ms": 0.0027170181274414062, "ViewRequirementAgentConnector_ms": 0.06571054458618164}}, "episode_reward_max": -11003.079689943259, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11331.61525982882, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11386.998820643545, -11137.817372441754, -11303.616726311751, -11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643320344787704, "mean_inference_ms": 0.372242600351095, "mean_action_processing_ms": 0.09057099016655848, "mean_env_wait_ms": 1.153719568122843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036427974700927734, "StateBufferConnector_ms": 0.0027170181274414062, "ViewRequirementAgentConnector_ms": 0.06571054458618164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254760, "num_agent_steps_trained": 254760, "num_env_steps_sampled": 254760, "num_env_steps_trained": 254760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.55919243776076, "num_env_steps_trained_throughput_per_sec": 106.55919243776076, "timesteps_total": 254760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 254760, "timers": {"training_iteration_time_ms": 3367.242, "sample_time_ms": 3356.651, "load_time_ms": 0.307, "load_throughput": 1173870.357, "learn_time_ms": 9.545, "learn_throughput": 37717.996, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 254760, "num_env_steps_trained": 254760, "num_agent_steps_sampled": 254760, "num_agent_steps_trained": 254760}, "done": false, "episodes_total": 1241, "training_iteration": 286, "trial_id": "04904_00000", "date": "2023-07-26_22-22-27", "timestamp": 1690399347, "time_this_iter_s": 10.138037204742432, "time_total_s": 3137.064129114151, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1168.1122629642487, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 19.94666666666667, "ram_util_percent": 63.09333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3343994140625, "policy_loss": -13428114273075.2, "vf_loss": 202027513.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1753.0, "diff_num_grad_updates_vs_sampler_policy": 1752.0}}, "num_env_steps_sampled": 255840, "num_env_steps_trained": 255840, "num_agent_steps_sampled": 255840, "num_agent_steps_trained": 255840}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11330.68118215996, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643718735100503, "mean_inference_ms": 0.37224706893007514, "mean_action_processing_ms": 0.09056964485662901, "mean_env_wait_ms": 1.1535266192204645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036439895629882812, "StateBufferConnector_ms": 0.0027070045471191406, "ViewRequirementAgentConnector_ms": 0.06575584411621094}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11330.68118215996, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11299.831089651007, -11337.60669369796, -11506.45316020181, -11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643718735100503, "mean_inference_ms": 0.37224706893007514, "mean_action_processing_ms": 0.09056964485662901, "mean_env_wait_ms": 1.1535266192204645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036439895629882812, "StateBufferConnector_ms": 0.0027070045471191406, "ViewRequirementAgentConnector_ms": 0.06575584411621094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255840, "num_agent_steps_trained": 255840, "num_env_steps_sampled": 255840, "num_env_steps_trained": 255840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.17189998375258, "num_env_steps_trained_throughput_per_sec": 106.17189998375258, "timesteps_total": 255840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 255840, "timers": {"training_iteration_time_ms": 3375.86, "sample_time_ms": 3365.234, "load_time_ms": 0.307, "load_throughput": 1174144.199, "learn_time_ms": 9.575, "learn_throughput": 37596.564, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 255840, "num_env_steps_trained": 255840, "num_agent_steps_sampled": 255840, "num_agent_steps_trained": 255840}, "done": false, "episodes_total": 1244, "training_iteration": 287, "trial_id": "04904_00000", "date": "2023-07-26_22-22-38", "timestamp": 1690399358, "time_this_iter_s": 10.175045728683472, "time_total_s": 3147.2391748428345, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1178.2873086929321, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 21.764285714285712, "ram_util_percent": 63.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.433203125, "policy_loss": -16111961925222.4, "vf_loss": 221952099.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1768.0, "diff_num_grad_updates_vs_sampler_policy": 1767.0}}, "num_env_steps_sampled": 256920, "num_env_steps_trained": 256920, "num_agent_steps_sampled": 256920, "num_agent_steps_trained": 256920}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11330.944721449305, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644097557263774, "mean_inference_ms": 0.3722524124294297, "mean_action_processing_ms": 0.09056832311421353, "mean_env_wait_ms": 1.1533419736290733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003648519515991211, "StateBufferConnector_ms": 0.0026993751525878906, "ViewRequirementAgentConnector_ms": 0.06572532653808594}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11330.944721449305, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11345.211451935224, -11371.554904796878, -11244.107991118375, -11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644097557263774, "mean_inference_ms": 0.3722524124294297, "mean_action_processing_ms": 0.09056832311421353, "mean_env_wait_ms": 1.1533419736290733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003648519515991211, "StateBufferConnector_ms": 0.0026993751525878906, "ViewRequirementAgentConnector_ms": 0.06572532653808594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256920, "num_agent_steps_trained": 256920, "num_env_steps_sampled": 256920, "num_env_steps_trained": 256920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.21592963083312, "num_env_steps_trained_throughput_per_sec": 106.21592963083312, "timesteps_total": 256920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 256920, "timers": {"training_iteration_time_ms": 3380.342, "sample_time_ms": 3369.657, "load_time_ms": 0.308, "load_throughput": 1170140.608, "learn_time_ms": 9.631, "learn_throughput": 37379.797, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 256920, "num_env_steps_trained": 256920, "num_agent_steps_sampled": 256920, "num_agent_steps_trained": 256920}, "done": false, "episodes_total": 1247, "training_iteration": 288, "trial_id": "04904_00000", "date": "2023-07-26_22-22-48", "timestamp": 1690399368, "time_this_iter_s": 10.170867919921875, "time_total_s": 3157.4100427627563, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1188.458176612854, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 20.526666666666667, "ram_util_percent": 63.326666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.420654296875, "policy_loss": -13115113786572.8, "vf_loss": 223200910.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1783.0, "diff_num_grad_updates_vs_sampler_policy": 1782.0}}, "num_env_steps_sampled": 258000, "num_env_steps_trained": 258000, "num_agent_steps_sampled": 258000, "num_agent_steps_trained": 258000}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11332.686422128807, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644495392831608, "mean_inference_ms": 0.3722570553892136, "mean_action_processing_ms": 0.09056692816311092, "mean_env_wait_ms": 1.1531447168863769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003653287887573242, "StateBufferConnector_ms": 0.0027091503143310547, "ViewRequirementAgentConnector_ms": 0.06577754020690918}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11332.686422128807, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11566.461090570969, -11347.688838347773, -11433.95270755232, -11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644495392831608, "mean_inference_ms": 0.3722570553892136, "mean_action_processing_ms": 0.09056692816311092, "mean_env_wait_ms": 1.1531447168863769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003653287887573242, "StateBufferConnector_ms": 0.0027091503143310547, "ViewRequirementAgentConnector_ms": 0.06577754020690918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258000, "num_agent_steps_trained": 258000, "num_env_steps_sampled": 258000, "num_env_steps_trained": 258000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.16997073523049, "num_env_steps_trained_throughput_per_sec": 107.16997073523049, "timesteps_total": 258000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 258000, "timers": {"training_iteration_time_ms": 3379.744, "sample_time_ms": 3369.113, "load_time_ms": 0.295, "load_throughput": 1218880.723, "learn_time_ms": 9.597, "learn_throughput": 37512.967, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 258000, "num_env_steps_trained": 258000, "num_agent_steps_sampled": 258000, "num_agent_steps_trained": 258000}, "done": false, "episodes_total": 1250, "training_iteration": 289, "trial_id": "04904_00000", "date": "2023-07-26_22-22-58", "timestamp": 1690399378, "time_this_iter_s": 10.080240964889526, "time_total_s": 3167.490283727646, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1198.5384175777435, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 20.278571428571432, "ram_util_percent": 63.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3845458984374, "policy_loss": -15580615357235.2, "vf_loss": 217605572.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1798.0, "diff_num_grad_updates_vs_sampler_policy": 1797.0}}, "num_env_steps_sampled": 259080, "num_env_steps_trained": 259080, "num_agent_steps_sampled": 259080, "num_agent_steps_trained": 259080}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11331.066991991782, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644912749321854, "mean_inference_ms": 0.372262621510437, "mean_action_processing_ms": 0.0905657395023776, "mean_env_wait_ms": 1.15294721862593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036547183990478516, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06583499908447266}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11331.066991991782, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11254.608921596815, -11269.401340245462, -11432.825868704165, -11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644912749321854, "mean_inference_ms": 0.372262621510437, "mean_action_processing_ms": 0.0905657395023776, "mean_env_wait_ms": 1.15294721862593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036547183990478516, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06583499908447266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259080, "num_agent_steps_trained": 259080, "num_env_steps_sampled": 259080, "num_env_steps_trained": 259080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.81584852222635, "num_env_steps_trained_throughput_per_sec": 106.81584852222635, "timesteps_total": 259080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 259080, "timers": {"training_iteration_time_ms": 3371.636, "sample_time_ms": 3360.974, "load_time_ms": 0.296, "load_throughput": 1214762.22, "learn_time_ms": 9.624, "learn_throughput": 37405.262, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 259080, "num_env_steps_trained": 259080, "num_agent_steps_sampled": 259080, "num_agent_steps_trained": 259080}, "done": false, "episodes_total": 1253, "training_iteration": 290, "trial_id": "04904_00000", "date": "2023-07-26_22-23-08", "timestamp": 1690399388, "time_this_iter_s": 10.113768100738525, "time_total_s": 3177.6040518283844, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1208.652185678482, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 19.892857142857142, "ram_util_percent": 63.30714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.6389892578125, "policy_loss": -13976562722406.4, "vf_loss": 205170995.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1813.0, "diff_num_grad_updates_vs_sampler_policy": 1812.0}}, "num_env_steps_sampled": 260160, "num_env_steps_trained": 260160, "num_agent_steps_sampled": 260160, "num_agent_steps_trained": 260160}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11327.62088195543, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6453485925194595, "mean_inference_ms": 0.37226837200849966, "mean_action_processing_ms": 0.09056454962121668, "mean_env_wait_ms": 1.1527519845489755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.0027081966400146484, "ViewRequirementAgentConnector_ms": 0.06582927703857422}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11703.93970678466, "episode_reward_mean": -11327.62088195543, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11703.93970678466, -11398.932184781752, -11272.421925490624, -11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6453485925194595, "mean_inference_ms": 0.37226837200849966, "mean_action_processing_ms": 0.09056454962121668, "mean_env_wait_ms": 1.1527519845489755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.0027081966400146484, "ViewRequirementAgentConnector_ms": 0.06582927703857422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260160, "num_agent_steps_trained": 260160, "num_env_steps_sampled": 260160, "num_env_steps_trained": 260160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.56880959538312, "num_env_steps_trained_throughput_per_sec": 107.56880959538312, "timesteps_total": 260160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 260160, "timers": {"training_iteration_time_ms": 3354.561, "sample_time_ms": 3343.912, "load_time_ms": 0.298, "load_throughput": 1209992.339, "learn_time_ms": 9.606, "learn_throughput": 37476.842, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 260160, "num_env_steps_trained": 260160, "num_agent_steps_sampled": 260160, "num_agent_steps_trained": 260160}, "done": false, "episodes_total": 1256, "training_iteration": 291, "trial_id": "04904_00000", "date": "2023-07-26_22-23-18", "timestamp": 1690399398, "time_this_iter_s": 10.043085098266602, "time_total_s": 3187.647136926651, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1218.6952707767487, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 20.178571428571427, "ram_util_percent": 63.20714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.465925925925926e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.2607666015624, "policy_loss": -15704141489766.4, "vf_loss": 217950526.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1828.0, "diff_num_grad_updates_vs_sampler_policy": 1827.0}}, "num_env_steps_sampled": 261240, "num_env_steps_trained": 261240, "num_agent_steps_sampled": 261240, "num_agent_steps_trained": 261240}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11652.082716361412, "episode_reward_mean": -11325.2818209412, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64578993661759, "mean_inference_ms": 0.37227418133020274, "mean_action_processing_ms": 0.09056333861778781, "mean_env_wait_ms": 1.1525709487617943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036520957946777344, "StateBufferConnector_ms": 0.0027086734771728516, "ViewRequirementAgentConnector_ms": 0.06583619117736816}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11652.082716361412, "episode_reward_mean": -11325.2818209412, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11392.724061549981, -11440.363125482392, -11090.136138423977, -11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64578993661759, "mean_inference_ms": 0.37227418133020274, "mean_action_processing_ms": 0.09056333861778781, "mean_env_wait_ms": 1.1525709487617943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036520957946777344, "StateBufferConnector_ms": 0.0027086734771728516, "ViewRequirementAgentConnector_ms": 0.06583619117736816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261240, "num_agent_steps_trained": 261240, "num_env_steps_sampled": 261240, "num_env_steps_trained": 261240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.99952238349063, "num_env_steps_trained_throughput_per_sec": 106.99952238349063, "timesteps_total": 261240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 261240, "timers": {"training_iteration_time_ms": 3354.795, "sample_time_ms": 3344.215, "load_time_ms": 0.298, "load_throughput": 1208539.651, "learn_time_ms": 9.539, "learn_throughput": 37739.113, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 261240, "num_env_steps_trained": 261240, "num_agent_steps_sampled": 261240, "num_agent_steps_trained": 261240}, "done": false, "episodes_total": 1259, "training_iteration": 292, "trial_id": "04904_00000", "date": "2023-07-26_22-23-28", "timestamp": 1690399408, "time_this_iter_s": 10.096320152282715, "time_total_s": 3197.7434570789337, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1228.7915909290314, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 20.333333333333332, "ram_util_percent": 62.980000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.665925925925926e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3364990234375, "policy_loss": -17256458643046.4, "vf_loss": 217552176.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1843.0, "diff_num_grad_updates_vs_sampler_policy": 1842.0}}, "num_env_steps_sampled": 262320, "num_env_steps_trained": 262320, "num_agent_steps_sampled": 262320, "num_agent_steps_trained": 262320}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11652.082716361412, "episode_reward_mean": -11327.102814669248, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64623291104846, "mean_inference_ms": 0.3722816569941071, "mean_action_processing_ms": 0.09056231538409568, "mean_env_wait_ms": 1.1523813367597369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003651857376098633, "StateBufferConnector_ms": 0.002733945846557617, "ViewRequirementAgentConnector_ms": 0.06586909294128418}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11652.082716361412, "episode_reward_mean": -11327.102814669248, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11652.082716361412, -11307.42700423717, -11207.886456909824, -11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64623291104846, "mean_inference_ms": 0.3722816569941071, "mean_action_processing_ms": 0.09056231538409568, "mean_env_wait_ms": 1.1523813367597369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003651857376098633, "StateBufferConnector_ms": 0.002733945846557617, "ViewRequirementAgentConnector_ms": 0.06586909294128418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262320, "num_agent_steps_trained": 262320, "num_env_steps_sampled": 262320, "num_env_steps_trained": 262320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.24093799710828, "num_env_steps_trained_throughput_per_sec": 107.24093799710828, "timesteps_total": 262320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 262320, "timers": {"training_iteration_time_ms": 3362.505, "sample_time_ms": 3351.921, "load_time_ms": 0.297, "load_throughput": 1210477.345, "learn_time_ms": 9.542, "learn_throughput": 37729.588, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 262320, "num_env_steps_trained": 262320, "num_agent_steps_sampled": 262320, "num_agent_steps_trained": 262320}, "done": false, "episodes_total": 1262, "training_iteration": 293, "trial_id": "04904_00000", "date": "2023-07-26_22-23-38", "timestamp": 1690399418, "time_this_iter_s": 10.073592185974121, "time_total_s": 3207.817049264908, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1238.8651831150055, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 20.857142857142858, "ram_util_percent": 62.957142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.865925925925926e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.389453125, "policy_loss": -16498495900876.8, "vf_loss": 211880371.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1858.0, "diff_num_grad_updates_vs_sampler_policy": 1857.0}}, "num_env_steps_sampled": 263400, "num_env_steps_trained": 263400, "num_agent_steps_sampled": 263400, "num_agent_steps_trained": 263400}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11326.618925619532, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64666907789672, "mean_inference_ms": 0.37228937167595477, "mean_action_processing_ms": 0.09056124713843952, "mean_env_wait_ms": 1.15219987587096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.002741098403930664, "ViewRequirementAgentConnector_ms": 0.06595444679260254}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11326.618925619532, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11228.222400910103, -11134.45138296878, -11532.194105113173, -11492.17382979456, -11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64666907789672, "mean_inference_ms": 0.37228937167595477, "mean_action_processing_ms": 0.09056124713843952, "mean_env_wait_ms": 1.15219987587096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.002741098403930664, "ViewRequirementAgentConnector_ms": 0.06595444679260254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263400, "num_agent_steps_trained": 263400, "num_env_steps_sampled": 263400, "num_env_steps_trained": 263400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.10896093640862, "num_env_steps_trained_throughput_per_sec": 107.10896093640862, "timesteps_total": 263400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 263400, "timers": {"training_iteration_time_ms": 3353.341, "sample_time_ms": 3342.777, "load_time_ms": 0.297, "load_throughput": 1212031.979, "learn_time_ms": 9.529, "learn_throughput": 37779.621, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 263400, "num_env_steps_trained": 263400, "num_agent_steps_sampled": 263400, "num_agent_steps_trained": 263400}, "done": false, "episodes_total": 1265, "training_iteration": 294, "trial_id": "04904_00000", "date": "2023-07-26_22-23-48", "timestamp": 1690399428, "time_this_iter_s": 10.085909843444824, "time_total_s": 3217.9029591083527, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1248.9510929584503, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 18.55, "ram_util_percent": 63.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7992592592592592e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4659423828125, "policy_loss": -15025160427929.6, "vf_loss": 210873081.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1878.0, "diff_num_grad_updates_vs_sampler_policy": 1877.0}}, "num_env_steps_sampled": 264840, "num_env_steps_trained": 264840, "num_agent_steps_sampled": 264840, "num_agent_steps_trained": 264840}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11328.205051161282, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6472168089538926, "mean_inference_ms": 0.37229958138615815, "mean_action_processing_ms": 0.09055995503219712, "mean_env_wait_ms": 1.1519646696517127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003657102584838867, "StateBufferConnector_ms": 0.0027434825897216797, "ViewRequirementAgentConnector_ms": 0.06601524353027344}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11328.205051161282, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11332.990997265984, -11445.451072166528, -11365.43903348757, -11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6472168089538926, "mean_inference_ms": 0.37229958138615815, "mean_action_processing_ms": 0.09055995503219712, "mean_env_wait_ms": 1.1519646696517127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003657102584838867, "StateBufferConnector_ms": 0.0027434825897216797, "ViewRequirementAgentConnector_ms": 0.06601524353027344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264840, "num_agent_steps_trained": 264840, "num_env_steps_sampled": 264840, "num_env_steps_trained": 264840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.48323982896505, "num_env_steps_trained_throughput_per_sec": 108.48323982896505, "timesteps_total": 264840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 264840, "timers": {"training_iteration_time_ms": 3342.778, "sample_time_ms": 3332.197, "load_time_ms": 0.295, "load_throughput": 1219274.419, "learn_time_ms": 9.552, "learn_throughput": 37688.623, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 264840, "num_env_steps_trained": 264840, "num_agent_steps_sampled": 264840, "num_agent_steps_trained": 264840}, "done": false, "episodes_total": 1269, "training_iteration": 295, "trial_id": "04904_00000", "date": "2023-07-26_22-24-02", "timestamp": 1690399442, "time_this_iter_s": 13.276673078536987, "time_total_s": 3231.1796321868896, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1262.2277660369873, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 21.510526315789473, "ram_util_percent": 63.026315789473685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.2855712890625, "policy_loss": -18223619217817.6, "vf_loss": 212485827.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1893.0, "diff_num_grad_updates_vs_sampler_policy": 1892.0}}, "num_env_steps_sampled": 265920, "num_env_steps_trained": 265920, "num_agent_steps_sampled": 265920, "num_agent_steps_trained": 265920}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11326.584267795437, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.647626565379384, "mean_inference_ms": 0.372306181818543, "mean_action_processing_ms": 0.09055895633980127, "mean_env_wait_ms": 1.1517874116233995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003644704818725586, "StateBufferConnector_ms": 0.0027387142181396484, "ViewRequirementAgentConnector_ms": 0.0659186840057373}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11326.584267795437, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11297.810252593157, -11011.849575887514, -11261.32240701303, -11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.647626565379384, "mean_inference_ms": 0.372306181818543, "mean_action_processing_ms": 0.09055895633980127, "mean_env_wait_ms": 1.1517874116233995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003644704818725586, "StateBufferConnector_ms": 0.0027387142181396484, "ViewRequirementAgentConnector_ms": 0.0659186840057373}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265920, "num_agent_steps_trained": 265920, "num_env_steps_sampled": 265920, "num_env_steps_trained": 265920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.21122020543626, "num_env_steps_trained_throughput_per_sec": 106.21122020543626, "timesteps_total": 265920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 265920, "timers": {"training_iteration_time_ms": 3352.542, "sample_time_ms": 3341.932, "load_time_ms": 0.296, "load_throughput": 1215544.55, "learn_time_ms": 9.564, "learn_throughput": 37642.865, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 265920, "num_env_steps_trained": 265920, "num_agent_steps_sampled": 265920, "num_agent_steps_trained": 265920}, "done": false, "episodes_total": 1272, "training_iteration": 296, "trial_id": "04904_00000", "date": "2023-07-26_22-24-12", "timestamp": 1690399452, "time_this_iter_s": 10.171257972717285, "time_total_s": 3241.350890159607, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1272.3990240097046, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 19.126666666666665, "ram_util_percent": 63.10666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.593408203125, "policy_loss": -16906653270016.0, "vf_loss": 211839532.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1908.0, "diff_num_grad_updates_vs_sampler_policy": 1907.0}}, "num_env_steps_sampled": 267000, "num_env_steps_trained": 267000, "num_agent_steps_sampled": 267000, "num_agent_steps_trained": 267000}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11334.032962587531, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648040201035078, "mean_inference_ms": 0.37231323084163237, "mean_action_processing_ms": 0.09055794881317882, "mean_env_wait_ms": 1.1516203754945185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036487579345703125, "StateBufferConnector_ms": 0.0027360916137695312, "ViewRequirementAgentConnector_ms": 0.06590151786804199}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11334.032962587531, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11254.34799463682, -11257.055270290863, -11309.544561854538, -11339.102359469412, -11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648040201035078, "mean_inference_ms": 0.37231323084163237, "mean_action_processing_ms": 0.09055794881317882, "mean_env_wait_ms": 1.1516203754945185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036487579345703125, "StateBufferConnector_ms": 0.0027360916137695312, "ViewRequirementAgentConnector_ms": 0.06590151786804199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267000, "num_agent_steps_trained": 267000, "num_env_steps_sampled": 267000, "num_env_steps_trained": 267000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.40101569629606, "num_env_steps_trained_throughput_per_sec": 106.40101569629606, "timesteps_total": 267000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 267000, "timers": {"training_iteration_time_ms": 3359.251, "sample_time_ms": 3348.607, "load_time_ms": 0.298, "load_throughput": 1208733.141, "learn_time_ms": 9.596, "learn_throughput": 37513.806, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 267000, "num_env_steps_trained": 267000, "num_agent_steps_sampled": 267000, "num_agent_steps_trained": 267000}, "done": false, "episodes_total": 1275, "training_iteration": 297, "trial_id": "04904_00000", "date": "2023-07-26_22-24-22", "timestamp": 1690399462, "time_this_iter_s": 10.153045892715454, "time_total_s": 3251.5039360523224, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1282.55206990242, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 21.621428571428574, "ram_util_percent": 63.121428571428574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4696533203125, "policy_loss": -18889252536320.0, "vf_loss": 213571078.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1928.0, "diff_num_grad_updates_vs_sampler_policy": 1927.0}}, "num_env_steps_sampled": 268440, "num_env_steps_trained": 268440, "num_agent_steps_sampled": 268440, "num_agent_steps_trained": 268440}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11337.888638462846, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648552346695215, "mean_inference_ms": 0.37232196694276565, "mean_action_processing_ms": 0.09055643419893052, "mean_env_wait_ms": 1.1513890488371288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036516189575195312, "StateBufferConnector_ms": 0.0027303695678710938, "ViewRequirementAgentConnector_ms": 0.06589508056640625}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11337.888638462846, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11270.808767427658, -11486.09484818891, -11385.231860461896, -11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648552346695215, "mean_inference_ms": 0.37232196694276565, "mean_action_processing_ms": 0.09055643419893052, "mean_env_wait_ms": 1.1513890488371288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036516189575195312, "StateBufferConnector_ms": 0.0027303695678710938, "ViewRequirementAgentConnector_ms": 0.06589508056640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268440, "num_agent_steps_trained": 268440, "num_env_steps_sampled": 268440, "num_env_steps_trained": 268440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.84631870144733, "num_env_steps_trained_throughput_per_sec": 108.84631870144733, "timesteps_total": 268440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 268440, "timers": {"training_iteration_time_ms": 3354.823, "sample_time_ms": 3344.184, "load_time_ms": 0.298, "load_throughput": 1209120.307, "learn_time_ms": 9.593, "learn_throughput": 37527.605, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 268440, "num_env_steps_trained": 268440, "num_agent_steps_sampled": 268440, "num_agent_steps_trained": 268440}, "done": false, "episodes_total": 1279, "training_iteration": 298, "trial_id": "04904_00000", "date": "2023-07-26_22-24-35", "timestamp": 1690399475, "time_this_iter_s": 13.23245906829834, "time_total_s": 3264.7363951206207, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1295.7845289707184, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 21.5, "ram_util_percent": 63.18947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4029541015625, "policy_loss": -19751438909440.0, "vf_loss": 217755766.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1943.0, "diff_num_grad_updates_vs_sampler_policy": 1942.0}}, "num_env_steps_sampled": 269520, "num_env_steps_trained": 269520, "num_agent_steps_sampled": 269520, "num_agent_steps_trained": 269520}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11338.66390814333, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6489259086237755, "mean_inference_ms": 0.37232812818264344, "mean_action_processing_ms": 0.09055535831637063, "mean_env_wait_ms": 1.1512248818059547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003649473190307617, "StateBufferConnector_ms": 0.0027337074279785156, "ViewRequirementAgentConnector_ms": 0.06591057777404785}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11338.66390814333, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11295.843414577856, -11431.037729959322, -11003.079689943259, -11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6489259086237755, "mean_inference_ms": 0.37232812818264344, "mean_action_processing_ms": 0.09055535831637063, "mean_env_wait_ms": 1.1512248818059547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003649473190307617, "StateBufferConnector_ms": 0.0027337074279785156, "ViewRequirementAgentConnector_ms": 0.06591057777404785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269520, "num_agent_steps_trained": 269520, "num_env_steps_sampled": 269520, "num_env_steps_trained": 269520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.12361791322635, "num_env_steps_trained_throughput_per_sec": 106.12361791322635, "timesteps_total": 269520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 269520, "timers": {"training_iteration_time_ms": 3355.662, "sample_time_ms": 3345.025, "load_time_ms": 0.298, "load_throughput": 1206415.34, "learn_time_ms": 9.601, "learn_throughput": 37496.665, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 269520, "num_env_steps_trained": 269520, "num_agent_steps_sampled": 269520, "num_agent_steps_trained": 269520}, "done": false, "episodes_total": 1282, "training_iteration": 299, "trial_id": "04904_00000", "date": "2023-07-26_22-24-46", "timestamp": 1690399486, "time_this_iter_s": 10.179620027542114, "time_total_s": 3274.916015148163, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1305.9641489982605, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 20.214285714285715, "ram_util_percent": 63.20714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.2409912109374, "policy_loss": -15877092147200.0, "vf_loss": 217732144.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1958.0, "diff_num_grad_updates_vs_sampler_policy": 1957.0}}, "num_env_steps_sampled": 270600, "num_env_steps_trained": 270600, "num_agent_steps_sampled": 270600, "num_agent_steps_trained": 270600}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11341.122646373216, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.649286535762762, "mean_inference_ms": 0.3723343090197727, "mean_action_processing_ms": 0.09055445513964377, "mean_env_wait_ms": 1.1510669530933355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003645181655883789, "StateBufferConnector_ms": 0.002737283706665039, "ViewRequirementAgentConnector_ms": 0.06589841842651367}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11341.122646373216, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11207.841356472794, -11366.358122070096, -11291.304182945096, -11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.649286535762762, "mean_inference_ms": 0.3723343090197727, "mean_action_processing_ms": 0.09055445513964377, "mean_env_wait_ms": 1.1510669530933355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003645181655883789, "StateBufferConnector_ms": 0.002737283706665039, "ViewRequirementAgentConnector_ms": 0.06589841842651367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270600, "num_agent_steps_trained": 270600, "num_env_steps_sampled": 270600, "num_env_steps_trained": 270600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.34743682587315, "num_env_steps_trained_throughput_per_sec": 107.34743682587315, "timesteps_total": 270600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 270600, "timers": {"training_iteration_time_ms": 3346.713, "sample_time_ms": 3336.094, "load_time_ms": 0.297, "load_throughput": 1213103.109, "learn_time_ms": 9.591, "learn_throughput": 37534.135, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 270600, "num_env_steps_trained": 270600, "num_agent_steps_sampled": 270600, "num_agent_steps_trained": 270600}, "done": false, "episodes_total": 1285, "training_iteration": 300, "trial_id": "04904_00000", "date": "2023-07-26_22-24-56", "timestamp": 1690399496, "time_this_iter_s": 10.063468933105469, "time_total_s": 3284.9794840812683, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1316.027617931366, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 19.992857142857144, "ram_util_percent": 63.357142857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3404541015625, "policy_loss": -20807399505920.0, "vf_loss": 220787712.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1973.0, "diff_num_grad_updates_vs_sampler_policy": 1972.0}}, "num_env_steps_sampled": 271680, "num_env_steps_trained": 271680, "num_agent_steps_sampled": 271680, "num_agent_steps_trained": 271680}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11342.901783335348, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64964104690178, "mean_inference_ms": 0.3723405514602374, "mean_action_processing_ms": 0.09055356979344786, "mean_env_wait_ms": 1.1509193210898747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036461353302001953, "StateBufferConnector_ms": 0.002732992172241211, "ViewRequirementAgentConnector_ms": 0.06590056419372559}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11342.901783335348, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11118.183411999322, -11346.420261355286, -11134.150988417787, -11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.64964104690178, "mean_inference_ms": 0.3723405514602374, "mean_action_processing_ms": 0.09055356979344786, "mean_env_wait_ms": 1.1509193210898747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036461353302001953, "StateBufferConnector_ms": 0.002732992172241211, "ViewRequirementAgentConnector_ms": 0.06590056419372559}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271680, "num_agent_steps_trained": 271680, "num_env_steps_sampled": 271680, "num_env_steps_trained": 271680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.31874932464514, "num_env_steps_trained_throughput_per_sec": 107.31874932464514, "timesteps_total": 271680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 271680, "timers": {"training_iteration_time_ms": 3366.687, "sample_time_ms": 3356.047, "load_time_ms": 0.299, "load_throughput": 1204682.815, "learn_time_ms": 9.613, "learn_throughput": 37448.957, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 271680, "num_env_steps_trained": 271680, "num_agent_steps_sampled": 271680, "num_agent_steps_trained": 271680}, "done": false, "episodes_total": 1288, "training_iteration": 301, "trial_id": "04904_00000", "date": "2023-07-26_22-25-06", "timestamp": 1690399506, "time_this_iter_s": 10.066298007965088, "time_total_s": 3295.0457820892334, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1326.093915939331, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 20.406666666666663, "ram_util_percent": 63.27333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3723876953125, "policy_loss": -17373378432204.8, "vf_loss": 216623179.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1988.0, "diff_num_grad_updates_vs_sampler_policy": 1987.0}}, "num_env_steps_sampled": 272760, "num_env_steps_trained": 272760, "num_agent_steps_sampled": 272760, "num_agent_steps_trained": 272760}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11347.97977327302, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650003431425301, "mean_inference_ms": 0.3723460627271296, "mean_action_processing_ms": 0.09055251982453515, "mean_env_wait_ms": 1.1507969690398159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036573410034179688, "StateBufferConnector_ms": 0.002738475799560547, "ViewRequirementAgentConnector_ms": 0.06606769561767578}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11347.97977327302, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11380.728207396181, -11406.434238552922, -11470.18313866163, -11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650003431425301, "mean_inference_ms": 0.3723460627271296, "mean_action_processing_ms": 0.09055251982453515, "mean_env_wait_ms": 1.1507969690398159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036573410034179688, "StateBufferConnector_ms": 0.002738475799560547, "ViewRequirementAgentConnector_ms": 0.06606769561767578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272760, "num_agent_steps_trained": 272760, "num_env_steps_sampled": 272760, "num_env_steps_trained": 272760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.85459344866652, "num_env_steps_trained_throughput_per_sec": 105.85459344866652, "timesteps_total": 272760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 272760, "timers": {"training_iteration_time_ms": 3374.112, "sample_time_ms": 3363.44, "load_time_ms": 0.3, "load_throughput": 1201615.025, "learn_time_ms": 9.642, "learn_throughput": 37335.156, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 272760, "num_env_steps_trained": 272760, "num_agent_steps_sampled": 272760, "num_agent_steps_trained": 272760}, "done": false, "episodes_total": 1291, "training_iteration": 302, "trial_id": "04904_00000", "date": "2023-07-26_22-25-16", "timestamp": 1690399516, "time_this_iter_s": 10.205755949020386, "time_total_s": 3305.251538038254, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1336.2996718883514, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 19.65, "ram_util_percent": 63.14285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4753662109374, "policy_loss": -16885826243788.8, "vf_loss": 222697336.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2003.0, "diff_num_grad_updates_vs_sampler_policy": 2002.0}}, "num_env_steps_sampled": 273840, "num_env_steps_trained": 273840, "num_agent_steps_sampled": 273840, "num_agent_steps_trained": 273840}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11350.464424275968, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650362173127281, "mean_inference_ms": 0.3723517750349287, "mean_action_processing_ms": 0.09055152215923351, "mean_env_wait_ms": 1.1506907306684608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.0027322769165039062, "ViewRequirementAgentConnector_ms": 0.06604409217834473}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11350.464424275968, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11329.431724277549, -11429.4887053293, -11289.181731962655, -11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650362173127281, "mean_inference_ms": 0.3723517750349287, "mean_action_processing_ms": 0.09055152215923351, "mean_env_wait_ms": 1.1506907306684608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.0027322769165039062, "ViewRequirementAgentConnector_ms": 0.06604409217834473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273840, "num_agent_steps_trained": 273840, "num_env_steps_sampled": 273840, "num_env_steps_trained": 273840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.6506266287279, "num_env_steps_trained_throughput_per_sec": 106.6506266287279, "timesteps_total": 273840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 273840, "timers": {"training_iteration_time_ms": 3371.169, "sample_time_ms": 3360.582, "load_time_ms": 0.299, "load_throughput": 1202763.613, "learn_time_ms": 9.562, "learn_throughput": 37649.342, "synch_weights_time_ms": 0.683}, "counters": {"num_env_steps_sampled": 273840, "num_env_steps_trained": 273840, "num_agent_steps_sampled": 273840, "num_agent_steps_trained": 273840}, "done": false, "episodes_total": 1294, "training_iteration": 303, "trial_id": "04904_00000", "date": "2023-07-26_22-25-26", "timestamp": 1690399526, "time_this_iter_s": 10.129194974899292, "time_total_s": 3315.380733013153, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1346.4288668632507, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 20.493333333333332, "ram_util_percent": 63.05333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.446826171875, "policy_loss": -19775194293862.4, "vf_loss": 211191436.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2018.0, "diff_num_grad_updates_vs_sampler_policy": 2017.0}}, "num_env_steps_sampled": 274920, "num_env_steps_trained": 274920, "num_agent_steps_sampled": 274920, "num_agent_steps_trained": 274920}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11349.055970457475, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650711063794303, "mean_inference_ms": 0.37235727768937743, "mean_action_processing_ms": 0.0905505652609355, "mean_env_wait_ms": 1.1505582049112655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036580562591552734, "StateBufferConnector_ms": 0.0027284622192382812, "ViewRequirementAgentConnector_ms": 0.06610441207885742}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11349.055970457475, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11122.74556824538, -11425.821588895591, -11219.927686439552, -11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650711063794303, "mean_inference_ms": 0.37235727768937743, "mean_action_processing_ms": 0.0905505652609355, "mean_env_wait_ms": 1.1505582049112655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036580562591552734, "StateBufferConnector_ms": 0.0027284622192382812, "ViewRequirementAgentConnector_ms": 0.06610441207885742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274920, "num_agent_steps_trained": 274920, "num_env_steps_sampled": 274920, "num_env_steps_trained": 274920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.87060837321603, "num_env_steps_trained_throughput_per_sec": 107.87060837321603, "timesteps_total": 274920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 274920, "timers": {"training_iteration_time_ms": 3377.393, "sample_time_ms": 3366.835, "load_time_ms": 0.298, "load_throughput": 1207380.01, "learn_time_ms": 9.527, "learn_throughput": 37785.482, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 274920, "num_env_steps_trained": 274920, "num_agent_steps_sampled": 274920, "num_agent_steps_trained": 274920}, "done": false, "episodes_total": 1297, "training_iteration": 304, "trial_id": "04904_00000", "date": "2023-07-26_22-25-36", "timestamp": 1690399536, "time_this_iter_s": 10.01475715637207, "time_total_s": 3325.395490169525, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1356.4436240196228, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 19.800000000000004, "ram_util_percent": 62.949999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.378271484375, "policy_loss": -17429348378214.4, "vf_loss": 210927510.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2033.0, "diff_num_grad_updates_vs_sampler_policy": 2032.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11352.405826547614, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651028031072538, "mean_inference_ms": 0.37236240249119673, "mean_action_processing_ms": 0.09054961163960286, "mean_env_wait_ms": 1.150417521990219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003650665283203125, "StateBufferConnector_ms": 0.0027332305908203125, "ViewRequirementAgentConnector_ms": 0.06610488891601562}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11352.405826547614, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11315.475145301105, -11514.220061908378, -11192.88388672983, -11276.863384603625, -11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651028031072538, "mean_inference_ms": 0.37236240249119673, "mean_action_processing_ms": 0.09054961163960286, "mean_env_wait_ms": 1.150417521990219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003650665283203125, "StateBufferConnector_ms": 0.0027332305908203125, "ViewRequirementAgentConnector_ms": 0.06610488891601562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.66866855689248, "num_env_steps_trained_throughput_per_sec": 106.66866855689248, "timesteps_total": 276000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 3368.097, "sample_time_ms": 3357.589, "load_time_ms": 0.297, "load_throughput": 1211934.698, "learn_time_ms": 9.478, "learn_throughput": 37984.143, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1300, "training_iteration": 305, "trial_id": "04904_00000", "date": "2023-07-26_22-25-46", "timestamp": 1690399546, "time_this_iter_s": 10.127614974975586, "time_total_s": 3335.5231051445007, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1366.5712389945984, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 19.6, "ram_util_percent": 62.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4932861328125, "policy_loss": -15148704910540.8, "vf_loss": 220630014.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2053.0, "diff_num_grad_updates_vs_sampler_policy": 2052.0}}, "num_env_steps_sampled": 277440, "num_env_steps_trained": 277440, "num_agent_steps_sampled": 277440, "num_agent_steps_trained": 277440}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11350.48800281052, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6513814207348245, "mean_inference_ms": 0.3723683870624753, "mean_action_processing_ms": 0.09054824015629234, "mean_env_wait_ms": 1.150212351293105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036568641662597656, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.06612443923950195}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11350.48800281052, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11311.526195002663, -11197.885282683355, -11515.072596835564, -11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6513814207348245, "mean_inference_ms": 0.3723683870624753, "mean_action_processing_ms": 0.09054824015629234, "mean_env_wait_ms": 1.150212351293105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036568641662597656, "StateBufferConnector_ms": 0.002737760543823242, "ViewRequirementAgentConnector_ms": 0.06612443923950195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277440, "num_agent_steps_trained": 277440, "num_env_steps_sampled": 277440, "num_env_steps_trained": 277440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.38244939401953, "num_env_steps_trained_throughput_per_sec": 108.38244939401953, "timesteps_total": 277440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 277440, "timers": {"training_iteration_time_ms": 3342.296, "sample_time_ms": 3331.692, "load_time_ms": 0.298, "load_throughput": 1209120.307, "learn_time_ms": 9.563, "learn_throughput": 37643.898, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 277440, "num_env_steps_trained": 277440, "num_agent_steps_sampled": 277440, "num_agent_steps_trained": 277440}, "done": false, "episodes_total": 1304, "training_iteration": 306, "trial_id": "04904_00000", "date": "2023-07-26_22-26-00", "timestamp": 1690399560, "time_this_iter_s": 13.289215803146362, "time_total_s": 3348.812320947647, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1379.8604547977448, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 21.810526315789474, "ram_util_percent": 63.078947368421055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.51533203125, "policy_loss": -21680473558220.8, "vf_loss": 219916006.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2068.0, "diff_num_grad_updates_vs_sampler_policy": 2067.0}}, "num_env_steps_sampled": 278520, "num_env_steps_trained": 278520, "num_agent_steps_sampled": 278520, "num_agent_steps_trained": 278520}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11351.539937290341, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651625870988221, "mean_inference_ms": 0.3723736466185192, "mean_action_processing_ms": 0.0905472698219928, "mean_env_wait_ms": 1.1500910124747141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036592483520507812, "StateBufferConnector_ms": 0.002742290496826172, "ViewRequirementAgentConnector_ms": 0.06621456146240234}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11351.539937290341, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11408.95847745038, -11280.453034857408, -11519.815713729033, -11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651625870988221, "mean_inference_ms": 0.3723736466185192, "mean_action_processing_ms": 0.0905472698219928, "mean_env_wait_ms": 1.1500910124747141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036592483520507812, "StateBufferConnector_ms": 0.002742290496826172, "ViewRequirementAgentConnector_ms": 0.06621456146240234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278520, "num_agent_steps_trained": 278520, "num_env_steps_sampled": 278520, "num_env_steps_trained": 278520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.02204105863252, "num_env_steps_trained_throughput_per_sec": 106.02204105863252, "timesteps_total": 278520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 278520, "timers": {"training_iteration_time_ms": 3359.752, "sample_time_ms": 3349.114, "load_time_ms": 0.299, "load_throughput": 1205355.983, "learn_time_ms": 9.579, "learn_throughput": 37583.556, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 278520, "num_env_steps_trained": 278520, "num_agent_steps_sampled": 278520, "num_agent_steps_trained": 278520}, "done": false, "episodes_total": 1307, "training_iteration": 307, "trial_id": "04904_00000", "date": "2023-07-26_22-26-10", "timestamp": 1690399570, "time_this_iter_s": 10.189280986785889, "time_total_s": 3359.001601934433, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1390.0497357845306, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 18.3, "ram_util_percent": 63.04285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.278662109375, "policy_loss": -14862879090073.2, "vf_loss": 221685856.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2083.0, "diff_num_grad_updates_vs_sampler_policy": 2082.0}}, "num_env_steps_sampled": 279600, "num_env_steps_trained": 279600, "num_agent_steps_sampled": 279600, "num_agent_steps_trained": 279600}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11345.511709587277, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651868910047466, "mean_inference_ms": 0.3723797301235875, "mean_action_processing_ms": 0.09054641437076949, "mean_env_wait_ms": 1.1499770410065322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.0027425289154052734, "ViewRequirementAgentConnector_ms": 0.06620669364929199}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11345.511709587277, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11487.983758705004, -11299.37392720451, -11350.431978194852, -11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651868910047466, "mean_inference_ms": 0.3723797301235875, "mean_action_processing_ms": 0.09054641437076949, "mean_env_wait_ms": 1.1499770410065322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654003143310547, "StateBufferConnector_ms": 0.0027425289154052734, "ViewRequirementAgentConnector_ms": 0.06620669364929199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279600, "num_agent_steps_trained": 279600, "num_env_steps_sampled": 279600, "num_env_steps_trained": 279600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.10313119040771, "num_env_steps_trained_throughput_per_sec": 107.10313119040771, "timesteps_total": 279600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 279600, "timers": {"training_iteration_time_ms": 3355.645, "sample_time_ms": 3344.977, "load_time_ms": 0.298, "load_throughput": 1208249.532, "learn_time_ms": 9.602, "learn_throughput": 37490.334, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 279600, "num_env_steps_trained": 279600, "num_agent_steps_sampled": 279600, "num_agent_steps_trained": 279600}, "done": false, "episodes_total": 1310, "training_iteration": 308, "trial_id": "04904_00000", "date": "2023-07-26_22-26-20", "timestamp": 1690399580, "time_this_iter_s": 10.086638689041138, "time_total_s": 3369.088240623474, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1400.1363744735718, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 20.12, "ram_util_percent": 63.05333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.417236328125, "policy_loss": -20972050579456.0, "vf_loss": 213175904.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2098.0, "diff_num_grad_updates_vs_sampler_policy": 2097.0}}, "num_env_steps_sampled": 280680, "num_env_steps_trained": 280680, "num_agent_steps_sampled": 280680, "num_agent_steps_trained": 280680}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11342.553833843494, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652118328173006, "mean_inference_ms": 0.37238575278212466, "mean_action_processing_ms": 0.09054559367397579, "mean_env_wait_ms": 1.1498574868299953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036592483520507812, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.06618952751159668}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11342.553833843494, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11549.227218945503, -11082.8436627334, -11259.734135473958, -11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652118328173006, "mean_inference_ms": 0.37238575278212466, "mean_action_processing_ms": 0.09054559367397579, "mean_env_wait_ms": 1.1498574868299953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036592483520507812, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.06618952751159668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280680, "num_agent_steps_trained": 280680, "num_env_steps_sampled": 280680, "num_env_steps_trained": 280680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.9205503434566, "num_env_steps_trained_throughput_per_sec": 106.9205503434566, "timesteps_total": 280680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 280680, "timers": {"training_iteration_time_ms": 3368.593, "sample_time_ms": 3357.933, "load_time_ms": 0.3, "load_throughput": 1201519.408, "learn_time_ms": 9.592, "learn_throughput": 37530.869, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 280680, "num_env_steps_trained": 280680, "num_agent_steps_sampled": 280680, "num_agent_steps_trained": 280680}, "done": false, "episodes_total": 1313, "training_iteration": 309, "trial_id": "04904_00000", "date": "2023-07-26_22-26-30", "timestamp": 1690399590, "time_this_iter_s": 10.10378122329712, "time_total_s": 3379.1920218467712, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1410.240155696869, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 20.57857142857143, "ram_util_percent": 63.02142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3156982421874, "policy_loss": -21659416054988.8, "vf_loss": 214519427.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2113.0, "diff_num_grad_updates_vs_sampler_policy": 2112.0}}, "num_env_steps_sampled": 281760, "num_env_steps_trained": 281760, "num_agent_steps_sampled": 281760, "num_agent_steps_trained": 281760}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11339.604396171288, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652350042408621, "mean_inference_ms": 0.372391504229833, "mean_action_processing_ms": 0.09054471389759453, "mean_env_wait_ms": 1.1497311520020868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003662586212158203, "StateBufferConnector_ms": 0.002717256546020508, "ViewRequirementAgentConnector_ms": 0.06627464294433594}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11339.604396171288, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11303.532846296901, -11372.142057359853, -11453.244469061143, -11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652350042408621, "mean_inference_ms": 0.372391504229833, "mean_action_processing_ms": 0.09054471389759453, "mean_env_wait_ms": 1.1497311520020868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003662586212158203, "StateBufferConnector_ms": 0.002717256546020508, "ViewRequirementAgentConnector_ms": 0.06627464294433594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281760, "num_agent_steps_trained": 281760, "num_env_steps_sampled": 281760, "num_env_steps_trained": 281760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.57676203337432, "num_env_steps_trained_throughput_per_sec": 107.57676203337432, "timesteps_total": 281760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 281760, "timers": {"training_iteration_time_ms": 3361.587, "sample_time_ms": 3350.88, "load_time_ms": 0.3, "load_throughput": 1199514.967, "learn_time_ms": 9.612, "learn_throughput": 37451.465, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 281760, "num_env_steps_trained": 281760, "num_agent_steps_sampled": 281760, "num_agent_steps_trained": 281760}, "done": false, "episodes_total": 1316, "training_iteration": 310, "trial_id": "04904_00000", "date": "2023-07-26_22-26-40", "timestamp": 1690399600, "time_this_iter_s": 10.042129278182983, "time_total_s": 3389.234151124954, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1420.2822849750519, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 21.292857142857148, "ram_util_percent": 63.357142857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3161376953126, "policy_loss": -19831120619110.4, "vf_loss": 219036496.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2128.0, "diff_num_grad_updates_vs_sampler_policy": 2127.0}}, "num_env_steps_sampled": 282840, "num_env_steps_trained": 282840, "num_agent_steps_sampled": 282840, "num_agent_steps_trained": 282840}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11338.323573927064, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652572802658011, "mean_inference_ms": 0.37239689826933314, "mean_action_processing_ms": 0.09054387360401865, "mean_env_wait_ms": 1.149615450178176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003657817840576172, "StateBufferConnector_ms": 0.0027129650115966797, "ViewRequirementAgentConnector_ms": 0.06627345085144043}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11338.323573927064, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11365.481997344654, -11379.485973757828, -11332.803853557296, -11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652572802658011, "mean_inference_ms": 0.37239689826933314, "mean_action_processing_ms": 0.09054387360401865, "mean_env_wait_ms": 1.149615450178176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003657817840576172, "StateBufferConnector_ms": 0.0027129650115966797, "ViewRequirementAgentConnector_ms": 0.06627345085144043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 282840, "num_agent_steps_trained": 282840, "num_env_steps_sampled": 282840, "num_env_steps_trained": 282840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.57149411626841, "num_env_steps_trained_throughput_per_sec": 106.57149411626841, "timesteps_total": 282840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 282840, "timers": {"training_iteration_time_ms": 3359.927, "sample_time_ms": 3349.265, "load_time_ms": 0.302, "load_throughput": 1193258.606, "learn_time_ms": 9.581, "learn_throughput": 37575.98, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 282840, "num_env_steps_trained": 282840, "num_agent_steps_sampled": 282840, "num_agent_steps_trained": 282840}, "done": false, "episodes_total": 1319, "training_iteration": 311, "trial_id": "04904_00000", "date": "2023-07-26_22-26-50", "timestamp": 1690399610, "time_this_iter_s": 10.136780738830566, "time_total_s": 3399.370931863785, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1430.4190657138824, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 20.22666666666667, "ram_util_percent": 63.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3998779296876, "policy_loss": -23455914262528.0, "vf_loss": 214449576.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2143.0, "diff_num_grad_updates_vs_sampler_policy": 2142.0}}, "num_env_steps_sampled": 283920, "num_env_steps_trained": 283920, "num_agent_steps_sampled": 283920, "num_agent_steps_trained": 283920}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11336.338091203063, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652803304259567, "mean_inference_ms": 0.37240248296646483, "mean_action_processing_ms": 0.0905431965494321, "mean_env_wait_ms": 1.1495134839520589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003659486770629883, "StateBufferConnector_ms": 0.002711057662963867, "ViewRequirementAgentConnector_ms": 0.06625914573669434}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11336.338091203063, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11006.32320934442, -11382.965052133048, -11558.009094704117, -11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652803304259567, "mean_inference_ms": 0.37240248296646483, "mean_action_processing_ms": 0.0905431965494321, "mean_env_wait_ms": 1.1495134839520589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003659486770629883, "StateBufferConnector_ms": 0.002711057662963867, "ViewRequirementAgentConnector_ms": 0.06625914573669434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283920, "num_agent_steps_trained": 283920, "num_env_steps_sampled": 283920, "num_env_steps_trained": 283920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.14717388919964, "num_env_steps_trained_throughput_per_sec": 107.14717388919964, "timesteps_total": 283920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 283920, "timers": {"training_iteration_time_ms": 3361.494, "sample_time_ms": 3350.772, "load_time_ms": 0.301, "load_throughput": 1197327.286, "learn_time_ms": 9.639, "learn_throughput": 37348.546, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 283920, "num_env_steps_trained": 283920, "num_agent_steps_sampled": 283920, "num_agent_steps_trained": 283920}, "done": false, "episodes_total": 1322, "training_iteration": 312, "trial_id": "04904_00000", "date": "2023-07-26_22-27-00", "timestamp": 1690399620, "time_this_iter_s": 10.08231496810913, "time_total_s": 3409.453246831894, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1440.5013806819916, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 20.928571428571427, "ram_util_percent": 63.26428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4138427734374, "policy_loss": -24720420791910.4, "vf_loss": 218296134.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2158.0, "diff_num_grad_updates_vs_sampler_policy": 2157.0}}, "num_env_steps_sampled": 285000, "num_env_steps_trained": 285000, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11335.85656617418, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653016385584624, "mean_inference_ms": 0.3724075104413804, "mean_action_processing_ms": 0.09054253747792425, "mean_env_wait_ms": 1.1494106600678358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003659486770629883, "StateBufferConnector_ms": 0.002701997756958008, "ViewRequirementAgentConnector_ms": 0.06620669364929199}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11335.85656617418, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11331.03188237056, -11083.202920239151, -11278.814683025865, -11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653016385584624, "mean_inference_ms": 0.3724075104413804, "mean_action_processing_ms": 0.09054253747792425, "mean_env_wait_ms": 1.1494106600678358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003659486770629883, "StateBufferConnector_ms": 0.002701997756958008, "ViewRequirementAgentConnector_ms": 0.06620669364929199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000, "num_env_steps_sampled": 285000, "num_env_steps_trained": 285000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.21296205984913, "num_env_steps_trained_throughput_per_sec": 107.21296205984913, "timesteps_total": 285000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 285000, "timers": {"training_iteration_time_ms": 3362.781, "sample_time_ms": 3352.064, "load_time_ms": 0.297, "load_throughput": 1211740.181, "learn_time_ms": 9.64, "learn_throughput": 37343.097, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 285000, "num_env_steps_trained": 285000, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000}, "done": false, "episodes_total": 1325, "training_iteration": 313, "trial_id": "04904_00000", "date": "2023-07-26_22-27-11", "timestamp": 1690399631, "time_this_iter_s": 10.07623291015625, "time_total_s": 3419.52947974205, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1450.5776135921478, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 19.62857142857143, "ram_util_percent": 63.36428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.5719482421875, "policy_loss": -13149448280473.6, "vf_loss": 211491830.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2173.0, "diff_num_grad_updates_vs_sampler_policy": 2172.0}}, "num_env_steps_sampled": 286080, "num_env_steps_trained": 286080, "num_agent_steps_sampled": 286080, "num_agent_steps_trained": 286080}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11341.382017548847, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653221676111173, "mean_inference_ms": 0.37241297713933474, "mean_action_processing_ms": 0.09054193055550769, "mean_env_wait_ms": 1.1493147146181595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036602020263671875, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06628251075744629}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11341.382017548847, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11317.492769025597, -11452.672601238988, -11212.314803063098, -11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653221676111173, "mean_inference_ms": 0.37241297713933474, "mean_action_processing_ms": 0.09054193055550769, "mean_env_wait_ms": 1.1493147146181595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036602020263671875, "StateBufferConnector_ms": 0.0027065277099609375, "ViewRequirementAgentConnector_ms": 0.06628251075744629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286080, "num_agent_steps_trained": 286080, "num_env_steps_sampled": 286080, "num_env_steps_trained": 286080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.65316277830668, "num_env_steps_trained_throughput_per_sec": 106.65316277830668, "timesteps_total": 286080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 286080, "timers": {"training_iteration_time_ms": 3364.166, "sample_time_ms": 3353.492, "load_time_ms": 0.297, "load_throughput": 1212226.59, "learn_time_ms": 9.624, "learn_throughput": 37407.857, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 286080, "num_env_steps_trained": 286080, "num_agent_steps_sampled": 286080, "num_agent_steps_trained": 286080}, "done": false, "episodes_total": 1328, "training_iteration": 314, "trial_id": "04904_00000", "date": "2023-07-26_22-27-21", "timestamp": 1690399641, "time_this_iter_s": 10.128994941711426, "time_total_s": 3429.6584746837616, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1460.7066085338593, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 20.09333333333333, "ram_util_percent": 63.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.38232421875, "policy_loss": -22871768720998.4, "vf_loss": 221553417.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2188.0, "diff_num_grad_updates_vs_sampler_policy": 2187.0}}, "num_env_steps_sampled": 287160, "num_env_steps_trained": 287160, "num_agent_steps_sampled": 287160, "num_agent_steps_trained": 287160}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11343.06421280293, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653419891884603, "mean_inference_ms": 0.3724168875373802, "mean_action_processing_ms": 0.09054103424102687, "mean_env_wait_ms": 1.1492288084876607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036597251892089844, "StateBufferConnector_ms": 0.002704143524169922, "ViewRequirementAgentConnector_ms": 0.06625604629516602}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11582.059949678549, "episode_reward_mean": -11343.06421280293, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11444.209672283525, -11530.803661282403, -11359.798124341709, -11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653419891884603, "mean_inference_ms": 0.3724168875373802, "mean_action_processing_ms": 0.09054103424102687, "mean_env_wait_ms": 1.1492288084876607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036597251892089844, "StateBufferConnector_ms": 0.002704143524169922, "ViewRequirementAgentConnector_ms": 0.06625604629516602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287160, "num_agent_steps_trained": 287160, "num_env_steps_sampled": 287160, "num_env_steps_trained": 287160, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.95375106447035, "num_env_steps_trained_throughput_per_sec": 107.95375106447035, "timesteps_total": 287160, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 287160, "timers": {"training_iteration_time_ms": 3359.8, "sample_time_ms": 3349.073, "load_time_ms": 0.301, "load_throughput": 1197137.43, "learn_time_ms": 9.669, "learn_throughput": 37233.425, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 287160, "num_env_steps_trained": 287160, "num_agent_steps_sampled": 287160, "num_agent_steps_trained": 287160}, "done": false, "episodes_total": 1331, "training_iteration": 315, "trial_id": "04904_00000", "date": "2023-07-26_22-27-31", "timestamp": 1690399651, "time_this_iter_s": 10.00721001625061, "time_total_s": 3439.665684700012, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1470.7138185501099, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 24.157142857142862, "ram_util_percent": 62.96428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4237548828125, "policy_loss": -20486411098521.6, "vf_loss": 208460696.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2203.0, "diff_num_grad_updates_vs_sampler_policy": 2202.0}}, "num_env_steps_sampled": 288240, "num_env_steps_trained": 288240, "num_agent_steps_sampled": 288240, "num_agent_steps_trained": 288240}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11342.096496243104, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65361797608521, "mean_inference_ms": 0.3724219429938064, "mean_action_processing_ms": 0.0905404001735789, "mean_env_wait_ms": 1.1491520692209045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036644935607910156, "StateBufferConnector_ms": 0.0027022361755371094, "ViewRequirementAgentConnector_ms": 0.06626343727111816}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11342.096496243104, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11183.263682996705, -11319.327676152194, -11213.481715107902, -11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65361797608521, "mean_inference_ms": 0.3724219429938064, "mean_action_processing_ms": 0.0905404001735789, "mean_env_wait_ms": 1.1491520692209045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036644935607910156, "StateBufferConnector_ms": 0.0027022361755371094, "ViewRequirementAgentConnector_ms": 0.06626343727111816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288240, "num_agent_steps_trained": 288240, "num_env_steps_sampled": 288240, "num_env_steps_trained": 288240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.63439812718303, "num_env_steps_trained_throughput_per_sec": 106.63439812718303, "timesteps_total": 288240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 288240, "timers": {"training_iteration_time_ms": 3362.419, "sample_time_ms": 3351.719, "load_time_ms": 0.303, "load_throughput": 1190061.034, "learn_time_ms": 9.627, "learn_throughput": 37393.868, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 288240, "num_env_steps_trained": 288240, "num_agent_steps_sampled": 288240, "num_agent_steps_trained": 288240}, "done": false, "episodes_total": 1334, "training_iteration": 316, "trial_id": "04904_00000", "date": "2023-07-26_22-27-41", "timestamp": 1690399661, "time_this_iter_s": 10.130792140960693, "time_total_s": 3449.796476840973, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1480.8446106910706, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 21.678571428571427, "ram_util_percent": 62.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4271484375, "policy_loss": -18333465732710.4, "vf_loss": 212500953.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2218.0, "diff_num_grad_updates_vs_sampler_policy": 2217.0}}, "num_env_steps_sampled": 289320, "num_env_steps_trained": 289320, "num_agent_steps_sampled": 289320, "num_agent_steps_trained": 289320}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11346.337330608065, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653819254349457, "mean_inference_ms": 0.372427256801805, "mean_action_processing_ms": 0.09053988396141785, "mean_env_wait_ms": 1.1490819918734383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036606788635253906, "StateBufferConnector_ms": 0.002702474594116211, "ViewRequirementAgentConnector_ms": 0.0662851333618164}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11346.337330608065, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11247.782372220092, -11441.994803018655, -11161.61318247169, -11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653819254349457, "mean_inference_ms": 0.372427256801805, "mean_action_processing_ms": 0.09053988396141785, "mean_env_wait_ms": 1.1490819918734383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036606788635253906, "StateBufferConnector_ms": 0.002702474594116211, "ViewRequirementAgentConnector_ms": 0.0662851333618164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289320, "num_agent_steps_trained": 289320, "num_env_steps_sampled": 289320, "num_env_steps_trained": 289320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.5624938321657, "num_env_steps_trained_throughput_per_sec": 106.5624938321657, "timesteps_total": 289320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 289320, "timers": {"training_iteration_time_ms": 3361.388, "sample_time_ms": 3350.664, "load_time_ms": 0.3, "load_throughput": 1199133.926, "learn_time_ms": 9.664, "learn_throughput": 37251.429, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 289320, "num_env_steps_trained": 289320, "num_agent_steps_sampled": 289320, "num_agent_steps_trained": 289320}, "done": false, "episodes_total": 1337, "training_iteration": 317, "trial_id": "04904_00000", "date": "2023-07-26_22-27-51", "timestamp": 1690399671, "time_this_iter_s": 10.137625217437744, "time_total_s": 3459.9341020584106, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1490.9822359085083, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 19.742857142857137, "ram_util_percent": 62.97857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4121826171875, "policy_loss": -25694500080844.8, "vf_loss": 218057542.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2233.0, "diff_num_grad_updates_vs_sampler_policy": 2232.0}}, "num_env_steps_sampled": 290400, "num_env_steps_trained": 290400, "num_agent_steps_sampled": 290400, "num_agent_steps_trained": 290400}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11346.379443192587, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654012739379925, "mean_inference_ms": 0.37243265760625327, "mean_action_processing_ms": 0.09053938853813785, "mean_env_wait_ms": 1.1490041882707833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036554336547851562, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06626772880554199}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11346.379443192587, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11490.681655256505, -11551.100379191603, -11237.781053424042, -10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654012739379925, "mean_inference_ms": 0.37243265760625327, "mean_action_processing_ms": 0.09053938853813785, "mean_env_wait_ms": 1.1490041882707833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036554336547851562, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06626772880554199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290400, "num_agent_steps_trained": 290400, "num_env_steps_sampled": 290400, "num_env_steps_trained": 290400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.45473110320374, "num_env_steps_trained_throughput_per_sec": 107.45473110320374, "timesteps_total": 290400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 290400, "timers": {"training_iteration_time_ms": 3361.284, "sample_time_ms": 3350.652, "load_time_ms": 0.298, "load_throughput": 1209507.722, "learn_time_ms": 9.595, "learn_throughput": 37521.45, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 290400, "num_env_steps_trained": 290400, "num_agent_steps_sampled": 290400, "num_agent_steps_trained": 290400}, "done": false, "episodes_total": 1340, "training_iteration": 318, "trial_id": "04904_00000", "date": "2023-07-26_22-28-01", "timestamp": 1690399681, "time_this_iter_s": 10.053705930709839, "time_total_s": 3469.9878079891205, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1501.0359418392181, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 21.02, "ram_util_percent": 62.986666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.386572265625, "policy_loss": -5079074982593.75, "vf_loss": 220440696.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2248.0, "diff_num_grad_updates_vs_sampler_policy": 2247.0}}, "num_env_steps_sampled": 291480, "num_env_steps_trained": 291480, "num_agent_steps_sampled": 291480, "num_agent_steps_trained": 291480}, "sampler_results": {"episode_reward_max": -10946.143719895463, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11344.317613838706, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654179207961115, "mean_inference_ms": 0.37243820538739636, "mean_action_processing_ms": 0.09053894724986555, "mean_env_wait_ms": 1.1489205272329261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003648519515991211, "StateBufferConnector_ms": 0.0026967525482177734, "ViewRequirementAgentConnector_ms": 0.06614804267883301}}, "episode_reward_max": -10946.143719895463, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11344.317613838706, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10946.143719895463, -11398.123044516224, -11246.00291346632, -11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654179207961115, "mean_inference_ms": 0.37243820538739636, "mean_action_processing_ms": 0.09053894724986555, "mean_env_wait_ms": 1.1489205272329261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003648519515991211, "StateBufferConnector_ms": 0.0026967525482177734, "ViewRequirementAgentConnector_ms": 0.06614804267883301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 291480, "num_agent_steps_trained": 291480, "num_env_steps_sampled": 291480, "num_env_steps_trained": 291480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.85616620063148, "num_env_steps_trained_throughput_per_sec": 107.85616620063148, "timesteps_total": 291480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 291480, "timers": {"training_iteration_time_ms": 3357.35, "sample_time_ms": 3346.773, "load_time_ms": 0.296, "load_throughput": 1215740.29, "learn_time_ms": 9.547, "learn_throughput": 37709.989, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 291480, "num_env_steps_trained": 291480, "num_agent_steps_sampled": 291480, "num_agent_steps_trained": 291480}, "done": false, "episodes_total": 1343, "training_iteration": 319, "trial_id": "04904_00000", "date": "2023-07-26_22-28-11", "timestamp": 1690399691, "time_this_iter_s": 10.016036987304688, "time_total_s": 3480.003844976425, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1511.0519788265228, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 18.985714285714288, "ram_util_percent": 62.92142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4594970703124, "policy_loss": -13344773784115.15, "vf_loss": 202170772.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2263.0, "diff_num_grad_updates_vs_sampler_policy": 2262.0}}, "num_env_steps_sampled": 292560, "num_env_steps_trained": 292560, "num_agent_steps_sampled": 292560, "num_agent_steps_trained": 292560}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11345.97492450956, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654335303408556, "mean_inference_ms": 0.37244339420154593, "mean_action_processing_ms": 0.09053851871381348, "mean_env_wait_ms": 1.148821546435199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003647327423095703, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06614923477172852}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11345.97492450956, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11526.118914502216, -11497.26310845283, -11055.721357669712, -11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654335303408556, "mean_inference_ms": 0.37244339420154593, "mean_action_processing_ms": 0.09053851871381348, "mean_env_wait_ms": 1.148821546435199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003647327423095703, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06614923477172852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292560, "num_agent_steps_trained": 292560, "num_env_steps_sampled": 292560, "num_env_steps_trained": 292560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.36519362693001, "num_env_steps_trained_throughput_per_sec": 107.36519362693001, "timesteps_total": 292560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 292560, "timers": {"training_iteration_time_ms": 3346.262, "sample_time_ms": 3335.739, "load_time_ms": 0.296, "load_throughput": 1217701.161, "learn_time_ms": 9.504, "learn_throughput": 37876.854, "synch_weights_time_ms": 0.677}, "counters": {"num_env_steps_sampled": 292560, "num_env_steps_trained": 292560, "num_agent_steps_sampled": 292560, "num_agent_steps_trained": 292560}, "done": false, "episodes_total": 1346, "training_iteration": 320, "trial_id": "04904_00000", "date": "2023-07-26_22-28-21", "timestamp": 1690399701, "time_this_iter_s": 10.062004089355469, "time_total_s": 3490.0658490657806, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1521.1139829158783, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 19.985714285714288, "ram_util_percent": 62.98571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4420654296875, "policy_loss": -15058580537344.0, "vf_loss": 211954531.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2278.0, "diff_num_grad_updates_vs_sampler_policy": 2277.0}}, "num_env_steps_sampled": 293640, "num_env_steps_trained": 293640, "num_agent_steps_sampled": 293640, "num_agent_steps_trained": 293640}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11345.15214189895, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654484108944916, "mean_inference_ms": 0.372449131751706, "mean_action_processing_ms": 0.09053827631971811, "mean_env_wait_ms": 1.1487171430527767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036454200744628906, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06616663932800293}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11345.15214189895, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11582.059949678549, -11505.286245215219, -11297.165466638564, -11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654484108944916, "mean_inference_ms": 0.372449131751706, "mean_action_processing_ms": 0.09053827631971811, "mean_env_wait_ms": 1.1487171430527767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036454200744628906, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06616663932800293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293640, "num_agent_steps_trained": 293640, "num_env_steps_sampled": 293640, "num_env_steps_trained": 293640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.40403531183566, "num_env_steps_trained_throughput_per_sec": 107.40403531183566, "timesteps_total": 293640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 293640, "timers": {"training_iteration_time_ms": 3351.495, "sample_time_ms": 3340.933, "load_time_ms": 0.296, "load_throughput": 1214469.106, "learn_time_ms": 9.545, "learn_throughput": 37715.829, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 293640, "num_env_steps_trained": 293640, "num_agent_steps_sampled": 293640, "num_agent_steps_trained": 293640}, "done": false, "episodes_total": 1349, "training_iteration": 321, "trial_id": "04904_00000", "date": "2023-07-26_22-28-31", "timestamp": 1690399711, "time_this_iter_s": 10.05825400352478, "time_total_s": 3500.1241030693054, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1531.172236919403, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 20.264285714285712, "ram_util_percent": 63.07857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.341162109375, "policy_loss": -27210031300608.0, "vf_loss": 222958822.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2293.0, "diff_num_grad_updates_vs_sampler_policy": 2292.0}}, "num_env_steps_sampled": 294720, "num_env_steps_trained": 294720, "num_agent_steps_sampled": 294720, "num_agent_steps_trained": 294720}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11344.000133001513, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654621372461444, "mean_inference_ms": 0.37245568730118955, "mean_action_processing_ms": 0.09053832602492465, "mean_env_wait_ms": 1.1486296059365628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003640413284301758, "StateBufferConnector_ms": 0.0026988983154296875, "ViewRequirementAgentConnector_ms": 0.06612896919250488}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11344.000133001513, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11383.707910914922, -11183.819775804637, -11291.371454568722, -11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654621372461444, "mean_inference_ms": 0.37245568730118955, "mean_action_processing_ms": 0.09053832602492465, "mean_env_wait_ms": 1.1486296059365628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003640413284301758, "StateBufferConnector_ms": 0.0026988983154296875, "ViewRequirementAgentConnector_ms": 0.06612896919250488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 294720, "num_agent_steps_trained": 294720, "num_env_steps_sampled": 294720, "num_env_steps_trained": 294720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.45053617264514, "num_env_steps_trained_throughput_per_sec": 106.45053617264514, "timesteps_total": 294720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 294720, "timers": {"training_iteration_time_ms": 3352.189, "sample_time_ms": 3341.621, "load_time_ms": 0.297, "load_throughput": 1213980.897, "learn_time_ms": 9.539, "learn_throughput": 37739.773, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 294720, "num_env_steps_trained": 294720, "num_agent_steps_sampled": 294720, "num_agent_steps_trained": 294720}, "done": false, "episodes_total": 1352, "training_iteration": 322, "trial_id": "04904_00000", "date": "2023-07-26_22-28-42", "timestamp": 1690399722, "time_this_iter_s": 10.148422002792358, "time_total_s": 3510.272525072098, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1541.3206589221954, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 21.526666666666664, "ram_util_percent": 63.25999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.41689453125, "policy_loss": -20281048642355.2, "vf_loss": 215249801.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2308.0, "diff_num_grad_updates_vs_sampler_policy": 2307.0}}, "num_env_steps_sampled": 295800, "num_env_steps_trained": 295800, "num_agent_steps_sampled": 295800, "num_agent_steps_trained": 295800}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11343.440284334292, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65475155654872, "mean_inference_ms": 0.3724617491550735, "mean_action_processing_ms": 0.09053841100867178, "mean_env_wait_ms": 1.1485503302419615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003639698028564453, "StateBufferConnector_ms": 0.0027005672454833984, "ViewRequirementAgentConnector_ms": 0.06609463691711426}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11343.440284334292, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11137.033896537821, -11470.178514314995, -11301.890963000766, -11369.318238318221, -11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65475155654872, "mean_inference_ms": 0.3724617491550735, "mean_action_processing_ms": 0.09053841100867178, "mean_env_wait_ms": 1.1485503302419615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003639698028564453, "StateBufferConnector_ms": 0.0027005672454833984, "ViewRequirementAgentConnector_ms": 0.06609463691711426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 295800, "num_agent_steps_trained": 295800, "num_env_steps_sampled": 295800, "num_env_steps_trained": 295800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.26748319609266, "num_env_steps_trained_throughput_per_sec": 107.26748319609266, "timesteps_total": 295800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 295800, "timers": {"training_iteration_time_ms": 3358.932, "sample_time_ms": 3348.366, "load_time_ms": 0.295, "load_throughput": 1218487.282, "learn_time_ms": 9.539, "learn_throughput": 37740.81, "synch_weights_time_ms": 0.688}, "counters": {"num_env_steps_sampled": 295800, "num_env_steps_trained": 295800, "num_agent_steps_sampled": 295800, "num_agent_steps_trained": 295800}, "done": false, "episodes_total": 1355, "training_iteration": 323, "trial_id": "04904_00000", "date": "2023-07-26_22-28-52", "timestamp": 1690399732, "time_this_iter_s": 10.070924997329712, "time_total_s": 3520.3434500694275, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1551.3915839195251, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 20.257142857142856, "ram_util_percent": 63.25714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3326416015625, "policy_loss": -13890723145318.4, "vf_loss": 216005723.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2328.0, "diff_num_grad_updates_vs_sampler_policy": 2327.0}}, "num_env_steps_sampled": 297240, "num_env_steps_trained": 297240, "num_agent_steps_sampled": 297240, "num_agent_steps_trained": 297240}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11341.221104897675, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655035031356494, "mean_inference_ms": 0.37248323857622495, "mean_action_processing_ms": 0.09054139672743339, "mean_env_wait_ms": 1.1484479956694746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036568641662597656, "StateBufferConnector_ms": 0.0027098655700683594, "ViewRequirementAgentConnector_ms": 0.06638312339782715}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11619.376190431802, "episode_reward_mean": -11341.221104897675, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11390.905127830729, -11325.281876745728, -11389.135693684595, -11448.307567461798, -11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655035031356494, "mean_inference_ms": 0.37248323857622495, "mean_action_processing_ms": 0.09054139672743339, "mean_env_wait_ms": 1.1484479956694746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036568641662597656, "StateBufferConnector_ms": 0.0027098655700683594, "ViewRequirementAgentConnector_ms": 0.06638312339782715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297240, "num_agent_steps_trained": 297240, "num_env_steps_sampled": 297240, "num_env_steps_trained": 297240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 102.95511109126186, "num_env_steps_trained_throughput_per_sec": 102.95511109126186, "timesteps_total": 297240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 297240, "timers": {"training_iteration_time_ms": 3420.039, "sample_time_ms": 3409.339, "load_time_ms": 0.298, "load_throughput": 1206608.151, "learn_time_ms": 9.648, "learn_throughput": 37313.567, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 297240, "num_env_steps_trained": 297240, "num_agent_steps_sampled": 297240, "num_agent_steps_trained": 297240}, "done": false, "episodes_total": 1359, "training_iteration": 324, "trial_id": "04904_00000", "date": "2023-07-26_22-29-06", "timestamp": 1690399746, "time_this_iter_s": 13.989681959152222, "time_total_s": 3534.3331320285797, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1565.3812658786774, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 32.17, "ram_util_percent": 63.165}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4576904296875, "policy_loss": -22021961295152.85, "vf_loss": 216285481.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2348.0, "diff_num_grad_updates_vs_sampler_policy": 2347.0}}, "num_env_steps_sampled": 298680, "num_env_steps_trained": 298680, "num_agent_steps_sampled": 298680, "num_agent_steps_trained": 298680}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11657.252611612452, "episode_reward_mean": -11342.254380981405, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655288745966564, "mean_inference_ms": 0.37251322146033206, "mean_action_processing_ms": 0.09054621300289678, "mean_env_wait_ms": 1.1483553991557764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668546676635742, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.06649303436279297}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11657.252611612452, "episode_reward_mean": -11342.254380981405, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11378.182071591591, -11292.517633483461, -11501.943021136689, -11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655288745966564, "mean_inference_ms": 0.37251322146033206, "mean_action_processing_ms": 0.09054621300289678, "mean_env_wait_ms": 1.1483553991557764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668546676635742, "StateBufferConnector_ms": 0.002689838409423828, "ViewRequirementAgentConnector_ms": 0.06649303436279297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298680, "num_agent_steps_trained": 298680, "num_env_steps_sampled": 298680, "num_env_steps_trained": 298680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.22641962813378, "num_env_steps_trained_throughput_per_sec": 107.22641962813378, "timesteps_total": 298680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 298680, "timers": {"training_iteration_time_ms": 3412.739, "sample_time_ms": 3400.576, "load_time_ms": 0.339, "load_throughput": 1061177.483, "learn_time_ms": 10.929, "learn_throughput": 32941.213, "synch_weights_time_ms": 0.838}, "counters": {"num_env_steps_sampled": 298680, "num_env_steps_trained": 298680, "num_agent_steps_sampled": 298680, "num_agent_steps_trained": 298680}, "done": false, "episodes_total": 1363, "training_iteration": 325, "trial_id": "04904_00000", "date": "2023-07-26_22-29-19", "timestamp": 1690399759, "time_this_iter_s": 13.436272144317627, "time_total_s": 3547.7694041728973, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1578.817538022995, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 39.257894736842104, "ram_util_percent": 62.48421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.368017578125, "policy_loss": -16328780310118.4, "vf_loss": 216615971.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 2362.0}}, "num_env_steps_sampled": 299760, "num_env_steps_trained": 299760, "num_agent_steps_sampled": 299760, "num_agent_steps_trained": 299760}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11657.252611612452, "episode_reward_mean": -11338.393947025888, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655569021421652, "mean_inference_ms": 0.372549749884335, "mean_action_processing_ms": 0.09055271234448391, "mean_env_wait_ms": 1.1482924843848192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00368499755859375, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06671595573425293}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11657.252611612452, "episode_reward_mean": -11338.393947025888, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11421.435332813942, -11446.554266313413, -11175.721652697488, -11406.626360436983, -11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655569021421652, "mean_inference_ms": 0.372549749884335, "mean_action_processing_ms": 0.09055271234448391, "mean_env_wait_ms": 1.1482924843848192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00368499755859375, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06671595573425293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299760, "num_agent_steps_trained": 299760, "num_env_steps_sampled": 299760, "num_env_steps_trained": 299760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 101.19725996898434, "num_env_steps_trained_throughput_per_sec": 101.19725996898434, "timesteps_total": 299760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 299760, "timers": {"training_iteration_time_ms": 3467.517, "sample_time_ms": 3455.253, "load_time_ms": 0.348, "load_throughput": 1035701.653, "learn_time_ms": 10.991, "learn_throughput": 32753.642, "synch_weights_time_ms": 0.865}, "counters": {"num_env_steps_sampled": 299760, "num_env_steps_trained": 299760, "num_agent_steps_sampled": 299760, "num_agent_steps_trained": 299760}, "done": false, "episodes_total": 1366, "training_iteration": 326, "trial_id": "04904_00000", "date": "2023-07-26_22-29-30", "timestamp": 1690399770, "time_this_iter_s": 10.675412893295288, "time_total_s": 3558.4448170661926, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1589.4929509162903, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 49.79333333333334, "ram_util_percent": 62.51333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3997802734375, "policy_loss": -17535800652595.2, "vf_loss": 213345388.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2383.0, "diff_num_grad_updates_vs_sampler_policy": 2382.0}}, "num_env_steps_sampled": 301200, "num_env_steps_trained": 301200, "num_agent_steps_sampled": 301200, "num_agent_steps_trained": 301200}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11657.252611612452, "episode_reward_mean": -11334.139330124925, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655755013087969, "mean_inference_ms": 0.37264431889779315, "mean_action_processing_ms": 0.0905703095839472, "mean_env_wait_ms": 1.148247126746052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037183761596679688, "StateBufferConnector_ms": 0.0027320384979248047, "ViewRequirementAgentConnector_ms": 0.06719207763671875}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11657.252611612452, "episode_reward_mean": -11334.139330124925, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11324.725624027897, -11250.450781870952, -11394.557221214644, -11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655755013087969, "mean_inference_ms": 0.37264431889779315, "mean_action_processing_ms": 0.0905703095839472, "mean_env_wait_ms": 1.148247126746052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037183761596679688, "StateBufferConnector_ms": 0.0027320384979248047, "ViewRequirementAgentConnector_ms": 0.06719207763671875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301200, "num_agent_steps_trained": 301200, "num_env_steps_sampled": 301200, "num_env_steps_trained": 301200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.2147407774712, "num_env_steps_trained_throughput_per_sec": 111.2147407774712, "timesteps_total": 301200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 301200, "timers": {"training_iteration_time_ms": 3379.226, "sample_time_ms": 3366.663, "load_time_ms": 0.348, "load_throughput": 1034424.498, "learn_time_ms": 11.225, "learn_throughput": 32071.176, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 301200, "num_env_steps_trained": 301200, "num_agent_steps_sampled": 301200, "num_agent_steps_trained": 301200}, "done": false, "episodes_total": 1370, "training_iteration": 327, "trial_id": "04904_00000", "date": "2023-07-26_22-29-43", "timestamp": 1690399783, "time_this_iter_s": 12.951173067092896, "time_total_s": 3571.3959901332855, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1602.4441239833832, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 36.17368421052632, "ram_util_percent": 62.978947368421046}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.38740234375, "policy_loss": -13012920958976.0, "vf_loss": 212579430.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2398.0, "diff_num_grad_updates_vs_sampler_policy": 2397.0}}, "num_env_steps_sampled": 302280, "num_env_steps_trained": 302280, "num_agent_steps_sampled": 302280, "num_agent_steps_trained": 302280}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11657.252611612452, "episode_reward_mean": -11337.500605843969, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655872464392453, "mean_inference_ms": 0.3727256136209794, "mean_action_processing_ms": 0.09058533328465236, "mean_env_wait_ms": 1.1482156398732983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446022033691406, "StateBufferConnector_ms": 0.0027468204498291016, "ViewRequirementAgentConnector_ms": 0.06757187843322754}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11657.252611612452, "episode_reward_mean": -11337.500605843969, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11569.848599336563, -11351.445894151588, -11217.149300444995, -11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655872464392453, "mean_inference_ms": 0.3727256136209794, "mean_action_processing_ms": 0.09058533328465236, "mean_env_wait_ms": 1.1482156398732983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037446022033691406, "StateBufferConnector_ms": 0.0027468204498291016, "ViewRequirementAgentConnector_ms": 0.06757187843322754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302280, "num_agent_steps_trained": 302280, "num_env_steps_sampled": 302280, "num_env_steps_trained": 302280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.15162765655101, "num_env_steps_trained_throughput_per_sec": 106.15162765655101, "timesteps_total": 302280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 302280, "timers": {"training_iteration_time_ms": 3379.412, "sample_time_ms": 3367.561, "load_time_ms": 0.322, "load_throughput": 1119642.177, "learn_time_ms": 10.611, "learn_throughput": 33927.788, "synch_weights_time_ms": 0.868}, "counters": {"num_env_steps_sampled": 302280, "num_env_steps_trained": 302280, "num_agent_steps_sampled": 302280, "num_agent_steps_trained": 302280}, "done": false, "episodes_total": 1373, "training_iteration": 328, "trial_id": "04904_00000", "date": "2023-07-26_22-29-53", "timestamp": 1690399793, "time_this_iter_s": 10.178472995758057, "time_total_s": 3581.5744631290436, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1612.6225969791412, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 40.771428571428565, "ram_util_percent": 63.628571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4787109375, "policy_loss": -12078102714777.6, "vf_loss": 214252300.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2413.0, "diff_num_grad_updates_vs_sampler_policy": 2412.0}}, "num_env_steps_sampled": 303360, "num_env_steps_trained": 303360, "num_agent_steps_sampled": 303360, "num_agent_steps_trained": 303360}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11339.906016248868, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655975248723438, "mean_inference_ms": 0.3728180510545374, "mean_action_processing_ms": 0.0906025498642726, "mean_env_wait_ms": 1.1482037996885668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037834644317626953, "StateBufferConnector_ms": 0.0027637481689453125, "ViewRequirementAgentConnector_ms": 0.0680701732635498}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11339.906016248868, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11478.475811560736, -11557.111748961015, -11292.880912816296, -11392.816685027548, -11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655975248723438, "mean_inference_ms": 0.3728180510545374, "mean_action_processing_ms": 0.0906025498642726, "mean_env_wait_ms": 1.1482037996885668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037834644317626953, "StateBufferConnector_ms": 0.0027637481689453125, "ViewRequirementAgentConnector_ms": 0.0680701732635498}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303360, "num_agent_steps_trained": 303360, "num_env_steps_sampled": 303360, "num_env_steps_trained": 303360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.1726838632016, "num_env_steps_trained_throughput_per_sec": 106.1726838632016, "timesteps_total": 303360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 303360, "timers": {"training_iteration_time_ms": 3329.4, "sample_time_ms": 3317.528, "load_time_ms": 0.316, "load_throughput": 1140272.95, "learn_time_ms": 10.617, "learn_throughput": 33909.121, "synch_weights_time_ms": 0.889}, "counters": {"num_env_steps_sampled": 303360, "num_env_steps_trained": 303360, "num_agent_steps_sampled": 303360, "num_agent_steps_trained": 303360}, "done": false, "episodes_total": 1376, "training_iteration": 329, "trial_id": "04904_00000", "date": "2023-07-26_22-30-03", "timestamp": 1690399803, "time_this_iter_s": 10.175110816955566, "time_total_s": 3591.749573945999, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1622.7977077960968, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 41.00714285714286, "ram_util_percent": 63.67857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.6030517578124, "policy_loss": -14045411488563.2, "vf_loss": 206512430.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2433.0, "diff_num_grad_updates_vs_sampler_policy": 2432.0}}, "num_env_steps_sampled": 304800, "num_env_steps_trained": 304800, "num_agent_steps_sampled": 304800, "num_agent_steps_trained": 304800}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11331.255600617993, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655914187266885, "mean_inference_ms": 0.37295325900946813, "mean_action_processing_ms": 0.09062755639851787, "mean_env_wait_ms": 1.1481916741711171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795146942138672, "StateBufferConnector_ms": 0.002779722213745117, "ViewRequirementAgentConnector_ms": 0.0682382583618164}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11331.255600617993, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11391.942504808538, -11434.903254291099, -11130.03006153726, -11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655914187266885, "mean_inference_ms": 0.37295325900946813, "mean_action_processing_ms": 0.09062755639851787, "mean_env_wait_ms": 1.1481916741711171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795146942138672, "StateBufferConnector_ms": 0.002779722213745117, "ViewRequirementAgentConnector_ms": 0.0682382583618164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304800, "num_agent_steps_trained": 304800, "num_env_steps_sampled": 304800, "num_env_steps_trained": 304800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.00016536587414, "num_env_steps_trained_throughput_per_sec": 115.00016536587414, "timesteps_total": 304800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 304800, "timers": {"training_iteration_time_ms": 3286.779, "sample_time_ms": 3275.021, "load_time_ms": 0.316, "load_throughput": 1140962.249, "learn_time_ms": 10.506, "learn_throughput": 34265.79, "synch_weights_time_ms": 0.886}, "counters": {"num_env_steps_sampled": 304800, "num_env_steps_trained": 304800, "num_agent_steps_sampled": 304800, "num_agent_steps_trained": 304800}, "done": false, "episodes_total": 1380, "training_iteration": 330, "trial_id": "04904_00000", "date": "2023-07-26_22-30-16", "timestamp": 1690399816, "time_this_iter_s": 12.524785041809082, "time_total_s": 3604.2743589878082, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1635.3224928379059, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 31.688888888888886, "ram_util_percent": 61.955555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.2473388671874, "policy_loss": -22547948319539.2, "vf_loss": 219859212.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2448.0, "diff_num_grad_updates_vs_sampler_policy": 2447.0}}, "num_env_steps_sampled": 305880, "num_env_steps_trained": 305880, "num_agent_steps_sampled": 305880, "num_agent_steps_trained": 305880}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11332.469700448282, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655842066941248, "mean_inference_ms": 0.3730612138239425, "mean_action_processing_ms": 0.09064757645165393, "mean_env_wait_ms": 1.1481800449818274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038063526153564453, "StateBufferConnector_ms": 0.0027725696563720703, "ViewRequirementAgentConnector_ms": 0.06826210021972656}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11332.469700448282, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11509.685583159224, -11336.119012772673, -11167.293621852275, -11327.896067682812, -11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655842066941248, "mean_inference_ms": 0.3730612138239425, "mean_action_processing_ms": 0.09064757645165393, "mean_env_wait_ms": 1.1481800449818274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038063526153564453, "StateBufferConnector_ms": 0.0027725696563720703, "ViewRequirementAgentConnector_ms": 0.06826210021972656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 305880, "num_agent_steps_trained": 305880, "num_env_steps_sampled": 305880, "num_env_steps_trained": 305880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.45260529106754, "num_env_steps_trained_throughput_per_sec": 107.45260529106754, "timesteps_total": 305880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 305880, "timers": {"training_iteration_time_ms": 3274.461, "sample_time_ms": 3263.128, "load_time_ms": 0.309, "load_throughput": 1166164.226, "learn_time_ms": 10.077, "learn_throughput": 35724.835, "synch_weights_time_ms": 0.898}, "counters": {"num_env_steps_sampled": 305880, "num_env_steps_trained": 305880, "num_agent_steps_sampled": 305880, "num_agent_steps_trained": 305880}, "done": false, "episodes_total": 1383, "training_iteration": 331, "trial_id": "04904_00000", "date": "2023-07-26_22-30-26", "timestamp": 1690399826, "time_this_iter_s": 10.053691148757935, "time_total_s": 3614.328050136566, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1645.3761839866638, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 40.633333333333326, "ram_util_percent": 63.026666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3552734375, "policy_loss": -16846959594700.8, "vf_loss": 212768544.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2468.0, "diff_num_grad_updates_vs_sampler_policy": 2467.0}}, "num_env_steps_sampled": 307320, "num_env_steps_trained": 307320, "num_agent_steps_sampled": 307320, "num_agent_steps_trained": 307320}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11327.668940894187, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655602825806158, "mean_inference_ms": 0.37325262237918766, "mean_action_processing_ms": 0.09068413039054636, "mean_env_wait_ms": 1.1482267460366815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038712024688720703, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.06923174858093262}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11327.668940894187, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11548.227668166051, -11182.400349434538, -11563.999104947117, -11360.154201157939, -11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.655602825806158, "mean_inference_ms": 0.37325262237918766, "mean_action_processing_ms": 0.09068413039054636, "mean_env_wait_ms": 1.1482267460366815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038712024688720703, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.06923174858093262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307320, "num_agent_steps_trained": 307320, "num_env_steps_sampled": 307320, "num_env_steps_trained": 307320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.03952146477303, "num_env_steps_trained_throughput_per_sec": 108.03952146477303, "timesteps_total": 307320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 307320, "timers": {"training_iteration_time_ms": 3277.866, "sample_time_ms": 3266.096, "load_time_ms": 0.311, "load_throughput": 1159359.214, "learn_time_ms": 10.47, "learn_throughput": 34383.299, "synch_weights_time_ms": 0.94}, "counters": {"num_env_steps_sampled": 307320, "num_env_steps_trained": 307320, "num_agent_steps_sampled": 307320, "num_agent_steps_trained": 307320}, "done": false, "episodes_total": 1387, "training_iteration": 332, "trial_id": "04904_00000", "date": "2023-07-26_22-30-39", "timestamp": 1690399839, "time_this_iter_s": 13.331489086151123, "time_total_s": 3627.6595392227173, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1658.707673072815, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 39.011111111111106, "ram_util_percent": 63.45000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.44208984375, "policy_loss": -18160762748928.0, "vf_loss": 219181168.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2488.0, "diff_num_grad_updates_vs_sampler_policy": 2487.0}}, "num_env_steps_sampled": 308760, "num_env_steps_trained": 308760, "num_agent_steps_sampled": 308760, "num_agent_steps_trained": 308760}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11324.290034356613, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65512914136219, "mean_inference_ms": 0.3734519405404802, "mean_action_processing_ms": 0.0907220548955105, "mean_env_wait_ms": 1.1482471470514937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003893613815307617, "StateBufferConnector_ms": 0.0028235912322998047, "ViewRequirementAgentConnector_ms": 0.06940484046936035}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11324.290034356613, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11441.751802529332, -11499.993403572382, -11564.065478803606, -11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65512914136219, "mean_inference_ms": 0.3734519405404802, "mean_action_processing_ms": 0.0907220548955105, "mean_env_wait_ms": 1.1482471470514937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003893613815307617, "StateBufferConnector_ms": 0.0028235912322998047, "ViewRequirementAgentConnector_ms": 0.06940484046936035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308760, "num_agent_steps_trained": 308760, "num_env_steps_sampled": 308760, "num_env_steps_trained": 308760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.89408729438784, "num_env_steps_trained_throughput_per_sec": 115.89408729438784, "timesteps_total": 308760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 308760, "timers": {"training_iteration_time_ms": 3221.666, "sample_time_ms": 3210.229, "load_time_ms": 0.305, "load_throughput": 1179003.233, "learn_time_ms": 10.202, "learn_throughput": 35287.52, "synch_weights_time_ms": 0.88}, "counters": {"num_env_steps_sampled": 308760, "num_env_steps_trained": 308760, "num_agent_steps_sampled": 308760, "num_agent_steps_trained": 308760}, "done": false, "episodes_total": 1391, "training_iteration": 333, "trial_id": "04904_00000", "date": "2023-07-26_22-30-52", "timestamp": 1690399852, "time_this_iter_s": 12.428005933761597, "time_total_s": 3640.087545156479, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1671.1356790065765, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 33.416666666666664, "ram_util_percent": 64.52222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4873291015624, "policy_loss": -20913330386792.9, "vf_loss": 222165555.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2503.0, "diff_num_grad_updates_vs_sampler_policy": 2502.0}}, "num_env_steps_sampled": 309840, "num_env_steps_trained": 309840, "num_agent_steps_sampled": 309840, "num_agent_steps_trained": 309840}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11320.745423166212, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654803601931677, "mean_inference_ms": 0.3736237445342635, "mean_action_processing_ms": 0.0907550177233026, "mean_env_wait_ms": 1.1482700383719928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003987312316894531, "StateBufferConnector_ms": 0.0028810501098632812, "ViewRequirementAgentConnector_ms": 0.07100987434387207}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11320.745423166212, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11257.446182466325, -11331.974157740891, -11317.836439513483, -11539.692172918223, -11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654803601931677, "mean_inference_ms": 0.3736237445342635, "mean_action_processing_ms": 0.0907550177233026, "mean_env_wait_ms": 1.1482700383719928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003987312316894531, "StateBufferConnector_ms": 0.0028810501098632812, "ViewRequirementAgentConnector_ms": 0.07100987434387207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 309840, "num_agent_steps_trained": 309840, "num_env_steps_sampled": 309840, "num_env_steps_trained": 309840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.17364037517792, "num_env_steps_trained_throughput_per_sec": 102.17364037517792, "timesteps_total": 309840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 309840, "timers": {"training_iteration_time_ms": 3312.225, "sample_time_ms": 3300.69, "load_time_ms": 0.312, "load_throughput": 1155278.837, "learn_time_ms": 10.33, "learn_throughput": 34850.965, "synch_weights_time_ms": 0.842}, "counters": {"num_env_steps_sampled": 309840, "num_env_steps_trained": 309840, "num_agent_steps_sampled": 309840, "num_agent_steps_trained": 309840}, "done": false, "episodes_total": 1394, "training_iteration": 334, "trial_id": "04904_00000", "date": "2023-07-26_22-31-02", "timestamp": 1690399862, "time_this_iter_s": 10.573094129562378, "time_total_s": 3650.6606392860413, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1681.708773136139, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 44.553333333333335, "ram_util_percent": 62.77333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.21796875, "policy_loss": -19201146644070.4, "vf_loss": 216306881.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2523.0, "diff_num_grad_updates_vs_sampler_policy": 2522.0}}, "num_env_steps_sampled": 311280, "num_env_steps_trained": 311280, "num_agent_steps_sampled": 311280, "num_agent_steps_trained": 311280}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11316.801238437003, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654217776202991, "mean_inference_ms": 0.3738599956221668, "mean_action_processing_ms": 0.0908002263582268, "mean_env_wait_ms": 1.1482922154260464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040225982666015625, "StateBufferConnector_ms": 0.002893209457397461, "ViewRequirementAgentConnector_ms": 0.07132101058959961}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11316.801238437003, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11339.640251974659, -11224.148027701021, -11221.549628342213, -11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.654217776202991, "mean_inference_ms": 0.3738599956221668, "mean_action_processing_ms": 0.0908002263582268, "mean_env_wait_ms": 1.1482922154260464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040225982666015625, "StateBufferConnector_ms": 0.002893209457397461, "ViewRequirementAgentConnector_ms": 0.07132101058959961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311280, "num_agent_steps_trained": 311280, "num_env_steps_sampled": 311280, "num_env_steps_trained": 311280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.54861492935291, "num_env_steps_trained_throughput_per_sec": 113.54861492935291, "timesteps_total": 311280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 311280, "timers": {"training_iteration_time_ms": 3256.821, "sample_time_ms": 3245.735, "load_time_ms": 0.309, "load_throughput": 1164994.553, "learn_time_ms": 9.935, "learn_throughput": 36236.149, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 311280, "num_env_steps_trained": 311280, "num_agent_steps_sampled": 311280, "num_agent_steps_trained": 311280}, "done": false, "episodes_total": 1398, "training_iteration": 335, "trial_id": "04904_00000", "date": "2023-07-26_22-31-15", "timestamp": 1690399875, "time_this_iter_s": 12.684736013412476, "time_total_s": 3663.3453752994537, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1694.3935091495514, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 35.49444444444444, "ram_util_percent": 61.727777777777774}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.50625, "policy_loss": -18799386637107.2, "vf_loss": 221792494.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2538.0, "diff_num_grad_updates_vs_sampler_policy": 2537.0}}, "num_env_steps_sampled": 312360, "num_env_steps_trained": 312360, "num_agent_steps_sampled": 312360, "num_agent_steps_trained": 312360}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11321.354790713527, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653702883183727, "mean_inference_ms": 0.37406839763980865, "mean_action_processing_ms": 0.09084079093671554, "mean_env_wait_ms": 1.1483429652684267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004071950912475586, "StateBufferConnector_ms": 0.002922534942626953, "ViewRequirementAgentConnector_ms": 0.07210779190063477}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11321.354790713527, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11320.871218156824, -11097.918558883399, -11467.320699450978, -11492.715941357495, -11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.653702883183727, "mean_inference_ms": 0.37406839763980865, "mean_action_processing_ms": 0.09084079093671554, "mean_env_wait_ms": 1.1483429652684267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004071950912475586, "StateBufferConnector_ms": 0.002922534942626953, "ViewRequirementAgentConnector_ms": 0.07210779190063477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312360, "num_agent_steps_trained": 312360, "num_env_steps_sampled": 312360, "num_env_steps_trained": 312360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.47771002553618, "num_env_steps_trained_throughput_per_sec": 107.47771002553618, "timesteps_total": 312360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 312360, "timers": {"training_iteration_time_ms": 3330.048, "sample_time_ms": 3318.426, "load_time_ms": 0.312, "load_throughput": 1153073.265, "learn_time_ms": 10.479, "learn_throughput": 34355.917, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 312360, "num_env_steps_trained": 312360, "num_agent_steps_sampled": 312360, "num_agent_steps_trained": 312360}, "done": false, "episodes_total": 1401, "training_iteration": 336, "trial_id": "04904_00000", "date": "2023-07-26_22-31-25", "timestamp": 1690399885, "time_this_iter_s": 10.051456928253174, "time_total_s": 3673.396832227707, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1704.4449660778046, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 39.62142857142857, "ram_util_percent": 64.06428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.36328125, "policy_loss": -17803783962624.0, "vf_loss": 213818150.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2558.0, "diff_num_grad_updates_vs_sampler_policy": 2557.0}}, "num_env_steps_sampled": 313800, "num_env_steps_trained": 313800, "num_agent_steps_sampled": 313800, "num_agent_steps_trained": 313800}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11321.283954371675, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652968027952493, "mean_inference_ms": 0.3743774159300277, "mean_action_processing_ms": 0.09090079487630522, "mean_env_wait_ms": 1.1484610900464882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224538803100586, "StateBufferConnector_ms": 0.0031099319458007812, "ViewRequirementAgentConnector_ms": 0.07409405708312988}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11321.283954371675, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11145.740007667353, -11491.22157347934, -11114.590393080216, -11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652968027952493, "mean_inference_ms": 0.3743774159300277, "mean_action_processing_ms": 0.09090079487630522, "mean_env_wait_ms": 1.1484610900464882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004224538803100586, "StateBufferConnector_ms": 0.0031099319458007812, "ViewRequirementAgentConnector_ms": 0.07409405708312988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313800, "num_agent_steps_trained": 313800, "num_env_steps_sampled": 313800, "num_env_steps_trained": 313800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 106.46204775007402, "num_env_steps_trained_throughput_per_sec": 106.46204775007402, "timesteps_total": 313800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 313800, "timers": {"training_iteration_time_ms": 3317.696, "sample_time_ms": 3305.955, "load_time_ms": 0.309, "load_throughput": 1166434.484, "learn_time_ms": 10.562, "learn_throughput": 34085.638, "synch_weights_time_ms": 0.822}, "counters": {"num_env_steps_sampled": 313800, "num_env_steps_trained": 313800, "num_agent_steps_sampled": 313800, "num_agent_steps_trained": 313800}, "done": false, "episodes_total": 1405, "training_iteration": 337, "trial_id": "04904_00000", "date": "2023-07-26_22-31-39", "timestamp": 1690399899, "time_this_iter_s": 13.530728101730347, "time_total_s": 3686.9275603294373, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1717.975694179535, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 38.97, "ram_util_percent": 62.960000000000015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3876220703125, "policy_loss": -19031392598542.7, "vf_loss": 204978259.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2573.0, "diff_num_grad_updates_vs_sampler_policy": 2572.0}}, "num_env_steps_sampled": 314880, "num_env_steps_trained": 314880, "num_agent_steps_sampled": 314880, "num_agent_steps_trained": 314880}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11319.24364233591, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652402134538482, "mean_inference_ms": 0.3746433210681249, "mean_action_processing_ms": 0.09095290441021651, "mean_env_wait_ms": 1.1485823445100876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004288196563720703, "StateBufferConnector_ms": 0.0031528472900390625, "ViewRequirementAgentConnector_ms": 0.07525825500488281}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11319.24364233591, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11061.283399739343, -11430.530662910951, -11354.996181316426, -11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.652402134538482, "mean_inference_ms": 0.3746433210681249, "mean_action_processing_ms": 0.09095290441021651, "mean_env_wait_ms": 1.1485823445100876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004288196563720703, "StateBufferConnector_ms": 0.0031528472900390625, "ViewRequirementAgentConnector_ms": 0.07525825500488281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314880, "num_agent_steps_trained": 314880, "num_env_steps_sampled": 314880, "num_env_steps_trained": 314880, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.2857757043955, "num_env_steps_trained_throughput_per_sec": 102.2857757043955, "timesteps_total": 314880, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 314880, "timers": {"training_iteration_time_ms": 3413.304, "sample_time_ms": 3401.06, "load_time_ms": 0.326, "load_throughput": 1104248.53, "learn_time_ms": 11.002, "learn_throughput": 32721.134, "synch_weights_time_ms": 0.859}, "counters": {"num_env_steps_sampled": 314880, "num_env_steps_trained": 314880, "num_agent_steps_sampled": 314880, "num_agent_steps_trained": 314880}, "done": false, "episodes_total": 1408, "training_iteration": 338, "trial_id": "04904_00000", "date": "2023-07-26_22-31-49", "timestamp": 1690399909, "time_this_iter_s": 10.561697006225586, "time_total_s": 3697.489257335663, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1728.5373911857605, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 42.426666666666655, "ram_util_percent": 64.66000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.2920654296875, "policy_loss": -12031790707341.95, "vf_loss": 209270489.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2588.0, "diff_num_grad_updates_vs_sampler_policy": 2587.0}}, "num_env_steps_sampled": 315960, "num_env_steps_trained": 315960, "num_agent_steps_sampled": 315960, "num_agent_steps_trained": 315960}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11317.107987532872, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651822140923212, "mean_inference_ms": 0.37491760703846394, "mean_action_processing_ms": 0.09100655987198238, "mean_env_wait_ms": 1.1487017060738478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00434565544128418, "StateBufferConnector_ms": 0.0031914710998535156, "ViewRequirementAgentConnector_ms": 0.07612752914428711}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11317.107987532872, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11199.90508312261, -11287.100825286614, -11173.552088100652, -11089.05178534018, -11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.651822140923212, "mean_inference_ms": 0.37491760703846394, "mean_action_processing_ms": 0.09100655987198238, "mean_env_wait_ms": 1.1487017060738478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00434565544128418, "StateBufferConnector_ms": 0.0031914710998535156, "ViewRequirementAgentConnector_ms": 0.07612752914428711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315960, "num_agent_steps_trained": 315960, "num_env_steps_sampled": 315960, "num_env_steps_trained": 315960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.38738834419507, "num_env_steps_trained_throughput_per_sec": 107.38738834419507, "timesteps_total": 315960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 315960, "timers": {"training_iteration_time_ms": 3414.148, "sample_time_ms": 3402.383, "load_time_ms": 0.325, "load_throughput": 1107001.056, "learn_time_ms": 10.521, "learn_throughput": 34218.421, "synch_weights_time_ms": 0.863}, "counters": {"num_env_steps_sampled": 315960, "num_env_steps_trained": 315960, "num_agent_steps_sampled": 315960, "num_agent_steps_trained": 315960}, "done": false, "episodes_total": 1411, "training_iteration": 339, "trial_id": "04904_00000", "date": "2023-07-26_22-31-59", "timestamp": 1690399919, "time_this_iter_s": 10.060077905654907, "time_total_s": 3707.5493352413177, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1738.5974690914154, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 38.99285714285714, "ram_util_percent": 64.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.365478515625, "policy_loss": -14088135927398.4, "vf_loss": 212451632.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2608.0, "diff_num_grad_updates_vs_sampler_policy": 2607.0}}, "num_env_steps_sampled": 317400, "num_env_steps_trained": 317400, "num_agent_steps_sampled": 317400, "num_agent_steps_trained": 317400}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11323.008676156176, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65085918266582, "mean_inference_ms": 0.37529073362787935, "mean_action_processing_ms": 0.09107929036412933, "mean_env_wait_ms": 1.1488530529466936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00437474250793457, "StateBufferConnector_ms": 0.0032067298889160156, "ViewRequirementAgentConnector_ms": 0.07657456398010254}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11323.008676156176, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11334.257376491409, -11349.192562643379, -11205.848221137214, -11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.65085918266582, "mean_inference_ms": 0.37529073362787935, "mean_action_processing_ms": 0.09107929036412933, "mean_env_wait_ms": 1.1488530529466936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00437474250793457, "StateBufferConnector_ms": 0.0032067298889160156, "ViewRequirementAgentConnector_ms": 0.07657456398010254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317400, "num_agent_steps_trained": 317400, "num_env_steps_sampled": 317400, "num_env_steps_trained": 317400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.71686748647022, "num_env_steps_trained_throughput_per_sec": 114.71686748647022, "timesteps_total": 317400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 317400, "timers": {"training_iteration_time_ms": 3316.818, "sample_time_ms": 3304.595, "load_time_ms": 0.357, "load_throughput": 1007170.117, "learn_time_ms": 10.965, "learn_throughput": 32832.625, "synch_weights_time_ms": 0.842}, "counters": {"num_env_steps_sampled": 317400, "num_env_steps_trained": 317400, "num_agent_steps_sampled": 317400, "num_agent_steps_trained": 317400}, "done": false, "episodes_total": 1415, "training_iteration": 340, "trial_id": "04904_00000", "date": "2023-07-26_22-32-12", "timestamp": 1690399932, "time_this_iter_s": 12.5554940700531, "time_total_s": 3720.104829311371, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1751.1529631614685, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 33.616666666666674, "ram_util_percent": 61.80555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.40546875, "policy_loss": -23745293346406.4, "vf_loss": 222273089.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2623.0, "diff_num_grad_updates_vs_sampler_policy": 2622.0}}, "num_env_steps_sampled": 318480, "num_env_steps_trained": 318480, "num_agent_steps_sampled": 318480, "num_agent_steps_trained": 318480}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11325.520447646919, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650132856963869, "mean_inference_ms": 0.37557559990123357, "mean_action_processing_ms": 0.09113464827451874, "mean_env_wait_ms": 1.14895241373591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043866634368896484, "StateBufferConnector_ms": 0.003210783004760742, "ViewRequirementAgentConnector_ms": 0.0766294002532959}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11325.520447646919, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11445.796364514754, -11250.041943698594, -11297.473026484258, -11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.650132856963869, "mean_inference_ms": 0.37557559990123357, "mean_action_processing_ms": 0.09113464827451874, "mean_env_wait_ms": 1.14895241373591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043866634368896484, "StateBufferConnector_ms": 0.003210783004760742, "ViewRequirementAgentConnector_ms": 0.0766294002532959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 318480, "num_agent_steps_trained": 318480, "num_env_steps_sampled": 318480, "num_env_steps_trained": 318480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.80024730633144, "num_env_steps_trained_throughput_per_sec": 107.80024730633144, "timesteps_total": 318480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 318480, "timers": {"training_iteration_time_ms": 3262.806, "sample_time_ms": 3251.17, "load_time_ms": 0.341, "load_throughput": 1055465.846, "learn_time_ms": 10.462, "learn_throughput": 34411.194, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 318480, "num_env_steps_trained": 318480, "num_agent_steps_sampled": 318480, "num_agent_steps_trained": 318480}, "done": false, "episodes_total": 1418, "training_iteration": 341, "trial_id": "04904_00000", "date": "2023-07-26_22-32-22", "timestamp": 1690399942, "time_this_iter_s": 10.022233963012695, "time_total_s": 3730.1270632743835, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1761.1751971244812, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 37.57857142857142, "ram_util_percent": 58.20714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.333447265625, "policy_loss": -20755687328972.8, "vf_loss": 216114433.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2638.0, "diff_num_grad_updates_vs_sampler_policy": 2637.0}}, "num_env_steps_sampled": 319560, "num_env_steps_trained": 319560, "num_agent_steps_sampled": 319560, "num_agent_steps_trained": 319560}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11322.591095854452, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6494195415973785, "mean_inference_ms": 0.37586430399829746, "mean_action_processing_ms": 0.09119049918836186, "mean_env_wait_ms": 1.149038841719209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408597946166992, "StateBufferConnector_ms": 0.0032274723052978516, "ViewRequirementAgentConnector_ms": 0.07691764831542969}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11322.591095854452, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11331.708582076843, -11242.188676290007, -11214.357301442373, -11442.598875560869, -11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6494195415973785, "mean_inference_ms": 0.37586430399829746, "mean_action_processing_ms": 0.09119049918836186, "mean_env_wait_ms": 1.149038841719209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004408597946166992, "StateBufferConnector_ms": 0.0032274723052978516, "ViewRequirementAgentConnector_ms": 0.07691764831542969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319560, "num_agent_steps_trained": 319560, "num_env_steps_sampled": 319560, "num_env_steps_trained": 319560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.65234165528847, "num_env_steps_trained_throughput_per_sec": 106.65234165528847, "timesteps_total": 319560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 319560, "timers": {"training_iteration_time_ms": 3269.738, "sample_time_ms": 3258.102, "load_time_ms": 0.343, "load_throughput": 1049450.542, "learn_time_ms": 10.46, "learn_throughput": 34416.842, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 319560, "num_env_steps_trained": 319560, "num_agent_steps_sampled": 319560, "num_agent_steps_trained": 319560}, "done": false, "episodes_total": 1421, "training_iteration": 342, "trial_id": "04904_00000", "date": "2023-07-26_22-32-32", "timestamp": 1690399952, "time_this_iter_s": 10.12947702407837, "time_total_s": 3740.256540298462, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1771.3046741485596, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 40.378571428571426, "ram_util_percent": 57.18571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.313818359375, "policy_loss": -21982787456204.8, "vf_loss": 219890414.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2658.0, "diff_num_grad_updates_vs_sampler_policy": 2657.0}}, "num_env_steps_sampled": 321000, "num_env_steps_trained": 321000, "num_agent_steps_sampled": 321000, "num_agent_steps_trained": 321000}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11325.96425297115, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648267437328606, "mean_inference_ms": 0.3762548934418654, "mean_action_processing_ms": 0.09126584478371297, "mean_env_wait_ms": 1.1491544818172506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004449129104614258, "StateBufferConnector_ms": 0.003243684768676758, "ViewRequirementAgentConnector_ms": 0.07733654975891113}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11325.96425297115, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11562.617830935904, -11412.844934961002, -11270.131857205632, -11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.648267437328606, "mean_inference_ms": 0.3762548934418654, "mean_action_processing_ms": 0.09126584478371297, "mean_env_wait_ms": 1.1491544818172506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004449129104614258, "StateBufferConnector_ms": 0.003243684768676758, "ViewRequirementAgentConnector_ms": 0.07733654975891113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 321000, "num_agent_steps_trained": 321000, "num_env_steps_sampled": 321000, "num_env_steps_trained": 321000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.24053843021905, "num_env_steps_trained_throughput_per_sec": 115.24053843021905, "timesteps_total": 321000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 321000, "timers": {"training_iteration_time_ms": 3264.033, "sample_time_ms": 3253.017, "load_time_ms": 0.324, "load_throughput": 1111237.445, "learn_time_ms": 9.866, "learn_throughput": 36490.366, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 321000, "num_env_steps_trained": 321000, "num_agent_steps_sampled": 321000, "num_agent_steps_trained": 321000}, "done": false, "episodes_total": 1425, "training_iteration": 343, "trial_id": "04904_00000", "date": "2023-07-26_22-32-45", "timestamp": 1690399965, "time_this_iter_s": 12.498463153839111, "time_total_s": 3752.755003452301, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1783.8031373023987, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 33.922222222222224, "ram_util_percent": 56.98888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4582275390626, "policy_loss": -16931346186240.0, "vf_loss": 220013700.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2673.0, "diff_num_grad_updates_vs_sampler_policy": 2672.0}}, "num_env_steps_sampled": 322080, "num_env_steps_trained": 322080, "num_agent_steps_sampled": 322080, "num_agent_steps_trained": 322080}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11324.6884552797, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.647294061367696, "mean_inference_ms": 0.37657680012846456, "mean_action_processing_ms": 0.09132865009591672, "mean_env_wait_ms": 1.1493065965583162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004479646682739258, "StateBufferConnector_ms": 0.0032677650451660156, "ViewRequirementAgentConnector_ms": 0.07770276069641113}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11324.6884552797, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11155.029668750316, -11477.79825419109, -11517.871775794649, -11619.376190431802, -11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.647294061367696, "mean_inference_ms": 0.37657680012846456, "mean_action_processing_ms": 0.09132865009591672, "mean_env_wait_ms": 1.1493065965583162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004479646682739258, "StateBufferConnector_ms": 0.0032677650451660156, "ViewRequirementAgentConnector_ms": 0.07770276069641113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322080, "num_agent_steps_trained": 322080, "num_env_steps_sampled": 322080, "num_env_steps_trained": 322080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.09131916359777, "num_env_steps_trained_throughput_per_sec": 107.09131916359777, "timesteps_total": 322080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 322080, "timers": {"training_iteration_time_ms": 3270.661, "sample_time_ms": 3258.977, "load_time_ms": 0.337, "load_throughput": 1067630.234, "learn_time_ms": 10.451, "learn_throughput": 34447.149, "synch_weights_time_ms": 0.846}, "counters": {"num_env_steps_sampled": 322080, "num_env_steps_trained": 322080, "num_agent_steps_sampled": 322080, "num_agent_steps_trained": 322080}, "done": false, "episodes_total": 1428, "training_iteration": 344, "trial_id": "04904_00000", "date": "2023-07-26_22-32-55", "timestamp": 1690399975, "time_this_iter_s": 10.087849855422974, "time_total_s": 3762.842853307724, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1793.8909871578217, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 38.40714285714286, "ram_util_percent": 58.02857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.472021484375, "policy_loss": -16719334919372.8, "vf_loss": 212614550.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2693.0, "diff_num_grad_updates_vs_sampler_policy": 2692.0}}, "num_env_steps_sampled": 323520, "num_env_steps_trained": 323520, "num_agent_steps_sampled": 323520, "num_agent_steps_trained": 323520}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11317.68545952606, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.645992609685067, "mean_inference_ms": 0.37700837020888583, "mean_action_processing_ms": 0.09141286362866363, "mean_env_wait_ms": 1.1494800320102139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004496097564697266, "StateBufferConnector_ms": 0.0032775402069091797, "ViewRequirementAgentConnector_ms": 0.07797980308532715}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11317.68545952606, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11401.536237846645, -11217.127373646552, -11508.851400202722, -11400.465106793687, -11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.645992609685067, "mean_inference_ms": 0.37700837020888583, "mean_action_processing_ms": 0.09141286362866363, "mean_env_wait_ms": 1.1494800320102139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004496097564697266, "StateBufferConnector_ms": 0.0032775402069091797, "ViewRequirementAgentConnector_ms": 0.07797980308532715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323520, "num_agent_steps_trained": 323520, "num_env_steps_sampled": 323520, "num_env_steps_trained": 323520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.96881558081078, "num_env_steps_trained_throughput_per_sec": 108.96881558081078, "timesteps_total": 323520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 323520, "timers": {"training_iteration_time_ms": 3264.05, "sample_time_ms": 3251.372, "load_time_ms": 0.359, "load_throughput": 1003622.094, "learn_time_ms": 11.344, "learn_throughput": 31734.027, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 323520, "num_env_steps_trained": 323520, "num_agent_steps_sampled": 323520, "num_agent_steps_trained": 323520}, "done": false, "episodes_total": 1432, "training_iteration": 345, "trial_id": "04904_00000", "date": "2023-07-26_22-33-08", "timestamp": 1690399988, "time_this_iter_s": 13.21972393989563, "time_total_s": 3776.0625772476196, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1807.1107110977173, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 39.16315789473684, "ram_util_percent": 62.13684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.520703125, "policy_loss": -22016286733107.2, "vf_loss": 220606300.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2713.0, "diff_num_grad_updates_vs_sampler_policy": 2712.0}}, "num_env_steps_sampled": 324960, "num_env_steps_trained": 324960, "num_agent_steps_sampled": 324960, "num_agent_steps_trained": 324960}, "sampler_results": {"episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11314.195481965742, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644499827736772, "mean_inference_ms": 0.3774574622425442, "mean_action_processing_ms": 0.09150040268996626, "mean_env_wait_ms": 1.1496589046501087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004615068435668945, "StateBufferConnector_ms": 0.003309965133666992, "ViewRequirementAgentConnector_ms": 0.07825994491577148}}, "episode_reward_max": -11045.846099032608, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11314.195481965742, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11230.840003756284, -11170.324107256303, -11176.040524649321, -11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.644499827736772, "mean_inference_ms": 0.3774574622425442, "mean_action_processing_ms": 0.09150040268996626, "mean_env_wait_ms": 1.1496589046501087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004615068435668945, "StateBufferConnector_ms": 0.003309965133666992, "ViewRequirementAgentConnector_ms": 0.07825994491577148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324960, "num_agent_steps_trained": 324960, "num_env_steps_sampled": 324960, "num_env_steps_trained": 324960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.40724203091231, "num_env_steps_trained_throughput_per_sec": 113.40724203091231, "timesteps_total": 324960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 324960, "timers": {"training_iteration_time_ms": 3284.148, "sample_time_ms": 3272.161, "load_time_ms": 0.327, "load_throughput": 1102313.798, "learn_time_ms": 10.706, "learn_throughput": 33625.194, "synch_weights_time_ms": 0.901}, "counters": {"num_env_steps_sampled": 324960, "num_env_steps_trained": 324960, "num_agent_steps_sampled": 324960, "num_agent_steps_trained": 324960}, "done": false, "episodes_total": 1436, "training_iteration": 346, "trial_id": "04904_00000", "date": "2023-07-26_22-33-21", "timestamp": 1690400001, "time_this_iter_s": 12.700576305389404, "time_total_s": 3788.763153553009, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1819.8112874031067, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 33.90555555555555, "ram_util_percent": 61.24444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4641357421874, "policy_loss": -9025725084467.2, "vf_loss": 213455481.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2728.0, "diff_num_grad_updates_vs_sampler_policy": 2727.0}}, "num_env_steps_sampled": 326040, "num_env_steps_trained": 326040, "num_agent_steps_sampled": 326040, "num_agent_steps_trained": 326040}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11312.974811475076, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643471977352526, "mean_inference_ms": 0.3778208172554558, "mean_action_processing_ms": 0.09157131670572817, "mean_env_wait_ms": 1.149827622564386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046460628509521484, "StateBufferConnector_ms": 0.0033245086669921875, "ViewRequirementAgentConnector_ms": 0.07860946655273438}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11312.974811475076, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11509.236984256953, -11151.862264796247, -11463.109603908075, -11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.643471977352526, "mean_inference_ms": 0.3778208172554558, "mean_action_processing_ms": 0.09157131670572817, "mean_env_wait_ms": 1.149827622564386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046460628509521484, "StateBufferConnector_ms": 0.0033245086669921875, "ViewRequirementAgentConnector_ms": 0.07860946655273438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326040, "num_agent_steps_trained": 326040, "num_env_steps_sampled": 326040, "num_env_steps_trained": 326040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 97.02486777081093, "num_env_steps_trained_throughput_per_sec": 97.02486777081093, "timesteps_total": 326040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 326040, "timers": {"training_iteration_time_ms": 3357.32, "sample_time_ms": 3344.447, "load_time_ms": 0.347, "load_throughput": 1037908.606, "learn_time_ms": 11.511, "learn_throughput": 31274.455, "synch_weights_time_ms": 0.962}, "counters": {"num_env_steps_sampled": 326040, "num_env_steps_trained": 326040, "num_agent_steps_sampled": 326040, "num_agent_steps_trained": 326040}, "done": false, "episodes_total": 1439, "training_iteration": 347, "trial_id": "04904_00000", "date": "2023-07-26_22-33-32", "timestamp": 1690400012, "time_this_iter_s": 11.133932113647461, "time_total_s": 3799.8970856666565, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1830.9452195167542, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 39.73125, "ram_util_percent": 61.106249999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.244921875, "policy_loss": -23649092265574.4, "vf_loss": 224541020.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2743.0, "diff_num_grad_updates_vs_sampler_policy": 2742.0}}, "num_env_steps_sampled": 327120, "num_env_steps_trained": 327120, "num_agent_steps_sampled": 327120, "num_agent_steps_trained": 327120}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11312.973742287806, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.642459791232752, "mean_inference_ms": 0.3781819865083863, "mean_action_processing_ms": 0.0916417850204791, "mean_env_wait_ms": 1.1500059550953265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004649639129638672, "StateBufferConnector_ms": 0.0033228397369384766, "ViewRequirementAgentConnector_ms": 0.07860851287841797}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11312.973742287806, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11458.408283779756, -11045.846099032608, -11610.9853857406, -11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.642459791232752, "mean_inference_ms": 0.3781819865083863, "mean_action_processing_ms": 0.0916417850204791, "mean_env_wait_ms": 1.1500059550953265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004649639129638672, "StateBufferConnector_ms": 0.0033228397369384766, "ViewRequirementAgentConnector_ms": 0.07860851287841797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327120, "num_agent_steps_trained": 327120, "num_env_steps_sampled": 327120, "num_env_steps_trained": 327120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.40871141148553, "num_env_steps_trained_throughput_per_sec": 106.40871141148553, "timesteps_total": 327120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 327120, "timers": {"training_iteration_time_ms": 3397.815, "sample_time_ms": 3386.131, "load_time_ms": 0.32, "load_throughput": 1124394.549, "learn_time_ms": 10.439, "learn_throughput": 34485.542, "synch_weights_time_ms": 0.876}, "counters": {"num_env_steps_sampled": 327120, "num_env_steps_trained": 327120, "num_agent_steps_sampled": 327120, "num_agent_steps_trained": 327120}, "done": false, "episodes_total": 1442, "training_iteration": 348, "trial_id": "04904_00000", "date": "2023-07-26_22-33-42", "timestamp": 1690400022, "time_this_iter_s": 10.152271747589111, "time_total_s": 3810.0493574142456, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1841.0974912643433, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 19.057142857142853, "ram_util_percent": 60.907142857142844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4142333984375, "policy_loss": -13037121359052.8, "vf_loss": 207507129.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2758.0, "diff_num_grad_updates_vs_sampler_policy": 2757.0}}, "num_env_steps_sampled": 328200, "num_env_steps_trained": 328200, "num_agent_steps_sampled": 328200, "num_agent_steps_trained": 328200}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11310.050147483813, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.641447913178423, "mean_inference_ms": 0.3785429119917791, "mean_action_processing_ms": 0.09171216770976173, "mean_env_wait_ms": 1.1501853371707775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004656553268432617, "StateBufferConnector_ms": 0.0033249855041503906, "ViewRequirementAgentConnector_ms": 0.07863783836364746}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11310.050147483813, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11099.169260190147, -11189.851437149768, -11475.866459547553, -11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.641447913178423, "mean_inference_ms": 0.3785429119917791, "mean_action_processing_ms": 0.09171216770976173, "mean_env_wait_ms": 1.1501853371707775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004656553268432617, "StateBufferConnector_ms": 0.0033249855041503906, "ViewRequirementAgentConnector_ms": 0.07863783836364746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328200, "num_agent_steps_trained": 328200, "num_env_steps_sampled": 328200, "num_env_steps_trained": 328200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.66960098734191, "num_env_steps_trained_throughput_per_sec": 107.66960098734191, "timesteps_total": 328200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 328200, "timers": {"training_iteration_time_ms": 3439.762, "sample_time_ms": 3428.189, "load_time_ms": 0.318, "load_throughput": 1132065.857, "learn_time_ms": 10.382, "learn_throughput": 34676.884, "synch_weights_time_ms": 0.826}, "counters": {"num_env_steps_sampled": 328200, "num_env_steps_trained": 328200, "num_agent_steps_sampled": 328200, "num_agent_steps_trained": 328200}, "done": false, "episodes_total": 1445, "training_iteration": 349, "trial_id": "04904_00000", "date": "2023-07-26_22-33-52", "timestamp": 1690400032, "time_this_iter_s": 10.033396005630493, "time_total_s": 3820.082753419876, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1851.1308872699738, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 20.585714285714285, "ram_util_percent": 60.48571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.477099609375, "policy_loss": -21449308687564.8, "vf_loss": 214873808.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2773.0, "diff_num_grad_updates_vs_sampler_policy": 2772.0}}, "num_env_steps_sampled": 329280, "num_env_steps_trained": 329280, "num_agent_steps_sampled": 329280, "num_agent_steps_trained": 329280}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11315.304194656517, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640426884685661, "mean_inference_ms": 0.3789025557746533, "mean_action_processing_ms": 0.09178231667143522, "mean_env_wait_ms": 1.1503853250387488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004702568054199219, "StateBufferConnector_ms": 0.0033521652221679688, "ViewRequirementAgentConnector_ms": 0.07937169075012207}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11315.304194656517, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11331.10722286655, -11334.200969524192, -11352.5561958198, -11582.55360644466, -11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.640426884685661, "mean_inference_ms": 0.3789025557746533, "mean_action_processing_ms": 0.09178231667143522, "mean_env_wait_ms": 1.1503853250387488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004702568054199219, "StateBufferConnector_ms": 0.0033521652221679688, "ViewRequirementAgentConnector_ms": 0.07937169075012207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 329280, "num_agent_steps_trained": 329280, "num_env_steps_sampled": 329280, "num_env_steps_trained": 329280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.86933356812345, "num_env_steps_trained_throughput_per_sec": 106.86933356812345, "timesteps_total": 329280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 329280, "timers": {"training_iteration_time_ms": 3363.561, "sample_time_ms": 3352.997, "load_time_ms": 0.296, "load_throughput": 1216621.9, "learn_time_ms": 9.539, "learn_throughput": 37740.527, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 329280, "num_env_steps_trained": 329280, "num_agent_steps_sampled": 329280, "num_agent_steps_trained": 329280}, "done": false, "episodes_total": 1448, "training_iteration": 350, "trial_id": "04904_00000", "date": "2023-07-26_22-34-02", "timestamp": 1690400042, "time_this_iter_s": 10.108589172363281, "time_total_s": 3830.1913425922394, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1861.239476442337, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 21.713333333333335, "ram_util_percent": 60.36666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4395263671875, "policy_loss": -18614773717401.6, "vf_loss": 218731460.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2793.0, "diff_num_grad_updates_vs_sampler_policy": 2792.0}}, "num_env_steps_sampled": 330720, "num_env_steps_trained": 330720, "num_agent_steps_sampled": 330720, "num_agent_steps_trained": 330720}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11311.56400381135, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639057191313034, "mean_inference_ms": 0.37937628004117274, "mean_action_processing_ms": 0.09187467556011374, "mean_env_wait_ms": 1.1506337231131234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004694938659667969, "StateBufferConnector_ms": 0.003347158432006836, "ViewRequirementAgentConnector_ms": 0.07932162284851074}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11311.56400381135, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11155.305026153255, -11263.90454775532, -11383.70470065748, -11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.639057191313034, "mean_inference_ms": 0.37937628004117274, "mean_action_processing_ms": 0.09187467556011374, "mean_env_wait_ms": 1.1506337231131234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004694938659667969, "StateBufferConnector_ms": 0.003347158432006836, "ViewRequirementAgentConnector_ms": 0.07932162284851074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 330720, "num_agent_steps_trained": 330720, "num_env_steps_sampled": 330720, "num_env_steps_trained": 330720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.2508642929074, "num_env_steps_trained_throughput_per_sec": 108.2508642929074, "timesteps_total": 330720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 330720, "timers": {"training_iteration_time_ms": 3343.879, "sample_time_ms": 3333.3, "load_time_ms": 0.296, "load_throughput": 1217014.137, "learn_time_ms": 9.547, "learn_throughput": 37709.612, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 330720, "num_env_steps_trained": 330720, "num_agent_steps_sampled": 330720, "num_agent_steps_trained": 330720}, "done": false, "episodes_total": 1452, "training_iteration": 351, "trial_id": "04904_00000", "date": "2023-07-26_22-34-16", "timestamp": 1690400056, "time_this_iter_s": 13.305500268936157, "time_total_s": 3843.4968428611755, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1874.5449767112732, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 18.366666666666667, "ram_util_percent": 60.33888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.5403564453125, "policy_loss": -13465778721265.4, "vf_loss": 224055974.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2808.0, "diff_num_grad_updates_vs_sampler_policy": 2807.0}}, "num_env_steps_sampled": 331800, "num_env_steps_trained": 331800, "num_agent_steps_sampled": 331800, "num_agent_steps_trained": 331800}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11315.04717156072, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.638026897697505, "mean_inference_ms": 0.37972927243988525, "mean_action_processing_ms": 0.09194343238524116, "mean_env_wait_ms": 1.1508163566087655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046939849853515625, "StateBufferConnector_ms": 0.0033500194549560547, "ViewRequirementAgentConnector_ms": 0.0793449878692627}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11315.04717156072, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11377.65064602504, -11168.782342341403, -11166.378934015993, -11343.691746127639, -11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.638026897697505, "mean_inference_ms": 0.37972927243988525, "mean_action_processing_ms": 0.09194343238524116, "mean_env_wait_ms": 1.1508163566087655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046939849853515625, "StateBufferConnector_ms": 0.0033500194549560547, "ViewRequirementAgentConnector_ms": 0.0793449878692627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 331800, "num_agent_steps_trained": 331800, "num_env_steps_sampled": 331800, "num_env_steps_trained": 331800, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.8707368110928, "num_env_steps_trained_throughput_per_sec": 107.8707368110928, "timesteps_total": 331800, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 331800, "timers": {"training_iteration_time_ms": 3342.008, "sample_time_ms": 3331.407, "load_time_ms": 0.3, "load_throughput": 1200850.517, "learn_time_ms": 9.563, "learn_throughput": 37644.179, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 331800, "num_env_steps_trained": 331800, "num_agent_steps_sampled": 331800, "num_agent_steps_trained": 331800}, "done": false, "episodes_total": 1455, "training_iteration": 352, "trial_id": "04904_00000", "date": "2023-07-26_22-34-26", "timestamp": 1690400066, "time_this_iter_s": 10.014667987823486, "time_total_s": 3853.511510848999, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1884.5596446990967, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 17.14, "ram_util_percent": 60.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3672607421875, "policy_loss": -26562576724787.2, "vf_loss": 224724459.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2828.0, "diff_num_grad_updates_vs_sampler_policy": 2827.0}}, "num_env_steps_sampled": 333240, "num_env_steps_trained": 333240, "num_agent_steps_sampled": 333240, "num_agent_steps_trained": 333240}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11323.120251039334, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.636521942005033, "mean_inference_ms": 0.3801829051069423, "mean_action_processing_ms": 0.09203165866245538, "mean_env_wait_ms": 1.1510639570132395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046765804290771484, "StateBufferConnector_ms": 0.003339052200317383, "ViewRequirementAgentConnector_ms": 0.07907533645629883}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11323.120251039334, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11271.42337089582, -11361.274576109217, -11657.252611612452, -11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.636521942005033, "mean_inference_ms": 0.3801829051069423, "mean_action_processing_ms": 0.09203165866245538, "mean_env_wait_ms": 1.1510639570132395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046765804290771484, "StateBufferConnector_ms": 0.003339052200317383, "ViewRequirementAgentConnector_ms": 0.07907533645629883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 333240, "num_agent_steps_trained": 333240, "num_env_steps_sampled": 333240, "num_env_steps_trained": 333240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.02096199071129, "num_env_steps_trained_throughput_per_sec": 108.02096199071129, "timesteps_total": 333240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 333240, "timers": {"training_iteration_time_ms": 3330.757, "sample_time_ms": 3320.149, "load_time_ms": 0.3, "load_throughput": 1200277.774, "learn_time_ms": 9.553, "learn_throughput": 37684.108, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 333240, "num_env_steps_trained": 333240, "num_agent_steps_sampled": 333240, "num_agent_steps_trained": 333240}, "done": false, "episodes_total": 1459, "training_iteration": 353, "trial_id": "04904_00000", "date": "2023-07-26_22-34-39", "timestamp": 1690400079, "time_this_iter_s": 13.333653926849365, "time_total_s": 3866.8451647758484, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1897.893298625946, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 21.63157894736842, "ram_util_percent": 60.72631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.37138671875, "policy_loss": -15901936163225.6, "vf_loss": 212977016.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2843.0, "diff_num_grad_updates_vs_sampler_policy": 2842.0}}, "num_env_steps_sampled": 334320, "num_env_steps_trained": 334320, "num_agent_steps_sampled": 334320, "num_agent_steps_trained": 334320}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11317.168538223545, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635405275329787, "mean_inference_ms": 0.3805130060544528, "mean_action_processing_ms": 0.09209603245707582, "mean_env_wait_ms": 1.1512540989410522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004675626754760742, "StateBufferConnector_ms": 0.003336668014526367, "ViewRequirementAgentConnector_ms": 0.07905101776123047}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11317.168538223545, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11367.00731547828, -11219.58897163684, -11127.893886801492, -11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635405275329787, "mean_inference_ms": 0.3805130060544528, "mean_action_processing_ms": 0.09209603245707582, "mean_env_wait_ms": 1.1512540989410522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004675626754760742, "StateBufferConnector_ms": 0.003336668014526367, "ViewRequirementAgentConnector_ms": 0.07905101776123047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 334320, "num_agent_steps_trained": 334320, "num_env_steps_sampled": 334320, "num_env_steps_trained": 334320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.41174691351614, "num_env_steps_trained_throughput_per_sec": 107.41174691351614, "timesteps_total": 334320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 334320, "timers": {"training_iteration_time_ms": 3339.736, "sample_time_ms": 3329.091, "load_time_ms": 0.3, "load_throughput": 1198657.966, "learn_time_ms": 9.601, "learn_throughput": 37497.596, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 334320, "num_env_steps_trained": 334320, "num_agent_steps_sampled": 334320, "num_agent_steps_trained": 334320}, "done": false, "episodes_total": 1462, "training_iteration": 354, "trial_id": "04904_00000", "date": "2023-07-26_22-34-49", "timestamp": 1690400089, "time_this_iter_s": 10.05743408203125, "time_total_s": 3876.9025988578796, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1907.9507327079773, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 18.89285714285714, "ram_util_percent": 61.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4266845703125, "policy_loss": -18016236575129.6, "vf_loss": 217782769.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2858.0, "diff_num_grad_updates_vs_sampler_policy": 2857.0}}, "num_env_steps_sampled": 335400, "num_env_steps_trained": 335400, "num_agent_steps_sampled": 335400, "num_agent_steps_trained": 335400}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11320.073253475368, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634261264187196, "mean_inference_ms": 0.3808421737305325, "mean_action_processing_ms": 0.09216008072595425, "mean_env_wait_ms": 1.151455717306052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047359466552734375, "StateBufferConnector_ms": 0.0033605098724365234, "ViewRequirementAgentConnector_ms": 0.0797886848449707}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11320.073253475368, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11439.116472221938, -11266.969822959922, -11170.788495622846, -11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634261264187196, "mean_inference_ms": 0.3808421737305325, "mean_action_processing_ms": 0.09216008072595425, "mean_env_wait_ms": 1.151455717306052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047359466552734375, "StateBufferConnector_ms": 0.0033605098724365234, "ViewRequirementAgentConnector_ms": 0.0797886848449707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 335400, "num_agent_steps_trained": 335400, "num_env_steps_sampled": 335400, "num_env_steps_trained": 335400, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.65493165833558, "num_env_steps_trained_throughput_per_sec": 103.65493165833558, "timesteps_total": 335400, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 335400, "timers": {"training_iteration_time_ms": 3380.456, "sample_time_ms": 3369.785, "load_time_ms": 0.301, "load_throughput": 1197042.524, "learn_time_ms": 9.619, "learn_throughput": 37424.824, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 335400, "num_env_steps_trained": 335400, "num_agent_steps_sampled": 335400, "num_agent_steps_trained": 335400}, "done": false, "episodes_total": 1465, "training_iteration": 355, "trial_id": "04904_00000", "date": "2023-07-26_22-35-00", "timestamp": 1690400100, "time_this_iter_s": 10.421936750411987, "time_total_s": 3887.3245356082916, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1918.3726694583893, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 29.640000000000004, "ram_util_percent": 60.94000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3989013671876, "policy_loss": -14165548780748.8, "vf_loss": 209086294.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2873.0, "diff_num_grad_updates_vs_sampler_policy": 2872.0}}, "num_env_steps_sampled": 336480, "num_env_steps_trained": 336480, "num_agent_steps_sampled": 336480, "num_agent_steps_trained": 336480}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11325.632484708058, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6332055971279456, "mean_inference_ms": 0.38114153427221753, "mean_action_processing_ms": 0.09221833180648491, "mean_env_wait_ms": 1.1516490587675774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00472259521484375, "StateBufferConnector_ms": 0.0033457279205322266, "ViewRequirementAgentConnector_ms": 0.07957959175109863}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11325.632484708058, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11289.584550580661, -11297.533053001922, -11485.294425143056, -11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6332055971279456, "mean_inference_ms": 0.38114153427221753, "mean_action_processing_ms": 0.09221833180648491, "mean_env_wait_ms": 1.1516490587675774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00472259521484375, "StateBufferConnector_ms": 0.0033457279205322266, "ViewRequirementAgentConnector_ms": 0.07957959175109863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336480, "num_agent_steps_trained": 336480, "num_env_steps_sampled": 336480, "num_env_steps_trained": 336480, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.8758041776158, "num_env_steps_trained_throughput_per_sec": 105.8758041776158, "timesteps_total": 336480, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 336480, "timers": {"training_iteration_time_ms": 3402.018, "sample_time_ms": 3391.339, "load_time_ms": 0.302, "load_throughput": 1193730.287, "learn_time_ms": 9.615, "learn_throughput": 37439.672, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 336480, "num_env_steps_trained": 336480, "num_agent_steps_sampled": 336480, "num_agent_steps_trained": 336480}, "done": false, "episodes_total": 1468, "training_iteration": 356, "trial_id": "04904_00000", "date": "2023-07-26_22-35-10", "timestamp": 1690400110, "time_this_iter_s": 10.20337986946106, "time_total_s": 3897.5279154777527, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1928.5760493278503, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 18.05, "ram_util_percent": 59.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4999755859376, "policy_loss": -23147551758745.6, "vf_loss": 223096310.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2888.0, "diff_num_grad_updates_vs_sampler_policy": 2887.0}}, "num_env_steps_sampled": 337560, "num_env_steps_trained": 337560, "num_agent_steps_sampled": 337560, "num_agent_steps_trained": 337560}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11329.165344656414, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632212200887467, "mean_inference_ms": 0.3814240997028873, "mean_action_processing_ms": 0.09227339396496287, "mean_env_wait_ms": 1.1518501707778162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004693031311035156, "StateBufferConnector_ms": 0.003323078155517578, "ViewRequirementAgentConnector_ms": 0.07901668548583984}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11329.165344656414, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11583.775263289619, -11236.791510585248, -11401.411868101079, -11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632212200887467, "mean_inference_ms": 0.3814240997028873, "mean_action_processing_ms": 0.09227339396496287, "mean_env_wait_ms": 1.1518501707778162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004693031311035156, "StateBufferConnector_ms": 0.003323078155517578, "ViewRequirementAgentConnector_ms": 0.07901668548583984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337560, "num_agent_steps_trained": 337560, "num_env_steps_sampled": 337560, "num_env_steps_trained": 337560, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.5023193004417, "num_env_steps_trained_throughput_per_sec": 105.5023193004417, "timesteps_total": 337560, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 337560, "timers": {"training_iteration_time_ms": 3422.546, "sample_time_ms": 3411.922, "load_time_ms": 0.301, "load_throughput": 1195336.795, "learn_time_ms": 9.576, "learn_throughput": 37594.13, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 337560, "num_env_steps_trained": 337560, "num_agent_steps_sampled": 337560, "num_agent_steps_trained": 337560}, "done": false, "episodes_total": 1471, "training_iteration": 357, "trial_id": "04904_00000", "date": "2023-07-26_22-35-20", "timestamp": 1690400120, "time_this_iter_s": 10.239522933959961, "time_total_s": 3907.7674384117126, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1938.8155722618103, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 17.499999999999996, "ram_util_percent": 59.873333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.301513671875, "policy_loss": -23498051289088.0, "vf_loss": 216686043.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2903.0, "diff_num_grad_updates_vs_sampler_policy": 2902.0}}, "num_env_steps_sampled": 338640, "num_env_steps_trained": 338640, "num_agent_steps_sampled": 338640, "num_agent_steps_trained": 338640}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11330.09850275179, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631219994134904, "mean_inference_ms": 0.38169433299917543, "mean_action_processing_ms": 0.09232622337986635, "mean_env_wait_ms": 1.1520464036988203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004663705825805664, "StateBufferConnector_ms": 0.0033011436462402344, "ViewRequirementAgentConnector_ms": 0.0785520076751709}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11703.4254918346, "episode_reward_mean": -11330.09850275179, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11703.4254918346, -11274.147474487527, -11271.114564709915, -11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631219994134904, "mean_inference_ms": 0.38169433299917543, "mean_action_processing_ms": 0.09232622337986635, "mean_env_wait_ms": 1.1520464036988203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004663705825805664, "StateBufferConnector_ms": 0.0033011436462402344, "ViewRequirementAgentConnector_ms": 0.0785520076751709}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 338640, "num_agent_steps_trained": 338640, "num_env_steps_sampled": 338640, "num_env_steps_trained": 338640, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.5844984594239, "num_env_steps_trained_throughput_per_sec": 107.5844984594239, "timesteps_total": 338640, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 338640, "timers": {"training_iteration_time_ms": 3380.072, "sample_time_ms": 3369.475, "load_time_ms": 0.298, "load_throughput": 1208056.196, "learn_time_ms": 9.551, "learn_throughput": 37692.574, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 338640, "num_env_steps_trained": 338640, "num_agent_steps_sampled": 338640, "num_agent_steps_trained": 338640}, "done": false, "episodes_total": 1474, "training_iteration": 358, "trial_id": "04904_00000", "date": "2023-07-26_22-35-30", "timestamp": 1690400130, "time_this_iter_s": 10.041484117507935, "time_total_s": 3917.8089225292206, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1948.8570563793182, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 21.542857142857148, "ram_util_percent": 59.53571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.453515625, "policy_loss": -16672471039500.3, "vf_loss": 218660720.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2918.0, "diff_num_grad_updates_vs_sampler_policy": 2917.0}}, "num_env_steps_sampled": 339720, "num_env_steps_trained": 339720, "num_agent_steps_sampled": 339720, "num_agent_steps_trained": 339720}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11631.487554634232, "episode_reward_mean": -11328.530161943145, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630292168103195, "mean_inference_ms": 0.3819516753172298, "mean_action_processing_ms": 0.0923767090261445, "mean_env_wait_ms": 1.152232889784276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004630088806152344, "StateBufferConnector_ms": 0.003299236297607422, "ViewRequirementAgentConnector_ms": 0.07830381393432617}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11631.487554634232, "episode_reward_mean": -11328.530161943145, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11146.86748523126, -11340.34900270302, -11097.912542633925, -11342.471116789102, -11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630292168103195, "mean_inference_ms": 0.3819516753172298, "mean_action_processing_ms": 0.0923767090261445, "mean_env_wait_ms": 1.152232889784276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004630088806152344, "StateBufferConnector_ms": 0.003299236297607422, "ViewRequirementAgentConnector_ms": 0.07830381393432617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 339720, "num_agent_steps_trained": 339720, "num_env_steps_sampled": 339720, "num_env_steps_trained": 339720, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.56191060094929, "num_env_steps_trained_throughput_per_sec": 107.56191060094929, "timesteps_total": 339720, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 339720, "timers": {"training_iteration_time_ms": 3359.791, "sample_time_ms": 3349.254, "load_time_ms": 0.298, "load_throughput": 1208539.651, "learn_time_ms": 9.491, "learn_throughput": 37928.898, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 339720, "num_env_steps_trained": 339720, "num_agent_steps_sampled": 339720, "num_agent_steps_trained": 339720}, "done": false, "episodes_total": 1477, "training_iteration": 359, "trial_id": "04904_00000", "date": "2023-07-26_22-35-40", "timestamp": 1690400140, "time_this_iter_s": 10.043543100357056, "time_total_s": 3927.8524656295776, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1958.9005994796753, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 19.20714285714286, "ram_util_percent": 59.56428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.2667236328125, "policy_loss": -15456550990643.2, "vf_loss": 213214022.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2938.0, "diff_num_grad_updates_vs_sampler_policy": 2937.0}}, "num_env_steps_sampled": 341160, "num_env_steps_trained": 341160, "num_agent_steps_sampled": 341160, "num_agent_steps_trained": 341160}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11631.487554634232, "episode_reward_mean": -11326.373766730496, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629206469409159, "mean_inference_ms": 0.38228035230712976, "mean_action_processing_ms": 0.09244151379322028, "mean_env_wait_ms": 1.1524720519183822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004615306854248047, "StateBufferConnector_ms": 0.0032956600189208984, "ViewRequirementAgentConnector_ms": 0.07821083068847656}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11631.487554634232, "episode_reward_mean": -11326.373766730496, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11371.77218328426, -11364.042503592515, -11376.353152348229, -11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629206469409159, "mean_inference_ms": 0.38228035230712976, "mean_action_processing_ms": 0.09244151379322028, "mean_env_wait_ms": 1.1524720519183822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004615306854248047, "StateBufferConnector_ms": 0.0032956600189208984, "ViewRequirementAgentConnector_ms": 0.07821083068847656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 341160, "num_agent_steps_trained": 341160, "num_env_steps_sampled": 341160, "num_env_steps_trained": 341160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.08143657780094, "num_env_steps_trained_throughput_per_sec": 108.08143657780094, "timesteps_total": 341160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 341160, "timers": {"training_iteration_time_ms": 3340.25, "sample_time_ms": 3329.69, "load_time_ms": 0.296, "load_throughput": 1217210.351, "learn_time_ms": 9.529, "learn_throughput": 37779.81, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 341160, "num_env_steps_trained": 341160, "num_agent_steps_sampled": 341160, "num_agent_steps_trained": 341160}, "done": false, "episodes_total": 1481, "training_iteration": 360, "trial_id": "04904_00000", "date": "2023-07-26_22-35-54", "timestamp": 1690400154, "time_this_iter_s": 13.326047420501709, "time_total_s": 3941.1785130500793, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1972.226646900177, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 19.452631578947365, "ram_util_percent": 59.521052631578954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4280517578125, "policy_loss": -20581297474764.8, "vf_loss": 226391753.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2953.0, "diff_num_grad_updates_vs_sampler_policy": 2952.0}}, "num_env_steps_sampled": 342240, "num_env_steps_trained": 342240, "num_agent_steps_sampled": 342240, "num_agent_steps_trained": 342240}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11329.417425781403, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628450586602634, "mean_inference_ms": 0.38250792716039916, "mean_action_processing_ms": 0.09248638237796838, "mean_env_wait_ms": 1.1526303659498884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004600048065185547, "StateBufferConnector_ms": 0.0032951831817626953, "ViewRequirementAgentConnector_ms": 0.07811570167541504}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11329.417425781403, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11118.8769434448, -11124.069320955588, -11241.618913308614, -11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628450586602634, "mean_inference_ms": 0.38250792716039916, "mean_action_processing_ms": 0.09248638237796838, "mean_env_wait_ms": 1.1526303659498884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004600048065185547, "StateBufferConnector_ms": 0.0032951831817626953, "ViewRequirementAgentConnector_ms": 0.07811570167541504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342240, "num_agent_steps_trained": 342240, "num_env_steps_sampled": 342240, "num_env_steps_trained": 342240, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.99725532221106, "num_env_steps_trained_throughput_per_sec": 106.99725532221106, "timesteps_total": 342240, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 342240, "timers": {"training_iteration_time_ms": 3345.76, "sample_time_ms": 3335.185, "load_time_ms": 0.296, "load_throughput": 1215251.058, "learn_time_ms": 9.543, "learn_throughput": 37722.613, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 342240, "num_env_steps_trained": 342240, "num_agent_steps_sampled": 342240, "num_agent_steps_trained": 342240}, "done": false, "episodes_total": 1484, "training_iteration": 361, "trial_id": "04904_00000", "date": "2023-07-26_22-36-04", "timestamp": 1690400164, "time_this_iter_s": 10.096643924713135, "time_total_s": 3951.2751569747925, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1982.3232908248901, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 20.707142857142856, "ram_util_percent": 59.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4091552734376, "policy_loss": -15011187420404.8, "vf_loss": 211698904.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2968.0, "diff_num_grad_updates_vs_sampler_policy": 2967.0}}, "num_env_steps_sampled": 343320, "num_env_steps_trained": 343320, "num_agent_steps_sampled": 343320, "num_agent_steps_trained": 343320}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11336.801552645988, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627769180932225, "mean_inference_ms": 0.38270959002435945, "mean_action_processing_ms": 0.09252596928944641, "mean_env_wait_ms": 1.1527628150057652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004543304443359375, "StateBufferConnector_ms": 0.003255128860473633, "ViewRequirementAgentConnector_ms": 0.07724404335021973}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11336.801552645988, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11497.894783104974, -11191.540773668725, -11157.300862811897, -11470.154250362357, -11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627769180932225, "mean_inference_ms": 0.38270959002435945, "mean_action_processing_ms": 0.09252596928944641, "mean_env_wait_ms": 1.1527628150057652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004543304443359375, "StateBufferConnector_ms": 0.003255128860473633, "ViewRequirementAgentConnector_ms": 0.07724404335021973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 343320, "num_agent_steps_trained": 343320, "num_env_steps_sampled": 343320, "num_env_steps_trained": 343320, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.03441236139997, "num_env_steps_trained_throughput_per_sec": 107.03441236139997, "timesteps_total": 343320, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 343320, "timers": {"training_iteration_time_ms": 3350.708, "sample_time_ms": 3340.126, "load_time_ms": 0.294, "load_throughput": 1222631.126, "learn_time_ms": 9.549, "learn_throughput": 37699.82, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 343320, "num_env_steps_trained": 343320, "num_agent_steps_sampled": 343320, "num_agent_steps_trained": 343320}, "done": false, "episodes_total": 1487, "training_iteration": 362, "trial_id": "04904_00000", "date": "2023-07-26_22-36-14", "timestamp": 1690400174, "time_this_iter_s": 10.093040943145752, "time_total_s": 3961.3681979179382, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1992.416331768036, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 19.33333333333333, "ram_util_percent": 59.75333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.459130859375, "policy_loss": -18586804161409.45, "vf_loss": 207061459.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2988.0, "diff_num_grad_updates_vs_sampler_policy": 2987.0}}, "num_env_steps_sampled": 344760, "num_env_steps_trained": 344760, "num_agent_steps_sampled": 344760, "num_agent_steps_trained": 344760}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11339.58116937309, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627065571361877, "mean_inference_ms": 0.3829668507819862, "mean_action_processing_ms": 0.09257679816723094, "mean_env_wait_ms": 1.1529502977408828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004511833190917969, "StateBufferConnector_ms": 0.003244161605834961, "ViewRequirementAgentConnector_ms": 0.07686424255371094}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11339.58116937309, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11335.150868374432, -11270.983135477414, -11545.215562013647, -11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627065571361877, "mean_inference_ms": 0.3829668507819862, "mean_action_processing_ms": 0.09257679816723094, "mean_env_wait_ms": 1.1529502977408828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004511833190917969, "StateBufferConnector_ms": 0.003244161605834961, "ViewRequirementAgentConnector_ms": 0.07686424255371094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344760, "num_agent_steps_trained": 344760, "num_env_steps_sampled": 344760, "num_env_steps_trained": 344760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.32733390850377, "num_env_steps_trained_throughput_per_sec": 108.32733390850377, "timesteps_total": 344760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 344760, "timers": {"training_iteration_time_ms": 3347.684, "sample_time_ms": 3337.082, "load_time_ms": 0.298, "load_throughput": 1209992.339, "learn_time_ms": 9.562, "learn_throughput": 37647.558, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 344760, "num_env_steps_trained": 344760, "num_agent_steps_sampled": 344760, "num_agent_steps_trained": 344760}, "done": false, "episodes_total": 1491, "training_iteration": 363, "trial_id": "04904_00000", "date": "2023-07-26_22-36-27", "timestamp": 1690400187, "time_this_iter_s": 13.296010732650757, "time_total_s": 3974.664208650589, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2005.7123425006866, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 19.894444444444442, "ram_util_percent": 59.80555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3686279296876, "policy_loss": -28283937541324.8, "vf_loss": 225078790.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3003.0, "diff_num_grad_updates_vs_sampler_policy": 3002.0}}, "num_env_steps_sampled": 345840, "num_env_steps_trained": 345840, "num_agent_steps_sampled": 345840, "num_agent_steps_trained": 345840}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11341.722654674802, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.626511134829214, "mean_inference_ms": 0.3831355499723377, "mean_action_processing_ms": 0.09261008557307546, "mean_env_wait_ms": 1.153076710228244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004420042037963867, "StateBufferConnector_ms": 0.003188610076904297, "ViewRequirementAgentConnector_ms": 0.07526850700378418}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11341.722654674802, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11225.589717646353, -11100.965357562469, -11453.74714458462, -11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.626511134829214, "mean_inference_ms": 0.3831355499723377, "mean_action_processing_ms": 0.09261008557307546, "mean_env_wait_ms": 1.153076710228244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004420042037963867, "StateBufferConnector_ms": 0.003188610076904297, "ViewRequirementAgentConnector_ms": 0.07526850700378418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 345840, "num_agent_steps_trained": 345840, "num_env_steps_sampled": 345840, "num_env_steps_trained": 345840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.39055490803109, "num_env_steps_trained_throughput_per_sec": 106.39055490803109, "timesteps_total": 345840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 345840, "timers": {"training_iteration_time_ms": 3353.44, "sample_time_ms": 3342.889, "load_time_ms": 0.297, "load_throughput": 1210477.345, "learn_time_ms": 9.507, "learn_throughput": 37866.216, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 345840, "num_env_steps_trained": 345840, "num_agent_steps_sampled": 345840, "num_agent_steps_trained": 345840}, "done": false, "episodes_total": 1494, "training_iteration": 364, "trial_id": "04904_00000", "date": "2023-07-26_22-36-37", "timestamp": 1690400197, "time_this_iter_s": 10.154041051864624, "time_total_s": 3984.8182497024536, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2015.8663835525513, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 21.493333333333332, "ram_util_percent": 61.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.385498046875, "policy_loss": -16172784182886.4, "vf_loss": 210277321.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3018.0, "diff_num_grad_updates_vs_sampler_policy": 3017.0}}, "num_env_steps_sampled": 346920, "num_env_steps_trained": 346920, "num_agent_steps_sampled": 346920, "num_agent_steps_trained": 346920}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11344.770038929775, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.626106226675497, "mean_inference_ms": 0.38330783213516706, "mean_action_processing_ms": 0.09264447624527093, "mean_env_wait_ms": 1.1532386518711835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004454374313354492, "StateBufferConnector_ms": 0.0032167434692382812, "ViewRequirementAgentConnector_ms": 0.07604837417602539}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11344.770038929775, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11272.22825992488, -11285.750151863795, -11416.384732009237, -11538.558251797276, -11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.626106226675497, "mean_inference_ms": 0.38330783213516706, "mean_action_processing_ms": 0.09264447624527093, "mean_env_wait_ms": 1.1532386518711835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004454374313354492, "StateBufferConnector_ms": 0.0032167434692382812, "ViewRequirementAgentConnector_ms": 0.07604837417602539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 346920, "num_agent_steps_trained": 346920, "num_env_steps_sampled": 346920, "num_env_steps_trained": 346920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 102.4049122726744, "num_env_steps_trained_throughput_per_sec": 102.4049122726744, "timesteps_total": 346920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 346920, "timers": {"training_iteration_time_ms": 3399.055, "sample_time_ms": 3388.436, "load_time_ms": 0.301, "load_throughput": 1194958.405, "learn_time_ms": 9.552, "learn_throughput": 37688.717, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 346920, "num_env_steps_trained": 346920, "num_agent_steps_sampled": 346920, "num_agent_steps_trained": 346920}, "done": false, "episodes_total": 1497, "training_iteration": 365, "trial_id": "04904_00000", "date": "2023-07-26_22-36-48", "timestamp": 1690400208, "time_this_iter_s": 10.54907512664795, "time_total_s": 3995.3673248291016, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2026.4154586791992, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 27.126666666666672, "ram_util_percent": 64.34666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4541259765624, "policy_loss": -27173399822336.0, "vf_loss": 222736249.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3038.0, "diff_num_grad_updates_vs_sampler_policy": 3037.0}}, "num_env_steps_sampled": 348360, "num_env_steps_trained": 348360, "num_agent_steps_sampled": 348360, "num_agent_steps_trained": 348360}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11347.23620390917, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625645695658229, "mean_inference_ms": 0.38350262477350755, "mean_action_processing_ms": 0.09268297875056965, "mean_env_wait_ms": 1.1534158891667952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004401683807373047, "StateBufferConnector_ms": 0.003178834915161133, "ViewRequirementAgentConnector_ms": 0.0751645565032959}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11347.23620390917, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11431.71212985665, -11169.345444383878, -11441.961396751769, -11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625645695658229, "mean_inference_ms": 0.38350262477350755, "mean_action_processing_ms": 0.09268297875056965, "mean_env_wait_ms": 1.1534158891667952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004401683807373047, "StateBufferConnector_ms": 0.003178834915161133, "ViewRequirementAgentConnector_ms": 0.0751645565032959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348360, "num_agent_steps_trained": 348360, "num_env_steps_sampled": 348360, "num_env_steps_trained": 348360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.61538818303916, "num_env_steps_trained_throughput_per_sec": 107.61538818303916, "timesteps_total": 348360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 348360, "timers": {"training_iteration_time_ms": 3407.849, "sample_time_ms": 3397.181, "load_time_ms": 0.299, "load_throughput": 1202859.428, "learn_time_ms": 9.593, "learn_throughput": 37525.926, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 348360, "num_env_steps_trained": 348360, "num_agent_steps_sampled": 348360, "num_agent_steps_trained": 348360}, "done": false, "episodes_total": 1501, "training_iteration": 366, "trial_id": "04904_00000", "date": "2023-07-26_22-37-01", "timestamp": 1690400221, "time_this_iter_s": 13.383722066879272, "time_total_s": 4008.751046895981, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2039.7991807460785, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 20.015789473684208, "ram_util_percent": 65.23157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4134765625, "policy_loss": -23733556949811.2, "vf_loss": 214214038.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3053.0, "diff_num_grad_updates_vs_sampler_policy": 3052.0}}, "num_env_steps_sampled": 349440, "num_env_steps_trained": 349440, "num_agent_steps_sampled": 349440, "num_agent_steps_trained": 349440}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11351.282614657835, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625377241945107, "mean_inference_ms": 0.3836158138339317, "mean_action_processing_ms": 0.09270543001134358, "mean_env_wait_ms": 1.1535113309391287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004319906234741211, "StateBufferConnector_ms": 0.0031540393829345703, "ViewRequirementAgentConnector_ms": 0.07442712783813477}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11351.282614657835, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11328.723812671082, -11206.844911351785, -11263.800729816108, -11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625377241945107, "mean_inference_ms": 0.3836158138339317, "mean_action_processing_ms": 0.09270543001134358, "mean_env_wait_ms": 1.1535113309391287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004319906234741211, "StateBufferConnector_ms": 0.0031540393829345703, "ViewRequirementAgentConnector_ms": 0.07442712783813477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 349440, "num_agent_steps_trained": 349440, "num_env_steps_sampled": 349440, "num_env_steps_trained": 349440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.17343291437878, "num_env_steps_trained_throughput_per_sec": 106.17343291437878, "timesteps_total": 349440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 349440, "timers": {"training_iteration_time_ms": 3409.925, "sample_time_ms": 3399.218, "load_time_ms": 0.3, "load_throughput": 1201423.806, "learn_time_ms": 9.633, "learn_throughput": 37369.714, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 349440, "num_env_steps_trained": 349440, "num_agent_steps_sampled": 349440, "num_agent_steps_trained": 349440}, "done": false, "episodes_total": 1504, "training_iteration": 367, "trial_id": "04904_00000", "date": "2023-07-26_22-37-11", "timestamp": 1690400231, "time_this_iter_s": 10.174872875213623, "time_total_s": 4018.9259197711945, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2049.974053621292, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 19.25, "ram_util_percent": 65.70714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.2911865234375, "policy_loss": -20470514791219.2, "vf_loss": 224226995.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3068.0, "diff_num_grad_updates_vs_sampler_policy": 3067.0}}, "num_env_steps_sampled": 350520, "num_env_steps_trained": 350520, "num_agent_steps_sampled": 350520, "num_agent_steps_trained": 350520}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11355.820675946561, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6251277999773, "mean_inference_ms": 0.38370385925764344, "mean_action_processing_ms": 0.09272268656175267, "mean_env_wait_ms": 1.153585732264926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004183292388916016, "StateBufferConnector_ms": 0.0029463768005371094, "ViewRequirementAgentConnector_ms": 0.07200908660888672}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11355.820675946561, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11076.875129482574, -11293.584966120443, -11134.022240360402, -11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6251277999773, "mean_inference_ms": 0.38370385925764344, "mean_action_processing_ms": 0.09272268656175267, "mean_env_wait_ms": 1.153585732264926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004183292388916016, "StateBufferConnector_ms": 0.0029463768005371094, "ViewRequirementAgentConnector_ms": 0.07200908660888672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 350520, "num_agent_steps_trained": 350520, "num_env_steps_sampled": 350520, "num_env_steps_trained": 350520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.82998649395942, "num_env_steps_trained_throughput_per_sec": 105.82998649395942, "timesteps_total": 350520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 350520, "timers": {"training_iteration_time_ms": 3375.793, "sample_time_ms": 3365.141, "load_time_ms": 0.296, "load_throughput": 1217112.236, "learn_time_ms": 9.609, "learn_throughput": 37464.66, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 350520, "num_env_steps_trained": 350520, "num_agent_steps_sampled": 350520, "num_agent_steps_trained": 350520}, "done": false, "episodes_total": 1507, "training_iteration": 368, "trial_id": "04904_00000", "date": "2023-07-26_22-37-22", "timestamp": 1690400242, "time_this_iter_s": 10.207809686660767, "time_total_s": 4029.133729457855, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2060.181863307953, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 18.679999999999996, "ram_util_percent": 65.72666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.491845703125, "policy_loss": -22840952120934.4, "vf_loss": 220994662.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3083.0, "diff_num_grad_updates_vs_sampler_policy": 3082.0}}, "num_env_steps_sampled": 351600, "num_env_steps_trained": 351600, "num_agent_steps_sampled": 351600, "num_agent_steps_trained": 351600}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11362.860971933516, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624885589476931, "mean_inference_ms": 0.3837731100413217, "mean_action_processing_ms": 0.09273624118662521, "mean_env_wait_ms": 1.1536609032722716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004167079925537109, "StateBufferConnector_ms": 0.0029311180114746094, "ViewRequirementAgentConnector_ms": 0.07175874710083008}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11362.860971933516, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11205.637557181752, -11222.680410970746, -11289.332026388714, -11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624885589476931, "mean_inference_ms": 0.3837731100413217, "mean_action_processing_ms": 0.09273624118662521, "mean_env_wait_ms": 1.1536609032722716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004167079925537109, "StateBufferConnector_ms": 0.0029311180114746094, "ViewRequirementAgentConnector_ms": 0.07175874710083008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 351600, "num_agent_steps_trained": 351600, "num_env_steps_sampled": 351600, "num_env_steps_trained": 351600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.55177068745435, "num_env_steps_trained_throughput_per_sec": 106.55177068745435, "timesteps_total": 351600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 351600, "timers": {"training_iteration_time_ms": 3389.759, "sample_time_ms": 3379.157, "load_time_ms": 0.297, "load_throughput": 1213395.564, "learn_time_ms": 9.561, "learn_throughput": 37651.877, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 351600, "num_env_steps_trained": 351600, "num_agent_steps_sampled": 351600, "num_agent_steps_trained": 351600}, "done": false, "episodes_total": 1510, "training_iteration": 369, "trial_id": "04904_00000", "date": "2023-07-26_22-37-32", "timestamp": 1690400252, "time_this_iter_s": 10.1387460231781, "time_total_s": 4039.2724754810333, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2070.320609331131, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 20.300000000000004, "ram_util_percent": 65.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4762451171875, "policy_loss": -17987124854784.0, "vf_loss": 212078547.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3098.0, "diff_num_grad_updates_vs_sampler_policy": 3097.0}}, "num_env_steps_sampled": 352680, "num_env_steps_trained": 352680, "num_agent_steps_sampled": 352680, "num_agent_steps_trained": 352680}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11364.8702224865, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.62474577564789, "mean_inference_ms": 0.3838336086615419, "mean_action_processing_ms": 0.09274825543135888, "mean_env_wait_ms": 1.1537434441435648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041158199310302734, "StateBufferConnector_ms": 0.0028989315032958984, "ViewRequirementAgentConnector_ms": 0.07099270820617676}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11364.8702224865, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11556.144427749185, -11271.521779072065, -11388.387463508241, -11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.62474577564789, "mean_inference_ms": 0.3838336086615419, "mean_action_processing_ms": 0.09274825543135888, "mean_env_wait_ms": 1.1537434441435648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041158199310302734, "StateBufferConnector_ms": 0.0028989315032958984, "ViewRequirementAgentConnector_ms": 0.07099270820617676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352680, "num_agent_steps_trained": 352680, "num_env_steps_sampled": 352680, "num_env_steps_trained": 352680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.9351317796547, "num_env_steps_trained_throughput_per_sec": 106.9351317796547, "timesteps_total": 352680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 352680, "timers": {"training_iteration_time_ms": 3378.3, "sample_time_ms": 3367.609, "load_time_ms": 0.295, "load_throughput": 1220062.573, "learn_time_ms": 9.635, "learn_throughput": 37365.552, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 352680, "num_env_steps_trained": 352680, "num_agent_steps_sampled": 352680, "num_agent_steps_trained": 352680}, "done": false, "episodes_total": 1513, "training_iteration": 370, "trial_id": "04904_00000", "date": "2023-07-26_22-37-42", "timestamp": 1690400262, "time_this_iter_s": 10.10234022140503, "time_total_s": 4049.3748157024384, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2080.422949552536, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 18.82857142857143, "ram_util_percent": 65.70714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3306884765625, "policy_loss": -14367388687486.025, "vf_loss": 214033220.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3113.0, "diff_num_grad_updates_vs_sampler_policy": 3112.0}}, "num_env_steps_sampled": 353760, "num_env_steps_trained": 353760, "num_agent_steps_sampled": 353760, "num_agent_steps_trained": 353760}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11358.53446043781, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6246693300213835, "mean_inference_ms": 0.3838887060648424, "mean_action_processing_ms": 0.0927593735478927, "mean_env_wait_ms": 1.1538162232938713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004095792770385742, "StateBufferConnector_ms": 0.0028917789459228516, "ViewRequirementAgentConnector_ms": 0.07069659233093262}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11358.53446043781, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11214.18758897079, -11537.90025686734, -11161.004927488495, -11156.92271614796, -11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6246693300213835, "mean_inference_ms": 0.3838887060648424, "mean_action_processing_ms": 0.0927593735478927, "mean_env_wait_ms": 1.1538162232938713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004095792770385742, "StateBufferConnector_ms": 0.0028917789459228516, "ViewRequirementAgentConnector_ms": 0.07069659233093262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 353760, "num_agent_steps_trained": 353760, "num_env_steps_sampled": 353760, "num_env_steps_trained": 353760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.48765879341846, "num_env_steps_trained_throughput_per_sec": 107.48765879341846, "timesteps_total": 353760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 353760, "timers": {"training_iteration_time_ms": 3369.258, "sample_time_ms": 3358.569, "load_time_ms": 0.296, "load_throughput": 1218192.368, "learn_time_ms": 9.649, "learn_throughput": 37311.261, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 353760, "num_env_steps_trained": 353760, "num_agent_steps_sampled": 353760, "num_agent_steps_trained": 353760}, "done": false, "episodes_total": 1516, "training_iteration": 371, "trial_id": "04904_00000", "date": "2023-07-26_22-37-52", "timestamp": 1690400272, "time_this_iter_s": 10.050355911254883, "time_total_s": 4059.4251716136932, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2090.473305463791, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 18.05333333333333, "ram_util_percent": 65.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3698974609374, "policy_loss": -12029270058598.4, "vf_loss": 208168897.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3133.0, "diff_num_grad_updates_vs_sampler_policy": 3132.0}}, "num_env_steps_sampled": 355200, "num_env_steps_trained": 355200, "num_agent_steps_sampled": 355200, "num_agent_steps_trained": 355200}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11356.180706133924, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624545224516738, "mean_inference_ms": 0.3839528593873769, "mean_action_processing_ms": 0.09277262004834702, "mean_env_wait_ms": 1.1539009071540385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040721893310546875, "StateBufferConnector_ms": 0.0028841495513916016, "ViewRequirementAgentConnector_ms": 0.0705103874206543}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11356.180706133924, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11382.448511814353, -11365.999731794263, -11405.759579402724, -11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624545224516738, "mean_inference_ms": 0.3839528593873769, "mean_action_processing_ms": 0.09277262004834702, "mean_env_wait_ms": 1.1539009071540385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040721893310546875, "StateBufferConnector_ms": 0.0028841495513916016, "ViewRequirementAgentConnector_ms": 0.0705103874206543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 355200, "num_agent_steps_trained": 355200, "num_env_steps_sampled": 355200, "num_env_steps_trained": 355200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.40787742081639, "num_env_steps_trained_throughput_per_sec": 109.40787742081639, "timesteps_total": 355200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 355200, "timers": {"training_iteration_time_ms": 3330.887, "sample_time_ms": 3320.23, "load_time_ms": 0.298, "load_throughput": 1207669.711, "learn_time_ms": 9.607, "learn_throughput": 37472.749, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 355200, "num_env_steps_trained": 355200, "num_agent_steps_sampled": 355200, "num_agent_steps_trained": 355200}, "done": false, "episodes_total": 1520, "training_iteration": 372, "trial_id": "04904_00000", "date": "2023-07-26_22-38-05", "timestamp": 1690400285, "time_this_iter_s": 13.164581775665283, "time_total_s": 4072.5897533893585, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2103.637887239456, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 23.738888888888887, "ram_util_percent": 65.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3450927734375, "policy_loss": -23844657037312.0, "vf_loss": 215754264.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3148.0, "diff_num_grad_updates_vs_sampler_policy": 3147.0}}, "num_env_steps_sampled": 356280, "num_env_steps_trained": 356280, "num_agent_steps_sampled": 356280, "num_agent_steps_trained": 356280}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11357.441048287119, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624554540612821, "mean_inference_ms": 0.38399433401947386, "mean_action_processing_ms": 0.0927814348309989, "mean_env_wait_ms": 1.1539754200316765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040433406829833984, "StateBufferConnector_ms": 0.0028731822967529297, "ViewRequirementAgentConnector_ms": 0.0701606273651123}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11357.441048287119, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11350.876891686783, -11445.53294415627, -11500.632356992683, -11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624554540612821, "mean_inference_ms": 0.38399433401947386, "mean_action_processing_ms": 0.0927814348309989, "mean_env_wait_ms": 1.1539754200316765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040433406829833984, "StateBufferConnector_ms": 0.0028731822967529297, "ViewRequirementAgentConnector_ms": 0.0701606273651123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356280, "num_agent_steps_trained": 356280, "num_env_steps_sampled": 356280, "num_env_steps_trained": 356280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.22499103271595, "num_env_steps_trained_throughput_per_sec": 106.22499103271595, "timesteps_total": 356280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 356280, "timers": {"training_iteration_time_ms": 3337.639, "sample_time_ms": 3327.067, "load_time_ms": 0.299, "load_throughput": 1204010.398, "learn_time_ms": 9.525, "learn_throughput": 37795.035, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 356280, "num_env_steps_trained": 356280, "num_agent_steps_sampled": 356280, "num_agent_steps_trained": 356280}, "done": false, "episodes_total": 1523, "training_iteration": 373, "trial_id": "04904_00000", "date": "2023-07-26_22-38-15", "timestamp": 1690400295, "time_this_iter_s": 10.169863939285278, "time_total_s": 4082.759617328644, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2113.8077511787415, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 19.346666666666668, "ram_util_percent": 65.61333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4929931640625, "policy_loss": -18560213214822.4, "vf_loss": 220331337.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3163.0, "diff_num_grad_updates_vs_sampler_policy": 3162.0}}, "num_env_steps_sampled": 357360, "num_env_steps_trained": 357360, "num_agent_steps_sampled": 357360, "num_agent_steps_trained": 357360}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11353.44372628368, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624653330963424, "mean_inference_ms": 0.38402290461909006, "mean_action_processing_ms": 0.09278759637961176, "mean_env_wait_ms": 1.1540320298908389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040285587310791016, "StateBufferConnector_ms": 0.002871990203857422, "ViewRequirementAgentConnector_ms": 0.06998419761657715}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11353.44372628368, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11114.432491562904, -11502.9500054019, -11235.925971689507, -11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624653330963424, "mean_inference_ms": 0.38402290461909006, "mean_action_processing_ms": 0.09278759637961176, "mean_env_wait_ms": 1.1540320298908389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040285587310791016, "StateBufferConnector_ms": 0.002871990203857422, "ViewRequirementAgentConnector_ms": 0.06998419761657715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 357360, "num_agent_steps_trained": 357360, "num_env_steps_sampled": 357360, "num_env_steps_trained": 357360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.65245716418431, "num_env_steps_trained_throughput_per_sec": 106.65245716418431, "timesteps_total": 357360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 357360, "timers": {"training_iteration_time_ms": 3345.508, "sample_time_ms": 3334.913, "load_time_ms": 0.3, "load_throughput": 1201997.644, "learn_time_ms": 9.55, "learn_throughput": 37697.656, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 357360, "num_env_steps_trained": 357360, "num_agent_steps_sampled": 357360, "num_agent_steps_trained": 357360}, "done": false, "episodes_total": 1526, "training_iteration": 374, "trial_id": "04904_00000", "date": "2023-07-26_22-38-26", "timestamp": 1690400306, "time_this_iter_s": 10.129106998443604, "time_total_s": 4092.8887243270874, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2123.936858177185, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 19.00714285714286, "ram_util_percent": 65.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3123779296875, "policy_loss": -15055604259225.6, "vf_loss": 215478416.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3178.0, "diff_num_grad_updates_vs_sampler_policy": 3177.0}}, "num_env_steps_sampled": 358440, "num_env_steps_trained": 358440, "num_agent_steps_sampled": 358440, "num_agent_steps_trained": 358440}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11354.569309444723, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624873442992185, "mean_inference_ms": 0.3840318061971415, "mean_action_processing_ms": 0.09278953477305477, "mean_env_wait_ms": 1.1540525872505762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040547847747802734, "StateBufferConnector_ms": 0.002885103225708008, "ViewRequirementAgentConnector_ms": 0.07057619094848633}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11354.569309444723, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11194.718756923636, -11326.854105991699, -11312.277479198767, -11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.624873442992185, "mean_inference_ms": 0.3840318061971415, "mean_action_processing_ms": 0.09278953477305477, "mean_env_wait_ms": 1.1540525872505762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040547847747802734, "StateBufferConnector_ms": 0.002885103225708008, "ViewRequirementAgentConnector_ms": 0.07057619094848633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 358440, "num_agent_steps_trained": 358440, "num_env_steps_sampled": 358440, "num_env_steps_trained": 358440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.26178943764755, "num_env_steps_trained_throughput_per_sec": 103.26178943764755, "timesteps_total": 358440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 358440, "timers": {"training_iteration_time_ms": 3417.179, "sample_time_ms": 3406.567, "load_time_ms": 0.297, "load_throughput": 1213298.063, "learn_time_ms": 9.563, "learn_throughput": 37644.367, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 358440, "num_env_steps_trained": 358440, "num_agent_steps_sampled": 358440, "num_agent_steps_trained": 358440}, "done": false, "episodes_total": 1529, "training_iteration": 375, "trial_id": "04904_00000", "date": "2023-07-26_22-38-36", "timestamp": 1690400316, "time_this_iter_s": 10.461516857147217, "time_total_s": 4103.350241184235, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2134.3983750343323, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 29.48, "ram_util_percent": 65.81333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.22509765625, "policy_loss": -15331218441700.25, "vf_loss": 215270217.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3193.0, "diff_num_grad_updates_vs_sampler_policy": 3192.0}}, "num_env_steps_sampled": 359520, "num_env_steps_trained": 359520, "num_agent_steps_sampled": 359520, "num_agent_steps_trained": 359520}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11359.11790783487, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625124254755234, "mean_inference_ms": 0.3840372236903867, "mean_action_processing_ms": 0.09279088671633512, "mean_env_wait_ms": 1.1540841002224844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004036903381347656, "StateBufferConnector_ms": 0.0028793811798095703, "ViewRequirementAgentConnector_ms": 0.07034730911254883}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11359.11790783487, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11325.256503547527, -11203.796129738286, -11186.767923771371, -11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625124254755234, "mean_inference_ms": 0.3840372236903867, "mean_action_processing_ms": 0.09279088671633512, "mean_env_wait_ms": 1.1540841002224844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004036903381347656, "StateBufferConnector_ms": 0.0028793811798095703, "ViewRequirementAgentConnector_ms": 0.07034730911254883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 359520, "num_agent_steps_trained": 359520, "num_env_steps_sampled": 359520, "num_env_steps_trained": 359520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.03265039543895, "num_env_steps_trained_throughput_per_sec": 106.03265039543895, "timesteps_total": 359520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 359520, "timers": {"training_iteration_time_ms": 3417.395, "sample_time_ms": 3406.695, "load_time_ms": 0.3, "load_throughput": 1201519.408, "learn_time_ms": 9.629, "learn_throughput": 37386.831, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 359520, "num_env_steps_trained": 359520, "num_agent_steps_sampled": 359520, "num_agent_steps_trained": 359520}, "done": false, "episodes_total": 1532, "training_iteration": 376, "trial_id": "04904_00000", "date": "2023-07-26_22-38-46", "timestamp": 1690400326, "time_this_iter_s": 10.188321828842163, "time_total_s": 4113.538563013077, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2144.5866968631744, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 20.185714285714287, "ram_util_percent": 65.97142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.43271484375, "policy_loss": -12187586265088.0, "vf_loss": 203538296.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3208.0, "diff_num_grad_updates_vs_sampler_policy": 3207.0}}, "num_env_steps_sampled": 360600, "num_env_steps_trained": 360600, "num_agent_steps_sampled": 360600, "num_agent_steps_trained": 360600}, "sampler_results": {"episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11363.98219433946, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6255177494946285, "mean_inference_ms": 0.3840266555884641, "mean_action_processing_ms": 0.09278928094291661, "mean_env_wait_ms": 1.1541156211225756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003918886184692383, "StateBufferConnector_ms": 0.002858400344848633, "ViewRequirementAgentConnector_ms": 0.07011032104492188}}, "episode_reward_max": -10850.105598294163, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11363.98219433946, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11463.1618054006, -10850.105598294163, -11285.390087600083, -11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6255177494946285, "mean_inference_ms": 0.3840266555884641, "mean_action_processing_ms": 0.09278928094291661, "mean_env_wait_ms": 1.1541156211225756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003918886184692383, "StateBufferConnector_ms": 0.002858400344848633, "ViewRequirementAgentConnector_ms": 0.07011032104492188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360600, "num_agent_steps_trained": 360600, "num_env_steps_sampled": 360600, "num_env_steps_trained": 360600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.14991377081138, "num_env_steps_trained_throughput_per_sec": 106.14991377081138, "timesteps_total": 360600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 360600, "timers": {"training_iteration_time_ms": 3417.815, "sample_time_ms": 3407.035, "load_time_ms": 0.302, "load_throughput": 1193164.315, "learn_time_ms": 9.698, "learn_throughput": 37122.297, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 360600, "num_env_steps_trained": 360600, "num_agent_steps_sampled": 360600, "num_agent_steps_trained": 360600}, "done": false, "episodes_total": 1535, "training_iteration": 377, "trial_id": "04904_00000", "date": "2023-07-26_22-38-57", "timestamp": 1690400337, "time_this_iter_s": 10.177068948745728, "time_total_s": 4123.7156319618225, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2154.76376581192, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 19.493333333333336, "ram_util_percent": 65.93333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.5499755859375, "policy_loss": -12319427633231.775, "vf_loss": 204867891.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3223.0, "diff_num_grad_updates_vs_sampler_policy": 3222.0}}, "num_env_steps_sampled": 361680, "num_env_steps_trained": 361680, "num_agent_steps_sampled": 361680, "num_agent_steps_trained": 361680}, "sampler_results": {"episode_reward_max": -10992.534772658331, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11361.934796159963, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625859039954121, "mean_inference_ms": 0.3839965747613895, "mean_action_processing_ms": 0.09278383647654596, "mean_env_wait_ms": 1.1541089304949965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038945674896240234, "StateBufferConnector_ms": 0.0028395652770996094, "ViewRequirementAgentConnector_ms": 0.06970572471618652}}, "episode_reward_max": -10992.534772658331, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11361.934796159963, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11319.641900701134, -11132.362770599226, -11440.537335903067, -11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.625859039954121, "mean_inference_ms": 0.3839965747613895, "mean_action_processing_ms": 0.09278383647654596, "mean_env_wait_ms": 1.1541089304949965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038945674896240234, "StateBufferConnector_ms": 0.0028395652770996094, "ViewRequirementAgentConnector_ms": 0.06970572471618652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 361680, "num_agent_steps_trained": 361680, "num_env_steps_sampled": 361680, "num_env_steps_trained": 361680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.80816985767322, "num_env_steps_trained_throughput_per_sec": 107.80816985767322, "timesteps_total": 361680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 361680, "timers": {"training_iteration_time_ms": 3374.048, "sample_time_ms": 3363.318, "load_time_ms": 0.302, "load_throughput": 1190342.483, "learn_time_ms": 9.667, "learn_throughput": 37240.956, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 361680, "num_env_steps_trained": 361680, "num_agent_steps_sampled": 361680, "num_agent_steps_trained": 361680}, "done": false, "episodes_total": 1538, "training_iteration": 378, "trial_id": "04904_00000", "date": "2023-07-26_22-39-07", "timestamp": 1690400347, "time_this_iter_s": 10.020378828048706, "time_total_s": 4133.736010789871, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2164.784144639969, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 20.107142857142858, "ram_util_percent": 65.9857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.41591796875, "policy_loss": -9468937045610.85, "vf_loss": 202642969.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3238.0, "diff_num_grad_updates_vs_sampler_policy": 3237.0}}, "num_env_steps_sampled": 362760, "num_env_steps_trained": 362760, "num_agent_steps_sampled": 362760, "num_agent_steps_trained": 362760}, "sampler_results": {"episode_reward_max": -10992.534772658331, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11362.02390422716, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.626172223311175, "mean_inference_ms": 0.3839574768581556, "mean_action_processing_ms": 0.09277666260744452, "mean_env_wait_ms": 1.1540861944283998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038919448852539062, "StateBufferConnector_ms": 0.0028367042541503906, "ViewRequirementAgentConnector_ms": 0.06972050666809082}}, "episode_reward_max": -10992.534772658331, "episode_reward_min": -11652.755564104496, "episode_reward_mean": -11362.02390422716, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11551.201827731964, -11391.425404908374, -11238.838800599076, -11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.626172223311175, "mean_inference_ms": 0.3839574768581556, "mean_action_processing_ms": 0.09277666260744452, "mean_env_wait_ms": 1.1540861944283998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038919448852539062, "StateBufferConnector_ms": 0.0028367042541503906, "ViewRequirementAgentConnector_ms": 0.06972050666809082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 362760, "num_agent_steps_trained": 362760, "num_env_steps_sampled": 362760, "num_env_steps_trained": 362760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.61452343665748, "num_env_steps_trained_throughput_per_sec": 106.61452343665748, "timesteps_total": 362760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 362760, "timers": {"training_iteration_time_ms": 3372.149, "sample_time_ms": 3361.496, "load_time_ms": 0.301, "load_throughput": 1195147.57, "learn_time_ms": 9.607, "learn_throughput": 37474.423, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 362760, "num_env_steps_trained": 362760, "num_agent_steps_sampled": 362760, "num_agent_steps_trained": 362760}, "done": false, "episodes_total": 1541, "training_iteration": 379, "trial_id": "04904_00000", "date": "2023-07-26_22-39-17", "timestamp": 1690400357, "time_this_iter_s": 10.13262414932251, "time_total_s": 4143.868634939194, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2174.9167687892914, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 19.364285714285717, "ram_util_percent": 65.95714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4705078125, "policy_loss": -22056867148595.2, "vf_loss": 227185494.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3253.0, "diff_num_grad_updates_vs_sampler_policy": 3252.0}}, "num_env_steps_sampled": 363840, "num_env_steps_trained": 363840, "num_agent_steps_sampled": 363840, "num_agent_steps_trained": 363840}, "sampler_results": {"episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11362.252311105465, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.62648828813237, "mean_inference_ms": 0.3839177536175673, "mean_action_processing_ms": 0.09276942838342096, "mean_env_wait_ms": 1.1540593996983532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038890838623046875, "StateBufferConnector_ms": 0.002838611602783203, "ViewRequirementAgentConnector_ms": 0.06967926025390625}}, "episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11362.252311105465, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11192.616082646267, -11405.28310411192, -11496.132439284762, -11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.62648828813237, "mean_inference_ms": 0.3839177536175673, "mean_action_processing_ms": 0.09276942838342096, "mean_env_wait_ms": 1.1540593996983532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038890838623046875, "StateBufferConnector_ms": 0.002838611602783203, "ViewRequirementAgentConnector_ms": 0.06967926025390625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 363840, "num_agent_steps_trained": 363840, "num_env_steps_sampled": 363840, "num_env_steps_trained": 363840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.28302838157423, "num_env_steps_trained_throughput_per_sec": 107.28302838157423, "timesteps_total": 363840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 363840, "timers": {"training_iteration_time_ms": 3356.324, "sample_time_ms": 3345.783, "load_time_ms": 0.301, "load_throughput": 1194296.797, "learn_time_ms": 9.498, "learn_throughput": 37902.24, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 363840, "num_env_steps_trained": 363840, "num_agent_steps_sampled": 363840, "num_agent_steps_trained": 363840}, "done": false, "episodes_total": 1544, "training_iteration": 380, "trial_id": "04904_00000", "date": "2023-07-26_22-39-27", "timestamp": 1690400367, "time_this_iter_s": 10.069666147232056, "time_total_s": 4153.938301086426, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2184.9864349365234, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 19.9, "ram_util_percent": 65.66000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.187744140625, "policy_loss": -23085229958758.4, "vf_loss": 215354571.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3268.0, "diff_num_grad_updates_vs_sampler_policy": 3267.0}}, "num_env_steps_sampled": 364920, "num_env_steps_trained": 364920, "num_agent_steps_sampled": 364920, "num_agent_steps_trained": 364920}, "sampler_results": {"episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11361.96289117602, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.62681189059124, "mean_inference_ms": 0.38387810072019973, "mean_action_processing_ms": 0.09276218193450164, "mean_env_wait_ms": 1.1540321875122213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038373470306396484, "StateBufferConnector_ms": 0.0028204917907714844, "ViewRequirementAgentConnector_ms": 0.06896543502807617}}, "episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11361.96289117602, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11388.876330761223, -11301.058191624135, -11389.536161431397, -11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.62681189059124, "mean_inference_ms": 0.38387810072019973, "mean_action_processing_ms": 0.09276218193450164, "mean_env_wait_ms": 1.1540321875122213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038373470306396484, "StateBufferConnector_ms": 0.0028204917907714844, "ViewRequirementAgentConnector_ms": 0.06896543502807617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364920, "num_agent_steps_trained": 364920, "num_env_steps_sampled": 364920, "num_env_steps_trained": 364920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.40698171563818, "num_env_steps_trained_throughput_per_sec": 106.40698171563818, "timesteps_total": 364920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 364920, "timers": {"training_iteration_time_ms": 3368.759, "sample_time_ms": 3358.238, "load_time_ms": 0.299, "load_throughput": 1204586.709, "learn_time_ms": 9.491, "learn_throughput": 37931.852, "synch_weights_time_ms": 0.686}, "counters": {"num_env_steps_sampled": 364920, "num_env_steps_trained": 364920, "num_agent_steps_sampled": 364920, "num_agent_steps_trained": 364920}, "done": false, "episodes_total": 1547, "training_iteration": 381, "trial_id": "04904_00000", "date": "2023-07-26_22-39-37", "timestamp": 1690400377, "time_this_iter_s": 10.152464151382446, "time_total_s": 4164.090765237808, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2195.138899087906, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 20.149999999999995, "ram_util_percent": 65.70714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3894775390625, "policy_loss": -15713288742502.4, "vf_loss": 219958324.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3283.0, "diff_num_grad_updates_vs_sampler_policy": 3282.0}}, "num_env_steps_sampled": 366000, "num_env_steps_trained": 366000, "num_agent_steps_sampled": 366000, "num_agent_steps_trained": 366000}, "sampler_results": {"episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11362.861123773186, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627143570649193, "mean_inference_ms": 0.3838395795813055, "mean_action_processing_ms": 0.09275509057880489, "mean_env_wait_ms": 1.1540080683283875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00383758544921875, "StateBufferConnector_ms": 0.00281524658203125, "ViewRequirementAgentConnector_ms": 0.06897163391113281}}, "episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11362.861123773186, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11155.423579316152, -11380.380977766756, -11258.486810694149, -11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627143570649193, "mean_inference_ms": 0.3838395795813055, "mean_action_processing_ms": 0.09275509057880489, "mean_env_wait_ms": 1.1540080683283875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00383758544921875, "StateBufferConnector_ms": 0.00281524658203125, "ViewRequirementAgentConnector_ms": 0.06897163391113281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 366000, "num_agent_steps_trained": 366000, "num_env_steps_sampled": 366000, "num_env_steps_trained": 366000, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.93350104592965, "num_env_steps_trained_throughput_per_sec": 106.93350104592965, "timesteps_total": 366000, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 366000, "timers": {"training_iteration_time_ms": 3366.161, "sample_time_ms": 3355.62, "load_time_ms": 0.297, "load_throughput": 1211059.865, "learn_time_ms": 9.511, "learn_throughput": 37852.452, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 366000, "num_env_steps_trained": 366000, "num_agent_steps_sampled": 366000, "num_agent_steps_trained": 366000}, "done": false, "episodes_total": 1550, "training_iteration": 382, "trial_id": "04904_00000", "date": "2023-07-26_22-39-47", "timestamp": 1690400387, "time_this_iter_s": 10.102590084075928, "time_total_s": 4174.193355321884, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2205.241489171982, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 19.285714285714285, "ram_util_percent": 65.69285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.365087890625, "policy_loss": -13590009479168.0, "vf_loss": 210926756.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3298.0, "diff_num_grad_updates_vs_sampler_policy": 3297.0}}, "num_env_steps_sampled": 367080, "num_env_steps_trained": 367080, "num_agent_steps_sampled": 367080, "num_agent_steps_trained": 367080}, "sampler_results": {"episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11364.444253044554, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627480662969053, "mean_inference_ms": 0.38380112124404087, "mean_action_processing_ms": 0.09274802923472698, "mean_env_wait_ms": 1.1539906906470692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038475990295410156, "StateBufferConnector_ms": 0.0028145313262939453, "ViewRequirementAgentConnector_ms": 0.0689690113067627}}, "episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11364.444253044554, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11312.997158255786, -11579.747080553074, -11572.718881123037, -11273.853695893109, -11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627480662969053, "mean_inference_ms": 0.38380112124404087, "mean_action_processing_ms": 0.09274802923472698, "mean_env_wait_ms": 1.1539906906470692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038475990295410156, "StateBufferConnector_ms": 0.0028145313262939453, "ViewRequirementAgentConnector_ms": 0.0689690113067627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 367080, "num_agent_steps_trained": 367080, "num_env_steps_sampled": 367080, "num_env_steps_trained": 367080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.8982555296036, "num_env_steps_trained_throughput_per_sec": 106.8982555296036, "timesteps_total": 367080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 367080, "timers": {"training_iteration_time_ms": 3376.432, "sample_time_ms": 3365.88, "load_time_ms": 0.299, "load_throughput": 1204682.815, "learn_time_ms": 9.518, "learn_throughput": 37823.058, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 367080, "num_env_steps_trained": 367080, "num_agent_steps_sampled": 367080, "num_agent_steps_trained": 367080}, "done": false, "episodes_total": 1553, "training_iteration": 383, "trial_id": "04904_00000", "date": "2023-07-26_22-39-57", "timestamp": 1690400397, "time_this_iter_s": 10.105916023254395, "time_total_s": 4184.299271345139, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2215.347405195236, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 17.706666666666663, "ram_util_percent": 65.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.370654296875, "policy_loss": -15698088899379.2, "vf_loss": 215009673.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3318.0, "diff_num_grad_updates_vs_sampler_policy": 3317.0}}, "num_env_steps_sampled": 368520, "num_env_steps_trained": 368520, "num_agent_steps_sampled": 368520, "num_agent_steps_trained": 368520}, "sampler_results": {"episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11355.529885699558, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627944922818903, "mean_inference_ms": 0.38375171255145046, "mean_action_processing_ms": 0.0927389229022651, "mean_env_wait_ms": 1.1539532234767937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003850698471069336, "StateBufferConnector_ms": 0.0028145313262939453, "ViewRequirementAgentConnector_ms": 0.06902432441711426}}, "episode_reward_max": -10992.534772658331, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11355.529885699558, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11439.111652287587, -11578.127387067685, -10992.534772658331, -11393.174425322108, -11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.627944922818903, "mean_inference_ms": 0.38375171255145046, "mean_action_processing_ms": 0.0927389229022651, "mean_env_wait_ms": 1.1539532234767937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003850698471069336, "StateBufferConnector_ms": 0.0028145313262939453, "ViewRequirementAgentConnector_ms": 0.06902432441711426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368520, "num_agent_steps_trained": 368520, "num_env_steps_sampled": 368520, "num_env_steps_trained": 368520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.80485368695842, "num_env_steps_trained_throughput_per_sec": 107.80485368695842, "timesteps_total": 368520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 368520, "timers": {"training_iteration_time_ms": 3356.014, "sample_time_ms": 3345.405, "load_time_ms": 0.297, "load_throughput": 1211351.336, "learn_time_ms": 9.566, "learn_throughput": 37632.546, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 368520, "num_env_steps_trained": 368520, "num_agent_steps_sampled": 368520, "num_agent_steps_trained": 368520}, "done": false, "episodes_total": 1557, "training_iteration": 384, "trial_id": "04904_00000", "date": "2023-07-26_22-40-11", "timestamp": 1690400411, "time_this_iter_s": 13.360422849655151, "time_total_s": 4197.659694194794, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2228.7078280448914, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 19.936842105263157, "ram_util_percent": 65.75263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.37392578125, "policy_loss": -25069075772211.2, "vf_loss": 212619097.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3338.0, "diff_num_grad_updates_vs_sampler_policy": 3337.0}}, "num_env_steps_sampled": 369960, "num_env_steps_trained": 369960, "num_agent_steps_sampled": 369960, "num_agent_steps_trained": 369960}, "sampler_results": {"episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11353.467264714067, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628398348220644, "mean_inference_ms": 0.3837026384350857, "mean_action_processing_ms": 0.09272984388888218, "mean_env_wait_ms": 1.1539110114165523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00384521484375, "StateBufferConnector_ms": 0.002820253372192383, "ViewRequirementAgentConnector_ms": 0.0689246654510498}}, "episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11353.467264714067, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11309.070079058463, -11284.670042889871, -11429.766251429426, -11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628398348220644, "mean_inference_ms": 0.3837026384350857, "mean_action_processing_ms": 0.09272984388888218, "mean_env_wait_ms": 1.1539110114165523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00384521484375, "StateBufferConnector_ms": 0.002820253372192383, "ViewRequirementAgentConnector_ms": 0.0689246654510498}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 369960, "num_agent_steps_trained": 369960, "num_env_steps_sampled": 369960, "num_env_steps_trained": 369960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 108.41279431559045, "num_env_steps_trained_throughput_per_sec": 108.41279431559045, "timesteps_total": 369960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 369960, "timers": {"training_iteration_time_ms": 3339.263, "sample_time_ms": 3328.664, "load_time_ms": 0.298, "load_throughput": 1208829.91, "learn_time_ms": 9.567, "learn_throughput": 37631.045, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 369960, "num_env_steps_trained": 369960, "num_agent_steps_sampled": 369960, "num_agent_steps_trained": 369960}, "done": false, "episodes_total": 1561, "training_iteration": 385, "trial_id": "04904_00000", "date": "2023-07-26_22-40-24", "timestamp": 1690400424, "time_this_iter_s": 13.285550117492676, "time_total_s": 4210.945244312286, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2241.993378162384, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 21.82777777777778, "ram_util_percent": 65.77777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4005859375, "policy_loss": -24612693606400.0, "vf_loss": 221473305.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3353.0, "diff_num_grad_updates_vs_sampler_policy": 3352.0}}, "num_env_steps_sampled": 371040, "num_env_steps_trained": 371040, "num_agent_steps_sampled": 371040, "num_agent_steps_trained": 371040}, "sampler_results": {"episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11354.151322048809, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628717495689208, "mean_inference_ms": 0.38366009449883376, "mean_action_processing_ms": 0.0927219388663321, "mean_env_wait_ms": 1.153869076904258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003754854202270508, "StateBufferConnector_ms": 0.0027768611907958984, "ViewRequirementAgentConnector_ms": 0.06786537170410156}}, "episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11354.151322048809, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11290.525404779366, -11601.950438688209, -11568.159998686087, -11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628717495689208, "mean_inference_ms": 0.38366009449883376, "mean_action_processing_ms": 0.0927219388663321, "mean_env_wait_ms": 1.153869076904258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003754854202270508, "StateBufferConnector_ms": 0.0027768611907958984, "ViewRequirementAgentConnector_ms": 0.06786537170410156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 371040, "num_agent_steps_trained": 371040, "num_env_steps_sampled": 371040, "num_env_steps_trained": 371040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.56281985872754, "num_env_steps_trained_throughput_per_sec": 107.56281985872754, "timesteps_total": 371040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 371040, "timers": {"training_iteration_time_ms": 3336.341, "sample_time_ms": 3325.699, "load_time_ms": 0.296, "load_throughput": 1214957.708, "learn_time_ms": 9.606, "learn_throughput": 37476.655, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 371040, "num_env_steps_trained": 371040, "num_agent_steps_sampled": 371040, "num_agent_steps_trained": 371040}, "done": false, "episodes_total": 1564, "training_iteration": 386, "trial_id": "04904_00000", "date": "2023-07-26_22-40-34", "timestamp": 1690400434, "time_this_iter_s": 10.043457984924316, "time_total_s": 4220.988702297211, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2252.0368361473083, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 22.186666666666667, "ram_util_percent": 65.87333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.1421875, "policy_loss": -11912334518382.3, "vf_loss": 211161329.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3368.0, "diff_num_grad_updates_vs_sampler_policy": 3367.0}}, "num_env_steps_sampled": 372120, "num_env_steps_trained": 372120, "num_agent_steps_sampled": 372120, "num_agent_steps_trained": 372120}, "sampler_results": {"episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11346.406037683319, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629017488682029, "mean_inference_ms": 0.3836147397224587, "mean_action_processing_ms": 0.09271349515276349, "mean_env_wait_ms": 1.153816415045446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003755331039428711, "StateBufferConnector_ms": 0.002774953842163086, "ViewRequirementAgentConnector_ms": 0.0678868293762207}}, "episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11346.406037683319, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11262.68747669951, -11439.990623107247, -11418.446502907123, -11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629017488682029, "mean_inference_ms": 0.3836147397224587, "mean_action_processing_ms": 0.09271349515276349, "mean_env_wait_ms": 1.153816415045446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003755331039428711, "StateBufferConnector_ms": 0.002774953842163086, "ViewRequirementAgentConnector_ms": 0.0678868293762207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372120, "num_agent_steps_trained": 372120, "num_env_steps_sampled": 372120, "num_env_steps_trained": 372120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.4553326672303, "num_env_steps_trained_throughput_per_sec": 107.4553326672303, "timesteps_total": 372120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 372120, "timers": {"training_iteration_time_ms": 3337.377, "sample_time_ms": 3326.667, "load_time_ms": 0.296, "load_throughput": 1215838.183, "learn_time_ms": 9.671, "learn_throughput": 37225.256, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 372120, "num_env_steps_trained": 372120, "num_agent_steps_sampled": 372120, "num_agent_steps_trained": 372120}, "done": false, "episodes_total": 1567, "training_iteration": 387, "trial_id": "04904_00000", "date": "2023-07-26_22-40-44", "timestamp": 1690400444, "time_this_iter_s": 10.053470134735107, "time_total_s": 4231.042172431946, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2262.0903062820435, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 19.571428571428573, "ram_util_percent": 65.95000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3473388671875, "policy_loss": -15536551152844.8, "vf_loss": 219974428.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3383.0, "diff_num_grad_updates_vs_sampler_policy": 3382.0}}, "num_env_steps_sampled": 373200, "num_env_steps_trained": 373200, "num_agent_steps_sampled": 373200, "num_agent_steps_trained": 373200}, "sampler_results": {"episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11345.432484395998, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629316855266968, "mean_inference_ms": 0.3835696909598799, "mean_action_processing_ms": 0.09270516512792115, "mean_env_wait_ms": 1.1537444758773818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037522315979003906, "StateBufferConnector_ms": 0.002781391143798828, "ViewRequirementAgentConnector_ms": 0.06790590286254883}}, "episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11345.432484395998, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11567.26089754699, -11336.443139342771, -11631.487554634232, -11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629316855266968, "mean_inference_ms": 0.3835696909598799, "mean_action_processing_ms": 0.09270516512792115, "mean_env_wait_ms": 1.1537444758773818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037522315979003906, "StateBufferConnector_ms": 0.002781391143798828, "ViewRequirementAgentConnector_ms": 0.06790590286254883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 373200, "num_agent_steps_trained": 373200, "num_env_steps_sampled": 373200, "num_env_steps_trained": 373200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.90372492188864, "num_env_steps_trained_throughput_per_sec": 106.90372492188864, "timesteps_total": 373200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 373200, "timers": {"training_iteration_time_ms": 3360.503, "sample_time_ms": 3349.812, "load_time_ms": 0.295, "load_throughput": 1218487.282, "learn_time_ms": 9.66, "learn_throughput": 37267.243, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 373200, "num_env_steps_trained": 373200, "num_agent_steps_sampled": 373200, "num_agent_steps_trained": 373200}, "done": false, "episodes_total": 1570, "training_iteration": 388, "trial_id": "04904_00000", "date": "2023-07-26_22-40-54", "timestamp": 1690400454, "time_this_iter_s": 10.105358839035034, "time_total_s": 4241.147531270981, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2272.1956651210785, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 17.728571428571428, "ram_util_percent": 66.00714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.36630859375, "policy_loss": -26795980305203.2, "vf_loss": 221359758.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3398.0, "diff_num_grad_updates_vs_sampler_policy": 3397.0}}, "num_env_steps_sampled": 374280, "num_env_steps_trained": 374280, "num_agent_steps_sampled": 374280, "num_agent_steps_trained": 374280}, "sampler_results": {"episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11342.465307885897, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6296235338156135, "mean_inference_ms": 0.3835251589871705, "mean_action_processing_ms": 0.09269692711919923, "mean_env_wait_ms": 1.1536685955720751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037527084350585938, "StateBufferConnector_ms": 0.002782583236694336, "ViewRequirementAgentConnector_ms": 0.06792378425598145}}, "episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11342.465307885897, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11347.363757536596, -11371.389733158247, -11288.999400398996, -11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6296235338156135, "mean_inference_ms": 0.3835251589871705, "mean_action_processing_ms": 0.09269692711919923, "mean_env_wait_ms": 1.1536685955720751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037527084350585938, "StateBufferConnector_ms": 0.002782583236694336, "ViewRequirementAgentConnector_ms": 0.06792378425598145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 374280, "num_agent_steps_trained": 374280, "num_env_steps_sampled": 374280, "num_env_steps_trained": 374280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.3760841271846, "num_env_steps_trained_throughput_per_sec": 106.3760841271846, "timesteps_total": 374280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 374280, "timers": {"training_iteration_time_ms": 3367.239, "sample_time_ms": 3356.563, "load_time_ms": 0.299, "load_throughput": 1204394.544, "learn_time_ms": 9.635, "learn_throughput": 37362.871, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 374280, "num_env_steps_trained": 374280, "num_agent_steps_sampled": 374280, "num_agent_steps_trained": 374280}, "done": false, "episodes_total": 1573, "training_iteration": 389, "trial_id": "04904_00000", "date": "2023-07-26_22-41-04", "timestamp": 1690400464, "time_this_iter_s": 10.155433177947998, "time_total_s": 4251.302964448929, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2282.3510982990265, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 20.326666666666668, "ram_util_percent": 66.06}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3921630859375, "policy_loss": -18963908106649.6, "vf_loss": 212150027.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3413.0, "diff_num_grad_updates_vs_sampler_policy": 3412.0}}, "num_env_steps_sampled": 375360, "num_env_steps_trained": 375360, "num_agent_steps_sampled": 375360, "num_agent_steps_trained": 375360}, "sampler_results": {"episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11338.340609824867, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629934729258698, "mean_inference_ms": 0.3834811228136934, "mean_action_processing_ms": 0.09268878138897085, "mean_env_wait_ms": 1.1535861057859291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037565231323242188, "StateBufferConnector_ms": 0.002780437469482422, "ViewRequirementAgentConnector_ms": 0.06792068481445312}}, "episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11338.340609824867, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11431.464316610354, -11148.542588311071, -11309.190765230538, -10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.629934729258698, "mean_inference_ms": 0.3834811228136934, "mean_action_processing_ms": 0.09268878138897085, "mean_env_wait_ms": 1.1535861057859291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037565231323242188, "StateBufferConnector_ms": 0.002780437469482422, "ViewRequirementAgentConnector_ms": 0.06792068481445312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 375360, "num_agent_steps_trained": 375360, "num_env_steps_sampled": 375360, "num_env_steps_trained": 375360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.66762276974085, "num_env_steps_trained_throughput_per_sec": 107.66762276974085, "timesteps_total": 375360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 375360, "timers": {"training_iteration_time_ms": 3356.986, "sample_time_ms": 3346.389, "load_time_ms": 0.299, "load_throughput": 1205933.584, "learn_time_ms": 9.545, "learn_throughput": 37715.264, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 375360, "num_env_steps_trained": 375360, "num_agent_steps_sampled": 375360, "num_agent_steps_trained": 375360}, "done": false, "episodes_total": 1576, "training_iteration": 390, "trial_id": "04904_00000", "date": "2023-07-26_22-41-14", "timestamp": 1690400474, "time_this_iter_s": 10.033660888671875, "time_total_s": 4261.336625337601, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2292.3847591876984, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 19.342857142857145, "ram_util_percent": 65.90714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.47255859375, "policy_loss": -15060054992486.4, "vf_loss": 209293246.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3428.0, "diff_num_grad_updates_vs_sampler_policy": 3427.0}}, "num_env_steps_sampled": 376440, "num_env_steps_trained": 376440, "num_agent_steps_sampled": 376440, "num_agent_steps_trained": 376440}, "sampler_results": {"episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11337.68570326609, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630258925994217, "mean_inference_ms": 0.38343820939987266, "mean_action_processing_ms": 0.09268082415956995, "mean_env_wait_ms": 1.1535113247949405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759145736694336, "StateBufferConnector_ms": 0.002773284912109375, "ViewRequirementAgentConnector_ms": 0.06792068481445312}}, "episode_reward_max": -10994.340882012872, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11337.68570326609, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10994.340882012872, -11259.886390537737, -11323.70071083568, -11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630258925994217, "mean_inference_ms": 0.38343820939987266, "mean_action_processing_ms": 0.09268082415956995, "mean_env_wait_ms": 1.1535113247949405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759145736694336, "StateBufferConnector_ms": 0.002773284912109375, "ViewRequirementAgentConnector_ms": 0.06792068481445312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376440, "num_agent_steps_trained": 376440, "num_env_steps_sampled": 376440, "num_env_steps_trained": 376440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.18648203633767, "num_env_steps_trained_throughput_per_sec": 106.18648203633767, "timesteps_total": 376440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 376440, "timers": {"training_iteration_time_ms": 3373.937, "sample_time_ms": 3363.3, "load_time_ms": 0.299, "load_throughput": 1202572.029, "learn_time_ms": 9.572, "learn_throughput": 37608.55, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 376440, "num_env_steps_trained": 376440, "num_agent_steps_sampled": 376440, "num_agent_steps_trained": 376440}, "done": false, "episodes_total": 1579, "training_iteration": 391, "trial_id": "04904_00000", "date": "2023-07-26_22-41-25", "timestamp": 1690400485, "time_this_iter_s": 10.173603057861328, "time_total_s": 4271.510228395462, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2302.5583622455597, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 19.064285714285713, "ram_util_percent": 65.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4886474609375, "policy_loss": -14700708888576.0, "vf_loss": 210583020.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3443.0, "diff_num_grad_updates_vs_sampler_policy": 3442.0}}, "num_env_steps_sampled": 377520, "num_env_steps_trained": 377520, "num_agent_steps_sampled": 377520, "num_agent_steps_trained": 377520}, "sampler_results": {"episode_reward_max": -11066.084996155038, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11342.228963272515, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6305820398492905, "mean_inference_ms": 0.38339556701093885, "mean_action_processing_ms": 0.09267291364219946, "mean_env_wait_ms": 1.1534394230982323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037643909454345703, "StateBufferConnector_ms": 0.0027723312377929688, "ViewRequirementAgentConnector_ms": 0.06792783737182617}}, "episode_reward_max": -11066.084996155038, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11342.228963272515, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11440.077469375477, -11652.755564104496, -11482.614523468475, -11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6305820398492905, "mean_inference_ms": 0.38339556701093885, "mean_action_processing_ms": 0.09267291364219946, "mean_env_wait_ms": 1.1534394230982323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037643909454345703, "StateBufferConnector_ms": 0.0027723312377929688, "ViewRequirementAgentConnector_ms": 0.06792783737182617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 377520, "num_agent_steps_trained": 377520, "num_env_steps_sampled": 377520, "num_env_steps_trained": 377520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.32829740629286, "num_env_steps_trained_throughput_per_sec": 107.32829740629286, "timesteps_total": 377520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 377520, "timers": {"training_iteration_time_ms": 3369.392, "sample_time_ms": 3358.744, "load_time_ms": 0.3, "load_throughput": 1200564.077, "learn_time_ms": 9.59, "learn_throughput": 37539.547, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 377520, "num_env_steps_trained": 377520, "num_agent_steps_sampled": 377520, "num_agent_steps_trained": 377520}, "done": false, "episodes_total": 1582, "training_iteration": 392, "trial_id": "04904_00000", "date": "2023-07-26_22-41-35", "timestamp": 1690400495, "time_this_iter_s": 10.065371036529541, "time_total_s": 4281.575599431992, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2312.6237332820892, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 21.426666666666673, "ram_util_percent": 65.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.395703125, "policy_loss": -15525851273625.6, "vf_loss": 212327732.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3458.0, "diff_num_grad_updates_vs_sampler_policy": 3457.0}}, "num_env_steps_sampled": 378600, "num_env_steps_trained": 378600, "num_agent_steps_sampled": 378600, "num_agent_steps_trained": 378600}, "sampler_results": {"episode_reward_max": -11066.084996155038, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11338.007330931074, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630894113324214, "mean_inference_ms": 0.3833535312158187, "mean_action_processing_ms": 0.092665105808302, "mean_env_wait_ms": 1.1533766037147424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003762960433959961, "StateBufferConnector_ms": 0.002767324447631836, "ViewRequirementAgentConnector_ms": 0.0679025650024414}}, "episode_reward_max": -11066.084996155038, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11338.007330931074, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11474.176309253355, -11266.187031445443, -11427.73449241827, -11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.630894113324214, "mean_inference_ms": 0.3833535312158187, "mean_action_processing_ms": 0.092665105808302, "mean_env_wait_ms": 1.1533766037147424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003762960433959961, "StateBufferConnector_ms": 0.002767324447631836, "ViewRequirementAgentConnector_ms": 0.0679025650024414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378600, "num_agent_steps_trained": 378600, "num_env_steps_sampled": 378600, "num_env_steps_trained": 378600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.98213140197905, "num_env_steps_trained_throughput_per_sec": 106.98213140197905, "timesteps_total": 378600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 378600, "timers": {"training_iteration_time_ms": 3366.253, "sample_time_ms": 3355.602, "load_time_ms": 0.298, "load_throughput": 1209895.385, "learn_time_ms": 9.586, "learn_throughput": 37553.178, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 378600, "num_env_steps_trained": 378600, "num_agent_steps_sampled": 378600, "num_agent_steps_trained": 378600}, "done": false, "episodes_total": 1585, "training_iteration": 393, "trial_id": "04904_00000", "date": "2023-07-26_22-41-45", "timestamp": 1690400505, "time_this_iter_s": 10.097903728485107, "time_total_s": 4291.673503160477, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2322.7216370105743, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 18.021428571428572, "ram_util_percent": 65.70714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4608642578125, "policy_loss": -10222100337707.9, "vf_loss": 207052468.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3473.0, "diff_num_grad_updates_vs_sampler_policy": 3472.0}}, "num_env_steps_sampled": 379680, "num_env_steps_trained": 379680, "num_agent_steps_sampled": 379680, "num_agent_steps_trained": 379680}, "sampler_results": {"episode_reward_max": -11032.446953208406, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11333.462508337492, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631226240696792, "mean_inference_ms": 0.38331273669561805, "mean_action_processing_ms": 0.09265750034173026, "mean_env_wait_ms": 1.153306567870137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003763437271118164, "StateBufferConnector_ms": 0.00276947021484375, "ViewRequirementAgentConnector_ms": 0.06789231300354004}}, "episode_reward_max": -11032.446953208406, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11333.462508337492, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11527.385893436063, -11397.072665618418, -11242.659291185555, -11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631226240696792, "mean_inference_ms": 0.38331273669561805, "mean_action_processing_ms": 0.09265750034173026, "mean_env_wait_ms": 1.153306567870137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003763437271118164, "StateBufferConnector_ms": 0.00276947021484375, "ViewRequirementAgentConnector_ms": 0.06789231300354004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 379680, "num_agent_steps_trained": 379680, "num_env_steps_sampled": 379680, "num_env_steps_trained": 379680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.25965930886544, "num_env_steps_trained_throughput_per_sec": 106.25965930886544, "timesteps_total": 379680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 379680, "timers": {"training_iteration_time_ms": 3372.032, "sample_time_ms": 3361.412, "load_time_ms": 0.296, "load_throughput": 1214859.957, "learn_time_ms": 9.578, "learn_throughput": 37585.147, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 379680, "num_env_steps_trained": 379680, "num_agent_steps_sampled": 379680, "num_agent_steps_trained": 379680}, "done": false, "episodes_total": 1588, "training_iteration": 394, "trial_id": "04904_00000", "date": "2023-07-26_22-41-55", "timestamp": 1690400515, "time_this_iter_s": 10.166496992111206, "time_total_s": 4301.840000152588, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2332.8881340026855, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 17.635714285714283, "ram_util_percent": 65.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.5315673828125, "policy_loss": -30635688198144.0, "vf_loss": 214213657.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3488.0, "diff_num_grad_updates_vs_sampler_policy": 3487.0}}, "num_env_steps_sampled": 380760, "num_env_steps_trained": 380760, "num_agent_steps_sampled": 380760, "num_agent_steps_trained": 380760}, "sampler_results": {"episode_reward_max": -11032.446953208406, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11329.878159957696, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631563874446419, "mean_inference_ms": 0.3832728268097078, "mean_action_processing_ms": 0.09265003754604445, "mean_env_wait_ms": 1.1532396728336791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037641525268554688, "StateBufferConnector_ms": 0.002763032913208008, "ViewRequirementAgentConnector_ms": 0.06790685653686523}}, "episode_reward_max": -11032.446953208406, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11329.878159957696, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11148.73076867886, -11575.723725111346, -11641.043602246347, -11335.997893662505, -11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631563874446419, "mean_inference_ms": 0.3832728268097078, "mean_action_processing_ms": 0.09265003754604445, "mean_env_wait_ms": 1.1532396728336791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037641525268554688, "StateBufferConnector_ms": 0.002763032913208008, "ViewRequirementAgentConnector_ms": 0.06790685653686523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380760, "num_agent_steps_trained": 380760, "num_env_steps_sampled": 380760, "num_env_steps_trained": 380760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.42146949001243, "num_env_steps_trained_throughput_per_sec": 107.42146949001243, "timesteps_total": 380760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 380760, "timers": {"training_iteration_time_ms": 3365.695, "sample_time_ms": 3355.079, "load_time_ms": 0.296, "load_throughput": 1216719.936, "learn_time_ms": 9.575, "learn_throughput": 37596.658, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 380760, "num_env_steps_trained": 380760, "num_agent_steps_sampled": 380760, "num_agent_steps_trained": 380760}, "done": false, "episodes_total": 1591, "training_iteration": 395, "trial_id": "04904_00000", "date": "2023-07-26_22-42-05", "timestamp": 1690400525, "time_this_iter_s": 10.056766986846924, "time_total_s": 4311.896767139435, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2342.9449009895325, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 20.686666666666664, "ram_util_percent": 65.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4622314453125, "policy_loss": -17668409445580.8, "vf_loss": 214756528.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3508.0, "diff_num_grad_updates_vs_sampler_policy": 3507.0}}, "num_env_steps_sampled": 382200, "num_env_steps_trained": 382200, "num_agent_steps_sampled": 382200, "num_agent_steps_trained": 382200}, "sampler_results": {"episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11319.252487325042, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631992913541597, "mean_inference_ms": 0.38321631299370174, "mean_action_processing_ms": 0.09263924273305012, "mean_env_wait_ms": 1.1531224133538072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037589073181152344, "StateBufferConnector_ms": 0.002766847610473633, "ViewRequirementAgentConnector_ms": 0.0678713321685791}}, "episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11319.252487325042, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11429.091887637473, -11319.950863991024, -11469.702794697572, -11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.631992913541597, "mean_inference_ms": 0.38321631299370174, "mean_action_processing_ms": 0.09263924273305012, "mean_env_wait_ms": 1.1531224133538072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037589073181152344, "StateBufferConnector_ms": 0.002766847610473633, "ViewRequirementAgentConnector_ms": 0.0678713321685791}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 382200, "num_agent_steps_trained": 382200, "num_env_steps_sampled": 382200, "num_env_steps_trained": 382200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 107.98416913375846, "num_env_steps_trained_throughput_per_sec": 107.98416913375846, "timesteps_total": 382200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 382200, "timers": {"training_iteration_time_ms": 3355.28, "sample_time_ms": 3344.684, "load_time_ms": 0.296, "load_throughput": 1216916.054, "learn_time_ms": 9.564, "learn_throughput": 37640.989, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 382200, "num_env_steps_trained": 382200, "num_agent_steps_sampled": 382200, "num_agent_steps_trained": 382200}, "done": false, "episodes_total": 1595, "training_iteration": 396, "trial_id": "04904_00000", "date": "2023-07-26_22-42-19", "timestamp": 1690400539, "time_this_iter_s": 13.338173866271973, "time_total_s": 4325.234941005707, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2356.2830748558044, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 19.531578947368423, "ram_util_percent": 65.80526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.40712890625, "policy_loss": -14390648792678.4, "vf_loss": 218572656.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3523.0, "diff_num_grad_updates_vs_sampler_policy": 3522.0}}, "num_env_steps_sampled": 383280, "num_env_steps_trained": 383280, "num_agent_steps_sampled": 383280, "num_agent_steps_trained": 383280}, "sampler_results": {"episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11318.591217545856, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632290372128491, "mean_inference_ms": 0.38316697819913825, "mean_action_processing_ms": 0.09262961319462874, "mean_env_wait_ms": 1.1530152838283778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037012100219726562, "StateBufferConnector_ms": 0.0027256011962890625, "ViewRequirementAgentConnector_ms": 0.06680941581726074}}, "episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11318.591217545856, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11436.199689209892, -11318.204155094509, -11535.431254532767, -11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632290372128491, "mean_inference_ms": 0.38316697819913825, "mean_action_processing_ms": 0.09262961319462874, "mean_env_wait_ms": 1.1530152838283778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037012100219726562, "StateBufferConnector_ms": 0.0027256011962890625, "ViewRequirementAgentConnector_ms": 0.06680941581726074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 383280, "num_agent_steps_trained": 383280, "num_env_steps_sampled": 383280, "num_env_steps_trained": 383280, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.58891393311212, "num_env_steps_trained_throughput_per_sec": 107.58891393311212, "timesteps_total": 383280, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 383280, "timers": {"training_iteration_time_ms": 3342.722, "sample_time_ms": 3332.099, "load_time_ms": 0.298, "load_throughput": 1209217.138, "learn_time_ms": 9.582, "learn_throughput": 37572.24, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 383280, "num_env_steps_trained": 383280, "num_agent_steps_sampled": 383280, "num_agent_steps_trained": 383280}, "done": false, "episodes_total": 1598, "training_iteration": 397, "trial_id": "04904_00000", "date": "2023-07-26_22-42-29", "timestamp": 1690400549, "time_this_iter_s": 10.041168212890625, "time_total_s": 4335.276109218597, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2366.324243068695, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 20.585714285714285, "ram_util_percent": 65.76428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.433740234375, "policy_loss": -29294688154419.2, "vf_loss": 219733084.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3538.0, "diff_num_grad_updates_vs_sampler_policy": 3537.0}}, "num_env_steps_sampled": 384360, "num_env_steps_trained": 384360, "num_agent_steps_sampled": 384360, "num_agent_steps_trained": 384360}, "sampler_results": {"episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11317.66800027288, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632598504517516, "mean_inference_ms": 0.38311824692545626, "mean_action_processing_ms": 0.09262008402451859, "mean_env_wait_ms": 1.1529123668836703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.002731800079345703, "ViewRequirementAgentConnector_ms": 0.06682634353637695}}, "episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11317.66800027288, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11460.745236706567, -11594.128165545886, -11392.786643606376, -11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632598504517516, "mean_inference_ms": 0.38311824692545626, "mean_action_processing_ms": 0.09262008402451859, "mean_env_wait_ms": 1.1529123668836703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.002731800079345703, "ViewRequirementAgentConnector_ms": 0.06682634353637695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384360, "num_agent_steps_trained": 384360, "num_env_steps_sampled": 384360, "num_env_steps_trained": 384360, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.18519763942167, "num_env_steps_trained_throughput_per_sec": 106.18519763942167, "timesteps_total": 384360, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 384360, "timers": {"training_iteration_time_ms": 3354.428, "sample_time_ms": 3343.831, "load_time_ms": 0.297, "load_throughput": 1211059.865, "learn_time_ms": 9.55, "learn_throughput": 37694.55, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 384360, "num_env_steps_trained": 384360, "num_agent_steps_sampled": 384360, "num_agent_steps_trained": 384360}, "done": false, "episodes_total": 1601, "training_iteration": 398, "trial_id": "04904_00000", "date": "2023-07-26_22-42-39", "timestamp": 1690400559, "time_this_iter_s": 10.1736900806427, "time_total_s": 4345.44979929924, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2376.4979331493378, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 20.87142857142857, "ram_util_percent": 65.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3549560546876, "policy_loss": -14944120655052.8, "vf_loss": 210772281.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3553.0, "diff_num_grad_updates_vs_sampler_policy": 3552.0}}, "num_env_steps_sampled": 385440, "num_env_steps_trained": 385440, "num_agent_steps_sampled": 385440, "num_agent_steps_trained": 385440}, "sampler_results": {"episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11309.66779933764, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632901166487195, "mean_inference_ms": 0.3830696773070857, "mean_action_processing_ms": 0.09261063364910008, "mean_env_wait_ms": 1.1527980977466288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037000179290771484, "StateBufferConnector_ms": 0.0027327537536621094, "ViewRequirementAgentConnector_ms": 0.06682872772216797}}, "episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11309.66779933764, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11391.71071682814, -11332.812554659367, -11528.652311223934, -11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.632901166487195, "mean_inference_ms": 0.3830696773070857, "mean_action_processing_ms": 0.09261063364910008, "mean_env_wait_ms": 1.1527980977466288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037000179290771484, "StateBufferConnector_ms": 0.0027327537536621094, "ViewRequirementAgentConnector_ms": 0.06682872772216797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 385440, "num_agent_steps_trained": 385440, "num_env_steps_sampled": 385440, "num_env_steps_trained": 385440, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.41545794343635, "num_env_steps_trained_throughput_per_sec": 107.41545794343635, "timesteps_total": 385440, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 385440, "timers": {"training_iteration_time_ms": 3364.652, "sample_time_ms": 3354.108, "load_time_ms": 0.297, "load_throughput": 1211740.181, "learn_time_ms": 9.5, "learn_throughput": 37893.965, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 385440, "num_env_steps_trained": 385440, "num_agent_steps_sampled": 385440, "num_agent_steps_trained": 385440}, "done": false, "episodes_total": 1604, "training_iteration": 399, "trial_id": "04904_00000", "date": "2023-07-26_22-42-49", "timestamp": 1690400569, "time_this_iter_s": 10.056865930557251, "time_total_s": 4355.506665229797, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2386.554799079895, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 21.826666666666668, "ram_util_percent": 66.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.51259765625, "policy_loss": -16208846598963.2, "vf_loss": 213070888.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3568.0, "diff_num_grad_updates_vs_sampler_policy": 3567.0}}, "num_env_steps_sampled": 386520, "num_env_steps_trained": 386520, "num_agent_steps_sampled": 386520, "num_agent_steps_trained": 386520}, "sampler_results": {"episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11305.313908486372, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63319003783228, "mean_inference_ms": 0.38302169183105456, "mean_action_processing_ms": 0.0926013165787026, "mean_env_wait_ms": 1.1526755293016069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002725839614868164, "ViewRequirementAgentConnector_ms": 0.06681370735168457}}, "episode_reward_max": -11007.774447110976, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11305.313908486372, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11340.607385113437, -11500.393401741587, -11367.511147804054, -11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63319003783228, "mean_inference_ms": 0.38302169183105456, "mean_action_processing_ms": 0.0926013165787026, "mean_env_wait_ms": 1.1526755293016069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002725839614868164, "ViewRequirementAgentConnector_ms": 0.06681370735168457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 386520, "num_agent_steps_trained": 386520, "num_env_steps_sampled": 386520, "num_env_steps_trained": 386520, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.46343404567924, "num_env_steps_trained_throughput_per_sec": 107.46343404567924, "timesteps_total": 386520, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 386520, "timers": {"training_iteration_time_ms": 3355.439, "sample_time_ms": 3344.863, "load_time_ms": 0.298, "load_throughput": 1207766.309, "learn_time_ms": 9.525, "learn_throughput": 37795.603, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 386520, "num_env_steps_trained": 386520, "num_agent_steps_sampled": 386520, "num_agent_steps_trained": 386520}, "done": false, "episodes_total": 1607, "training_iteration": 400, "trial_id": "04904_00000", "date": "2023-07-26_22-42-59", "timestamp": 1690400579, "time_this_iter_s": 10.052910089492798, "time_total_s": 4365.55957531929, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2396.607709169388, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 20.678571428571427, "ram_util_percent": 65.9142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4262451171876, "policy_loss": -21656377806028.8, "vf_loss": 218528814.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3583.0, "diff_num_grad_updates_vs_sampler_policy": 3582.0}}, "num_env_steps_sampled": 387600, "num_env_steps_trained": 387600, "num_agent_steps_sampled": 387600, "num_agent_steps_trained": 387600}, "sampler_results": {"episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11300.297909886951, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.633492371737681, "mean_inference_ms": 0.38297374953913604, "mean_action_processing_ms": 0.09259194120867394, "mean_env_wait_ms": 1.152528339480648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003702878952026367, "StateBufferConnector_ms": 0.00272369384765625, "ViewRequirementAgentConnector_ms": 0.06679272651672363}}, "episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11300.297909886951, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11335.285051621939, -11225.309303580583, -11357.980694636934, -11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.633492371737681, "mean_inference_ms": 0.38297374953913604, "mean_action_processing_ms": 0.09259194120867394, "mean_env_wait_ms": 1.152528339480648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003702878952026367, "StateBufferConnector_ms": 0.00272369384765625, "ViewRequirementAgentConnector_ms": 0.06679272651672363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 387600, "num_agent_steps_trained": 387600, "num_env_steps_sampled": 387600, "num_env_steps_trained": 387600, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.4183286277155, "num_env_steps_trained_throughput_per_sec": 107.4183286277155, "timesteps_total": 387600, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 387600, "timers": {"training_iteration_time_ms": 3350.537, "sample_time_ms": 3340.0, "load_time_ms": 0.297, "load_throughput": 1213883.303, "learn_time_ms": 9.491, "learn_throughput": 37931.376, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 387600, "num_env_steps_trained": 387600, "num_agent_steps_sampled": 387600, "num_agent_steps_trained": 387600}, "done": false, "episodes_total": 1610, "training_iteration": 401, "trial_id": "04904_00000", "date": "2023-07-26_22-43-09", "timestamp": 1690400589, "time_this_iter_s": 10.056847095489502, "time_total_s": 4375.61642241478, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2406.6645562648773, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 18.071428571428573, "ram_util_percent": 65.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.5763916015626, "policy_loss": -17950678161817.6, "vf_loss": 223589534.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3598.0, "diff_num_grad_updates_vs_sampler_policy": 3597.0}}, "num_env_steps_sampled": 388680, "num_env_steps_trained": 388680, "num_agent_steps_sampled": 388680, "num_agent_steps_trained": 388680}, "sampler_results": {"episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11304.794617216177, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63380202139356, "mean_inference_ms": 0.38292677934540825, "mean_action_processing_ms": 0.09258270230176008, "mean_env_wait_ms": 1.1523784252390903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037055015563964844, "StateBufferConnector_ms": 0.0027234554290771484, "ViewRequirementAgentConnector_ms": 0.0668039321899414}}, "episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11304.794617216177, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11095.204791575768, -11215.614043801388, -11271.658630083479, -11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.63380202139356, "mean_inference_ms": 0.38292677934540825, "mean_action_processing_ms": 0.09258270230176008, "mean_env_wait_ms": 1.1523784252390903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037055015563964844, "StateBufferConnector_ms": 0.0027234554290771484, "ViewRequirementAgentConnector_ms": 0.0668039321899414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388680, "num_agent_steps_trained": 388680, "num_env_steps_sampled": 388680, "num_env_steps_trained": 388680, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.32554225025618, "num_env_steps_trained_throughput_per_sec": 106.32554225025618, "timesteps_total": 388680, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 388680, "timers": {"training_iteration_time_ms": 3363.746, "sample_time_ms": 3353.223, "load_time_ms": 0.296, "load_throughput": 1215446.704, "learn_time_ms": 9.486, "learn_throughput": 37952.064, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 388680, "num_env_steps_trained": 388680, "num_agent_steps_sampled": 388680, "num_agent_steps_trained": 388680}, "done": false, "episodes_total": 1613, "training_iteration": 402, "trial_id": "04904_00000", "date": "2023-07-26_22-43-19", "timestamp": 1690400599, "time_this_iter_s": 10.160287141799927, "time_total_s": 4385.77670955658, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2416.8248434066772, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 19.507142857142856, "ram_util_percent": 65.75714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.430419921875, "policy_loss": -25500038935347.2, "vf_loss": 205588883.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3613.0, "diff_num_grad_updates_vs_sampler_policy": 3612.0}}, "num_env_steps_sampled": 389760, "num_env_steps_trained": 389760, "num_agent_steps_sampled": 389760, "num_agent_steps_trained": 389760}, "sampler_results": {"episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11304.288616764037, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637, -11015.817924659359, -11301.48088750043, -11214.578608086886], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634095786018857, "mean_inference_ms": 0.3828805074365882, "mean_action_processing_ms": 0.09257353464711598, "mean_env_wait_ms": 1.152243662591092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037119388580322266, "StateBufferConnector_ms": 0.0027213096618652344, "ViewRequirementAgentConnector_ms": 0.06677055358886719}}, "episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11304.288616764037, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11447.5826940438, -11076.716924936163, -11137.512303964459, -11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637, -11015.817924659359, -11301.48088750043, -11214.578608086886], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634095786018857, "mean_inference_ms": 0.3828805074365882, "mean_action_processing_ms": 0.09257353464711598, "mean_env_wait_ms": 1.152243662591092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037119388580322266, "StateBufferConnector_ms": 0.0027213096618652344, "ViewRequirementAgentConnector_ms": 0.06677055358886719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 389760, "num_agent_steps_trained": 389760, "num_env_steps_sampled": 389760, "num_env_steps_trained": 389760, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 107.46851523763591, "num_env_steps_trained_throughput_per_sec": 107.46851523763591, "timesteps_total": 389760, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 389760, "timers": {"training_iteration_time_ms": 3354.767, "sample_time_ms": 3344.309, "load_time_ms": 0.295, "load_throughput": 1220259.77, "learn_time_ms": 9.427, "learn_throughput": 38186.352, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 389760, "num_env_steps_trained": 389760, "num_agent_steps_sampled": 389760, "num_agent_steps_trained": 389760}, "done": false, "episodes_total": 1616, "training_iteration": 403, "trial_id": "04904_00000", "date": "2023-07-26_22-43-29", "timestamp": 1690400609, "time_this_iter_s": 10.0523099899292, "time_total_s": 4395.829019546509, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2426.8771533966064, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 20.186666666666664, "ram_util_percent": 65.54666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.4010009765625, "policy_loss": -18995812394598.4, "vf_loss": 216344265.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3628.0, "diff_num_grad_updates_vs_sampler_policy": 3627.0}}, "num_env_steps_sampled": 390840, "num_env_steps_trained": 390840, "num_agent_steps_sampled": 390840, "num_agent_steps_trained": 390840}, "sampler_results": {"episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11307.87888195815, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637, -11015.817924659359, -11301.48088750043, -11214.578608086886, -11347.497695290826, -11280.445305307147, -11392.895441758035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634411482860891, "mean_inference_ms": 0.38283493748769104, "mean_action_processing_ms": 0.09256449041882284, "mean_env_wait_ms": 1.1521365394641974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003715038299560547, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.06681013107299805}}, "episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11307.87888195815, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11172.828136141234, -11446.846849046164, -11443.159743341608, -11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637, -11015.817924659359, -11301.48088750043, -11214.578608086886, -11347.497695290826, -11280.445305307147, -11392.895441758035], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.634411482860891, "mean_inference_ms": 0.38283493748769104, "mean_action_processing_ms": 0.09256449041882284, "mean_env_wait_ms": 1.1521365394641974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003715038299560547, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.06681013107299805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 390840, "num_agent_steps_trained": 390840, "num_env_steps_sampled": 390840, "num_env_steps_trained": 390840, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.77485407017988, "num_env_steps_trained_throughput_per_sec": 105.77485407017988, "timesteps_total": 390840, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 390840, "timers": {"training_iteration_time_ms": 3375.181, "sample_time_ms": 3364.612, "load_time_ms": 0.296, "load_throughput": 1216916.054, "learn_time_ms": 9.527, "learn_throughput": 37788.414, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 390840, "num_env_steps_trained": 390840, "num_agent_steps_sampled": 390840, "num_agent_steps_trained": 390840}, "done": false, "episodes_total": 1619, "training_iteration": 404, "trial_id": "04904_00000", "date": "2023-07-26_22-43-40", "timestamp": 1690400620, "time_this_iter_s": 10.213374853134155, "time_total_s": 4406.042394399643, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2437.0905282497406, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 18.814285714285713, "ram_util_percent": 65.58571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3415771484374, "policy_loss": -13481343555993.6, "vf_loss": 208802257.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3643.0, "diff_num_grad_updates_vs_sampler_policy": 3642.0}}, "num_env_steps_sampled": 391920, "num_env_steps_trained": 391920, "num_agent_steps_sampled": 391920, "num_agent_steps_trained": 391920}, "sampler_results": {"episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11308.704892547652, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637, -11015.817924659359, -11301.48088750043, -11214.578608086886, -11347.497695290826, -11280.445305307147, -11392.895441758035, -11453.70231835915, -11551.01587669211, -11140.717592427693], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6347253524053125, "mean_inference_ms": 0.3827894138211025, "mean_action_processing_ms": 0.09255541984644973, "mean_env_wait_ms": 1.1520281721429462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003715991973876953, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.0667872428894043}}, "episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11308.704892547652, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11390.235445943206, -11209.208798620735, -11205.382901106563, -11482.718292764603, -11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637, -11015.817924659359, -11301.48088750043, -11214.578608086886, -11347.497695290826, -11280.445305307147, -11392.895441758035, -11453.70231835915, -11551.01587669211, -11140.717592427693], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6347253524053125, "mean_inference_ms": 0.3827894138211025, "mean_action_processing_ms": 0.09255541984644973, "mean_env_wait_ms": 1.1520281721429462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003715991973876953, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.0667872428894043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 391920, "num_agent_steps_trained": 391920, "num_env_steps_sampled": 391920, "num_env_steps_trained": 391920, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 106.69363947063863, "num_env_steps_trained_throughput_per_sec": 106.69363947063863, "timesteps_total": 391920, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 391920, "timers": {"training_iteration_time_ms": 3377.654, "sample_time_ms": 3367.016, "load_time_ms": 0.295, "load_throughput": 1220259.77, "learn_time_ms": 9.601, "learn_throughput": 37497.13, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 391920, "num_env_steps_trained": 391920, "num_agent_steps_sampled": 391920, "num_agent_steps_trained": 391920}, "done": false, "episodes_total": 1622, "training_iteration": 405, "trial_id": "04904_00000", "date": "2023-07-26_22-43-50", "timestamp": 1690400630, "time_this_iter_s": 10.125278949737549, "time_total_s": 4416.1676733493805, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2447.215807199478, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 19.09333333333333, "ram_util_percent": 65.65333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": -1186.3707763671875, "policy_loss": -29923255464755.2, "vf_loss": 222722361.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3663.0, "diff_num_grad_updates_vs_sampler_policy": 3662.0}}, "num_env_steps_sampled": 393360, "num_env_steps_trained": 393360, "num_agent_steps_sampled": 393360, "num_agent_steps_trained": 393360}, "sampler_results": {"episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11310.252340702875, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637, -11015.817924659359, -11301.48088750043, -11214.578608086886, -11347.497695290826, -11280.445305307147, -11392.895441758035, -11453.70231835915, -11551.01587669211, -11140.717592427693, -11229.6535390407, -11267.061568479385, -11377.497941832371, -11568.07720460516], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635134949809383, "mean_inference_ms": 0.3827292381694674, "mean_action_processing_ms": 0.09254333119104363, "mean_env_wait_ms": 1.151883392410291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003713846206665039, "StateBufferConnector_ms": 0.0027124881744384766, "ViewRequirementAgentConnector_ms": 0.06680011749267578}}, "episode_reward_max": -10970.06994570255, "episode_reward_min": -11671.729945847226, "episode_reward_mean": -11310.252340702875, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11316.41913362376, -11335.813391426249, -11313.634259708126, -11564.964490020098, -11429.226368045365, -11294.519323063681, -11500.871692735136, -11635.292518626224, -11066.084996155038, -11095.06568106313, -11135.86246862358, -11162.98952365823, -11310.344688728554, -11460.609895097277, -11130.49823009739, -11421.164755976122, -11111.412019246733, -11671.729945847226, -11250.434272562108, -11545.193164758002, -11269.462195778018, -11450.217603215086, -11270.777178771032, -11448.29916154738, -11391.861566709393, -11351.578819172977, -11209.16390903181, -11073.544727162362, -11387.439043013394, -11073.424802096724, -11313.471509052528, -11246.799706364787, -11368.256474859876, -11325.502688271525, -11256.127269290677, -11271.786938592686, -11396.742643387832, -11423.382524871233, -11219.198911347677, -11285.262142564137, -11181.646351692883, -11390.026102378442, -11230.167278755862, -11403.57589284724, -11072.304067761244, -11635.534475085287, -11530.63539766772, -11245.642154301087, -11114.43383693481, -11235.207093754672, -11249.434311328563, -11347.176301842654, -11227.096401103236, -11577.352443362282, -11184.264962786367, -11270.636577879965, -11521.728741057512, -11383.065202534175, -11248.490379212808, -11032.446953208406, -11482.157058746907, -11199.01156180331, -11193.275065854888, -11231.000801954428, -11384.40714445158, -11007.774447110976, -11028.688822578375, -11283.5600810741, -11318.905375670161, -11461.321283464225, -11231.974461687307, -11459.322823255749, -11359.210669651125, -11362.481645994802, -11475.821055893888, -11440.516025909936, -11090.103641191929, -11117.020285232937, -11413.735111386353, -11181.987256424043, -11222.06412977441, -11441.514441433827, -10970.06994570255, -11295.327687580462, -11322.016896379122, -11452.48709712315, -11593.741789259637, -11015.817924659359, -11301.48088750043, -11214.578608086886, -11347.497695290826, -11280.445305307147, -11392.895441758035, -11453.70231835915, -11551.01587669211, -11140.717592427693, -11229.6535390407, -11267.061568479385, -11377.497941832371, -11568.07720460516], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.635134949809383, "mean_inference_ms": 0.3827292381694674, "mean_action_processing_ms": 0.09254333119104363, "mean_env_wait_ms": 1.151883392410291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003713846206665039, "StateBufferConnector_ms": 0.0027124881744384766, "ViewRequirementAgentConnector_ms": 0.06680011749267578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 393360, "num_agent_steps_trained": 393360, "num_env_steps_sampled": 393360, "num_env_steps_trained": 393360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 106.95624303687559, "num_env_steps_trained_throughput_per_sec": 106.95624303687559, "timesteps_total": 393360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 393360, "timers": {"training_iteration_time_ms": 3379.612, "sample_time_ms": 3368.945, "load_time_ms": 0.297, "load_throughput": 1210089.309, "learn_time_ms": 9.627, "learn_throughput": 37396.183, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 393360, "num_env_steps_trained": 393360, "num_agent_steps_sampled": 393360, "num_agent_steps_trained": 393360}, "done": true, "episodes_total": 1626, "training_iteration": 406, "trial_id": "04904_00000", "date": "2023-07-26_22-44-03", "timestamp": 1690400643, "time_this_iter_s": 13.466338157653809, "time_total_s": 4429.634011507034, "pid": 12914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[130559, 5e-05], [135959, 8e-05], [141359, 2.5e-05], [146759, 2.5e-05], [152159, 2.5e-05], [157559, 2.5e-05], [162959, 1e-05], [168359, 1e-05], [173759, 1e-05], [179159, 5e-06], [184559, 5e-06], [189959, 5e-06], [195359, 5e-06], [200759, 1e-06], [206159, 1e-06], [211559, 1e-06], [216959, 1e-06], [222359, 5e-07], [227759, 5e-07], [233159, 2.5e-07], [238559, 2.5e-07], [243959, 1e-08], [249359, 1e-08], [254759, 5e-09], [260159, 5e-09], [265559, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 132899}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3189789d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2460.682145357132, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 19.905263157894737, "ram_util_percent": 65.63684210526316}}
