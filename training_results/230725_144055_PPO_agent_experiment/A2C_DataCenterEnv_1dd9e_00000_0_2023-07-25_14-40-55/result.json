{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.300000000000001e-05, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.2612609863281, "policy_loss": 1031863352494882.4, "vf_loss": 94983533772.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25.5, "diff_num_grad_updates_vs_sampler_policy": 24.5}}, "num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880}, "sampler_results": {"episode_reward_max": 692305.6844704272, "episode_reward_min": 691933.8723594593, "episode_reward_mean": 692180.9325315068, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593], "episode_lengths": [1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4033169919866484, "mean_inference_ms": 0.2402958688521445, "mean_action_processing_ms": 0.05842850824688184, "mean_env_wait_ms": 1.4187789764446672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005396207173665364, "StateBufferConnector_ms": 0.0016768773396809895, "ViewRequirementAgentConnector_ms": 0.04401206970214844}}, "episode_reward_max": 692305.6844704272, "episode_reward_min": 691933.8723594593, "episode_reward_mean": 692180.9325315068, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593], "episode_lengths": [1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4033169919866484, "mean_inference_ms": 0.2402958688521445, "mean_action_processing_ms": 0.05842850824688184, "mean_env_wait_ms": 1.4187789764446672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005396207173665364, "StateBufferConnector_ms": 0.0016768773396809895, "ViewRequirementAgentConnector_ms": 0.04401206970214844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880, "num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 317.39286870015803, "num_env_steps_trained_throughput_per_sec": 317.39286870015803, "timesteps_total": 5102880, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5102880, "timers": {"training_iteration_time_ms": 3780.791, "sample_time_ms": 3763.482, "load_time_ms": 0.377, "load_throughput": 3182861.383, "learn_time_ms": 16.329, "learn_throughput": 73489.017, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880}, "done": false, "episodes_total": 1212, "training_iteration": 581, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-41-11", "timestamp": 1690285271, "time_this_iter_s": 11.344337940216064, "time_total_s": 10190.975881576538, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.344337940216064, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.682352941176468, "ram_util_percent": 79.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.7e-05, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3796020507813, "policy_loss": 100013175745449.6, "vf_loss": 94991568076.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 65.5, "diff_num_grad_updates_vs_sampler_policy": 64.5}}, "num_env_steps_sampled": 5107680, "num_env_steps_trained": 5107680, "num_agent_steps_sampled": 5107680, "num_agent_steps_trained": 5107680}, "sampler_results": {"episode_reward_max": 692305.6844704272, "episode_reward_min": 691933.8723594593, "episode_reward_mean": 692115.5905642576, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4125201064574509, "mean_inference_ms": 0.23977702418226338, "mean_action_processing_ms": 0.058309584878013805, "mean_env_wait_ms": 1.2552113746786941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004717281886509487, "StateBufferConnector_ms": 0.0016484941755022322, "ViewRequirementAgentConnector_ms": 0.04355566842215402}}, "episode_reward_max": 692305.6844704272, "episode_reward_min": 691933.8723594593, "episode_reward_mean": 692115.5905642576, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4125201064574509, "mean_inference_ms": 0.23977702418226338, "mean_action_processing_ms": 0.058309584878013805, "mean_env_wait_ms": 1.2552113746786941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004717281886509487, "StateBufferConnector_ms": 0.0016484941755022322, "ViewRequirementAgentConnector_ms": 0.04355566842215402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5107680, "num_agent_steps_trained": 5107680, "num_env_steps_sampled": 5107680, "num_env_steps_trained": 5107680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 374.15123351106297, "num_env_steps_trained_throughput_per_sec": 374.15123351106297, "timesteps_total": 5107680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5107680, "timers": {"training_iteration_time_ms": 3453.052, "sample_time_ms": 3437.481, "load_time_ms": 0.409, "load_throughput": 2936746.987, "learn_time_ms": 14.523, "learn_throughput": 82628.358, "synch_weights_time_ms": 0.605}, "counters": {"num_env_steps_sampled": 5107680, "num_env_steps_trained": 5107680, "num_agent_steps_sampled": 5107680, "num_agent_steps_trained": 5107680}, "done": false, "episodes_total": 1216, "training_iteration": 582, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-41-23", "timestamp": 1690285283, "time_this_iter_s": 12.831847190856934, "time_total_s": 10203.807728767395, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 24.176185131072998, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.899999999999995, "ram_util_percent": 79.12777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.6666666666666665e-05, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0969787597656, "policy_loss": 36181318958496.8, "vf_loss": 95105055129.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 104.5}}, "num_env_steps_sampled": 5112480, "num_env_steps_trained": 5112480, "num_agent_steps_sampled": 5112480, "num_agent_steps_trained": 5112480}, "sampler_results": {"episode_reward_max": 692367.3877969892, "episode_reward_min": 691933.8723594593, "episode_reward_mean": 692154.4912722469, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.414880141494509, "mean_inference_ms": 0.2405318162791253, "mean_action_processing_ms": 0.058462411961579315, "mean_env_wait_ms": 1.1828927841395824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004410743713378906, "StateBufferConnector_ms": 0.001712278886274858, "ViewRequirementAgentConnector_ms": 0.044120441783558235}}, "episode_reward_max": 692367.3877969892, "episode_reward_min": 691933.8723594593, "episode_reward_mean": 692154.4912722469, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.414880141494509, "mean_inference_ms": 0.2405318162791253, "mean_action_processing_ms": 0.058462411961579315, "mean_env_wait_ms": 1.1828927841395824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004410743713378906, "StateBufferConnector_ms": 0.001712278886274858, "ViewRequirementAgentConnector_ms": 0.044120441783558235}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5112480, "num_agent_steps_trained": 5112480, "num_env_steps_sampled": 5112480, "num_env_steps_trained": 5112480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 373.906115270894, "num_env_steps_trained_throughput_per_sec": 373.906115270894, "timesteps_total": 5112480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5112480, "timers": {"training_iteration_time_ms": 3196.375, "sample_time_ms": 3182.343, "load_time_ms": 0.418, "load_throughput": 2872155.216, "learn_time_ms": 12.965, "learn_throughput": 92554.078, "synch_weights_time_ms": 0.612}, "counters": {"num_env_steps_sampled": 5112480, "num_env_steps_trained": 5112480, "num_agent_steps_sampled": 5112480, "num_agent_steps_trained": 5112480}, "done": false, "episodes_total": 1220, "training_iteration": 583, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-41-36", "timestamp": 1690285296, "time_this_iter_s": 12.840136051177979, "time_total_s": 10216.647864818573, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 37.01632118225098, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.983333333333334, "ram_util_percent": 79.79444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8e-05, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.2866027832031, "policy_loss": 39180129511283.2, "vf_loss": 95050543923.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 145.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280}, "sampler_results": {"episode_reward_max": 692367.9563616116, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692126.3913908763, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4168510708758673, "mean_inference_ms": 0.2415849076395126, "mean_action_processing_ms": 0.058685991948083556, "mean_env_wait_ms": 1.1402547520625723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038989384969075522, "StateBufferConnector_ms": 0.001705487569173177, "ViewRequirementAgentConnector_ms": 0.04546642303466797}}, "episode_reward_max": 692367.9563616116, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692126.3913908763, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4168510708758673, "mean_inference_ms": 0.2415849076395126, "mean_action_processing_ms": 0.058685991948083556, "mean_env_wait_ms": 1.1402547520625723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038989384969075522, "StateBufferConnector_ms": 0.001705487569173177, "ViewRequirementAgentConnector_ms": 0.04546642303466797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280, "num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 370.1441148599079, "num_env_steps_trained_throughput_per_sec": 370.1441148599079, "timesteps_total": 5117280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5117280, "timers": {"training_iteration_time_ms": 3235.129, "sample_time_ms": 3220.878, "load_time_ms": 0.421, "load_throughput": 2851166.827, "learn_time_ms": 13.142, "learn_throughput": 91308.221, "synch_weights_time_ms": 0.651}, "counters": {"num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280}, "done": false, "episodes_total": 1224, "training_iteration": 584, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-41-49", "timestamp": 1690285309, "time_this_iter_s": 12.970040082931519, "time_total_s": 10229.617904901505, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 49.986361265182495, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.126315789473683, "ram_util_percent": 79.89473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.000000000000001e-06, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.324609375, "policy_loss": 279741689109.2, "vf_loss": 95033755238.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 185.5, "diff_num_grad_updates_vs_sampler_policy": 184.5}}, "num_env_steps_sampled": 5122080, "num_env_steps_trained": 5122080, "num_agent_steps_sampled": 5122080, "num_agent_steps_trained": 5122080}, "sampler_results": {"episode_reward_max": 692538.9225289184, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692158.6731775951, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4176860199222094, "mean_inference_ms": 0.2424579619399131, "mean_action_processing_ms": 0.058871676749495123, "mean_env_wait_ms": 1.1117369599458693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035825528596576894, "StateBufferConnector_ms": 0.0017178686041581003, "ViewRequirementAgentConnector_ms": 0.04564460955168072}}, "episode_reward_max": 692538.9225289184, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692158.6731775951, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4176860199222094, "mean_inference_ms": 0.2424579619399131, "mean_action_processing_ms": 0.058871676749495123, "mean_env_wait_ms": 1.1117369599458693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035825528596576894, "StateBufferConnector_ms": 0.0017178686041581003, "ViewRequirementAgentConnector_ms": 0.04564460955168072}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5122080, "num_agent_steps_trained": 5122080, "num_env_steps_sampled": 5122080, "num_env_steps_trained": 5122080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 371.89462042637655, "num_env_steps_trained_throughput_per_sec": 371.89462042637655, "timesteps_total": 5122080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5122080, "timers": {"training_iteration_time_ms": 3232.181, "sample_time_ms": 3218.098, "load_time_ms": 0.457, "load_throughput": 2623899.906, "learn_time_ms": 12.93, "learn_throughput": 92804.431, "synch_weights_time_ms": 0.645}, "counters": {"num_env_steps_sampled": 5122080, "num_env_steps_trained": 5122080, "num_agent_steps_sampled": 5122080, "num_agent_steps_trained": 5122080}, "done": false, "episodes_total": 1228, "training_iteration": 585, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-42-02", "timestamp": 1690285322, "time_this_iter_s": 12.909502983093262, "time_total_s": 10242.527407884598, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 62.89586424827576, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.38888888888889, "ram_util_percent": 79.24444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666667e-06, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3243347167969, "policy_loss": 1050168264330.8, "vf_loss": 95147725209.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 5126880, "num_env_steps_trained": 5126880, "num_agent_steps_sampled": 5126880, "num_agent_steps_trained": 5126880}, "sampler_results": {"episode_reward_max": 692629.9904760376, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692207.20477861, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.418458543570025, "mean_inference_ms": 0.24325978073450177, "mean_action_processing_ms": 0.05903543823689882, "mean_env_wait_ms": 1.0913653583237986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033368235049040422, "StateBufferConnector_ms": 0.001717650372049083, "ViewRequirementAgentConnector_ms": 0.045640572257663894}}, "episode_reward_max": 692629.9904760376, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692207.20477861, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.418458543570025, "mean_inference_ms": 0.24325978073450177, "mean_action_processing_ms": 0.05903543823689882, "mean_env_wait_ms": 1.0913653583237986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033368235049040422, "StateBufferConnector_ms": 0.001717650372049083, "ViewRequirementAgentConnector_ms": 0.045640572257663894}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5126880, "num_agent_steps_trained": 5126880, "num_env_steps_sampled": 5126880, "num_env_steps_trained": 5126880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 368.35799389715265, "num_env_steps_trained_throughput_per_sec": 368.35799389715265, "timesteps_total": 5126880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5126880, "timers": {"training_iteration_time_ms": 3241.124, "sample_time_ms": 3227.751, "load_time_ms": 0.475, "load_throughput": 2527196.626, "learn_time_ms": 12.194, "learn_throughput": 98405.481, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 5126880, "num_env_steps_trained": 5126880, "num_agent_steps_sampled": 5126880, "num_agent_steps_trained": 5126880}, "done": false, "episodes_total": 1232, "training_iteration": 586, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-42-15", "timestamp": 1690285335, "time_this_iter_s": 13.0327889919281, "time_total_s": 10255.560196876526, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 75.92865324020386, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.25789473684211, "ram_util_percent": 78.8157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8000000000000001e-06, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3240295410156, "policy_loss": 892086886552.1, "vf_loss": 95030795878.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 265.5, "diff_num_grad_updates_vs_sampler_policy": 264.5}}, "num_env_steps_sampled": 5131680, "num_env_steps_trained": 5131680, "num_agent_steps_sampled": 5131680, "num_agent_steps_trained": 5131680}, "sampler_results": {"episode_reward_max": 692629.9904760376, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692208.2318737896, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4181934002445251, "mean_inference_ms": 0.24374029917345566, "mean_action_processing_ms": 0.05913803678430532, "mean_env_wait_ms": 1.07576721910618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031444761488172743, "StateBufferConnector_ms": 0.0017174968013057002, "ViewRequirementAgentConnector_ms": 0.045413441128200956}}, "episode_reward_max": 692629.9904760376, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692208.2318737896, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4181934002445251, "mean_inference_ms": 0.24374029917345566, "mean_action_processing_ms": 0.05913803678430532, "mean_env_wait_ms": 1.07576721910618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031444761488172743, "StateBufferConnector_ms": 0.0017174968013057002, "ViewRequirementAgentConnector_ms": 0.045413441128200956}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5131680, "num_agent_steps_trained": 5131680, "num_env_steps_sampled": 5131680, "num_env_steps_trained": 5131680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.4476029721694, "num_env_steps_trained_throughput_per_sec": 377.4476029721694, "timesteps_total": 5131680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5131680, "timers": {"training_iteration_time_ms": 3225.11, "sample_time_ms": 3212.364, "load_time_ms": 0.463, "load_throughput": 2589476.154, "learn_time_ms": 11.618, "learn_throughput": 103287.416, "synch_weights_time_ms": 0.614}, "counters": {"num_env_steps_sampled": 5131680, "num_env_steps_trained": 5131680, "num_agent_steps_sampled": 5131680, "num_agent_steps_trained": 5131680}, "done": false, "episodes_total": 1236, "training_iteration": 587, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-42-28", "timestamp": 1690285348, "time_this_iter_s": 12.718840837478638, "time_total_s": 10268.279037714005, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 88.6474940776825, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.927777777777777, "ram_util_percent": 78.12777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8e-07, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3238525390625, "policy_loss": 161640380561.6, "vf_loss": 94961845862.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 305.5, "diff_num_grad_updates_vs_sampler_policy": 304.5}}, "num_env_steps_sampled": 5136480, "num_env_steps_trained": 5136480, "num_agent_steps_sampled": 5136480, "num_agent_steps_trained": 5136480}, "sampler_results": {"episode_reward_max": 692629.9904760376, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692221.502008921, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4176564489940637, "mean_inference_ms": 0.24405499146277757, "mean_action_processing_ms": 0.059208625078583994, "mean_env_wait_ms": 1.0631181288554614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030517578125, "StateBufferConnector_ms": 0.0017273810602003528, "ViewRequirementAgentConnector_ms": 0.04582558908770161}}, "episode_reward_max": 692629.9904760376, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692221.502008921, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4176564489940637, "mean_inference_ms": 0.24405499146277757, "mean_action_processing_ms": 0.059208625078583994, "mean_env_wait_ms": 1.0631181288554614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030517578125, "StateBufferConnector_ms": 0.0017273810602003528, "ViewRequirementAgentConnector_ms": 0.04582558908770161}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5136480, "num_agent_steps_trained": 5136480, "num_env_steps_sampled": 5136480, "num_env_steps_trained": 5136480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.897922474148, "num_env_steps_trained_throughput_per_sec": 377.897922474148, "timesteps_total": 5136480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5136480, "timers": {"training_iteration_time_ms": 3201.764, "sample_time_ms": 3189.238, "load_time_ms": 0.438, "load_throughput": 2736903.1, "learn_time_ms": 11.449, "learn_throughput": 104812.181, "synch_weights_time_ms": 0.601}, "counters": {"num_env_steps_sampled": 5136480, "num_env_steps_trained": 5136480, "num_agent_steps_sampled": 5136480, "num_agent_steps_trained": 5136480}, "done": false, "episodes_total": 1240, "training_iteration": 588, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-42-41", "timestamp": 1690285361, "time_this_iter_s": 12.703742027282715, "time_total_s": 10280.982779741287, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 101.35123610496521, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.366666666666664, "ram_util_percent": 78.26111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666666e-07, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3238708496094, "policy_loss": 53039585331.2, "vf_loss": 95074091417.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 344.5}}, "num_env_steps_sampled": 5141280, "num_env_steps_trained": 5141280, "num_agent_steps_sampled": 5141280, "num_agent_steps_trained": 5141280}, "sampler_results": {"episode_reward_max": 692718.7816541854, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692254.0766285856, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4174551740766694, "mean_inference_ms": 0.24440367479544303, "mean_action_processing_ms": 0.05928280866097439, "mean_env_wait_ms": 1.0530065198981222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029502596173967633, "StateBufferConnector_ms": 0.0017268317086356027, "ViewRequirementAgentConnector_ms": 0.045649664742606025}}, "episode_reward_max": 692718.7816541854, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692254.0766285856, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4174551740766694, "mean_inference_ms": 0.24440367479544303, "mean_action_processing_ms": 0.05928280866097439, "mean_env_wait_ms": 1.0530065198981222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029502596173967633, "StateBufferConnector_ms": 0.0017268317086356027, "ViewRequirementAgentConnector_ms": 0.045649664742606025}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5141280, "num_agent_steps_trained": 5141280, "num_env_steps_sampled": 5141280, "num_env_steps_trained": 5141280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 367.3237170724237, "num_env_steps_trained_throughput_per_sec": 367.3237170724237, "timesteps_total": 5141280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5141280, "timers": {"training_iteration_time_ms": 3205.299, "sample_time_ms": 3192.69, "load_time_ms": 0.435, "load_throughput": 2758805.525, "learn_time_ms": 11.553, "learn_throughput": 103868.684, "synch_weights_time_ms": 0.58}, "counters": {"num_env_steps_sampled": 5141280, "num_env_steps_trained": 5141280, "num_agent_steps_sampled": 5141280, "num_agent_steps_trained": 5141280}, "done": false, "episodes_total": 1244, "training_iteration": 589, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-42-54", "timestamp": 1690285374, "time_this_iter_s": 13.069821834564209, "time_total_s": 10294.052601575851, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 114.42105793952942, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.538888888888884, "ram_util_percent": 79.55555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8e-07, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3238525390625, "policy_loss": 5558555828.7, "vf_loss": 95034608844.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 385.5, "diff_num_grad_updates_vs_sampler_policy": 384.5}}, "num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080}, "sampler_results": {"episode_reward_max": 692718.7816541854, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692254.6854130095, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4170481154408219, "mean_inference_ms": 0.24459970468000813, "mean_action_processing_ms": 0.05934036107208439, "mean_env_wait_ms": 1.0444176851934348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029123746431790865, "StateBufferConnector_ms": 0.0017490142431014623, "ViewRequirementAgentConnector_ms": 0.04648123032007462}}, "episode_reward_max": 692718.7816541854, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692254.6854130095, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4170481154408219, "mean_inference_ms": 0.24459970468000813, "mean_action_processing_ms": 0.05934036107208439, "mean_env_wait_ms": 1.0444176851934348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029123746431790865, "StateBufferConnector_ms": 0.0017490142431014623, "ViewRequirementAgentConnector_ms": 0.04648123032007462}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080, "num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.30064728218053, "num_env_steps_trained_throughput_per_sec": 378.30064728218053, "timesteps_total": 5146080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5146080, "timers": {"training_iteration_time_ms": 3212.079, "sample_time_ms": 3198.25, "load_time_ms": 0.442, "load_throughput": 2714906.306, "learn_time_ms": 12.709, "learn_throughput": 94418.459, "synch_weights_time_ms": 0.636}, "counters": {"num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080}, "done": false, "episodes_total": 1248, "training_iteration": 590, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-43-07", "timestamp": 1690285387, "time_this_iter_s": 12.69028902053833, "time_total_s": 10306.74289059639, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 127.11134696006775, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 23.166666666666668, "ram_util_percent": 78.61666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.999999999999998e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3238708496094, "policy_loss": 379945539.0, "vf_loss": 95053303398.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 425.5, "diff_num_grad_updates_vs_sampler_policy": 424.5}}, "num_env_steps_sampled": 5150880, "num_env_steps_trained": 5150880, "num_agent_steps_sampled": 5150880, "num_agent_steps_trained": 5150880}, "sampler_results": {"episode_reward_max": 692718.7816541854, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692261.5913412386, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4166177017844896, "mean_inference_ms": 0.24471533706431714, "mean_action_processing_ms": 0.059379009318402134, "mean_env_wait_ms": 1.037006673989251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00287322110907976, "StateBufferConnector_ms": 0.0017526537873024165, "ViewRequirementAgentConnector_ms": 0.046489959539369095}}, "episode_reward_max": 692718.7816541854, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692261.5913412386, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4166177017844896, "mean_inference_ms": 0.24471533706431714, "mean_action_processing_ms": 0.059379009318402134, "mean_env_wait_ms": 1.037006673989251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00287322110907976, "StateBufferConnector_ms": 0.0017526537873024165, "ViewRequirementAgentConnector_ms": 0.046489959539369095}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5150880, "num_agent_steps_trained": 5150880, "num_env_steps_sampled": 5150880, "num_env_steps_trained": 5150880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.6654056346689, "num_env_steps_trained_throughput_per_sec": 377.6654056346689, "timesteps_total": 5150880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5150880, "timers": {"training_iteration_time_ms": 3180.697, "sample_time_ms": 3167.166, "load_time_ms": 0.419, "load_throughput": 2862517.659, "learn_time_ms": 12.466, "learn_throughput": 96263.662, "synch_weights_time_ms": 0.609}, "counters": {"num_env_steps_sampled": 5150880, "num_env_steps_trained": 5150880, "num_agent_steps_sampled": 5150880, "num_agent_steps_trained": 5150880}, "done": false, "episodes_total": 1252, "training_iteration": 591, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-43-19", "timestamp": 1690285399, "time_this_iter_s": 12.711792945861816, "time_total_s": 10319.454683542252, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 139.82313990592957, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.966666666666665, "ram_util_percent": 78.15555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3246032714844, "policy_loss": 31891603.7, "vf_loss": 95107185049.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 5155680, "num_env_steps_trained": 5155680, "num_agent_steps_sampled": 5155680, "num_agent_steps_trained": 5155680}, "sampler_results": {"episode_reward_max": 692725.6608740913, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692276.5053055784, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.416004834702634, "mean_inference_ms": 0.24477278762875557, "mean_action_processing_ms": 0.0594038926200111, "mean_env_wait_ms": 1.0305866232169927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028280501670025766, "StateBufferConnector_ms": 0.001763790211779006, "ViewRequirementAgentConnector_ms": 0.04640386459675241}}, "episode_reward_max": 692725.6608740913, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692276.5053055784, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.416004834702634, "mean_inference_ms": 0.24477278762875557, "mean_action_processing_ms": 0.0594038926200111, "mean_env_wait_ms": 1.0305866232169927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028280501670025766, "StateBufferConnector_ms": 0.001763790211779006, "ViewRequirementAgentConnector_ms": 0.04640386459675241}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5155680, "num_agent_steps_trained": 5155680, "num_env_steps_sampled": 5155680, "num_env_steps_trained": 5155680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 380.42229422354126, "num_env_steps_trained_throughput_per_sec": 380.42229422354126, "timesteps_total": 5155680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5155680, "timers": {"training_iteration_time_ms": 3173.655, "sample_time_ms": 3161.236, "load_time_ms": 0.41, "load_throughput": 2927279.749, "learn_time_ms": 11.426, "learn_throughput": 105024.107, "synch_weights_time_ms": 0.549}, "counters": {"num_env_steps_sampled": 5155680, "num_env_steps_trained": 5155680, "num_agent_steps_sampled": 5155680, "num_agent_steps_trained": 5155680}, "done": false, "episodes_total": 1256, "training_iteration": 592, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-43-32", "timestamp": 1690285412, "time_this_iter_s": 12.619575023651123, "time_total_s": 10332.074258565903, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 152.4427149295807, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.283333333333335, "ram_util_percent": 77.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3250061035156, "policy_loss": 84591947.0, "vf_loss": 95067688550.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 505.5, "diff_num_grad_updates_vs_sampler_policy": 504.5}}, "num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480}, "sampler_results": {"episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692293.5737021527, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4155612027003803, "mean_inference_ms": 0.2449714016452074, "mean_action_processing_ms": 0.05945117077262413, "mean_env_wait_ms": 1.025261270363387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028404535031786153, "StateBufferConnector_ms": 0.00179748909146178, "ViewRequirementAgentConnector_ms": 0.04734058006137025}}, "episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692293.5737021527, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4155612027003803, "mean_inference_ms": 0.2449714016452074, "mean_action_processing_ms": 0.05945117077262413, "mean_env_wait_ms": 1.025261270363387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028404535031786153, "StateBufferConnector_ms": 0.00179748909146178, "ViewRequirementAgentConnector_ms": 0.04734058006137025}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480, "num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 362.57035015779724, "num_env_steps_trained_throughput_per_sec": 362.57035015779724, "timesteps_total": 5160480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5160480, "timers": {"training_iteration_time_ms": 3218.362, "sample_time_ms": 3205.338, "load_time_ms": 0.465, "load_throughput": 2578069.354, "learn_time_ms": 11.92, "learn_throughput": 100669.538, "synch_weights_time_ms": 0.6}, "counters": {"num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480}, "done": false, "episodes_total": 1260, "training_iteration": 593, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-43-45", "timestamp": 1690285425, "time_this_iter_s": 13.240748882293701, "time_total_s": 10345.315007448196, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 165.6834638118744, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 28.91052631578948, "ram_util_percent": 78.65263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3251953125, "policy_loss": 65463162.9, "vf_loss": 95168745062.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 545.5, "diff_num_grad_updates_vs_sampler_policy": 544.5}}, "num_env_steps_sampled": 5165280, "num_env_steps_trained": 5165280, "num_agent_steps_sampled": 5165280, "num_agent_steps_trained": 5165280}, "sampler_results": {"episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692308.7109846756, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4151491280409059, "mean_inference_ms": 0.24517058008901949, "mean_action_processing_ms": 0.0594959893555314, "mean_env_wait_ms": 1.0206292777168506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027899308638139205, "StateBufferConnector_ms": 0.0017985430630770597, "ViewRequirementAgentConnector_ms": 0.04724719307639382}}, "episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692308.7109846756, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4151491280409059, "mean_inference_ms": 0.24517058008901949, "mean_action_processing_ms": 0.0594959893555314, "mean_env_wait_ms": 1.0206292777168506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027899308638139205, "StateBufferConnector_ms": 0.0017985430630770597, "ViewRequirementAgentConnector_ms": 0.04724719307639382}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5165280, "num_agent_steps_trained": 5165280, "num_env_steps_sampled": 5165280, "num_env_steps_trained": 5165280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 371.62089906682684, "num_env_steps_trained_throughput_per_sec": 371.62089906682684, "timesteps_total": 5165280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5165280, "timers": {"training_iteration_time_ms": 3246.052, "sample_time_ms": 3232.822, "load_time_ms": 0.488, "load_throughput": 2457600.0, "learn_time_ms": 12.08, "learn_throughput": 99339.694, "synch_weights_time_ms": 0.611}, "counters": {"num_env_steps_sampled": 5165280, "num_env_steps_trained": 5165280, "num_agent_steps_sampled": 5165280, "num_agent_steps_trained": 5165280}, "done": false, "episodes_total": 1264, "training_iteration": 594, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-43-58", "timestamp": 1690285438, "time_this_iter_s": 12.918613195419312, "time_total_s": 10358.233620643616, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 178.6020770072937, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.121052631578944, "ram_util_percent": 79.36842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.325244140625, "policy_loss": 63984216.9, "vf_loss": 94992589209.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 5170080, "num_env_steps_trained": 5170080, "num_agent_steps_sampled": 5170080, "num_agent_steps_trained": 5170080}, "sampler_results": {"episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692308.5956968706, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4146829920642037, "mean_inference_ms": 0.24531131094981912, "mean_action_processing_ms": 0.05952897627079367, "mean_env_wait_ms": 1.0164727547836128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00274343005681442, "StateBufferConnector_ms": 0.0017946049318475238, "ViewRequirementAgentConnector_ms": 0.04716283183986858}}, "episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692308.5956968706, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4146829920642037, "mean_inference_ms": 0.24531131094981912, "mean_action_processing_ms": 0.05952897627079367, "mean_env_wait_ms": 1.0164727547836128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00274343005681442, "StateBufferConnector_ms": 0.0017946049318475238, "ViewRequirementAgentConnector_ms": 0.04716283183986858}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5170080, "num_agent_steps_trained": 5170080, "num_env_steps_sampled": 5170080, "num_env_steps_trained": 5170080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.80987524181455, "num_env_steps_trained_throughput_per_sec": 378.80987524181455, "timesteps_total": 5170080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5170080, "timers": {"training_iteration_time_ms": 3214.277, "sample_time_ms": 3201.152, "load_time_ms": 0.448, "load_throughput": 2677072.922, "learn_time_ms": 12.022, "learn_throughput": 99816.651, "synch_weights_time_ms": 0.606}, "counters": {"num_env_steps_sampled": 5170080, "num_env_steps_trained": 5170080, "num_agent_steps_sampled": 5170080, "num_agent_steps_trained": 5170080}, "done": false, "episodes_total": 1268, "training_iteration": 595, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-44-11", "timestamp": 1690285451, "time_this_iter_s": 12.673500776290894, "time_total_s": 10370.907121419907, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 191.2755777835846, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.944444444444443, "ram_util_percent": 78.66111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3251953125, "policy_loss": -32863663.9, "vf_loss": 95052595200.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 625.5, "diff_num_grad_updates_vs_sampler_policy": 624.5}}, "num_env_steps_sampled": 5174880, "num_env_steps_trained": 5174880, "num_agent_steps_sampled": 5174880, "num_agent_steps_trained": 5174880}, "sampler_results": {"episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692316.785863774, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4142393780152542, "mean_inference_ms": 0.24541662621452354, "mean_action_processing_ms": 0.05955488039545651, "mean_env_wait_ms": 1.012704501284076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026994281344943577, "StateBufferConnector_ms": 0.0017866255745055183, "ViewRequirementAgentConnector_ms": 0.046949537973555305}}, "episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692316.785863774, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4142393780152542, "mean_inference_ms": 0.24541662621452354, "mean_action_processing_ms": 0.05955488039545651, "mean_env_wait_ms": 1.012704501284076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026994281344943577, "StateBufferConnector_ms": 0.0017866255745055183, "ViewRequirementAgentConnector_ms": 0.046949537973555305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5174880, "num_agent_steps_trained": 5174880, "num_env_steps_sampled": 5174880, "num_env_steps_trained": 5174880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 376.9541818693821, "num_env_steps_trained_throughput_per_sec": 376.9541818693821, "timesteps_total": 5174880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5174880, "timers": {"training_iteration_time_ms": 3172.297, "sample_time_ms": 3159.517, "load_time_ms": 0.42, "load_throughput": 2855696.34, "learn_time_ms": 11.721, "learn_throughput": 102380.42, "synch_weights_time_ms": 0.601}, "counters": {"num_env_steps_sampled": 5174880, "num_env_steps_trained": 5174880, "num_agent_steps_sampled": 5174880, "num_agent_steps_trained": 5174880}, "done": false, "episodes_total": 1272, "training_iteration": 596, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-44-24", "timestamp": 1690285464, "time_this_iter_s": 12.735700845718384, "time_total_s": 10383.642822265625, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 204.01127862930298, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.477777777777778, "ram_util_percent": 78.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3251953125, "policy_loss": -20365563.8, "vf_loss": 95108393369.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 665.5, "diff_num_grad_updates_vs_sampler_policy": 664.5}}, "num_env_steps_sampled": 5179680, "num_env_steps_trained": 5179680, "num_agent_steps_sampled": 5179680, "num_agent_steps_trained": 5179680}, "sampler_results": {"episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692317.0776585882, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4138107537423552, "mean_inference_ms": 0.2454883360639285, "mean_action_processing_ms": 0.05957441550811296, "mean_env_wait_ms": 1.009261301636019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026581892326696596, "StateBufferConnector_ms": 0.0017820899166277986, "ViewRequirementAgentConnector_ms": 0.0467940942565007}}, "episode_reward_max": 692750.545384386, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692317.0776585882, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4138107537423552, "mean_inference_ms": 0.2454883360639285, "mean_action_processing_ms": 0.05957441550811296, "mean_env_wait_ms": 1.009261301636019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026581892326696596, "StateBufferConnector_ms": 0.0017820899166277986, "ViewRequirementAgentConnector_ms": 0.0467940942565007}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5179680, "num_agent_steps_trained": 5179680, "num_env_steps_sampled": 5179680, "num_env_steps_trained": 5179680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.14239480000236, "num_env_steps_trained_throughput_per_sec": 378.14239480000236, "timesteps_total": 5179680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5179680, "timers": {"training_iteration_time_ms": 3173.022, "sample_time_ms": 3159.993, "load_time_ms": 0.42, "load_throughput": 2858940.528, "learn_time_ms": 11.959, "learn_throughput": 100340.401, "synch_weights_time_ms": 0.614}, "counters": {"num_env_steps_sampled": 5179680, "num_env_steps_trained": 5179680, "num_agent_steps_sampled": 5179680, "num_agent_steps_trained": 5179680}, "done": false, "episodes_total": 1276, "training_iteration": 597, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-44-36", "timestamp": 1690285476, "time_this_iter_s": 12.695828199386597, "time_total_s": 10396.338650465012, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 216.70710682868958, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.005555555555556, "ram_util_percent": 78.59444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3257263183593, "policy_loss": -34191659.4, "vf_loss": 95200831078.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 705.5, "diff_num_grad_updates_vs_sampler_policy": 704.5}}, "num_env_steps_sampled": 5184480, "num_env_steps_trained": 5184480, "num_agent_steps_sampled": 5184480, "num_agent_steps_trained": 5184480}, "sampler_results": {"episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692334.6198029036, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4134531021915855, "mean_inference_ms": 0.24558229446717642, "mean_action_processing_ms": 0.05959598954252841, "mean_env_wait_ms": 1.0061855096866046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026343573986644477, "StateBufferConnector_ms": 0.0017777295179770027, "ViewRequirementAgentConnector_ms": 0.046707207048443}}, "episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692334.6198029036, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4134531021915855, "mean_inference_ms": 0.24558229446717642, "mean_action_processing_ms": 0.05959598954252841, "mean_env_wait_ms": 1.0061855096866046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026343573986644477, "StateBufferConnector_ms": 0.0017777295179770027, "ViewRequirementAgentConnector_ms": 0.046707207048443}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5184480, "num_agent_steps_trained": 5184480, "num_env_steps_sampled": 5184480, "num_env_steps_trained": 5184480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 369.5180903669006, "num_env_steps_trained_throughput_per_sec": 369.5180903669006, "timesteps_total": 5184480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5184480, "timers": {"training_iteration_time_ms": 3203.656, "sample_time_ms": 3190.847, "load_time_ms": 0.437, "load_throughput": 2743467.132, "learn_time_ms": 11.761, "learn_throughput": 102035.883, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 5184480, "num_env_steps_trained": 5184480, "num_agent_steps_sampled": 5184480, "num_agent_steps_trained": 5184480}, "done": false, "episodes_total": 1280, "training_iteration": 598, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-44-49", "timestamp": 1690285489, "time_this_iter_s": 12.991873025894165, "time_total_s": 10409.330523490906, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 229.69897985458374, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 29.90555555555555, "ram_util_percent": 79.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3270568847656, "policy_loss": 6366125.0, "vf_loss": 95032844697.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 745.5, "diff_num_grad_updates_vs_sampler_policy": 744.5}}, "num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280}, "sampler_results": {"episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692327.8386997139, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895, 692251.4924173492, 692166.6621675924, 692283.4834172489, 692128.2584701942], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4131362837329582, "mean_inference_ms": 0.24566783258604075, "mean_action_processing_ms": 0.05961552979812412, "mean_env_wait_ms": 1.0033669277441588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002620697021484375, "StateBufferConnector_ms": 0.001781781514485677, "ViewRequirementAgentConnector_ms": 0.0470129648844401}}, "episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692327.8386997139, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895, 692251.4924173492, 692166.6621675924, 692283.4834172489, 692128.2584701942], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4131362837329582, "mean_inference_ms": 0.24566783258604075, "mean_action_processing_ms": 0.05961552979812412, "mean_env_wait_ms": 1.0033669277441588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002620697021484375, "StateBufferConnector_ms": 0.001781781514485677, "ViewRequirementAgentConnector_ms": 0.0470129648844401}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280, "num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 374.4173181792644, "num_env_steps_trained_throughput_per_sec": 374.4173181792644, "timesteps_total": 5189280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5189280, "timers": {"training_iteration_time_ms": 3221.048, "sample_time_ms": 3208.256, "load_time_ms": 0.438, "load_throughput": 2737647.43, "learn_time_ms": 11.739, "learn_throughput": 102219.901, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280}, "done": false, "episodes_total": 1284, "training_iteration": 599, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-45-02", "timestamp": 1690285502, "time_this_iter_s": 12.821883916854858, "time_total_s": 10422.15240740776, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 242.5208637714386, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 26.963157894736838, "ram_util_percent": 78.90526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3277709960937, "policy_loss": -34665279.6, "vf_loss": 94958763212.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 785.5, "diff_num_grad_updates_vs_sampler_policy": 784.5}}, "num_env_steps_sampled": 5194080, "num_env_steps_trained": 5194080, "num_agent_steps_sampled": 5194080, "num_agent_steps_trained": 5194080}, "sampler_results": {"episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692321.0967729986, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895, 692251.4924173492, 692166.6621675924, 692283.4834172489, 692128.2584701942, 692524.1057047623, 692227.3071442172, 692167.8414421208, 691859.4882972358], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.412784430444727, "mean_inference_ms": 0.24571438570504142, "mean_action_processing_ms": 0.05962781375210174, "mean_env_wait_ms": 1.000732196632455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025906140291238134, "StateBufferConnector_ms": 0.0017793872688390033, "ViewRequirementAgentConnector_ms": 0.046834161009969594}}, "episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692321.0967729986, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895, 692251.4924173492, 692166.6621675924, 692283.4834172489, 692128.2584701942, 692524.1057047623, 692227.3071442172, 692167.8414421208, 691859.4882972358], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.412784430444727, "mean_inference_ms": 0.24571438570504142, "mean_action_processing_ms": 0.05962781375210174, "mean_env_wait_ms": 1.000732196632455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025906140291238134, "StateBufferConnector_ms": 0.0017793872688390033, "ViewRequirementAgentConnector_ms": 0.046834161009969594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5194080, "num_agent_steps_trained": 5194080, "num_env_steps_sampled": 5194080, "num_env_steps_trained": 5194080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 382.60890056907124, "num_env_steps_trained_throughput_per_sec": 382.60890056907124, "timesteps_total": 5194080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5194080, "timers": {"training_iteration_time_ms": 3176.528, "sample_time_ms": 3163.976, "load_time_ms": 0.414, "load_throughput": 2900123.768, "learn_time_ms": 11.53, "learn_throughput": 104075.516, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 5194080, "num_env_steps_trained": 5194080, "num_agent_steps_sampled": 5194080, "num_agent_steps_trained": 5194080}, "done": false, "episodes_total": 1288, "training_iteration": 600, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-45-15", "timestamp": 1690285515, "time_this_iter_s": 12.547701120376587, "time_total_s": 10434.700108528137, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 255.06856489181519, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 22.50588235294118, "ram_util_percent": 78.05882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3292663574218, "policy_loss": -3449865.4, "vf_loss": 95086417920.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 824.5}}, "num_env_steps_sampled": 5198880, "num_env_steps_trained": 5198880, "num_agent_steps_sampled": 5198880, "num_agent_steps_trained": 5198880}, "sampler_results": {"episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692316.9791970492, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895, 692251.4924173492, 692166.6621675924, 692283.4834172489, 692128.2584701942, 692524.1057047623, 692227.3071442172, 692167.8414421208, 691859.4882972358, 692193.5862547191, 692247.697149975, 692204.6656709764, 692296.6792125265], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.412468254328781, "mean_inference_ms": 0.2457565893785787, "mean_action_processing_ms": 0.059640555238256, "mean_env_wait_ms": 0.998283049395331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025823891881000564, "StateBufferConnector_ms": 0.0017806708094585373, "ViewRequirementAgentConnector_ms": 0.046936000686093986}}, "episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692316.9791970492, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895, 692251.4924173492, 692166.6621675924, 692283.4834172489, 692128.2584701942, 692524.1057047623, 692227.3071442172, 692167.8414421208, 691859.4882972358, 692193.5862547191, 692247.697149975, 692204.6656709764, 692296.6792125265], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.412468254328781, "mean_inference_ms": 0.2457565893785787, "mean_action_processing_ms": 0.059640555238256, "mean_env_wait_ms": 0.998283049395331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025823891881000564, "StateBufferConnector_ms": 0.0017806708094585373, "ViewRequirementAgentConnector_ms": 0.046936000686093986}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5198880, "num_agent_steps_trained": 5198880, "num_env_steps_sampled": 5198880, "num_env_steps_trained": 5198880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 375.71711480426444, "num_env_steps_trained_throughput_per_sec": 375.71711480426444, "timesteps_total": 5198880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5198880, "timers": {"training_iteration_time_ms": 3172.425, "sample_time_ms": 3159.744, "load_time_ms": 0.44, "load_throughput": 2725196.167, "learn_time_ms": 11.624, "learn_throughput": 103234.877, "synch_weights_time_ms": 0.579}, "counters": {"num_env_steps_sampled": 5198880, "num_env_steps_trained": 5198880, "num_agent_steps_sampled": 5198880, "num_agent_steps_trained": 5198880}, "done": false, "episodes_total": 1292, "training_iteration": 601, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-45-27", "timestamp": 1690285527, "time_this_iter_s": 12.77763295173645, "time_total_s": 10447.477741479874, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 267.84619784355164, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 24.705263157894734, "ram_util_percent": 78.85789473684208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3299926757812, "policy_loss": -1004055.6, "vf_loss": 95178938368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 865.5, "diff_num_grad_updates_vs_sampler_policy": 864.5}}, "num_env_steps_sampled": 5203680, "num_env_steps_trained": 5203680, "num_agent_steps_sampled": 5203680, "num_agent_steps_trained": 5203680}, "sampler_results": {"episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692331.6104341866, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895, 692251.4924173492, 692166.6621675924, 692283.4834172489, 692128.2584701942, 692524.1057047623, 692227.3071442172, 692167.8414421208, 691859.4882972358, 692193.5862547191, 692247.697149975, 692204.6656709764, 692296.6792125265, 692415.1012738756, 692702.4194823381, 692750.7629569727, 692672.5507059834], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4121378316533386, "mean_inference_ms": 0.2457874342035373, "mean_action_processing_ms": 0.05965043734897726, "mean_env_wait_ms": 0.9959769885192195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002561492481450925, "StateBufferConnector_ms": 0.0017752592591033585, "ViewRequirementAgentConnector_ms": 0.046810336496638155}}, "episode_reward_max": 692829.8274216813, "episode_reward_min": 691732.6251955082, "episode_reward_mean": 692331.6104341866, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692305.6844704272, 692303.2407646336, 691933.8723594593, 692282.0494344605, 691988.5693394062, 692014.0973272175, 691981.6202541987, 692144.7817544951, 692101.2861470899, 692276.8143463384, 692367.3877969892, 691912.0899342687, 691732.6251955082, 692367.9563616116, 692183.7953770367, 692281.7449217974, 692538.9225289184, 692171.1438364782, 692127.1082239718, 692091.9980803085, 692548.3821675596, 692629.9904760376, 692480.5488098181, 692261.4938127396, 691994.7614878494, 692439.2727108793, 692161.0226728206, 692546.8821392949, 692342.1566222865, 692451.8507711749, 691903.4121514754, 692640.6896997269, 692411.8910613528, 692718.7816541854, 692254.7573086768, 692644.2805445115, 692075.6782648554, 692295.1658255967, 692024.9244719073, 692327.7233743373, 692303.7246480555, 692616.965257654, 692067.2832858529, 692268.9709617359, 692725.6608740913, 692393.3560511392, 692359.3338019532, 692371.5313647181, 692750.545384386, 692581.7166248843, 692272.7160736138, 692382.555087237, 692525.4637445781, 692507.01577096, 692591.810744589, 692512.4047258548, 692362.7100465138, 692331.6864530437, 692021.2407328045, 692349.1232410804, 692572.1995318163, 692586.2193637167, 692242.8211657874, 692222.3505500004, 692203.7070417393, 692504.2049289915, 692356.4311869098, 692608.3081213043, 692369.1412988774, 692829.8274216813, 692706.5260388895, 692251.4924173492, 692166.6621675924, 692283.4834172489, 692128.2584701942, 692524.1057047623, 692227.3071442172, 692167.8414421208, 691859.4882972358, 692193.5862547191, 692247.697149975, 692204.6656709764, 692296.6792125265, 692415.1012738756, 692702.4194823381, 692750.7629569727, 692672.5507059834], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4121378316533386, "mean_inference_ms": 0.2457874342035373, "mean_action_processing_ms": 0.05965043734897726, "mean_env_wait_ms": 0.9959769885192195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002561492481450925, "StateBufferConnector_ms": 0.0017752592591033585, "ViewRequirementAgentConnector_ms": 0.046810336496638155}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5203680, "num_agent_steps_trained": 5203680, "num_env_steps_sampled": 5203680, "num_env_steps_trained": 5203680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 381.12584697722787, "num_env_steps_trained_throughput_per_sec": 381.12584697722787, "timesteps_total": 5203680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5203680, "timers": {"training_iteration_time_ms": 3160.692, "sample_time_ms": 3148.179, "load_time_ms": 0.451, "load_throughput": 2658127.7, "learn_time_ms": 11.443, "learn_throughput": 104870.272, "synch_weights_time_ms": 0.579}, "counters": {"num_env_steps_sampled": 5203680, "num_env_steps_trained": 5203680, "num_agent_steps_sampled": 5203680, "num_agent_steps_trained": 5203680}, "done": false, "episodes_total": 1296, "training_iteration": 602, "trial_id": "1dd9e_00000", "date": "2023-07-25_14-45-40", "timestamp": 1690285540, "time_this_iter_s": 12.596315860748291, "time_total_s": 10460.074057340622, "pid": 63591, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16b677550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 280.4425137042999, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 26.01111111111111, "ram_util_percent": 78.25555555555553}}
