{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.2641110434129, "policy_loss": -1.0106882093979816e+21, "vf_loss": 310298411.5626822}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 5903520, "num_env_steps_trained": 5903520, "num_agent_steps_sampled": 5903520, "num_agent_steps_trained": 5903520}, "sampler_results": {"episode_reward_max": -1368051.7961812108, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1368051.7961812108, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2000361788872962, "mean_inference_ms": 0.3160139551438697, "mean_action_processing_ms": 0.0764732871539052, "mean_env_wait_ms": 0.6699789520636795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.064849853515625}}, "episode_reward_max": -1368051.7961812108, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1368051.7961812108, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2000361788872962, "mean_inference_ms": 0.3160139551438697, "mean_action_processing_ms": 0.0764732871539052, "mean_env_wait_ms": 0.6699789520636795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.064849853515625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5903520, "num_agent_steps_trained": 5903520, "num_env_steps_sampled": 5903520, "num_env_steps_trained": 5903520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 765.2481704152995, "num_env_steps_trained_throughput_per_sec": 765.2481704152995, "timesteps_total": 5903520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5903520, "timers": {"training_iteration_time_ms": 57393.125, "sample_time_ms": 56259.032, "load_time_ms": 0.583, "load_throughput": 75343080.442, "learn_time_ms": 1132.367, "learn_throughput": 38786.016, "synch_weights_time_ms": 0.969}, "counters": {"num_env_steps_sampled": 5903520, "num_env_steps_trained": 5903520, "num_agent_steps_sampled": 5903520, "num_agent_steps_trained": 5903520}, "done": false, "episodes_total": 1325, "training_iteration": 446, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-25-27", "timestamp": 1691090727, "time_this_iter_s": 57.39569020271301, "time_total_s": 10604.208201885223, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 57.39569020271301, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 19.691463414634146, "ram_util_percent": 62.6939024390244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4134204742165, "policy_loss": -9.207144307949394e+20, "vf_loss": 308222236.7113703}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 5947440, "num_env_steps_trained": 5947440, "num_agent_steps_sampled": 5947440, "num_agent_steps_trained": 5947440}, "sampler_results": {"episode_reward_max": -1363488.7761809474, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1365770.2861810792, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2045228376055554, "mean_inference_ms": 0.32924558706681784, "mean_action_processing_ms": 0.07983131619067595, "mean_env_wait_ms": 0.6839014398751901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026702880859375, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.06551742553710938}}, "episode_reward_max": -1363488.7761809474, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1365770.2861810792, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2045228376055554, "mean_inference_ms": 0.32924558706681784, "mean_action_processing_ms": 0.07983131619067595, "mean_env_wait_ms": 0.6839014398751901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026702880859375, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.06551742553710938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5947440, "num_agent_steps_trained": 5947440, "num_env_steps_sampled": 5947440, "num_env_steps_trained": 5947440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 690.6099802272064, "num_env_steps_trained_throughput_per_sec": 690.6099802272064, "timesteps_total": 5947440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5947440, "timers": {"training_iteration_time_ms": 60494.529, "sample_time_ms": 59362.051, "load_time_ms": 10.5, "load_throughput": 4182827.89, "learn_time_ms": 1120.857, "learn_throughput": 39184.319, "synch_weights_time_ms": 0.95}, "counters": {"num_env_steps_sampled": 5947440, "num_env_steps_trained": 5947440, "num_agent_steps_sampled": 5947440, "num_agent_steps_trained": 5947440}, "done": false, "episodes_total": 1326, "training_iteration": 447, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-26-31", "timestamp": 1691090791, "time_this_iter_s": 63.59864807128906, "time_total_s": 10667.806849956512, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 120.99433827400208, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.78021978021978, "ram_util_percent": 62.71428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4019172156866, "policy_loss": -8.915071799391915e+20, "vf_loss": 307979259.47521865}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 5991360, "num_env_steps_trained": 5991360, "num_agent_steps_sampled": 5991360, "num_agent_steps_trained": 5991360}, "sampler_results": {"episode_reward_max": -1362800.756835128, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1364780.4430657623, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2066239773243397, "mean_inference_ms": 0.3365112347227251, "mean_action_processing_ms": 0.08169091465916592, "mean_env_wait_ms": 0.690319207788089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027974446614583335, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06823539733886719}}, "episode_reward_max": -1362800.756835128, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1364780.4430657623, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2066239773243397, "mean_inference_ms": 0.3365112347227251, "mean_action_processing_ms": 0.08169091465916592, "mean_env_wait_ms": 0.690319207788089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027974446614583335, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06823539733886719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5991360, "num_agent_steps_trained": 5991360, "num_env_steps_sampled": 5991360, "num_env_steps_trained": 5991360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 698.5967378482534, "num_env_steps_trained_throughput_per_sec": 698.5967378482534, "timesteps_total": 5991360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5991360, "timers": {"training_iteration_time_ms": 61285.976, "sample_time_ms": 60156.097, "load_time_ms": 14.353, "load_throughput": 3059979.596, "learn_time_ms": 1114.425, "learn_throughput": 39410.457, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 5991360, "num_env_steps_trained": 5991360, "num_agent_steps_sampled": 5991360, "num_agent_steps_trained": 5991360}, "done": false, "episodes_total": 1327, "training_iteration": 448, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-27-33", "timestamp": 1691090853, "time_this_iter_s": 62.87136793136597, "time_total_s": 10730.678217887878, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 183.86570620536804, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.81685393258427, "ram_util_percent": 63.120224719101124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4134670958226, "policy_loss": -8.691286756308289e+20, "vf_loss": 306959534.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 6035280, "num_env_steps_trained": 6035280, "num_agent_steps_sampled": 6035280, "num_agent_steps_trained": 6035280}, "sampler_results": {"episode_reward_max": -1360855.0297909304, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1363799.0897470543, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20796554546721252, "mean_inference_ms": 0.3413043948706001, "mean_action_processing_ms": 0.08296226477588392, "mean_env_wait_ms": 0.6939530853760169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029325485229492188, "StateBufferConnector_ms": 0.0026285648345947266, "ViewRequirementAgentConnector_ms": 0.06798505783081055}}, "episode_reward_max": -1360855.0297909304, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1363799.0897470543, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20796554546721252, "mean_inference_ms": 0.3413043948706001, "mean_action_processing_ms": 0.08296226477588392, "mean_env_wait_ms": 0.6939530853760169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029325485229492188, "StateBufferConnector_ms": 0.0026285648345947266, "ViewRequirementAgentConnector_ms": 0.06798505783081055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6035280, "num_agent_steps_trained": 6035280, "num_env_steps_sampled": 6035280, "num_env_steps_trained": 6035280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 698.4899212268317, "num_env_steps_trained_throughput_per_sec": 698.4899212268317, "timesteps_total": 6035280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6035280, "timers": {"training_iteration_time_ms": 61684.103, "sample_time_ms": 60551.427, "load_time_ms": 15.801, "load_throughput": 2779558.226, "learn_time_ms": 1115.783, "learn_throughput": 39362.483, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 6035280, "num_env_steps_trained": 6035280, "num_agent_steps_sampled": 6035280, "num_agent_steps_trained": 6035280}, "done": false, "episodes_total": 1328, "training_iteration": 449, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-28-36", "timestamp": 1691090916, "time_this_iter_s": 62.88119411468506, "time_total_s": 10793.559412002563, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 246.7469003200531, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.116853932584267, "ram_util_percent": 62.9629213483146}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4033573250729, "policy_loss": -8.785217648205423e+20, "vf_loss": 306965735.2419825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 6079200, "num_env_steps_trained": 6079200, "num_agent_steps_sampled": 6079200, "num_agent_steps_trained": 6079200}, "sampler_results": {"episode_reward_max": -1360468.2767770018, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1363132.927153044, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20885733346163043, "mean_inference_ms": 0.344687399856726, "mean_action_processing_ms": 0.08386257822492409, "mean_env_wait_ms": 0.6962685700227329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035715103149414062, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06747245788574219}}, "episode_reward_max": -1360468.2767770018, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1363132.927153044, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20885733346163043, "mean_inference_ms": 0.344687399856726, "mean_action_processing_ms": 0.08386257822492409, "mean_env_wait_ms": 0.6962685700227329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035715103149414062, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06747245788574219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6079200, "num_agent_steps_trained": 6079200, "num_env_steps_sampled": 6079200, "num_env_steps_trained": 6079200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.0299243132142, "num_env_steps_trained_throughput_per_sec": 701.0299243132142, "timesteps_total": 6079200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6079200, "timers": {"training_iteration_time_ms": 61877.414, "sample_time_ms": 60742.846, "load_time_ms": 16.593, "load_throughput": 2646963.429, "learn_time_ms": 1116.892, "learn_throughput": 39323.415, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 6079200, "num_env_steps_trained": 6079200, "num_agent_steps_sampled": 6079200, "num_agent_steps_trained": 6079200}, "done": false, "episodes_total": 1329, "training_iteration": 450, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-29-39", "timestamp": 1691090979, "time_this_iter_s": 62.653512954711914, "time_total_s": 10856.212924957275, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 309.400413274765, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.63370786516854, "ram_util_percent": 62.721348314606736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.410162122187, "policy_loss": -8.679324710399996e+20, "vf_loss": 307235066.4956268}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 6123120, "num_env_steps_trained": 6123120, "num_agent_steps_sampled": 6123120, "num_agent_steps_trained": 6123120}, "sampler_results": {"episode_reward_max": -1360468.2767770018, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1362818.7091418947, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20943590133889856, "mean_inference_ms": 0.3471960335938467, "mean_action_processing_ms": 0.08453612896987973, "mean_env_wait_ms": 0.6977071665249648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.0025192896525065103, "ViewRequirementAgentConnector_ms": 0.06724993387858073}}, "episode_reward_max": -1360468.2767770018, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1362818.7091418947, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20943590133889856, "mean_inference_ms": 0.3471960335938467, "mean_action_processing_ms": 0.08453612896987973, "mean_env_wait_ms": 0.6977071665249648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.0025192896525065103, "ViewRequirementAgentConnector_ms": 0.06724993387858073}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6123120, "num_agent_steps_trained": 6123120, "num_env_steps_sampled": 6123120, "num_env_steps_trained": 6123120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.0346682601973, "num_env_steps_trained_throughput_per_sec": 706.0346682601973, "timesteps_total": 6123120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6123120, "timers": {"training_iteration_time_ms": 61932.271, "sample_time_ms": 60798.084, "load_time_ms": 17.182, "load_throughput": 2556188.185, "learn_time_ms": 1115.911, "learn_throughput": 39357.99, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 6123120, "num_env_steps_trained": 6123120, "num_agent_steps_sampled": 6123120, "num_agent_steps_trained": 6123120}, "done": false, "episodes_total": 1330, "training_iteration": 451, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-30-41", "timestamp": 1691091041, "time_this_iter_s": 62.209144830703735, "time_total_s": 10918.42206978798, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 371.60955810546875, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.065168539325843, "ram_util_percent": 62.76966292134831}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4086004763233, "policy_loss": -9.043333436656895e+20, "vf_loss": 306040790.2740525}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 6167040, "num_env_steps_trained": 6167040, "num_agent_steps_sampled": 6167040, "num_agent_steps_trained": 6167040}, "sampler_results": {"episode_reward_max": -1358547.4120187873, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1362208.5238385939, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20988387821110802, "mean_inference_ms": 0.34915694125024627, "mean_action_processing_ms": 0.08506615533994984, "mean_env_wait_ms": 0.6987995330104823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.002486365182059152, "ViewRequirementAgentConnector_ms": 0.06710801805768694}}, "episode_reward_max": -1358547.4120187873, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1362208.5238385939, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20988387821110802, "mean_inference_ms": 0.34915694125024627, "mean_action_processing_ms": 0.08506615533994984, "mean_env_wait_ms": 0.6987995330104823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.002486365182059152, "ViewRequirementAgentConnector_ms": 0.06710801805768694}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6167040, "num_agent_steps_trained": 6167040, "num_env_steps_sampled": 6167040, "num_env_steps_trained": 6167040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.3049474426447, "num_env_steps_trained_throughput_per_sec": 701.3049474426447, "timesteps_total": 6167040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6167040, "timers": {"training_iteration_time_ms": 62031.388, "sample_time_ms": 60896.348, "load_time_ms": 17.568, "load_throughput": 2500061.696, "learn_time_ms": 1116.381, "learn_throughput": 39341.413, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 6167040, "num_env_steps_trained": 6167040, "num_agent_steps_sampled": 6167040, "num_agent_steps_trained": 6167040}, "done": false, "episodes_total": 1331, "training_iteration": 452, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-31-44", "timestamp": 1691091104, "time_this_iter_s": 62.62857961654663, "time_total_s": 10981.050649404526, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 434.2381377220154, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.506818181818183, "ram_util_percent": 62.73068181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.400855951337, "policy_loss": -8.54185924196545e+20, "vf_loss": 306759067.9183673}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 6210960, "num_env_steps_trained": 6210960, "num_agent_steps_sampled": 6210960, "num_agent_steps_trained": 6210960}, "sampler_results": {"episode_reward_max": -1358547.4120187873, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1361953.6662643643, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21026921321885655, "mean_inference_ms": 0.3507550434471769, "mean_action_processing_ms": 0.08549498175460171, "mean_env_wait_ms": 0.6996121698327062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003427267074584961, "StateBufferConnector_ms": 0.0025004148483276367, "ViewRequirementAgentConnector_ms": 0.06699860095977783}}, "episode_reward_max": -1358547.4120187873, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1361953.6662643643, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21026921321885655, "mean_inference_ms": 0.3507550434471769, "mean_action_processing_ms": 0.08549498175460171, "mean_env_wait_ms": 0.6996121698327062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003427267074584961, "StateBufferConnector_ms": 0.0025004148483276367, "ViewRequirementAgentConnector_ms": 0.06699860095977783}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6210960, "num_agent_steps_trained": 6210960, "num_env_steps_sampled": 6210960, "num_env_steps_trained": 6210960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.9070169861079, "num_env_steps_trained_throughput_per_sec": 700.9070169861079, "timesteps_total": 6210960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6210960, "timers": {"training_iteration_time_ms": 62110.17, "sample_time_ms": 60968.124, "load_time_ms": 17.531, "load_throughput": 2505347.695, "learn_time_ms": 1123.407, "learn_throughput": 39095.375, "synch_weights_time_ms": 0.947}, "counters": {"num_env_steps_sampled": 6210960, "num_env_steps_trained": 6210960, "num_agent_steps_sampled": 6210960, "num_agent_steps_trained": 6210960}, "done": false, "episodes_total": 1332, "training_iteration": 453, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-32-47", "timestamp": 1691091167, "time_this_iter_s": 62.66414999961853, "time_total_s": 11043.714799404144, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 496.9022877216339, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.976404494382024, "ram_util_percent": 62.78426966292134}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.413123483908, "policy_loss": -9.060056492803076e+20, "vf_loss": 308395977.2244898}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 6254880, "num_env_steps_trained": 6254880, "num_agent_steps_sampled": 6254880, "num_agent_steps_trained": 6254880}, "sampler_results": {"episode_reward_max": -1358547.4120187873, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1362132.9731197408, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21058394455687562, "mean_inference_ms": 0.3520906672464962, "mean_action_processing_ms": 0.08585333109258221, "mean_env_wait_ms": 0.7002932691054468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034544203016493055, "StateBufferConnector_ms": 0.0024980968899197048, "ViewRequirementAgentConnector_ms": 0.06748570336235894}}, "episode_reward_max": -1358547.4120187873, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1362132.9731197408, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21058394455687562, "mean_inference_ms": 0.3520906672464962, "mean_action_processing_ms": 0.08585333109258221, "mean_env_wait_ms": 0.7002932691054468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034544203016493055, "StateBufferConnector_ms": 0.0024980968899197048, "ViewRequirementAgentConnector_ms": 0.06748570336235894}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6254880, "num_agent_steps_trained": 6254880, "num_env_steps_sampled": 6254880, "num_env_steps_trained": 6254880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 699.7702281345944, "num_env_steps_trained_throughput_per_sec": 699.7702281345944, "timesteps_total": 6254880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6254880, "timers": {"training_iteration_time_ms": 62182.756, "sample_time_ms": 61039.443, "load_time_ms": 17.767, "load_throughput": 2471983.141, "learn_time_ms": 1124.428, "learn_throughput": 39059.855, "synch_weights_time_ms": 0.955}, "counters": {"num_env_steps_sampled": 6254880, "num_env_steps_trained": 6254880, "num_agent_steps_sampled": 6254880, "num_agent_steps_trained": 6254880}, "done": false, "episodes_total": 1333, "training_iteration": 454, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-33-49", "timestamp": 1691091229, "time_this_iter_s": 62.76597571372986, "time_total_s": 11106.480775117874, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 559.6682634353638, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.53707865168539, "ram_util_percent": 62.81011235955056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4144379640807, "policy_loss": -7.97202158201628e+20, "vf_loss": 305809988.12827986}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 6298800, "num_env_steps_trained": 6298800, "num_agent_steps_sampled": 6298800, "num_agent_steps_trained": 6298800}, "sampler_results": {"episode_reward_max": -1357964.8344514098, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1361716.1592529076, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21084585266369849, "mean_inference_ms": 0.35321287603206225, "mean_action_processing_ms": 0.08615365813248924, "mean_env_wait_ms": 0.7007778733468153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037431716918945312, "StateBufferConnector_ms": 0.0024890899658203125, "ViewRequirementAgentConnector_ms": 0.06734371185302734}}, "episode_reward_max": -1357964.8344514098, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1361716.1592529076, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21084585266369849, "mean_inference_ms": 0.35321287603206225, "mean_action_processing_ms": 0.08615365813248924, "mean_env_wait_ms": 0.7007778733468153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037431716918945312, "StateBufferConnector_ms": 0.0024890899658203125, "ViewRequirementAgentConnector_ms": 0.06734371185302734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6298800, "num_agent_steps_trained": 6298800, "num_env_steps_sampled": 6298800, "num_env_steps_trained": 6298800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.563568352304, "num_env_steps_trained_throughput_per_sec": 705.563568352304, "timesteps_total": 6298800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6298800, "timers": {"training_iteration_time_ms": 62189.289, "sample_time_ms": 61047.058, "load_time_ms": 17.671, "load_throughput": 2485396.111, "learn_time_ms": 1123.448, "learn_throughput": 39093.924, "synch_weights_time_ms": 0.95}, "counters": {"num_env_steps_sampled": 6298800, "num_env_steps_trained": 6298800, "num_agent_steps_sampled": 6298800, "num_agent_steps_trained": 6298800}, "done": false, "episodes_total": 1334, "training_iteration": 455, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-34-52", "timestamp": 1691091292, "time_this_iter_s": 62.25095891952515, "time_total_s": 11168.7317340374, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 621.9192223548889, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.25340909090909, "ram_util_percent": 62.777272727272724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.412342127141, "policy_loss": -8.321919861009043e+20, "vf_loss": 306427076.81632656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 6342720, "num_env_steps_trained": 6342720, "num_agent_steps_sampled": 6342720, "num_agent_steps_trained": 6342720}, "sampler_results": {"episode_reward_max": -1357964.8344514098, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1361518.0274295115, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2110705840739845, "mean_inference_ms": 0.3541659853082764, "mean_action_processing_ms": 0.08641043973816954, "mean_env_wait_ms": 0.7011519743102467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036933205344460225, "StateBufferConnector_ms": 0.0025033950805664062, "ViewRequirementAgentConnector_ms": 0.0670844858342951}}, "episode_reward_max": -1357964.8344514098, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1361518.0274295115, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2110705840739845, "mean_inference_ms": 0.3541659853082764, "mean_action_processing_ms": 0.08641043973816954, "mean_env_wait_ms": 0.7011519743102467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036933205344460225, "StateBufferConnector_ms": 0.0025033950805664062, "ViewRequirementAgentConnector_ms": 0.0670844858342951}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6342720, "num_agent_steps_trained": 6342720, "num_env_steps_sampled": 6342720, "num_env_steps_trained": 6342720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 704.3539100867672, "num_env_steps_trained_throughput_per_sec": 704.3539100867672, "timesteps_total": 6342720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6342720, "timers": {"training_iteration_time_ms": 62685.476, "sample_time_ms": 61544.0, "load_time_ms": 19.323, "load_throughput": 2272945.609, "learn_time_ms": 1121.042, "learn_throughput": 39177.853, "synch_weights_time_ms": 0.952}, "counters": {"num_env_steps_sampled": 6342720, "num_env_steps_trained": 6342720, "num_agent_steps_sampled": 6342720, "num_agent_steps_trained": 6342720}, "done": false, "episodes_total": 1335, "training_iteration": 456, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-35-54", "timestamp": 1691091354, "time_this_iter_s": 62.35764980316162, "time_total_s": 11231.089383840561, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 684.2768721580505, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.645454545454545, "ram_util_percent": 62.762499999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4049355198274, "policy_loss": -7.693305640670218e+20, "vf_loss": 305316926.4489796}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7889.5, "diff_num_grad_updates_vs_sampler_policy": 7888.5}}, "num_env_steps_sampled": 6386640, "num_env_steps_trained": 6386640, "num_agent_steps_sampled": 6386640, "num_agent_steps_trained": 6386640}, "sampler_results": {"episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1361142.8604408617, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21126710935660067, "mean_inference_ms": 0.35499354683974094, "mean_action_processing_ms": 0.08663334479153499, "mean_env_wait_ms": 0.7014331923231901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036537647247314453, "StateBufferConnector_ms": 0.0025093555450439453, "ViewRequirementAgentConnector_ms": 0.06696383158365886}}, "episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1361142.8604408617, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21126710935660067, "mean_inference_ms": 0.35499354683974094, "mean_action_processing_ms": 0.08663334479153499, "mean_env_wait_ms": 0.7014331923231901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036537647247314453, "StateBufferConnector_ms": 0.0025093555450439453, "ViewRequirementAgentConnector_ms": 0.06696383158365886}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6386640, "num_agent_steps_trained": 6386640, "num_env_steps_sampled": 6386640, "num_env_steps_trained": 6386640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 704.6419491934843, "num_env_steps_trained_throughput_per_sec": 704.6419491934843, "timesteps_total": 6386640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6386640, "timers": {"training_iteration_time_ms": 62558.834, "sample_time_ms": 61417.565, "load_time_ms": 18.926, "load_throughput": 2320579.064, "learn_time_ms": 1121.222, "learn_throughput": 39171.564, "synch_weights_time_ms": 0.96}, "counters": {"num_env_steps_sampled": 6386640, "num_env_steps_trained": 6386640, "num_agent_steps_sampled": 6386640, "num_agent_steps_trained": 6386640}, "done": false, "episodes_total": 1336, "training_iteration": 457, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-36-56", "timestamp": 1691091416, "time_this_iter_s": 62.33210301399231, "time_total_s": 11293.421486854553, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 746.6089751720428, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.8876404494382, "ram_util_percent": 62.753932584269656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.40331995661, "policy_loss": -7.444641993248392e+20, "vf_loss": 306084985.1137026}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8575.5, "diff_num_grad_updates_vs_sampler_policy": 8574.5}}, "num_env_steps_sampled": 6430560, "num_env_steps_trained": 6430560, "num_agent_steps_sampled": 6430560, "num_agent_steps_trained": 6430560}, "sampler_results": {"episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360946.7358497917, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21143020845593521, "mean_inference_ms": 0.3557163379842298, "mean_action_processing_ms": 0.08682832545588717, "mean_env_wait_ms": 0.7016039777800014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003616626446063702, "StateBufferConnector_ms": 0.0025290709275465747, "ViewRequirementAgentConnector_ms": 0.06683056171123798}}, "episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360946.7358497917, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21143020845593521, "mean_inference_ms": 0.3557163379842298, "mean_action_processing_ms": 0.08682832545588717, "mean_env_wait_ms": 0.7016039777800014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003616626446063702, "StateBufferConnector_ms": 0.0025290709275465747, "ViewRequirementAgentConnector_ms": 0.06683056171123798}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6430560, "num_agent_steps_trained": 6430560, "num_env_steps_sampled": 6430560, "num_env_steps_trained": 6430560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.5512524293613, "num_env_steps_trained_throughput_per_sec": 709.5512524293613, "timesteps_total": 6430560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6430560, "timers": {"training_iteration_time_ms": 62461.773, "sample_time_ms": 61320.206, "load_time_ms": 18.518, "load_throughput": 2371805.085, "learn_time_ms": 1121.93, "learn_throughput": 39146.824, "synch_weights_time_ms": 0.958}, "counters": {"num_env_steps_sampled": 6430560, "num_env_steps_trained": 6430560, "num_agent_steps_sampled": 6430560, "num_agent_steps_trained": 6430560}, "done": false, "episodes_total": 1337, "training_iteration": 458, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-37-58", "timestamp": 1691091478, "time_this_iter_s": 61.90089297294617, "time_total_s": 11355.3223798275, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 808.509868144989, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.67011494252873, "ram_util_percent": 62.80919540229885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4160490786717, "policy_loss": -7.837668876518284e+20, "vf_loss": 306734824.6472303}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 6474480, "num_env_steps_trained": 6474480, "num_agent_steps_sampled": 6474480, "num_agent_steps_trained": 6474480}, "sampler_results": {"episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360902.7212133973, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2115754415179675, "mean_inference_ms": 0.3563525297727918, "mean_action_processing_ms": 0.08699905656859692, "mean_env_wait_ms": 0.7017220310639483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035881996154785156, "StateBufferConnector_ms": 0.0025033950805664062, "ViewRequirementAgentConnector_ms": 0.06694623402186803}}, "episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360902.7212133973, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2115754415179675, "mean_inference_ms": 0.3563525297727918, "mean_action_processing_ms": 0.08699905656859692, "mean_env_wait_ms": 0.7017220310639483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035881996154785156, "StateBufferConnector_ms": 0.0025033950805664062, "ViewRequirementAgentConnector_ms": 0.06694623402186803}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6474480, "num_agent_steps_trained": 6474480, "num_env_steps_sampled": 6474480, "num_env_steps_trained": 6474480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.5016585779579, "num_env_steps_trained_throughput_per_sec": 706.5016585779579, "timesteps_total": 6474480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6474480, "timers": {"training_iteration_time_ms": 62390.468, "sample_time_ms": 61249.537, "load_time_ms": 18.098, "load_throughput": 2426784.734, "learn_time_ms": 1121.703, "learn_throughput": 39154.743, "synch_weights_time_ms": 0.969}, "counters": {"num_env_steps_sampled": 6474480, "num_env_steps_trained": 6474480, "num_agent_steps_sampled": 6474480, "num_agent_steps_trained": 6474480}, "done": false, "episodes_total": 1338, "training_iteration": 459, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-39-00", "timestamp": 1691091540, "time_this_iter_s": 62.16824293136597, "time_total_s": 11417.490622758865, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 870.678111076355, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.252272727272725, "ram_util_percent": 62.7590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4211947160281, "policy_loss": -7.894454243019051e+20, "vf_loss": 305611841.29446065}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9947.5, "diff_num_grad_updates_vs_sampler_policy": 9946.5}}, "num_env_steps_sampled": 6518400, "num_env_steps_trained": 6518400, "num_agent_steps_sampled": 6518400, "num_agent_steps_trained": 6518400}, "sampler_results": {"episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360692.3911205663, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21170235813158653, "mean_inference_ms": 0.3569195306178331, "mean_action_processing_ms": 0.08715156115166538, "mean_env_wait_ms": 0.7018097678825733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035572052001953125, "StateBufferConnector_ms": 0.0025065739949544272, "ViewRequirementAgentConnector_ms": 0.06689707438151042}}, "episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360692.3911205663, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21170235813158653, "mean_inference_ms": 0.3569195306178331, "mean_action_processing_ms": 0.08715156115166538, "mean_env_wait_ms": 0.7018097678825733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035572052001953125, "StateBufferConnector_ms": 0.0025065739949544272, "ViewRequirementAgentConnector_ms": 0.06689707438151042}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6518400, "num_agent_steps_trained": 6518400, "num_env_steps_sampled": 6518400, "num_env_steps_trained": 6518400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.5682381350096, "num_env_steps_trained_throughput_per_sec": 705.5682381350096, "timesteps_total": 6518400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6518400, "timers": {"training_iteration_time_ms": 62350.17, "sample_time_ms": 61210.256, "load_time_ms": 17.734, "load_throughput": 2476648.14, "learn_time_ms": 1121.054, "learn_throughput": 39177.431, "synch_weights_time_ms": 0.967}, "counters": {"num_env_steps_sampled": 6518400, "num_env_steps_trained": 6518400, "num_agent_steps_sampled": 6518400, "num_agent_steps_trained": 6518400}, "done": false, "episodes_total": 1339, "training_iteration": 460, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-40-03", "timestamp": 1691091603, "time_this_iter_s": 62.250441789627075, "time_total_s": 11479.741064548492, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 932.928552865982, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.598863636363635, "ram_util_percent": 62.779545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4181970535144, "policy_loss": -7.668243069252437e+20, "vf_loss": 305380518.2390671}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10633.5, "diff_num_grad_updates_vs_sampler_policy": 10632.5}}, "num_env_steps_sampled": 6562320, "num_env_steps_trained": 6562320, "num_agent_steps_sampled": 6562320, "num_agent_steps_trained": 6562320}, "sampler_results": {"episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360486.2441615805, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2118247688799637, "mean_inference_ms": 0.35742906144772013, "mean_action_processing_ms": 0.08728805466081005, "mean_env_wait_ms": 0.7018616798003194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509223461151123, "StateBufferConnector_ms": 0.002531707286834717, "ViewRequirementAgentConnector_ms": 0.06680488586425781}}, "episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360486.2441615805, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2118247688799637, "mean_inference_ms": 0.35742906144772013, "mean_action_processing_ms": 0.08728805466081005, "mean_env_wait_ms": 0.7018616798003194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509223461151123, "StateBufferConnector_ms": 0.002531707286834717, "ViewRequirementAgentConnector_ms": 0.06680488586425781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6562320, "num_agent_steps_trained": 6562320, "num_env_steps_sampled": 6562320, "num_env_steps_trained": 6562320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.7237058327565, "num_env_steps_trained_throughput_per_sec": 705.7237058327565, "timesteps_total": 6562320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6562320, "timers": {"training_iteration_time_ms": 62352.911, "sample_time_ms": 61212.333, "load_time_ms": 17.405, "load_throughput": 2523408.012, "learn_time_ms": 1122.059, "learn_throughput": 39142.34, "synch_weights_time_ms": 0.954}, "counters": {"num_env_steps_sampled": 6562320, "num_env_steps_trained": 6562320, "num_agent_steps_sampled": 6562320, "num_agent_steps_trained": 6562320}, "done": false, "episodes_total": 1340, "training_iteration": 461, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-41-05", "timestamp": 1691091665, "time_this_iter_s": 62.23669195175171, "time_total_s": 11541.977756500244, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 995.1652448177338, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.676136363636367, "ram_util_percent": 62.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4175313610376, "policy_loss": -7.702328130766787e+20, "vf_loss": 306163180.1749271}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11319.5, "diff_num_grad_updates_vs_sampler_policy": 11318.5}}, "num_env_steps_sampled": 6606240, "num_env_steps_trained": 6606240, "num_agent_steps_sampled": 6606240, "num_agent_steps_trained": 6606240}, "sampler_results": {"episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360385.2553860783, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.211939479691169, "mean_inference_ms": 0.3578900792547816, "mean_action_processing_ms": 0.08741139302691035, "mean_env_wait_ms": 0.7019213504706028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003507558037252987, "StateBufferConnector_ms": 0.002580530503216912, "ViewRequirementAgentConnector_ms": 0.06717653835521024}}, "episode_reward_max": -1357016.0235657156, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360385.2553860783, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.211939479691169, "mean_inference_ms": 0.3578900792547816, "mean_action_processing_ms": 0.08741139302691035, "mean_env_wait_ms": 0.7019213504706028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003507558037252987, "StateBufferConnector_ms": 0.002580530503216912, "ViewRequirementAgentConnector_ms": 0.06717653835521024}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6606240, "num_agent_steps_trained": 6606240, "num_env_steps_sampled": 6606240, "num_env_steps_trained": 6606240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.089335591179, "num_env_steps_trained_throughput_per_sec": 701.089335591179, "timesteps_total": 6606240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6606240, "timers": {"training_iteration_time_ms": 62354.837, "sample_time_ms": 61214.273, "load_time_ms": 17.061, "load_throughput": 2574271.4, "learn_time_ms": 1122.375, "learn_throughput": 39131.296, "synch_weights_time_ms": 0.966}, "counters": {"num_env_steps_sampled": 6606240, "num_env_steps_trained": 6606240, "num_agent_steps_sampled": 6606240, "num_agent_steps_trained": 6606240}, "done": false, "episodes_total": 1341, "training_iteration": 462, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-42-08", "timestamp": 1691091728, "time_this_iter_s": 62.647960901260376, "time_total_s": 11604.625717401505, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1057.8132057189941, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.57415730337079, "ram_util_percent": 62.76404494382024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.408165934482, "policy_loss": -7.910377713793519e+20, "vf_loss": 305100712.56559765}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12005.5, "diff_num_grad_updates_vs_sampler_policy": 12004.5}}, "num_env_steps_sampled": 6650160, "num_env_steps_trained": 6650160, "num_agent_steps_sampled": 6650160, "num_agent_steps_trained": 6650160}, "sampler_results": {"episode_reward_max": -1356448.335173681, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360166.5375965005, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21204363239948248, "mean_inference_ms": 0.3583069401635646, "mean_action_processing_ms": 0.08752314271149025, "mean_env_wait_ms": 0.7019610462670536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034703148735894095, "StateBufferConnector_ms": 0.0025815433926052516, "ViewRequirementAgentConnector_ms": 0.06707774268256293}}, "episode_reward_max": -1356448.335173681, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360166.5375965005, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21204363239948248, "mean_inference_ms": 0.3583069401635646, "mean_action_processing_ms": 0.08752314271149025, "mean_env_wait_ms": 0.7019610462670536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034703148735894095, "StateBufferConnector_ms": 0.0025815433926052516, "ViewRequirementAgentConnector_ms": 0.06707774268256293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6650160, "num_agent_steps_trained": 6650160, "num_env_steps_sampled": 6650160, "num_env_steps_trained": 6650160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.0224562364865, "num_env_steps_trained_throughput_per_sec": 706.0224562364865, "timesteps_total": 6650160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6650160, "timers": {"training_iteration_time_ms": 62309.436, "sample_time_ms": 61172.995, "load_time_ms": 17.05, "load_throughput": 2575916.454, "learn_time_ms": 1118.272, "learn_throughput": 39274.871, "synch_weights_time_ms": 0.957}, "counters": {"num_env_steps_sampled": 6650160, "num_env_steps_trained": 6650160, "num_agent_steps_sampled": 6650160, "num_agent_steps_trained": 6650160}, "done": false, "episodes_total": 1342, "training_iteration": 463, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-43-10", "timestamp": 1691091790, "time_this_iter_s": 62.2103807926178, "time_total_s": 11666.836098194122, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1120.023586511612, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.997727272727275, "ram_util_percent": 62.838636363636354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.3882280800156, "policy_loss": -6.946547615494186e+20, "vf_loss": 305806968.64139944}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12691.5, "diff_num_grad_updates_vs_sampler_policy": 12690.5}}, "num_env_steps_sampled": 6694080, "num_env_steps_trained": 6694080, "num_agent_steps_sampled": 6694080, "num_agent_steps_trained": 6694080}, "sampler_results": {"episode_reward_max": -1356448.335173681, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360051.8496165369, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21214233430683094, "mean_inference_ms": 0.35869074993278566, "mean_action_processing_ms": 0.08762523788186444, "mean_env_wait_ms": 0.7019453907370414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459579066226357, "StateBufferConnector_ms": 0.0025724109850431744, "ViewRequirementAgentConnector_ms": 0.06700314973530017}}, "episode_reward_max": -1356448.335173681, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1360051.8496165369, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21214233430683094, "mean_inference_ms": 0.35869074993278566, "mean_action_processing_ms": 0.08762523788186444, "mean_env_wait_ms": 0.7019453907370414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459579066226357, "StateBufferConnector_ms": 0.0025724109850431744, "ViewRequirementAgentConnector_ms": 0.06700314973530017}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6694080, "num_agent_steps_trained": 6694080, "num_env_steps_sampled": 6694080, "num_env_steps_trained": 6694080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.1662439843309, "num_env_steps_trained_throughput_per_sec": 711.1662439843309, "timesteps_total": 6694080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6694080, "timers": {"training_iteration_time_ms": 62208.862, "sample_time_ms": 61068.62, "load_time_ms": 16.643, "load_throughput": 2638943.58, "learn_time_ms": 1122.476, "learn_throughput": 39127.787, "synch_weights_time_ms": 0.961}, "counters": {"num_env_steps_sampled": 6694080, "num_env_steps_trained": 6694080, "num_agent_steps_sampled": 6694080, "num_agent_steps_trained": 6694080}, "done": false, "episodes_total": 1343, "training_iteration": 464, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-44-12", "timestamp": 1691091852, "time_this_iter_s": 61.76028490066528, "time_total_s": 11728.596383094788, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1181.7838714122772, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.759090909090908, "ram_util_percent": 62.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4084803634066, "policy_loss": -7.084568790826054e+20, "vf_loss": 305683302.6938776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13377.5, "diff_num_grad_updates_vs_sampler_policy": 13376.5}}, "num_env_steps_sampled": 6738000, "num_env_steps_trained": 6738000, "num_agent_steps_sampled": 6738000, "num_agent_steps_trained": 6738000}, "sampler_results": {"episode_reward_max": -1356448.335173681, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1359937.5381911313, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2122376266074797, "mean_inference_ms": 0.35904365522272963, "mean_action_processing_ms": 0.08771827785834228, "mean_env_wait_ms": 0.7019250722488751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034499168395996094, "StateBufferConnector_ms": 0.0025784969329833984, "ViewRequirementAgentConnector_ms": 0.06700396537780762}}, "episode_reward_max": -1356448.335173681, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1359937.5381911313, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2122376266074797, "mean_inference_ms": 0.35904365522272963, "mean_action_processing_ms": 0.08771827785834228, "mean_env_wait_ms": 0.7019250722488751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034499168395996094, "StateBufferConnector_ms": 0.0025784969329833984, "ViewRequirementAgentConnector_ms": 0.06700396537780762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6738000, "num_agent_steps_trained": 6738000, "num_env_steps_sampled": 6738000, "num_env_steps_trained": 6738000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 704.6200932991541, "num_env_steps_trained_throughput_per_sec": 704.6200932991541, "timesteps_total": 6738000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6738000, "timers": {"training_iteration_time_ms": 62217.197, "sample_time_ms": 61077.428, "load_time_ms": 16.584, "load_throughput": 2648321.945, "learn_time_ms": 1122.053, "learn_throughput": 39142.521, "synch_weights_time_ms": 0.97}, "counters": {"num_env_steps_sampled": 6738000, "num_env_steps_trained": 6738000, "num_agent_steps_sampled": 6738000, "num_agent_steps_trained": 6738000}, "done": false, "episodes_total": 1344, "training_iteration": 465, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-45-14", "timestamp": 1691091914, "time_this_iter_s": 62.334107875823975, "time_total_s": 11790.930490970612, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1244.1179792881012, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.595454545454544, "ram_util_percent": 63.12045454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.397368761958, "policy_loss": -7.139786869985534e+20, "vf_loss": 303945946.6122449}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14063.5, "diff_num_grad_updates_vs_sampler_policy": 14062.5}}, "num_env_steps_sampled": 6781920, "num_env_steps_trained": 6781920, "num_agent_steps_sampled": 6781920, "num_agent_steps_trained": 6781920}, "sampler_results": {"episode_reward_max": -1353824.0562198034, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1359646.4200020204, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21232879076154615, "mean_inference_ms": 0.35936945344341575, "mean_action_processing_ms": 0.08780471309841566, "mean_env_wait_ms": 0.7018824290783924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034309568859281995, "StateBufferConnector_ms": 0.0025942212059384302, "ViewRequirementAgentConnector_ms": 0.06700924464634486}}, "episode_reward_max": -1353824.0562198034, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1359646.4200020204, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21232879076154615, "mean_inference_ms": 0.35936945344341575, "mean_action_processing_ms": 0.08780471309841566, "mean_env_wait_ms": 0.7018824290783924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034309568859281995, "StateBufferConnector_ms": 0.0025942212059384302, "ViewRequirementAgentConnector_ms": 0.06700924464634486}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6781920, "num_agent_steps_trained": 6781920, "num_env_steps_sampled": 6781920, "num_env_steps_trained": 6781920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 708.4449826478624, "num_env_steps_trained_throughput_per_sec": 708.4449826478624, "timesteps_total": 6781920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6781920, "timers": {"training_iteration_time_ms": 62181.188, "sample_time_ms": 61041.167, "load_time_ms": 16.675, "load_throughput": 2633823.528, "learn_time_ms": 1122.223, "learn_throughput": 39136.608, "synch_weights_time_ms": 0.961}, "counters": {"num_env_steps_sampled": 6781920, "num_env_steps_trained": 6781920, "num_agent_steps_sampled": 6781920, "num_agent_steps_trained": 6781920}, "done": false, "episodes_total": 1345, "training_iteration": 466, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-46-16", "timestamp": 1691091976, "time_this_iter_s": 61.997578859329224, "time_total_s": 11852.92806982994, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1306.1155581474304, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.020454545454545, "ram_util_percent": 63.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4091286172672, "policy_loss": -6.814664574929965e+20, "vf_loss": 302838534.05247813}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14749.5, "diff_num_grad_updates_vs_sampler_policy": 14748.5}}, "num_env_steps_sampled": 6825840, "num_env_steps_trained": 6825840, "num_agent_steps_sampled": 6825840, "num_agent_steps_trained": 6825840}, "sampler_results": {"episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1359283.346846379, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21241789940398512, "mean_inference_ms": 0.35967179825561274, "mean_action_processing_ms": 0.08788469190841645, "mean_env_wait_ms": 0.7018138745637984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034223903309215198, "StateBufferConnector_ms": 0.002582506699995561, "ViewRequirementAgentConnector_ms": 0.0669240951538086}}, "episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1359283.346846379, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21241789940398512, "mean_inference_ms": 0.35967179825561274, "mean_action_processing_ms": 0.08788469190841645, "mean_env_wait_ms": 0.7018138745637984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034223903309215198, "StateBufferConnector_ms": 0.002582506699995561, "ViewRequirementAgentConnector_ms": 0.0669240951538086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6825840, "num_agent_steps_trained": 6825840, "num_env_steps_sampled": 6825840, "num_env_steps_trained": 6825840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.0117314269385, "num_env_steps_trained_throughput_per_sec": 710.0117314269385, "timesteps_total": 6825840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6825840, "timers": {"training_iteration_time_ms": 62134.049, "sample_time_ms": 60993.099, "load_time_ms": 16.669, "load_throughput": 2634829.367, "learn_time_ms": 1123.159, "learn_throughput": 39103.978, "synch_weights_time_ms": 0.96}, "counters": {"num_env_steps_sampled": 6825840, "num_env_steps_trained": 6825840, "num_agent_steps_sampled": 6825840, "num_agent_steps_trained": 6825840}, "done": false, "episodes_total": 1346, "training_iteration": 467, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-47-18", "timestamp": 1691092038, "time_this_iter_s": 61.86060094833374, "time_total_s": 11914.788670778275, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1367.9761590957642, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.26551724137931, "ram_util_percent": 63.1080459770115}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.3948399846824, "policy_loss": -6.734320463745977e+20, "vf_loss": 303239028.97959185}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 15434.5}}, "num_env_steps_sampled": 6869760, "num_env_steps_trained": 6869760, "num_agent_steps_sampled": 6869760, "num_agent_steps_trained": 6869760}, "sampler_results": {"episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358978.8263433273, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21250284853729468, "mean_inference_ms": 0.35995168448637865, "mean_action_processing_ms": 0.08795878530285448, "mean_env_wait_ms": 0.7017372943080049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033959098484205165, "StateBufferConnector_ms": 0.0025966893071713653, "ViewRequirementAgentConnector_ms": 0.0669054363084876}}, "episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358978.8263433273, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21250284853729468, "mean_inference_ms": 0.35995168448637865, "mean_action_processing_ms": 0.08795878530285448, "mean_env_wait_ms": 0.7017372943080049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033959098484205165, "StateBufferConnector_ms": 0.0025966893071713653, "ViewRequirementAgentConnector_ms": 0.0669054363084876}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6869760, "num_agent_steps_trained": 6869760, "num_env_steps_sampled": 6869760, "num_env_steps_trained": 6869760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.7654966759881, "num_env_steps_trained_throughput_per_sec": 707.7654966759881, "timesteps_total": 6869760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6869760, "timers": {"training_iteration_time_ms": 62149.667, "sample_time_ms": 61007.465, "load_time_ms": 16.47, "load_throughput": 2666608.258, "learn_time_ms": 1124.613, "learn_throughput": 39053.441, "synch_weights_time_ms": 0.957}, "counters": {"num_env_steps_sampled": 6869760, "num_env_steps_trained": 6869760, "num_agent_steps_sampled": 6869760, "num_agent_steps_trained": 6869760}, "done": false, "episodes_total": 1347, "training_iteration": 468, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-48-20", "timestamp": 1691092100, "time_this_iter_s": 62.05707597732544, "time_total_s": 11976.8457467556, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1430.0332350730896, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.912499999999998, "ram_util_percent": 63.13977272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.402369552034, "policy_loss": -6.748525782130716e+20, "vf_loss": 303899331.5685131}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16121.5, "diff_num_grad_updates_vs_sampler_policy": 16120.5}}, "num_env_steps_sampled": 6913680, "num_env_steps_trained": 6913680, "num_agent_steps_sampled": 6913680, "num_agent_steps_trained": 6913680}, "sampler_results": {"episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358760.905218808, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2125844139904242, "mean_inference_ms": 0.36021104595513703, "mean_action_processing_ms": 0.08802736530060318, "mean_env_wait_ms": 0.7016425526835146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505746523539225, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.0669558842976888}}, "episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358760.905218808, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2125844139904242, "mean_inference_ms": 0.36021104595513703, "mean_action_processing_ms": 0.08802736530060318, "mean_env_wait_ms": 0.7016425526835146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505746523539225, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.0669558842976888}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6913680, "num_agent_steps_trained": 6913680, "num_env_steps_sampled": 6913680, "num_env_steps_trained": 6913680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.4512605176087, "num_env_steps_trained_throughput_per_sec": 711.4512605176087, "timesteps_total": 6913680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6913680, "timers": {"training_iteration_time_ms": 62106.418, "sample_time_ms": 60964.231, "load_time_ms": 16.508, "load_throughput": 2660580.889, "learn_time_ms": 1124.571, "learn_throughput": 39054.893, "synch_weights_time_ms": 0.948}, "counters": {"num_env_steps_sampled": 6913680, "num_env_steps_trained": 6913680, "num_agent_steps_sampled": 6913680, "num_agent_steps_trained": 6913680}, "done": false, "episodes_total": 1348, "training_iteration": 469, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-49-22", "timestamp": 1691092162, "time_this_iter_s": 61.73547410964966, "time_total_s": 12038.58122086525, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1491.7687091827393, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.3875, "ram_util_percent": 63.14545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.396550570563, "policy_loss": -5.903004346430388e+20, "vf_loss": 303909430.99708456}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16807.5, "diff_num_grad_updates_vs_sampler_policy": 16806.5}}, "num_env_steps_sampled": 6957600, "num_env_steps_trained": 6957600, "num_agent_steps_sampled": 6957600, "num_agent_steps_trained": 6957600}, "sampler_results": {"episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358563.7862859871, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21266064124756517, "mean_inference_ms": 0.3604535142020844, "mean_action_processing_ms": 0.08809116255762238, "mean_env_wait_ms": 0.7015147621144149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347900390625, "StateBufferConnector_ms": 0.0026044845581054688, "ViewRequirementAgentConnector_ms": 0.06704330444335938}}, "episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358563.7862859871, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21266064124756517, "mean_inference_ms": 0.3604535142020844, "mean_action_processing_ms": 0.08809116255762238, "mean_env_wait_ms": 0.7015147621144149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347900390625, "StateBufferConnector_ms": 0.0026044845581054688, "ViewRequirementAgentConnector_ms": 0.06704330444335938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6957600, "num_agent_steps_trained": 6957600, "num_env_steps_sampled": 6957600, "num_env_steps_trained": 6957600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.8973379056816, "num_env_steps_trained_throughput_per_sec": 717.8973379056816, "timesteps_total": 6957600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6957600, "timers": {"training_iteration_time_ms": 61999.515, "sample_time_ms": 60858.467, "load_time_ms": 16.581, "load_throughput": 2648797.946, "learn_time_ms": 1123.358, "learn_throughput": 39097.055, "synch_weights_time_ms": 0.947}, "counters": {"num_env_steps_sampled": 6957600, "num_env_steps_trained": 6957600, "num_agent_steps_sampled": 6957600, "num_agent_steps_trained": 6957600}, "done": false, "episodes_total": 1349, "training_iteration": 470, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-50-23", "timestamp": 1691092223, "time_this_iter_s": 61.18122220039368, "time_total_s": 12099.762443065643, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1552.949931383133, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.872093023255818, "ram_util_percent": 63.11279069767443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.3927695938867, "policy_loss": -6.287214902073054e+20, "vf_loss": 303547127.31778425}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17493.5, "diff_num_grad_updates_vs_sampler_policy": 17492.5}}, "num_env_steps_sampled": 7001520, "num_env_steps_trained": 7001520, "num_agent_steps_sampled": 7001520, "num_agent_steps_trained": 7001520}, "sampler_results": {"episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358355.2483572566, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21273435190361314, "mean_inference_ms": 0.3606789738952799, "mean_action_processing_ms": 0.08815038614657965, "mean_env_wait_ms": 0.7013689421841943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034644053532527043, "StateBufferConnector_ms": 0.0026152684138371395, "ViewRequirementAgentConnector_ms": 0.06699470373300406}}, "episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358355.2483572566, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21273435190361314, "mean_inference_ms": 0.3606789738952799, "mean_action_processing_ms": 0.08815038614657965, "mean_env_wait_ms": 0.7013689421841943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034644053532527043, "StateBufferConnector_ms": 0.0026152684138371395, "ViewRequirementAgentConnector_ms": 0.06699470373300406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7001520, "num_agent_steps_trained": 7001520, "num_env_steps_sampled": 7001520, "num_env_steps_trained": 7001520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.7511360750652, "num_env_steps_trained_throughput_per_sec": 714.7511360750652, "timesteps_total": 7001520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7001520, "timers": {"training_iteration_time_ms": 61920.912, "sample_time_ms": 60780.102, "load_time_ms": 16.54, "load_throughput": 2655456.997, "learn_time_ms": 1123.15, "learn_throughput": 39104.301, "synch_weights_time_ms": 0.959}, "counters": {"num_env_steps_sampled": 7001520, "num_env_steps_trained": 7001520, "num_agent_steps_sampled": 7001520, "num_agent_steps_trained": 7001520}, "done": false, "episodes_total": 1350, "training_iteration": 471, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-51-24", "timestamp": 1691092284, "time_this_iter_s": 61.4505980014801, "time_total_s": 12161.213041067123, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1614.400529384613, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 19.426436781609198, "ram_util_percent": 63.14942528735631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.010382513661202e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.725296242939, "policy_loss": -6.139112058199676e+20, "vf_loss": 304061926.11078715}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18179.5, "diff_num_grad_updates_vs_sampler_policy": 18178.5}}, "num_env_steps_sampled": 7045440, "num_env_steps_trained": 7045440, "num_agent_steps_sampled": 7045440, "num_agent_steps_trained": 7045440}, "sampler_results": {"episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358207.5525135694, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21280073487814383, "mean_inference_ms": 0.36088960753439847, "mean_action_processing_ms": 0.08820569788343828, "mean_env_wait_ms": 0.7012030466179799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449122111002604, "StateBufferConnector_ms": 0.0026181892112449364, "ViewRequirementAgentConnector_ms": 0.06698679040979456}}, "episode_reward_max": -1351658.8105779118, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1358207.5525135694, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21280073487814383, "mean_inference_ms": 0.36088960753439847, "mean_action_processing_ms": 0.08820569788343828, "mean_env_wait_ms": 0.7012030466179799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449122111002604, "StateBufferConnector_ms": 0.0026181892112449364, "ViewRequirementAgentConnector_ms": 0.06698679040979456}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7045440, "num_agent_steps_trained": 7045440, "num_env_steps_sampled": 7045440, "num_env_steps_trained": 7045440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.6680994891078, "num_env_steps_trained_throughput_per_sec": 718.6680994891078, "timesteps_total": 7045440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7045440, "timers": {"training_iteration_time_ms": 61767.68, "sample_time_ms": 60627.818, "load_time_ms": 16.498, "load_throughput": 2662072.672, "learn_time_ms": 1122.258, "learn_throughput": 39135.385, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 7045440, "num_env_steps_trained": 7045440, "num_agent_steps_sampled": 7045440, "num_agent_steps_trained": 7045440}, "done": false, "episodes_total": 1351, "training_iteration": 472, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-52-26", "timestamp": 1691092346, "time_this_iter_s": 61.11583209037781, "time_total_s": 12222.328873157501, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1675.5163614749908, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 19.58505747126437, "ram_util_percent": 63.18275862068966}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.310382513661202e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.9749819919598, "policy_loss": -5.206256546308837e+20, "vf_loss": 301798834.64139944}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18865.5, "diff_num_grad_updates_vs_sampler_policy": 18864.5}}, "num_env_steps_sampled": 7089360, "num_env_steps_trained": 7089360, "num_agent_steps_sampled": 7089360, "num_agent_steps_trained": 7089360}, "sampler_results": {"episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357881.1206944932, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21286427614158207, "mean_inference_ms": 0.36108681175717033, "mean_action_processing_ms": 0.08825720300721514, "mean_env_wait_ms": 0.7010139856222778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445999962942941, "StateBufferConnector_ms": 0.0026157924107142855, "ViewRequirementAgentConnector_ms": 0.06692664963858468}}, "episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357881.1206944932, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21286427614158207, "mean_inference_ms": 0.36108681175717033, "mean_action_processing_ms": 0.08825720300721514, "mean_env_wait_ms": 0.7010139856222778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445999962942941, "StateBufferConnector_ms": 0.0026157924107142855, "ViewRequirementAgentConnector_ms": 0.06692664963858468}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7089360, "num_agent_steps_trained": 7089360, "num_env_steps_sampled": 7089360, "num_env_steps_trained": 7089360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.2424280659886, "num_env_steps_trained_throughput_per_sec": 720.2424280659886, "timesteps_total": 7089360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7089360, "timers": {"training_iteration_time_ms": 61644.862, "sample_time_ms": 60506.613, "load_time_ms": 16.543, "load_throughput": 2654959.468, "learn_time_ms": 1120.611, "learn_throughput": 39192.915, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 7089360, "num_env_steps_trained": 7089360, "num_agent_steps_sampled": 7089360, "num_agent_steps_trained": 7089360}, "done": false, "episodes_total": 1352, "training_iteration": 473, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-53-27", "timestamp": 1691092407, "time_this_iter_s": 60.98275184631348, "time_total_s": 12283.311625003815, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1736.4991133213043, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 19.117441860465117, "ram_util_percent": 63.12790697674418}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.610382513661202e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1737.1985655136775, "policy_loss": -5.7480405032135315e+20, "vf_loss": 302486155.16034985}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19551.5, "diff_num_grad_updates_vs_sampler_policy": 19550.5}}, "num_env_steps_sampled": 7133280, "num_env_steps_trained": 7133280, "num_agent_steps_sampled": 7133280, "num_agent_steps_trained": 7133280}, "sampler_results": {"episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357631.820146045, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21292663063092454, "mean_inference_ms": 0.36127243021068284, "mean_action_processing_ms": 0.08830545491394395, "mean_env_wait_ms": 0.7008060499503074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035499704295191272, "StateBufferConnector_ms": 0.00263000356739965, "ViewRequirementAgentConnector_ms": 0.06722252944420123}}, "episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357631.820146045, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21292663063092454, "mean_inference_ms": 0.36127243021068284, "mean_action_processing_ms": 0.08830545491394395, "mean_env_wait_ms": 0.7008060499503074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035499704295191272, "StateBufferConnector_ms": 0.00263000356739965, "ViewRequirementAgentConnector_ms": 0.06722252944420123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7133280, "num_agent_steps_trained": 7133280, "num_env_steps_sampled": 7133280, "num_env_steps_trained": 7133280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.6544005562534, "num_env_steps_trained_throughput_per_sec": 719.6544005562534, "timesteps_total": 7133280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7133280, "timers": {"training_iteration_time_ms": 61572.02, "sample_time_ms": 60439.604, "load_time_ms": 16.67, "load_throughput": 2634633.413, "learn_time_ms": 1114.655, "learn_throughput": 39402.311, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 7133280, "num_env_steps_trained": 7133280, "num_agent_steps_sampled": 7133280, "num_agent_steps_trained": 7133280}, "done": false, "episodes_total": 1353, "training_iteration": 474, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-54-28", "timestamp": 1691092468, "time_this_iter_s": 61.03188896179199, "time_total_s": 12344.343513965607, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1797.5310022830963, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 19.375581395348835, "ram_util_percent": 63.167441860465104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.910382513661201e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1737.3652923850902, "policy_loss": -5.6537403107746775e+20, "vf_loss": 302165251.4635568}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20237.5, "diff_num_grad_updates_vs_sampler_policy": 20236.5}}, "num_env_steps_sampled": 7177200, "num_env_steps_trained": 7177200, "num_agent_steps_sampled": 7177200, "num_agent_steps_trained": 7177200}, "sampler_results": {"episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357373.833386198, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21298648603218953, "mean_inference_ms": 0.3614465863835072, "mean_action_processing_ms": 0.08835071814368514, "mean_env_wait_ms": 0.7005912468910551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035429000854492188, "StateBufferConnector_ms": 0.002628167470296224, "ViewRequirementAgentConnector_ms": 0.06715933481852214}}, "episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357373.833386198, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21298648603218953, "mean_inference_ms": 0.3614465863835072, "mean_action_processing_ms": 0.08835071814368514, "mean_env_wait_ms": 0.7005912468910551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035429000854492188, "StateBufferConnector_ms": 0.002628167470296224, "ViewRequirementAgentConnector_ms": 0.06715933481852214}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7177200, "num_agent_steps_trained": 7177200, "num_env_steps_sampled": 7177200, "num_env_steps_trained": 7177200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.6540473702013, "num_env_steps_trained_throughput_per_sec": 716.6540473702013, "timesteps_total": 7177200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7177200, "timers": {"training_iteration_time_ms": 61467.354, "sample_time_ms": 60332.578, "load_time_ms": 16.728, "load_throughput": 2625482.538, "learn_time_ms": 1116.937, "learn_throughput": 39321.832, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 7177200, "num_env_steps_trained": 7177200, "num_agent_steps_sampled": 7177200, "num_agent_steps_trained": 7177200}, "done": false, "episodes_total": 1354, "training_iteration": 475, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-55-29", "timestamp": 1691092529, "time_this_iter_s": 61.28755974769592, "time_total_s": 12405.631073713303, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1858.8185620307922, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.95287356321839, "ram_util_percent": 63.24482758620691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.210382513661204e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1737.5378147492256, "policy_loss": -5.997068324222232e+20, "vf_loss": 303192384.8862974}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20923.5, "diff_num_grad_updates_vs_sampler_policy": 20922.5}}, "num_env_steps_sampled": 7221120, "num_env_steps_trained": 7221120, "num_agent_steps_sampled": 7221120, "num_agent_steps_trained": 7221120}, "sampler_results": {"episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357202.263332946, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21304066121043128, "mean_inference_ms": 0.36160947417724193, "mean_action_processing_ms": 0.08839344833982156, "mean_env_wait_ms": 0.7003729627193611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035293640628937754, "StateBufferConnector_ms": 0.00263106438421434, "ViewRequirementAgentConnector_ms": 0.06713328822966545}}, "episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357202.263332946, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21304066121043128, "mean_inference_ms": 0.36160947417724193, "mean_action_processing_ms": 0.08839344833982156, "mean_env_wait_ms": 0.7003729627193611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035293640628937754, "StateBufferConnector_ms": 0.00263106438421434, "ViewRequirementAgentConnector_ms": 0.06713328822966545}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7221120, "num_agent_steps_trained": 7221120, "num_env_steps_sampled": 7221120, "num_env_steps_trained": 7221120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.3482702483926, "num_env_steps_trained_throughput_per_sec": 718.3482702483926, "timesteps_total": 7221120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7221120, "timers": {"training_iteration_time_ms": 61381.887, "sample_time_ms": 60248.312, "load_time_ms": 16.574, "load_throughput": 2649929.609, "learn_time_ms": 1115.896, "learn_throughput": 39358.511, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 7221120, "num_env_steps_trained": 7221120, "num_agent_steps_sampled": 7221120, "num_agent_steps_trained": 7221120}, "done": false, "episodes_total": 1355, "training_iteration": 476, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-56-30", "timestamp": 1691092590, "time_this_iter_s": 61.14292359352112, "time_total_s": 12466.773997306824, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1919.9614856243134, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.178160919540232, "ram_util_percent": 63.205747126436776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.510382513661204e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1737.6831189925747, "policy_loss": -6.210649924285672e+20, "vf_loss": 303777606.08746356}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21609.5, "diff_num_grad_updates_vs_sampler_policy": 21608.5}}, "num_env_steps_sampled": 7265040, "num_env_steps_trained": 7265040, "num_agent_steps_sampled": 7265040, "num_agent_steps_trained": 7265040}, "sampler_results": {"episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357083.7944103964, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21309265454246334, "mean_inference_ms": 0.3617616790304565, "mean_action_processing_ms": 0.08843377741583452, "mean_env_wait_ms": 0.7001445292823719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035114586353302, "StateBufferConnector_ms": 0.0026322901248931885, "ViewRequirementAgentConnector_ms": 0.06731897592544556}}, "episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357083.7944103964, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21309265454246334, "mean_inference_ms": 0.3617616790304565, "mean_action_processing_ms": 0.08843377741583452, "mean_env_wait_ms": 0.7001445292823719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035114586353302, "StateBufferConnector_ms": 0.0026322901248931885, "ViewRequirementAgentConnector_ms": 0.06731897592544556}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7265040, "num_agent_steps_trained": 7265040, "num_env_steps_sampled": 7265040, "num_env_steps_trained": 7265040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.0777757938102, "num_env_steps_trained_throughput_per_sec": 721.0777757938102, "timesteps_total": 7265040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7265040, "timers": {"training_iteration_time_ms": 61286.956, "sample_time_ms": 60154.304, "load_time_ms": 16.691, "load_throughput": 2631370.548, "learn_time_ms": 1114.85, "learn_throughput": 39395.45, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 7265040, "num_env_steps_trained": 7265040, "num_agent_steps_sampled": 7265040, "num_agent_steps_trained": 7265040}, "done": false, "episodes_total": 1356, "training_iteration": 477, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-57-31", "timestamp": 1691092651, "time_this_iter_s": 60.911744832992554, "time_total_s": 12527.685742139816, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1980.873230457306, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 22.593023255813954, "ram_util_percent": 63.1779069767442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.810382513661204e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1737.8226069236289, "policy_loss": -5.889135670833228e+20, "vf_loss": 304911933.8600583}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22295.5, "diff_num_grad_updates_vs_sampler_policy": 22294.5}}, "num_env_steps_sampled": 7308960, "num_env_steps_trained": 7308960, "num_agent_steps_sampled": 7308960, "num_agent_steps_trained": 7308960}, "sampler_results": {"episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357049.3244491746, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2131411814186175, "mean_inference_ms": 0.3619046473662706, "mean_action_processing_ms": 0.08847210025002901, "mean_env_wait_ms": 0.699912833711211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034924709435665245, "StateBufferConnector_ms": 0.0026283842144590435, "ViewRequirementAgentConnector_ms": 0.06723476178718335}}, "episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1357049.3244491746, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2131411814186175, "mean_inference_ms": 0.3619046473662706, "mean_action_processing_ms": 0.08847210025002901, "mean_env_wait_ms": 0.699912833711211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034924709435665245, "StateBufferConnector_ms": 0.0026283842144590435, "ViewRequirementAgentConnector_ms": 0.06723476178718335}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7308960, "num_agent_steps_trained": 7308960, "num_env_steps_sampled": 7308960, "num_env_steps_trained": 7308960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.8863371424138, "num_env_steps_trained_throughput_per_sec": 718.8863371424138, "timesteps_total": 7308960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7308960, "timers": {"training_iteration_time_ms": 61190.96, "sample_time_ms": 60058.178, "load_time_ms": 16.871, "load_throughput": 2603339.029, "learn_time_ms": 1114.796, "learn_throughput": 39397.341, "synch_weights_time_ms": 0.95}, "counters": {"num_env_steps_sampled": 7308960, "num_env_steps_trained": 7308960, "num_agent_steps_sampled": 7308960, "num_agent_steps_trained": 7308960}, "done": false, "episodes_total": 1357, "training_iteration": 478, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-58-32", "timestamp": 1691092712, "time_this_iter_s": 61.097487926483154, "time_total_s": 12588.7832300663, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2041.970718383789, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 19.04252873563218, "ram_util_percent": 63.2103448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.110382513661203e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1737.9812246606232, "policy_loss": -6.380096093186891e+20, "vf_loss": 302900644.78134114}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22981.5, "diff_num_grad_updates_vs_sampler_policy": 22980.5}}, "num_env_steps_sampled": 7352880, "num_env_steps_trained": 7352880, "num_agent_steps_sampled": 7352880, "num_agent_steps_trained": 7352880}, "sampler_results": {"episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356894.3386091993, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21318711095809703, "mean_inference_ms": 0.3620399953248233, "mean_action_processing_ms": 0.08850844783704337, "mean_env_wait_ms": 0.6996827583971063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480210023767808, "StateBufferConnector_ms": 0.002626811756807215, "ViewRequirementAgentConnector_ms": 0.06720528883092544}}, "episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356894.3386091993, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21318711095809703, "mean_inference_ms": 0.3620399953248233, "mean_action_processing_ms": 0.08850844783704337, "mean_env_wait_ms": 0.6996827583971063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480210023767808, "StateBufferConnector_ms": 0.002626811756807215, "ViewRequirementAgentConnector_ms": 0.06720528883092544}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7352880, "num_agent_steps_trained": 7352880, "num_env_steps_sampled": 7352880, "num_env_steps_trained": 7352880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.3017806181846, "num_env_steps_trained_throughput_per_sec": 716.3017806181846, "timesteps_total": 7352880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7352880, "timers": {"training_iteration_time_ms": 61149.157, "sample_time_ms": 60018.23, "load_time_ms": 16.906, "load_throughput": 2597843.073, "learn_time_ms": 1112.896, "learn_throughput": 39464.61, "synch_weights_time_ms": 0.957}, "counters": {"num_env_steps_sampled": 7352880, "num_env_steps_trained": 7352880, "num_agent_steps_sampled": 7352880, "num_agent_steps_trained": 7352880}, "done": false, "episodes_total": 1358, "training_iteration": 479, "trial_id": "5bc4e_00000", "date": "2023-08-03_22-59-33", "timestamp": 1691092773, "time_this_iter_s": 61.31766724586487, "time_total_s": 12650.100897312164, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2103.288385629654, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 19.609302325581393, "ram_util_percent": 63.183720930232546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.410382513661203e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.114177381332, "policy_loss": -6.09329807565401e+20, "vf_loss": 303499748.7172012}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23667.5, "diff_num_grad_updates_vs_sampler_policy": 23666.5}}, "num_env_steps_sampled": 7396800, "num_env_steps_trained": 7396800, "num_agent_steps_sampled": 7396800, "num_agent_steps_trained": 7396800}, "sampler_results": {"episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356776.5562557688, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21323080581042486, "mean_inference_ms": 0.36216813193301206, "mean_action_processing_ms": 0.08854285700973086, "mean_env_wait_ms": 0.6994507602998287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003463200160435268, "StateBufferConnector_ms": 0.002636228288922991, "ViewRequirementAgentConnector_ms": 0.06727354867117745}}, "episode_reward_max": -1349067.4615794364, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356776.5562557688, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21323080581042486, "mean_inference_ms": 0.36216813193301206, "mean_action_processing_ms": 0.08854285700973086, "mean_env_wait_ms": 0.6994507602998287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003463200160435268, "StateBufferConnector_ms": 0.002636228288922991, "ViewRequirementAgentConnector_ms": 0.06727354867117745}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7396800, "num_agent_steps_trained": 7396800, "num_env_steps_sampled": 7396800, "num_env_steps_trained": 7396800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.6333827127173, "num_env_steps_trained_throughput_per_sec": 718.6333827127173, "timesteps_total": 7396800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7396800, "timers": {"training_iteration_time_ms": 61142.89, "sample_time_ms": 60009.538, "load_time_ms": 16.889, "load_throughput": 2600556.942, "learn_time_ms": 1115.324, "learn_throughput": 39378.697, "synch_weights_time_ms": 0.973}, "counters": {"num_env_steps_sampled": 7396800, "num_env_steps_trained": 7396800, "num_agent_steps_sampled": 7396800, "num_agent_steps_trained": 7396800}, "done": false, "episodes_total": 1359, "training_iteration": 480, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-00-35", "timestamp": 1691092835, "time_this_iter_s": 61.118993043899536, "time_total_s": 12711.219890356064, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2164.4073786735535, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.95977011494253, "ram_util_percent": 63.435632183908055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.710382513661203e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.258722866937, "policy_loss": -6.118011115291793e+20, "vf_loss": 301550764.1166181}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24353.5, "diff_num_grad_updates_vs_sampler_policy": 24352.5}}, "num_env_steps_sampled": 7440720, "num_env_steps_trained": 7440720, "num_agent_steps_sampled": 7440720, "num_agent_steps_trained": 7440720}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356550.2339194464, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21327045356229288, "mean_inference_ms": 0.3622894980859084, "mean_action_processing_ms": 0.08857570787763314, "mean_env_wait_ms": 0.6992166292187117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034583939446343314, "StateBufferConnector_ms": 0.0026325384775797525, "ViewRequirementAgentConnector_ms": 0.067240662044949}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356550.2339194464, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21327045356229288, "mean_inference_ms": 0.3622894980859084, "mean_action_processing_ms": 0.08857570787763314, "mean_env_wait_ms": 0.6992166292187117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034583939446343314, "StateBufferConnector_ms": 0.0026325384775797525, "ViewRequirementAgentConnector_ms": 0.067240662044949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7440720, "num_agent_steps_trained": 7440720, "num_env_steps_sampled": 7440720, "num_env_steps_trained": 7440720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.6906223508441, "num_env_steps_trained_throughput_per_sec": 720.6906223508441, "timesteps_total": 7440720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7440720, "timers": {"training_iteration_time_ms": 61092.249, "sample_time_ms": 59958.125, "load_time_ms": 16.873, "load_throughput": 2602978.529, "learn_time_ms": 1116.11, "learn_throughput": 39350.952, "synch_weights_time_ms": 0.974}, "counters": {"num_env_steps_sampled": 7440720, "num_env_steps_trained": 7440720, "num_agent_steps_sampled": 7440720, "num_agent_steps_trained": 7440720}, "done": false, "episodes_total": 1360, "training_iteration": 481, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-01-36", "timestamp": 1691092896, "time_this_iter_s": 60.94407296180725, "time_total_s": 12772.163963317871, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2225.3514516353607, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 19.48372093023256, "ram_util_percent": 63.50813953488372}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.980965391621132e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.3994676239636, "policy_loss": -6.45045748571566e+20, "vf_loss": 302666318.851312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25039.5, "diff_num_grad_updates_vs_sampler_policy": 25038.5}}, "num_env_steps_sampled": 7484640, "num_env_steps_trained": 7484640, "num_agent_steps_sampled": 7484640, "num_agent_steps_trained": 7484640}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356402.4063036204, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21330953896910868, "mean_inference_ms": 0.36240565161838895, "mean_action_processing_ms": 0.08860729186776059, "mean_env_wait_ms": 0.6989885944431281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448692527977196, "StateBufferConnector_ms": 0.0026200268719647384, "ViewRequirementAgentConnector_ms": 0.06721857431772593}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356402.4063036204, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21330953896910868, "mean_inference_ms": 0.36240565161838895, "mean_action_processing_ms": 0.08860729186776059, "mean_env_wait_ms": 0.6989885944431281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448692527977196, "StateBufferConnector_ms": 0.0026200268719647384, "ViewRequirementAgentConnector_ms": 0.06721857431772593}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7484640, "num_agent_steps_trained": 7484640, "num_env_steps_sampled": 7484640, "num_env_steps_trained": 7484640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.7177544424904, "num_env_steps_trained_throughput_per_sec": 712.7177544424904, "timesteps_total": 7484640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7484640, "timers": {"training_iteration_time_ms": 61143.271, "sample_time_ms": 60008.828, "load_time_ms": 16.993, "load_throughput": 2584641.084, "learn_time_ms": 1116.311, "learn_throughput": 39343.875, "synch_weights_time_ms": 0.973}, "counters": {"num_env_steps_sampled": 7484640, "num_env_steps_trained": 7484640, "num_agent_steps_sampled": 7484640, "num_agent_steps_trained": 7484640}, "done": false, "episodes_total": 1361, "training_iteration": 482, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-02-37", "timestamp": 1691092957, "time_this_iter_s": 61.626508951187134, "time_total_s": 12833.790472269058, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2286.977960586548, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.27471264367816, "ram_util_percent": 63.53448275862071}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.430965391621131e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.5135604813913, "policy_loss": -6.343276799518365e+20, "vf_loss": 302781600.38483965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25725.5, "diff_num_grad_updates_vs_sampler_policy": 25724.5}}, "num_env_steps_sampled": 7528560, "num_env_steps_trained": 7528560, "num_agent_steps_sampled": 7528560, "num_agent_steps_trained": 7528560}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356267.5520005736, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21334855961787294, "mean_inference_ms": 0.3625166989543599, "mean_action_processing_ms": 0.08863772022408001, "mean_env_wait_ms": 0.6987674152905128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034413839641370273, "StateBufferConnector_ms": 0.002625114039370888, "ViewRequirementAgentConnector_ms": 0.06723717639320775}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356267.5520005736, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21334855961787294, "mean_inference_ms": 0.3625166989543599, "mean_action_processing_ms": 0.08863772022408001, "mean_env_wait_ms": 0.6987674152905128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034413839641370273, "StateBufferConnector_ms": 0.002625114039370888, "ViewRequirementAgentConnector_ms": 0.06723717639320775}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7528560, "num_agent_steps_trained": 7528560, "num_env_steps_sampled": 7528560, "num_env_steps_trained": 7528560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.8325763521954, "num_env_steps_trained_throughput_per_sec": 710.8325763521954, "timesteps_total": 7528560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7528560, "timers": {"training_iteration_time_ms": 61223.994, "sample_time_ms": 60081.814, "load_time_ms": 17.233, "load_throughput": 2548568.325, "learn_time_ms": 1123.808, "learn_throughput": 39081.419, "synch_weights_time_ms": 0.973}, "counters": {"num_env_steps_sampled": 7528560, "num_env_steps_trained": 7528560, "num_agent_steps_sampled": 7528560, "num_agent_steps_trained": 7528560}, "done": false, "episodes_total": 1362, "training_iteration": 483, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-03-39", "timestamp": 1691093019, "time_this_iter_s": 61.78971314430237, "time_total_s": 12895.58018541336, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2348.76767373085, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.49204545454546, "ram_util_percent": 63.56136363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.880965391621128e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.6863846403517, "policy_loss": -5.8882683621073545e+20, "vf_loss": 303191695.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26411.5, "diff_num_grad_updates_vs_sampler_policy": 26410.5}}, "num_env_steps_sampled": 7572480, "num_env_steps_trained": 7572480, "num_agent_steps_sampled": 7572480, "num_agent_steps_trained": 7572480}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356161.540224626, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21338600827481238, "mean_inference_ms": 0.362625243381782, "mean_action_processing_ms": 0.08866674560584191, "mean_env_wait_ms": 0.6985485522841718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034301708906124798, "StateBufferConnector_ms": 0.00265806149213742, "ViewRequirementAgentConnector_ms": 0.06725360185672076}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1356161.540224626, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21338600827481238, "mean_inference_ms": 0.362625243381782, "mean_action_processing_ms": 0.08866674560584191, "mean_env_wait_ms": 0.6985485522841718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034301708906124798, "StateBufferConnector_ms": 0.00265806149213742, "ViewRequirementAgentConnector_ms": 0.06725360185672076}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7572480, "num_agent_steps_trained": 7572480, "num_env_steps_sampled": 7572480, "num_env_steps_trained": 7572480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.6673164038514, "num_env_steps_trained_throughput_per_sec": 714.6673164038514, "timesteps_total": 7572480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7572480, "timers": {"training_iteration_time_ms": 61266.582, "sample_time_ms": 60124.417, "load_time_ms": 17.349, "load_throughput": 2531599.071, "learn_time_ms": 1123.679, "learn_throughput": 39085.902, "synch_weights_time_ms": 0.971}, "counters": {"num_env_steps_sampled": 7572480, "num_env_steps_trained": 7572480, "num_agent_steps_sampled": 7572480, "num_agent_steps_trained": 7572480}, "done": false, "episodes_total": 1363, "training_iteration": 484, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-04-41", "timestamp": 1691093081, "time_this_iter_s": 61.45817017555237, "time_total_s": 12957.038355588913, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2410.2258439064026, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.090804597701148, "ram_util_percent": 63.51954022988505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.330965391621128e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.81663615502, "policy_loss": -6.727260657622892e+20, "vf_loss": 301960485.7026239}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27097.5, "diff_num_grad_updates_vs_sampler_policy": 27096.5}}, "num_env_steps_sampled": 7616400, "num_env_steps_trained": 7616400, "num_agent_steps_sampled": 7616400, "num_agent_steps_trained": 7616400}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355993.396488631, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2134227856379622, "mean_inference_ms": 0.3627285541359851, "mean_action_processing_ms": 0.08869449212584099, "mean_env_wait_ms": 0.6983386483630868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034219026565551758, "StateBufferConnector_ms": 0.0026595592498779297, "ViewRequirementAgentConnector_ms": 0.06726682186126709}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355993.396488631, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2134227856379622, "mean_inference_ms": 0.3627285541359851, "mean_action_processing_ms": 0.08869449212584099, "mean_env_wait_ms": 0.6983386483630868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034219026565551758, "StateBufferConnector_ms": 0.0026595592498779297, "ViewRequirementAgentConnector_ms": 0.06726682186126709}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7616400, "num_agent_steps_trained": 7616400, "num_env_steps_sampled": 7616400, "num_env_steps_trained": 7616400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.8175070945798, "num_env_steps_trained_throughput_per_sec": 710.8175070945798, "timesteps_total": 7616400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7616400, "timers": {"training_iteration_time_ms": 61316.903, "sample_time_ms": 60175.434, "load_time_ms": 17.281, "load_throughput": 2541578.056, "learn_time_ms": 1123.079, "learn_throughput": 39106.769, "synch_weights_time_ms": 0.948}, "counters": {"num_env_steps_sampled": 7616400, "num_env_steps_trained": 7616400, "num_agent_steps_sampled": 7616400, "num_agent_steps_trained": 7616400}, "done": false, "episodes_total": 1364, "training_iteration": 485, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-05-42", "timestamp": 1691093142, "time_this_iter_s": 61.79092025756836, "time_total_s": 13018.829275846481, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2472.016764163971, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.4183908045977, "ram_util_percent": 63.52528735632186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.7809653916211284e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.9810283872198, "policy_loss": -6.477376203398574e+20, "vf_loss": 303144017.3994169}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27783.5, "diff_num_grad_updates_vs_sampler_policy": 27782.5}}, "num_env_steps_sampled": 7660320, "num_env_steps_trained": 7660320, "num_agent_steps_sampled": 7660320, "num_agent_steps_trained": 7660320}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355898.880577772, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21345864259207883, "mean_inference_ms": 0.3628266042582675, "mean_action_processing_ms": 0.08872107671439586, "mean_env_wait_ms": 0.6981328570025904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034093856811523438, "StateBufferConnector_ms": 0.002659820928806212, "ViewRequirementAgentConnector_ms": 0.06719275218684499}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355898.880577772, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21345864259207883, "mean_inference_ms": 0.3628266042582675, "mean_action_processing_ms": 0.08872107671439586, "mean_env_wait_ms": 0.6981328570025904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034093856811523438, "StateBufferConnector_ms": 0.002659820928806212, "ViewRequirementAgentConnector_ms": 0.06719275218684499}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7660320, "num_agent_steps_trained": 7660320, "num_env_steps_sampled": 7660320, "num_env_steps_trained": 7660320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.9410425368497, "num_env_steps_trained_throughput_per_sec": 714.9410425368497, "timesteps_total": 7660320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7660320, "timers": {"training_iteration_time_ms": 61346.041, "sample_time_ms": 60200.005, "load_time_ms": 17.303, "load_throughput": 2538282.636, "learn_time_ms": 1127.605, "learn_throughput": 38949.817, "synch_weights_time_ms": 0.966}, "counters": {"num_env_steps_sampled": 7660320, "num_env_steps_trained": 7660320, "num_agent_steps_sampled": 7660320, "num_agent_steps_trained": 7660320}, "done": false, "episodes_total": 1365, "training_iteration": 486, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-06-44", "timestamp": 1691093204, "time_this_iter_s": 61.43466019630432, "time_total_s": 13080.263936042786, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2533.4514243602753, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.27241379310345, "ram_util_percent": 63.573563218390824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.230965391621129e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.1018596682534, "policy_loss": -6.12785681459415e+20, "vf_loss": 305160611.4868805}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28469.5, "diff_num_grad_updates_vs_sampler_policy": 28468.5}}, "num_env_steps_sampled": 7704240, "num_env_steps_trained": 7704240, "num_agent_steps_sampled": 7704240, "num_agent_steps_trained": 7704240}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355911.7246321375, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2134938195785706, "mean_inference_ms": 0.3629194657800972, "mean_action_processing_ms": 0.08874639437171399, "mean_env_wait_ms": 0.6979318533855062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003405979701450893, "StateBufferConnector_ms": 0.0026498522077287945, "ViewRequirementAgentConnector_ms": 0.06716535204932803}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355911.7246321375, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2134938195785706, "mean_inference_ms": 0.3629194657800972, "mean_action_processing_ms": 0.08874639437171399, "mean_env_wait_ms": 0.6979318533855062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003405979701450893, "StateBufferConnector_ms": 0.0026498522077287945, "ViewRequirementAgentConnector_ms": 0.06716535204932803}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7704240, "num_agent_steps_trained": 7704240, "num_env_steps_sampled": 7704240, "num_env_steps_trained": 7704240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.8966221260912, "num_env_steps_trained_throughput_per_sec": 714.8966221260912, "timesteps_total": 7704240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7704240, "timers": {"training_iteration_time_ms": 61398.704, "sample_time_ms": 60252.052, "load_time_ms": 17.17, "load_throughput": 2557992.525, "learn_time_ms": 1128.361, "learn_throughput": 38923.71, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 7704240, "num_env_steps_trained": 7704240, "num_agent_steps_sampled": 7704240, "num_agent_steps_trained": 7704240}, "done": false, "episodes_total": 1366, "training_iteration": 487, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-07-45", "timestamp": 1691093265, "time_this_iter_s": 61.438769817352295, "time_total_s": 13141.702705860138, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2594.8901941776276, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.364367816091953, "ram_util_percent": 63.43333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.6809653916211285e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.2230751326758, "policy_loss": -6.121640152417873e+20, "vf_loss": 303109668.0116618}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29155.5, "diff_num_grad_updates_vs_sampler_policy": 29154.5}}, "num_env_steps_sampled": 7748160, "num_env_steps_trained": 7748160, "num_agent_steps_sampled": 7748160, "num_agent_steps_trained": 7748160}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355822.6467644759, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21352585102894647, "mean_inference_ms": 0.36300829022805675, "mean_action_processing_ms": 0.08877054455505866, "mean_env_wait_ms": 0.6977346894438713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00346704970958621, "StateBufferConnector_ms": 0.002647000689839208, "ViewRequirementAgentConnector_ms": 0.0672157420668491}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355822.6467644759, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21352585102894647, "mean_inference_ms": 0.36300829022805675, "mean_action_processing_ms": 0.08877054455505866, "mean_env_wait_ms": 0.6977346894438713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00346704970958621, "StateBufferConnector_ms": 0.002647000689839208, "ViewRequirementAgentConnector_ms": 0.0672157420668491}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7748160, "num_agent_steps_trained": 7748160, "num_env_steps_sampled": 7748160, "num_env_steps_trained": 7748160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.2090459620209, "num_env_steps_trained_throughput_per_sec": 717.2090459620209, "timesteps_total": 7748160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7748160, "timers": {"training_iteration_time_ms": 61412.991, "sample_time_ms": 60266.38, "load_time_ms": 17.046, "load_throughput": 2576615.427, "learn_time_ms": 1128.441, "learn_throughput": 38920.95, "synch_weights_time_ms": 0.958}, "counters": {"num_env_steps_sampled": 7748160, "num_env_steps_trained": 7748160, "num_agent_steps_sampled": 7748160, "num_agent_steps_trained": 7748160}, "done": false, "episodes_total": 1367, "training_iteration": 488, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-08-47", "timestamp": 1691093327, "time_this_iter_s": 61.2403678894043, "time_total_s": 13202.943073749542, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2656.130562067032, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.018390804597704, "ram_util_percent": 63.50804597701149}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.1309653916211295e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.3710095819856, "policy_loss": -6.599660684871155e+20, "vf_loss": 303510449.74927115}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29841.5, "diff_num_grad_updates_vs_sampler_policy": 29840.5}}, "num_env_steps_sampled": 7792080, "num_env_steps_trained": 7792080, "num_agent_steps_sampled": 7792080, "num_agent_steps_trained": 7792080}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355758.2415220002, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2135573540441288, "mean_inference_ms": 0.3630929596978833, "mean_action_processing_ms": 0.08879377439082138, "mean_env_wait_ms": 0.6975418831410102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00345490195534446, "StateBufferConnector_ms": 0.00265403227372603, "ViewRequirementAgentConnector_ms": 0.06725679744373668}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355758.2415220002, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2135573540441288, "mean_inference_ms": 0.3630929596978833, "mean_action_processing_ms": 0.08879377439082138, "mean_env_wait_ms": 0.6975418831410102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00345490195534446, "StateBufferConnector_ms": 0.00265403227372603, "ViewRequirementAgentConnector_ms": 0.06725679744373668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7792080, "num_agent_steps_trained": 7792080, "num_env_steps_sampled": 7792080, "num_env_steps_trained": 7792080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.4656452475516, "num_env_steps_trained_throughput_per_sec": 714.4656452475516, "timesteps_total": 7792080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7792080, "timers": {"training_iteration_time_ms": 61428.749, "sample_time_ms": 60279.083, "load_time_ms": 17.096, "load_throughput": 2569004.839, "learn_time_ms": 1131.46, "learn_throughput": 38817.09, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 7792080, "num_env_steps_trained": 7792080, "num_agent_steps_sampled": 7792080, "num_agent_steps_trained": 7792080}, "done": false, "episodes_total": 1368, "training_iteration": 489, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-09-48", "timestamp": 1691093388, "time_this_iter_s": 61.4755072593689, "time_total_s": 13264.418581008911, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2717.6060693264008, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.235632183908045, "ram_util_percent": 63.52528735632185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.58096539162113e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.5021937067238, "policy_loss": -6.339786122603848e+20, "vf_loss": 302232602.0058309}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30527.5, "diff_num_grad_updates_vs_sampler_policy": 30526.5}}, "num_env_steps_sampled": 7836000, "num_env_steps_trained": 7836000, "num_agent_steps_sampled": 7836000, "num_agent_steps_trained": 7836000}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355632.6092391347, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21358772863036787, "mean_inference_ms": 0.3631736895041273, "mean_action_processing_ms": 0.088816089973389, "mean_env_wait_ms": 0.697353818348441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034496519300672743, "StateBufferConnector_ms": 0.0026559829711914062, "ViewRequirementAgentConnector_ms": 0.06731457180447048}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355632.6092391347, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21358772863036787, "mean_inference_ms": 0.3631736895041273, "mean_action_processing_ms": 0.088816089973389, "mean_env_wait_ms": 0.697353818348441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034496519300672743, "StateBufferConnector_ms": 0.0026559829711914062, "ViewRequirementAgentConnector_ms": 0.06731457180447048}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7836000, "num_agent_steps_trained": 7836000, "num_env_steps_sampled": 7836000, "num_env_steps_trained": 7836000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.9441613289698, "num_env_steps_trained_throughput_per_sec": 714.9441613289698, "timesteps_total": 7836000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7836000, "timers": {"training_iteration_time_ms": 61460.286, "sample_time_ms": 60311.809, "load_time_ms": 17.199, "load_throughput": 2553691.161, "learn_time_ms": 1130.169, "learn_throughput": 38861.444, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 7836000, "num_env_steps_trained": 7836000, "num_agent_steps_sampled": 7836000, "num_agent_steps_trained": 7836000}, "done": false, "episodes_total": 1369, "training_iteration": 490, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-10-49", "timestamp": 1691093449, "time_this_iter_s": 61.43411302566528, "time_total_s": 13325.852694034576, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2779.040182352066, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.222988505747125, "ram_util_percent": 63.552873563218405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.0309653916211296e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.61332484654, "policy_loss": -6.577894226624696e+20, "vf_loss": 303374022.83381927}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31213.5, "diff_num_grad_updates_vs_sampler_policy": 31212.5}}, "num_env_steps_sampled": 7879920, "num_env_steps_trained": 7879920, "num_agent_steps_sampled": 7879920, "num_agent_steps_trained": 7879920}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355571.0349287207, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21361787983829958, "mean_inference_ms": 0.3632518252759128, "mean_action_processing_ms": 0.08883768035083164, "mean_env_wait_ms": 0.6971699324556131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034420386604640794, "StateBufferConnector_ms": 0.0026547390481700068, "ViewRequirementAgentConnector_ms": 0.06731178449547809}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355571.0349287207, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21361787983829958, "mean_inference_ms": 0.3632518252759128, "mean_action_processing_ms": 0.08883768035083164, "mean_env_wait_ms": 0.6971699324556131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034420386604640794, "StateBufferConnector_ms": 0.0026547390481700068, "ViewRequirementAgentConnector_ms": 0.06731178449547809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7879920, "num_agent_steps_trained": 7879920, "num_env_steps_sampled": 7879920, "num_env_steps_trained": 7879920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.897866376013, "num_env_steps_trained_throughput_per_sec": 712.897866376013, "timesteps_total": 7879920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7879920, "timers": {"training_iteration_time_ms": 61526.902, "sample_time_ms": 60378.096, "load_time_ms": 17.207, "load_throughput": 2552396.144, "learn_time_ms": 1130.492, "learn_throughput": 38850.352, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 7879920, "num_env_steps_trained": 7879920, "num_agent_steps_sampled": 7879920, "num_agent_steps_trained": 7879920}, "done": false, "episodes_total": 1370, "training_iteration": 491, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-11-51", "timestamp": 1691093511, "time_this_iter_s": 61.61079812049866, "time_total_s": 13387.463492155075, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2840.6509804725647, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.028735632183906, "ram_util_percent": 63.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.7158567912377, "policy_loss": -6.253822679236279e+20, "vf_loss": 302670544.52478135}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31899.5, "diff_num_grad_updates_vs_sampler_policy": 31898.5}}, "num_env_steps_sampled": 7923840, "num_env_steps_trained": 7923840, "num_agent_steps_sampled": 7923840, "num_agent_steps_trained": 7923840}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355472.928784117, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21364800836686967, "mean_inference_ms": 0.36332664741402076, "mean_action_processing_ms": 0.08885848984944242, "mean_env_wait_ms": 0.6969903919278609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034286620769094912, "StateBufferConnector_ms": 0.002655577152333361, "ViewRequirementAgentConnector_ms": 0.0672715775510098}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355472.928784117, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21364800836686967, "mean_inference_ms": 0.36332664741402076, "mean_action_processing_ms": 0.08885848984944242, "mean_env_wait_ms": 0.6969903919278609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034286620769094912, "StateBufferConnector_ms": 0.002655577152333361, "ViewRequirementAgentConnector_ms": 0.0672715775510098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7923840, "num_agent_steps_trained": 7923840, "num_env_steps_sampled": 7923840, "num_env_steps_trained": 7923840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.4693565746793, "num_env_steps_trained_throughput_per_sec": 713.4693565746793, "timesteps_total": 7923840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7923840, "timers": {"training_iteration_time_ms": 61520.41, "sample_time_ms": 60370.243, "load_time_ms": 17.25, "load_throughput": 2546021.645, "learn_time_ms": 1131.806, "learn_throughput": 38805.238, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 7923840, "num_env_steps_trained": 7923840, "num_agent_steps_sampled": 7923840, "num_agent_steps_trained": 7923840}, "done": false, "episodes_total": 1371, "training_iteration": 492, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-12-53", "timestamp": 1691093573, "time_this_iter_s": 61.561342000961304, "time_total_s": 13449.024834156036, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2902.212322473526, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.73793103448276, "ram_util_percent": 63.657471264367814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.879931391502, "policy_loss": -6.427458569726339e+20, "vf_loss": 303777323.13702625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32585.5, "diff_num_grad_updates_vs_sampler_policy": 32584.5}}, "num_env_steps_sampled": 7967760, "num_env_steps_trained": 7967760, "num_agent_steps_sampled": 7967760, "num_agent_steps_trained": 7967760}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355431.3563151176, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2136776732853062, "mean_inference_ms": 0.3633984796395151, "mean_action_processing_ms": 0.08887850515252926, "mean_env_wait_ms": 0.69681494148065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477931022644043, "StateBufferConnector_ms": 0.0026563803354899087, "ViewRequirementAgentConnector_ms": 0.06724894046783447}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355431.3563151176, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2136776732853062, "mean_inference_ms": 0.3633984796395151, "mean_action_processing_ms": 0.08887850515252926, "mean_env_wait_ms": 0.69681494148065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477931022644043, "StateBufferConnector_ms": 0.0026563803354899087, "ViewRequirementAgentConnector_ms": 0.06724894046783447}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7967760, "num_agent_steps_trained": 7967760, "num_env_steps_sampled": 7967760, "num_env_steps_trained": 7967760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.2362183489959, "num_env_steps_trained_throughput_per_sec": 713.2362183489959, "timesteps_total": 7967760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7967760, "timers": {"training_iteration_time_ms": 61499.588, "sample_time_ms": 60349.322, "load_time_ms": 16.849, "load_throughput": 2606628.599, "learn_time_ms": 1132.305, "learn_throughput": 38788.141, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 7967760, "num_env_steps_trained": 7967760, "num_agent_steps_sampled": 7967760, "num_agent_steps_trained": 7967760}, "done": false, "episodes_total": 1372, "training_iteration": 493, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-13-54", "timestamp": 1691093634, "time_this_iter_s": 61.58158898353577, "time_total_s": 13510.606423139572, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2963.7939114570618, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.936363636363637, "ram_util_percent": 63.57272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.0055990413744, "policy_loss": -7.00977651091894e+20, "vf_loss": 302311358.82215744}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33271.5, "diff_num_grad_updates_vs_sampler_policy": 33270.5}}, "num_env_steps_sampled": 8011680, "num_env_steps_trained": 8011680, "num_agent_steps_sampled": 8011680, "num_agent_steps_trained": 8011680}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355327.1163601403, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2137065906867316, "mean_inference_ms": 0.36346859218596494, "mean_action_processing_ms": 0.08889781997246185, "mean_env_wait_ms": 0.6966454954271194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034775052751813617, "StateBufferConnector_ms": 0.0026517984818439093, "ViewRequirementAgentConnector_ms": 0.06723793185487086}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355327.1163601403, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2137065906867316, "mean_inference_ms": 0.36346859218596494, "mean_action_processing_ms": 0.08889781997246185, "mean_env_wait_ms": 0.6966454954271194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034775052751813617, "StateBufferConnector_ms": 0.0026517984818439093, "ViewRequirementAgentConnector_ms": 0.06723793185487086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8011680, "num_agent_steps_trained": 8011680, "num_env_steps_sampled": 8011680, "num_env_steps_trained": 8011680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.6074378718243, "num_env_steps_trained_throughput_per_sec": 710.6074378718243, "timesteps_total": 8011680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8011680, "timers": {"training_iteration_time_ms": 61534.699, "sample_time_ms": 60383.882, "load_time_ms": 16.749, "load_throughput": 2622305.743, "learn_time_ms": 1132.966, "learn_throughput": 38765.521, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 8011680, "num_env_steps_trained": 8011680, "num_agent_steps_sampled": 8011680, "num_agent_steps_trained": 8011680}, "done": false, "episodes_total": 1373, "training_iteration": 494, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-14-56", "timestamp": 1691093696, "time_this_iter_s": 61.809305906295776, "time_total_s": 13572.415729045868, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3025.6032173633575, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.239080459770115, "ram_util_percent": 63.61724137931035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.110943407776, "policy_loss": -6.578010850555357e+20, "vf_loss": 303469455.8542274}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33957.5, "diff_num_grad_updates_vs_sampler_policy": 33956.5}}, "num_env_steps_sampled": 8055600, "num_env_steps_trained": 8055600, "num_agent_steps_sampled": 8055600, "num_agent_steps_trained": 8055600}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355275.2337245652, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21373517568765407, "mean_inference_ms": 0.36353589762119526, "mean_action_processing_ms": 0.08891646000375991, "mean_env_wait_ms": 0.6964798753859391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034728050231933594, "StateBufferConnector_ms": 0.0026445388793945312, "ViewRequirementAgentConnector_ms": 0.0672602653503418}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355275.2337245652, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21373517568765407, "mean_inference_ms": 0.36353589762119526, "mean_action_processing_ms": 0.08891646000375991, "mean_env_wait_ms": 0.6964798753859391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034728050231933594, "StateBufferConnector_ms": 0.0026445388793945312, "ViewRequirementAgentConnector_ms": 0.0672602653503418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8055600, "num_agent_steps_trained": 8055600, "num_env_steps_sampled": 8055600, "num_env_steps_trained": 8055600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.800166653237, "num_env_steps_trained_throughput_per_sec": 713.800166653237, "timesteps_total": 8055600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8055600, "timers": {"training_iteration_time_ms": 61508.88, "sample_time_ms": 60357.614, "load_time_ms": 16.88, "load_throughput": 2601824.13, "learn_time_ms": 1133.268, "learn_throughput": 38755.161, "synch_weights_time_ms": 0.951}, "counters": {"num_env_steps_sampled": 8055600, "num_env_steps_trained": 8055600, "num_agent_steps_sampled": 8055600, "num_agent_steps_trained": 8055600}, "done": false, "episodes_total": 1374, "training_iteration": 495, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-15-58", "timestamp": 1691093758, "time_this_iter_s": 61.53258395195007, "time_total_s": 13633.948312997818, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3087.1358013153076, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.547126436781607, "ram_util_percent": 63.64137931034483}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.247747927296, "policy_loss": -6.125785282927796e+20, "vf_loss": 302207758.606414}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34643.5, "diff_num_grad_updates_vs_sampler_policy": 34642.5}}, "num_env_steps_sampled": 8099520, "num_env_steps_trained": 8099520, "num_agent_steps_sampled": 8099520, "num_agent_steps_trained": 8099520}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355170.5569859776, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21376275951530307, "mean_inference_ms": 0.363600730969637, "mean_action_processing_ms": 0.08893444373588266, "mean_env_wait_ms": 0.6963185948969237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034654841703527116, "StateBufferConnector_ms": 0.0026436413035673253, "ViewRequirementAgentConnector_ms": 0.06723544176887064}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355170.5569859776, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21376275951530307, "mean_inference_ms": 0.363600730969637, "mean_action_processing_ms": 0.08893444373588266, "mean_env_wait_ms": 0.6963185948969237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034654841703527116, "StateBufferConnector_ms": 0.0026436413035673253, "ViewRequirementAgentConnector_ms": 0.06723544176887064}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8099520, "num_agent_steps_trained": 8099520, "num_env_steps_sampled": 8099520, "num_env_steps_trained": 8099520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.6937769018041, "num_env_steps_trained_throughput_per_sec": 713.6937769018041, "timesteps_total": 8099520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8099520, "timers": {"training_iteration_time_ms": 61519.616, "sample_time_ms": 60370.411, "load_time_ms": 16.821, "load_throughput": 2610962.265, "learn_time_ms": 1131.262, "learn_throughput": 38823.897, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 8099520, "num_env_steps_trained": 8099520, "num_agent_steps_sampled": 8099520, "num_agent_steps_trained": 8099520}, "done": false, "episodes_total": 1375, "training_iteration": 496, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-16-59", "timestamp": 1691093819, "time_this_iter_s": 61.54163193702698, "time_total_s": 13695.489944934845, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3148.6774332523346, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.739772727272726, "ram_util_percent": 63.64545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.3729911781957, "policy_loss": -6.79602011384809e+20, "vf_loss": 302500736.4431487}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35329.5, "diff_num_grad_updates_vs_sampler_policy": 35328.5}}, "num_env_steps_sampled": 8143440, "num_env_steps_trained": 8143440, "num_agent_steps_sampled": 8143440, "num_agent_steps_trained": 8143440}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355085.134160974, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2137898483504349, "mean_inference_ms": 0.36366309104872696, "mean_action_processing_ms": 0.08895187102750027, "mean_env_wait_ms": 0.6961620174996954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034566108997051534, "StateBufferConnector_ms": 0.0026441537416898287, "ViewRequirementAgentConnector_ms": 0.06721845039954552}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355085.134160974, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2137898483504349, "mean_inference_ms": 0.36366309104872696, "mean_action_processing_ms": 0.08895187102750027, "mean_env_wait_ms": 0.6961620174996954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034566108997051534, "StateBufferConnector_ms": 0.0026441537416898287, "ViewRequirementAgentConnector_ms": 0.06721845039954552}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8143440, "num_agent_steps_trained": 8143440, "num_env_steps_sampled": 8143440, "num_env_steps_trained": 8143440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.4599788833746, "num_env_steps_trained_throughput_per_sec": 712.4599788833746, "timesteps_total": 8143440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8143440, "timers": {"training_iteration_time_ms": 61540.628, "sample_time_ms": 60390.953, "load_time_ms": 16.816, "load_throughput": 2611765.555, "learn_time_ms": 1131.746, "learn_throughput": 38807.301, "synch_weights_time_ms": 0.949}, "counters": {"num_env_steps_sampled": 8143440, "num_env_steps_trained": 8143440, "num_agent_steps_sampled": 8143440, "num_agent_steps_trained": 8143440}, "done": false, "episodes_total": 1376, "training_iteration": 497, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-18-01", "timestamp": 1691093881, "time_this_iter_s": 61.64823794364929, "time_total_s": 13757.138182878494, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3210.325671195984, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.494252873563216, "ram_util_percent": 63.68735632183906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.4766765627846, "policy_loss": -6.360540828736152e+20, "vf_loss": 303307950.82215744}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36015.5, "diff_num_grad_updates_vs_sampler_policy": 36014.5}}, "num_env_steps_sampled": 8187360, "num_env_steps_trained": 8187360, "num_agent_steps_sampled": 8187360, "num_agent_steps_trained": 8187360}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355036.7982812359, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21381648804465997, "mean_inference_ms": 0.3637227985522661, "mean_action_processing_ms": 0.0889687020843015, "mean_env_wait_ms": 0.6960078442351776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034489721622107164, "StateBufferConnector_ms": 0.002640148378768057, "ViewRequirementAgentConnector_ms": 0.06720929775597914}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355036.7982812359, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21381648804465997, "mean_inference_ms": 0.3637227985522661, "mean_action_processing_ms": 0.0889687020843015, "mean_env_wait_ms": 0.6960078442351776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034489721622107164, "StateBufferConnector_ms": 0.002640148378768057, "ViewRequirementAgentConnector_ms": 0.06720929775597914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8187360, "num_agent_steps_trained": 8187360, "num_env_steps_sampled": 8187360, "num_env_steps_trained": 8187360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.9568275780724, "num_env_steps_trained_throughput_per_sec": 715.9568275780724, "timesteps_total": 8187360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8187360, "timers": {"training_iteration_time_ms": 61551.338, "sample_time_ms": 60401.981, "load_time_ms": 16.828, "load_throughput": 2609893.213, "learn_time_ms": 1131.42, "learn_throughput": 38818.469, "synch_weights_time_ms": 0.947}, "counters": {"num_env_steps_sampled": 8187360, "num_env_steps_trained": 8187360, "num_agent_steps_sampled": 8187360, "num_agent_steps_trained": 8187360}, "done": false, "episodes_total": 1377, "training_iteration": 498, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-19-02", "timestamp": 1691093942, "time_this_iter_s": 61.3475821018219, "time_total_s": 13818.485764980316, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3271.673253297806, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.29080459770115, "ram_util_percent": 63.67356321839082}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.6077841711462, "policy_loss": -6.799346506479846e+20, "vf_loss": 304388197.59183675}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36701.5, "diff_num_grad_updates_vs_sampler_policy": 36700.5}}, "num_env_steps_sampled": 8231280, "num_env_steps_trained": 8231280, "num_agent_steps_sampled": 8231280, "num_agent_steps_trained": 8231280}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355034.3655752556, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.213842390485431, "mean_inference_ms": 0.36378004888753895, "mean_action_processing_ms": 0.0889849161386857, "mean_env_wait_ms": 0.6958595194696038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.002647329259801794, "ViewRequirementAgentConnector_ms": 0.06721991079824942}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1355034.3655752556, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.213842390485431, "mean_inference_ms": 0.36378004888753895, "mean_action_processing_ms": 0.0889849161386857, "mean_env_wait_ms": 0.6958595194696038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.002647329259801794, "ViewRequirementAgentConnector_ms": 0.06721991079824942}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8231280, "num_agent_steps_trained": 8231280, "num_env_steps_sampled": 8231280, "num_env_steps_trained": 8231280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.4741028156756, "num_env_steps_trained_throughput_per_sec": 711.4741028156756, "timesteps_total": 8231280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8231280, "timers": {"training_iteration_time_ms": 61577.185, "sample_time_ms": 60428.532, "load_time_ms": 16.899, "load_throughput": 2598931.607, "learn_time_ms": 1130.632, "learn_throughput": 38845.547, "synch_weights_time_ms": 0.959}, "counters": {"num_env_steps_sampled": 8231280, "num_env_steps_trained": 8231280, "num_agent_steps_sampled": 8231280, "num_agent_steps_trained": 8231280}, "done": false, "episodes_total": 1378, "training_iteration": 499, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-20-04", "timestamp": 1691094004, "time_this_iter_s": 61.734102964401245, "time_total_s": 13880.219867944717, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3333.407356262207, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.10574712643678, "ram_util_percent": 63.650574712643675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.6966082959411, "policy_loss": -7.45808195225287e+20, "vf_loss": 302424721.8367347}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37387.5, "diff_num_grad_updates_vs_sampler_policy": 37386.5}}, "num_env_steps_sampled": 8275200, "num_env_steps_trained": 8275200, "num_agent_steps_sampled": 8275200, "num_agent_steps_trained": 8275200}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354952.5063697598, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21386827482082899, "mean_inference_ms": 0.3638351238544206, "mean_action_processing_ms": 0.08900059255443915, "mean_env_wait_ms": 0.6957155237496889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003439296375621449, "StateBufferConnector_ms": 0.002646879716352983, "ViewRequirementAgentConnector_ms": 0.06719025698575107}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354952.5063697598, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21386827482082899, "mean_inference_ms": 0.3638351238544206, "mean_action_processing_ms": 0.08900059255443915, "mean_env_wait_ms": 0.6957155237496889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003439296375621449, "StateBufferConnector_ms": 0.002646879716352983, "ViewRequirementAgentConnector_ms": 0.06719025698575107}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8275200, "num_agent_steps_trained": 8275200, "num_env_steps_sampled": 8275200, "num_env_steps_trained": 8275200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.8541820940072, "num_env_steps_trained_throughput_per_sec": 711.8541820940072, "timesteps_total": 8275200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8275200, "timers": {"training_iteration_time_ms": 61603.851, "sample_time_ms": 60454.605, "load_time_ms": 16.798, "load_throughput": 2614590.244, "learn_time_ms": 1131.323, "learn_throughput": 38821.803, "synch_weights_time_ms": 0.96}, "counters": {"num_env_steps_sampled": 8275200, "num_env_steps_trained": 8275200, "num_agent_steps_sampled": 8275200, "num_agent_steps_trained": 8275200}, "done": false, "episodes_total": 1379, "training_iteration": 500, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-21-06", "timestamp": 1691094066, "time_this_iter_s": 61.70064616203308, "time_total_s": 13941.92051410675, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3395.10800242424, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.25287356321839, "ram_util_percent": 63.62068965517243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.8333133441713, "policy_loss": -6.750972944797397e+20, "vf_loss": 303702062.6705539}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38073.5, "diff_num_grad_updates_vs_sampler_policy": 38072.5}}, "num_env_steps_sampled": 8319120, "num_env_steps_trained": 8319120, "num_agent_steps_sampled": 8319120, "num_agent_steps_trained": 8319120}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354925.4202637002, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21389357007437537, "mean_inference_ms": 0.363888227487238, "mean_action_processing_ms": 0.08901574801657532, "mean_env_wait_ms": 0.695573065307505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034293958118983676, "StateBufferConnector_ms": 0.002647723470415388, "ViewRequirementAgentConnector_ms": 0.06717486040932792}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354925.4202637002, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21389357007437537, "mean_inference_ms": 0.363888227487238, "mean_action_processing_ms": 0.08901574801657532, "mean_env_wait_ms": 0.695573065307505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034293958118983676, "StateBufferConnector_ms": 0.002647723470415388, "ViewRequirementAgentConnector_ms": 0.06717486040932792}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8319120, "num_agent_steps_trained": 8319120, "num_env_steps_sampled": 8319120, "num_env_steps_trained": 8319120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.6294076401741, "num_env_steps_trained_throughput_per_sec": 716.6294076401741, "timesteps_total": 8319120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8319120, "timers": {"training_iteration_time_ms": 61571.772, "sample_time_ms": 60422.783, "load_time_ms": 16.882, "load_throughput": 2601526.505, "learn_time_ms": 1130.99, "learn_throughput": 38833.229, "synch_weights_time_ms": 0.951}, "counters": {"num_env_steps_sampled": 8319120, "num_env_steps_trained": 8319120, "num_agent_steps_sampled": 8319120, "num_agent_steps_trained": 8319120}, "done": false, "episodes_total": 1380, "training_iteration": 501, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-22-07", "timestamp": 1691094127, "time_this_iter_s": 61.28999209403992, "time_total_s": 14003.21050620079, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3456.39799451828, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.486206896551725, "ram_util_percent": 63.66321839080461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.944844326542, "policy_loss": -6.729480657503226e+20, "vf_loss": 303828318.606414}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38759.5, "diff_num_grad_updates_vs_sampler_policy": 38758.5}}, "num_env_steps_sampled": 8363040, "num_env_steps_trained": 8363040, "num_agent_steps_sampled": 8363040, "num_agent_steps_trained": 8363040}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354900.1207115166, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21391841518974553, "mean_inference_ms": 0.3639394053446267, "mean_action_processing_ms": 0.08903044415868051, "mean_env_wait_ms": 0.6954337365396419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034240254184655975, "StateBufferConnector_ms": 0.0026497924536989445, "ViewRequirementAgentConnector_ms": 0.06718008141768606}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354900.1207115166, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21391841518974553, "mean_inference_ms": 0.3639394053446267, "mean_action_processing_ms": 0.08903044415868051, "mean_env_wait_ms": 0.6954337365396419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034240254184655975, "StateBufferConnector_ms": 0.0026497924536989445, "ViewRequirementAgentConnector_ms": 0.06718008141768606}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8363040, "num_agent_steps_trained": 8363040, "num_env_steps_sampled": 8363040, "num_env_steps_trained": 8363040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.057426745147, "num_env_steps_trained_throughput_per_sec": 714.057426745147, "timesteps_total": 8363040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8363040, "timers": {"training_iteration_time_ms": 61566.701, "sample_time_ms": 60418.757, "load_time_ms": 16.825, "load_throughput": 2610447.975, "learn_time_ms": 1129.991, "learn_throughput": 38867.563, "synch_weights_time_ms": 0.965}, "counters": {"num_env_steps_sampled": 8363040, "num_env_steps_trained": 8363040, "num_agent_steps_sampled": 8363040, "num_agent_steps_trained": 8363040}, "done": false, "episodes_total": 1381, "training_iteration": 502, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-23-09", "timestamp": 1691094189, "time_this_iter_s": 61.51049184799194, "time_total_s": 14064.720998048782, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3517.908486366272, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.386206896551727, "ram_util_percent": 63.67241379310346}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.078136744374, "policy_loss": -6.141583522254978e+20, "vf_loss": 302652697.93586004}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39445.5, "diff_num_grad_updates_vs_sampler_policy": 39444.5}}, "num_env_steps_sampled": 8406960, "num_env_steps_trained": 8406960, "num_agent_steps_sampled": 8406960, "num_agent_steps_trained": 8406960}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354830.1430985946, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21394309349397023, "mean_inference_ms": 0.3639888863125483, "mean_action_processing_ms": 0.08904460419982282, "mean_env_wait_ms": 0.6952922520344265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415551678887729, "StateBufferConnector_ms": 0.002648090494090113, "ViewRequirementAgentConnector_ms": 0.0671444268062197}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354830.1430985946, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21394309349397023, "mean_inference_ms": 0.3639888863125483, "mean_action_processing_ms": 0.08904460419982282, "mean_env_wait_ms": 0.6952922520344265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415551678887729, "StateBufferConnector_ms": 0.002648090494090113, "ViewRequirementAgentConnector_ms": 0.0671444268062197}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8406960, "num_agent_steps_trained": 8406960, "num_env_steps_sampled": 8406960, "num_env_steps_trained": 8406960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.6504179805046, "num_env_steps_trained_throughput_per_sec": 721.6504179805046, "timesteps_total": 8406960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8406960, "timers": {"training_iteration_time_ms": 61494.903, "sample_time_ms": 60347.813, "load_time_ms": 16.948, "load_throughput": 2591480.433, "learn_time_ms": 1128.999, "learn_throughput": 38901.704, "synch_weights_time_ms": 0.977}, "counters": {"num_env_steps_sampled": 8406960, "num_env_steps_trained": 8406960, "num_agent_steps_sampled": 8406960, "num_agent_steps_trained": 8406960}, "done": false, "episodes_total": 1382, "training_iteration": 503, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-24-10", "timestamp": 1691094250, "time_this_iter_s": 60.86331486701965, "time_total_s": 14125.584312915802, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3578.7718012332916, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 19.437209302325584, "ram_util_percent": 63.4593023255814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.1991226596665, "policy_loss": -6.95387246155022e+20, "vf_loss": 304196980.08746356}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40131.5, "diff_num_grad_updates_vs_sampler_policy": 40130.5}}, "num_env_steps_sampled": 8450880, "num_env_steps_trained": 8450880, "num_agent_steps_sampled": 8450880, "num_agent_steps_trained": 8450880}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354822.197973299, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21396715445088937, "mean_inference_ms": 0.36403714971581724, "mean_action_processing_ms": 0.08905829349521663, "mean_env_wait_ms": 0.6951553989199353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003410597979012182, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06714352106643935}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354822.197973299, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21396715445088937, "mean_inference_ms": 0.36403714971581724, "mean_action_processing_ms": 0.08905829349521663, "mean_env_wait_ms": 0.6951553989199353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003410597979012182, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06714352106643935}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8450880, "num_agent_steps_trained": 8450880, "num_env_steps_sampled": 8450880, "num_env_steps_trained": 8450880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.9711782000091, "num_env_steps_trained_throughput_per_sec": 710.9711782000091, "timesteps_total": 8450880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8450880, "timers": {"training_iteration_time_ms": 61491.741, "sample_time_ms": 60344.697, "load_time_ms": 16.864, "load_throughput": 2604387.989, "learn_time_ms": 1129.034, "learn_throughput": 38900.514, "synch_weights_time_ms": 0.979}, "counters": {"num_env_steps_sampled": 8450880, "num_env_steps_trained": 8450880, "num_agent_steps_sampled": 8450880, "num_agent_steps_trained": 8450880}, "done": false, "episodes_total": 1383, "training_iteration": 504, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-25-11", "timestamp": 1691094311, "time_this_iter_s": 61.77730679512024, "time_total_s": 14187.361619710922, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3640.549108028412, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 16.915909090909093, "ram_util_percent": 63.14886363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.3229270467953, "policy_loss": -6.463503962334227e+20, "vf_loss": 304072275.9766764}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40817.5, "diff_num_grad_updates_vs_sampler_policy": 40816.5}}, "num_env_steps_sampled": 8494800, "num_env_steps_trained": 8494800, "num_agent_steps_sampled": 8494800, "num_agent_steps_trained": 8494800}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354812.7830109596, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21399019099053973, "mean_inference_ms": 0.36408396412478755, "mean_action_processing_ms": 0.08907155927563186, "mean_env_wait_ms": 0.6950187538510504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034073988596598306, "StateBufferConnector_ms": 0.002648035685221354, "ViewRequirementAgentConnector_ms": 0.06712039311726888}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354812.7830109596, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21399019099053973, "mean_inference_ms": 0.36408396412478755, "mean_action_processing_ms": 0.08907155927563186, "mean_env_wait_ms": 0.6950187538510504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034073988596598306, "StateBufferConnector_ms": 0.002648035685221354, "ViewRequirementAgentConnector_ms": 0.06712039311726888}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8494800, "num_agent_steps_trained": 8494800, "num_env_steps_sampled": 8494800, "num_env_steps_trained": 8494800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.8097678595943, "num_env_steps_trained_throughput_per_sec": 719.8097678595943, "timesteps_total": 8494800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8494800, "timers": {"training_iteration_time_ms": 61440.369, "sample_time_ms": 60294.202, "load_time_ms": 16.79, "load_throughput": 2615915.724, "learn_time_ms": 1128.239, "learn_throughput": 38927.932, "synch_weights_time_ms": 0.972}, "counters": {"num_env_steps_sampled": 8494800, "num_env_steps_trained": 8494800, "num_agent_steps_sampled": 8494800, "num_agent_steps_trained": 8494800}, "done": false, "episodes_total": 1384, "training_iteration": 505, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-26-12", "timestamp": 1691094372, "time_this_iter_s": 61.01883125305176, "time_total_s": 14248.380450963974, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3701.5679392814636, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.748837209302323, "ram_util_percent": 63.282558139534885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.431789920907, "policy_loss": -7.082841041723678e+20, "vf_loss": 304597372.7521866}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41503.5, "diff_num_grad_updates_vs_sampler_policy": 41502.5}}, "num_env_steps_sampled": 8538720, "num_env_steps_trained": 8538720, "num_agent_steps_sampled": 8538720, "num_agent_steps_trained": 8538720}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354823.6865261996, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2140125568932735, "mean_inference_ms": 0.3641291579117511, "mean_action_processing_ms": 0.08908440965273477, "mean_env_wait_ms": 0.6948862748016994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034054771798555966, "StateBufferConnector_ms": 0.0026480096285460427, "ViewRequirementAgentConnector_ms": 0.06710427706358862}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354823.6865261996, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2140125568932735, "mean_inference_ms": 0.3641291579117511, "mean_action_processing_ms": 0.08908440965273477, "mean_env_wait_ms": 0.6948862748016994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034054771798555966, "StateBufferConnector_ms": 0.0026480096285460427, "ViewRequirementAgentConnector_ms": 0.06710427706358862}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8538720, "num_agent_steps_trained": 8538720, "num_env_steps_sampled": 8538720, "num_env_steps_trained": 8538720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.6340277786402, "num_env_steps_trained_throughput_per_sec": 712.6340277786402, "timesteps_total": 8538720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8538720, "timers": {"training_iteration_time_ms": 61449.521, "sample_time_ms": 60304.199, "load_time_ms": 16.812, "load_throughput": 2612387.797, "learn_time_ms": 1127.39, "learn_throughput": 38957.228, "synch_weights_time_ms": 0.954}, "counters": {"num_env_steps_sampled": 8538720, "num_env_steps_trained": 8538720, "num_agent_steps_sampled": 8538720, "num_agent_steps_trained": 8538720}, "done": false, "episodes_total": 1385, "training_iteration": 506, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-27-14", "timestamp": 1691094434, "time_this_iter_s": 61.63345503807068, "time_total_s": 14310.013906002045, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3763.2013943195343, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.527586206896554, "ram_util_percent": 63.247126436781606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.5550969515875, "policy_loss": -6.922299815457738e+20, "vf_loss": 302598202.0233236}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42189.5, "diff_num_grad_updates_vs_sampler_policy": 42188.5}}, "num_env_steps_sampled": 8582640, "num_env_steps_trained": 8582640, "num_agent_steps_sampled": 8582640, "num_agent_steps_trained": 8582640}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354758.836398935, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21403466142396085, "mean_inference_ms": 0.36417311623724663, "mean_action_processing_ms": 0.08909696213393571, "mean_env_wait_ms": 0.6947561922065925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034513012055427798, "StateBufferConnector_ms": 0.002643754405360068, "ViewRequirementAgentConnector_ms": 0.06709098815917969}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354758.836398935, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21403466142396085, "mean_inference_ms": 0.36417311623724663, "mean_action_processing_ms": 0.08909696213393571, "mean_env_wait_ms": 0.6947561922065925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034513012055427798, "StateBufferConnector_ms": 0.002643754405360068, "ViewRequirementAgentConnector_ms": 0.06709098815917969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8582640, "num_agent_steps_trained": 8582640, "num_env_steps_sampled": 8582640, "num_env_steps_trained": 8582640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.0904211551879, "num_env_steps_trained_throughput_per_sec": 714.0904211551879, "timesteps_total": 8582640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8582640, "timers": {"training_iteration_time_ms": 61435.445, "sample_time_ms": 60290.261, "load_time_ms": 16.828, "load_throughput": 2609996.751, "learn_time_ms": 1127.24, "learn_throughput": 38962.429, "synch_weights_time_ms": 0.952}, "counters": {"num_env_steps_sampled": 8582640, "num_env_steps_trained": 8582640, "num_agent_steps_sampled": 8582640, "num_agent_steps_trained": 8582640}, "done": false, "episodes_total": 1386, "training_iteration": 507, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-28-16", "timestamp": 1691094496, "time_this_iter_s": 61.5075740814209, "time_total_s": 14371.521480083466, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3824.708968400955, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.4816091954023, "ram_util_percent": 63.35977011494254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.6705347177933, "policy_loss": -6.255981771460541e+20, "vf_loss": 302700065.4052478}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42875.5, "diff_num_grad_updates_vs_sampler_policy": 42874.5}}, "num_env_steps_sampled": 8626560, "num_env_steps_trained": 8626560, "num_agent_steps_sampled": 8626560, "num_agent_steps_trained": 8626560}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354703.0611796496, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2140563464963058, "mean_inference_ms": 0.3642156888453231, "mean_action_processing_ms": 0.08910911188160292, "mean_env_wait_ms": 0.6946276897212919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034472299000573537, "StateBufferConnector_ms": 0.0026445540170820935, "ViewRequirementAgentConnector_ms": 0.06711520845927889}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354703.0611796496, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2140563464963058, "mean_inference_ms": 0.3642156888453231, "mean_action_processing_ms": 0.08910911188160292, "mean_env_wait_ms": 0.6946276897212919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034472299000573537, "StateBufferConnector_ms": 0.0026445540170820935, "ViewRequirementAgentConnector_ms": 0.06711520845927889}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8626560, "num_agent_steps_trained": 8626560, "num_env_steps_sampled": 8626560, "num_env_steps_trained": 8626560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.4890955202725, "num_env_steps_trained_throughput_per_sec": 716.4890955202725, "timesteps_total": 8626560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8626560, "timers": {"training_iteration_time_ms": 61430.888, "sample_time_ms": 60284.44, "load_time_ms": 16.901, "load_throughput": 2598627.312, "learn_time_ms": 1128.433, "learn_throughput": 38921.242, "synch_weights_time_ms": 0.949}, "counters": {"num_env_steps_sampled": 8626560, "num_env_steps_trained": 8626560, "num_agent_steps_sampled": 8626560, "num_agent_steps_trained": 8626560}, "done": false, "episodes_total": 1387, "training_iteration": 508, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-29-17", "timestamp": 1691094557, "time_this_iter_s": 61.30199313163757, "time_total_s": 14432.823473215103, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3886.010961532593, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 16.634482758620692, "ram_util_percent": 63.39655172413792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.7588100600174, "policy_loss": -7.080939735677529e+20, "vf_loss": 304731437.0787172}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43561.5, "diff_num_grad_updates_vs_sampler_policy": 43560.5}}, "num_env_steps_sampled": 8670480, "num_env_steps_trained": 8670480, "num_agent_steps_sampled": 8670480, "num_agent_steps_trained": 8670480}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354714.2217601473, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21407771093478545, "mean_inference_ms": 0.36425698503356857, "mean_action_processing_ms": 0.08912096922091282, "mean_env_wait_ms": 0.6945022595370925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003442540764808655, "StateBufferConnector_ms": 0.0026386231184005737, "ViewRequirementAgentConnector_ms": 0.0670846551656723}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354714.2217601473, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21407771093478545, "mean_inference_ms": 0.36425698503356857, "mean_action_processing_ms": 0.08912096922091282, "mean_env_wait_ms": 0.6945022595370925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003442540764808655, "StateBufferConnector_ms": 0.0026386231184005737, "ViewRequirementAgentConnector_ms": 0.0670846551656723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8670480, "num_agent_steps_trained": 8670480, "num_env_steps_sampled": 8670480, "num_env_steps_trained": 8670480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.7787689873711, "num_env_steps_trained_throughput_per_sec": 712.7787689873711, "timesteps_total": 8670480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8670480, "timers": {"training_iteration_time_ms": 61419.589, "sample_time_ms": 60271.376, "load_time_ms": 16.933, "load_throughput": 2593709.834, "learn_time_ms": 1130.174, "learn_throughput": 38861.27, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 8670480, "num_env_steps_trained": 8670480, "num_agent_steps_sampled": 8670480, "num_agent_steps_trained": 8670480}, "done": false, "episodes_total": 1388, "training_iteration": 509, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-30-19", "timestamp": 1691094619, "time_this_iter_s": 61.62087082862854, "time_total_s": 14494.444344043732, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3947.6318323612213, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.72068965517241, "ram_util_percent": 63.327586206896555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.881474175189, "policy_loss": -6.991026812871026e+20, "vf_loss": 302235050.74052477}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44247.5, "diff_num_grad_updates_vs_sampler_policy": 44246.5}}, "num_env_steps_sampled": 8714400, "num_env_steps_trained": 8714400, "num_agent_steps_sampled": 8714400, "num_agent_steps_trained": 8714400}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354641.7510501037, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21409875062828015, "mean_inference_ms": 0.3642969590287278, "mean_action_processing_ms": 0.08913247068436246, "mean_env_wait_ms": 0.6943785350082011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034416638887845553, "StateBufferConnector_ms": 0.0026387434739332935, "ViewRequirementAgentConnector_ms": 0.06708291860727164}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354641.7510501037, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21409875062828015, "mean_inference_ms": 0.3642969590287278, "mean_action_processing_ms": 0.08913247068436246, "mean_env_wait_ms": 0.6943785350082011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034416638887845553, "StateBufferConnector_ms": 0.0026387434739332935, "ViewRequirementAgentConnector_ms": 0.06708291860727164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8714400, "num_agent_steps_trained": 8714400, "num_env_steps_sampled": 8714400, "num_env_steps_trained": 8714400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.1064711280417, "num_env_steps_trained_throughput_per_sec": 716.1064711280417, "timesteps_total": 8714400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8714400, "timers": {"training_iteration_time_ms": 61382.951, "sample_time_ms": 60234.743, "load_time_ms": 16.894, "load_throughput": 2599760.531, "learn_time_ms": 1130.216, "learn_throughput": 38859.824, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 8714400, "num_env_steps_trained": 8714400, "num_agent_steps_sampled": 8714400, "num_agent_steps_trained": 8714400}, "done": false, "episodes_total": 1389, "training_iteration": 510, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-31-20", "timestamp": 1691094680, "time_this_iter_s": 61.33470892906189, "time_total_s": 14555.779052972794, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4008.966541290283, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.839080459770113, "ram_util_percent": 63.451724137931045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.0192073899873, "policy_loss": -7.387828594383663e+20, "vf_loss": 303194341.79008746}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44933.5, "diff_num_grad_updates_vs_sampler_policy": 44932.5}}, "num_env_steps_sampled": 8758320, "num_env_steps_trained": 8758320, "num_agent_steps_sampled": 8758320, "num_agent_steps_trained": 8758320}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354606.211503829, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21411925159116538, "mean_inference_ms": 0.3643357129392053, "mean_action_processing_ms": 0.08914363227153946, "mean_env_wait_ms": 0.6942576555798191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00344045234448982, "StateBufferConnector_ms": 0.0026356090198863635, "ViewRequirementAgentConnector_ms": 0.06706606258045543}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354606.211503829, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21411925159116538, "mean_inference_ms": 0.3643357129392053, "mean_action_processing_ms": 0.08914363227153946, "mean_env_wait_ms": 0.6942576555798191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00344045234448982, "StateBufferConnector_ms": 0.0026356090198863635, "ViewRequirementAgentConnector_ms": 0.06706606258045543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8758320, "num_agent_steps_trained": 8758320, "num_env_steps_sampled": 8758320, "num_env_steps_trained": 8758320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.8884723000602, "num_env_steps_trained_throughput_per_sec": 713.8884723000602, "timesteps_total": 8758320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8758320, "timers": {"training_iteration_time_ms": 61406.482, "sample_time_ms": 60258.564, "load_time_ms": 16.809, "load_throughput": 2612921.383, "learn_time_ms": 1130.001, "learn_throughput": 38867.208, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 8758320, "num_env_steps_trained": 8758320, "num_agent_steps_sampled": 8758320, "num_agent_steps_trained": 8758320}, "done": false, "episodes_total": 1390, "training_iteration": 511, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-32-21", "timestamp": 1691094741, "time_this_iter_s": 61.5249559879303, "time_total_s": 14617.304008960724, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4070.4914972782135, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.54022988505747, "ram_util_percent": 63.43103448275861}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.1359327666614, "policy_loss": -6.71181639961455e+20, "vf_loss": 302173740.1341108}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 45619.5, "diff_num_grad_updates_vs_sampler_policy": 45618.5}}, "num_env_steps_sampled": 8802240, "num_env_steps_trained": 8802240, "num_agent_steps_sampled": 8802240, "num_agent_steps_trained": 8802240}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354538.4475002326, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21413944568082732, "mean_inference_ms": 0.36437332151547425, "mean_action_processing_ms": 0.0891545118746869, "mean_env_wait_ms": 0.694138725587239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482690498010436, "StateBufferConnector_ms": 0.002636126617887127, "ViewRequirementAgentConnector_ms": 0.06704935386999329}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354538.4475002326, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21413944568082732, "mean_inference_ms": 0.36437332151547425, "mean_action_processing_ms": 0.0891545118746869, "mean_env_wait_ms": 0.694138725587239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482690498010436, "StateBufferConnector_ms": 0.002636126617887127, "ViewRequirementAgentConnector_ms": 0.06704935386999329}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8802240, "num_agent_steps_trained": 8802240, "num_env_steps_sampled": 8802240, "num_env_steps_trained": 8802240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.1315024592969, "num_env_steps_trained_throughput_per_sec": 715.1315024592969, "timesteps_total": 8802240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8802240, "timers": {"training_iteration_time_ms": 61397.245, "sample_time_ms": 60248.927, "load_time_ms": 16.805, "load_throughput": 2613466.31, "learn_time_ms": 1130.421, "learn_throughput": 38852.792, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 8802240, "num_env_steps_trained": 8802240, "num_agent_steps_sampled": 8802240, "num_agent_steps_trained": 8802240}, "done": false, "episodes_total": 1391, "training_iteration": 512, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-33-23", "timestamp": 1691094803, "time_this_iter_s": 61.418241024017334, "time_total_s": 14678.722249984741, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4131.909738302231, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.51818181818182, "ram_util_percent": 63.50227272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.1976923372586, "policy_loss": -6.079597321998713e+20, "vf_loss": 302043789.45772594}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 46304.5}}, "num_env_steps_sampled": 8846160, "num_env_steps_trained": 8846160, "num_agent_steps_sampled": 8846160, "num_agent_steps_trained": 8846160}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354464.8084450809, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2141594064845258, "mean_inference_ms": 0.3644103098041952, "mean_action_processing_ms": 0.08916507747481119, "mean_env_wait_ms": 0.6940205016091056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034753014059627756, "StateBufferConnector_ms": 0.002635927761302275, "ViewRequirementAgentConnector_ms": 0.06705136860118192}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354464.8084450809, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2141594064845258, "mean_inference_ms": 0.3644103098041952, "mean_action_processing_ms": 0.08916507747481119, "mean_env_wait_ms": 0.6940205016091056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034753014059627756, "StateBufferConnector_ms": 0.002635927761302275, "ViewRequirementAgentConnector_ms": 0.06705136860118192}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8846160, "num_agent_steps_trained": 8846160, "num_env_steps_sampled": 8846160, "num_env_steps_trained": 8846160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.9204162715669, "num_env_steps_trained_throughput_per_sec": 715.9204162715669, "timesteps_total": 8846160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8846160, "timers": {"training_iteration_time_ms": 61445.955, "sample_time_ms": 60296.891, "load_time_ms": 16.819, "load_throughput": 2611299.069, "learn_time_ms": 1131.168, "learn_throughput": 38827.107, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 8846160, "num_env_steps_trained": 8846160, "num_agent_steps_sampled": 8846160, "num_agent_steps_trained": 8846160}, "done": false, "episodes_total": 1392, "training_iteration": 513, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-34-24", "timestamp": 1691094864, "time_this_iter_s": 61.350382804870605, "time_total_s": 14740.072632789612, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4193.260121107101, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.308139534883722, "ram_util_percent": 63.58837209302326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.3509083739523, "policy_loss": -7.46033691355875e+20, "vf_loss": 304022284.6472303}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46991.5, "diff_num_grad_updates_vs_sampler_policy": 46990.5}}, "num_env_steps_sampled": 8890080, "num_env_steps_trained": 8890080, "num_agent_steps_sampled": 8890080, "num_agent_steps_trained": 8890080}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354459.8238884246, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21417893054587428, "mean_inference_ms": 0.364446540566852, "mean_action_processing_ms": 0.08917538470628388, "mean_env_wait_ms": 0.6939059739485068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034712362980497055, "StateBufferConnector_ms": 0.0026360802028490148, "ViewRequirementAgentConnector_ms": 0.06705919901529948}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354459.8238884246, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21417893054587428, "mean_inference_ms": 0.364446540566852, "mean_action_processing_ms": 0.08917538470628388, "mean_env_wait_ms": 0.6939059739485068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034712362980497055, "StateBufferConnector_ms": 0.0026360802028490148, "ViewRequirementAgentConnector_ms": 0.06705919901529948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8890080, "num_agent_steps_trained": 8890080, "num_env_steps_sampled": 8890080, "num_env_steps_trained": 8890080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.2664833205447, "num_env_steps_trained_throughput_per_sec": 709.2664833205447, "timesteps_total": 8890080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8890080, "timers": {"training_iteration_time_ms": 61460.802, "sample_time_ms": 60312.136, "load_time_ms": 16.939, "load_throughput": 2592877.465, "learn_time_ms": 1130.641, "learn_throughput": 38845.205, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 8890080, "num_env_steps_trained": 8890080, "num_agent_steps_sampled": 8890080, "num_agent_steps_trained": 8890080}, "done": false, "episodes_total": 1393, "training_iteration": 514, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-35-26", "timestamp": 1691094926, "time_this_iter_s": 61.926029205322266, "time_total_s": 14801.998661994934, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4255.186150312424, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.629545454545454, "ram_util_percent": 63.51363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.4683978467224, "policy_loss": -7.173627351715394e+20, "vf_loss": 302894361.67346936}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47677.5, "diff_num_grad_updates_vs_sampler_policy": 47676.5}}, "num_env_steps_sampled": 8934000, "num_env_steps_trained": 8934000, "num_agent_steps_sampled": 8934000, "num_agent_steps_trained": 8934000}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354417.258149786, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21419827232923666, "mean_inference_ms": 0.3644820003344866, "mean_action_processing_ms": 0.08918547961780716, "mean_env_wait_ms": 0.6937935172546676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476483481270926, "StateBufferConnector_ms": 0.0026382718767438617, "ViewRequirementAgentConnector_ms": 0.06706748689923968}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354417.258149786, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21419827232923666, "mean_inference_ms": 0.3644820003344866, "mean_action_processing_ms": 0.08918547961780716, "mean_env_wait_ms": 0.6937935172546676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476483481270926, "StateBufferConnector_ms": 0.0026382718767438617, "ViewRequirementAgentConnector_ms": 0.06706748689923968}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8934000, "num_agent_steps_trained": 8934000, "num_env_steps_sampled": 8934000, "num_env_steps_trained": 8934000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.390263049336, "num_env_steps_trained_throughput_per_sec": 713.390263049336, "timesteps_total": 8934000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8934000, "timers": {"training_iteration_time_ms": 61515.708, "sample_time_ms": 60366.641, "load_time_ms": 16.971, "load_throughput": 2587930.804, "learn_time_ms": 1131.01, "learn_throughput": 38832.535, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 8934000, "num_env_steps_trained": 8934000, "num_agent_steps_sampled": 8934000, "num_agent_steps_trained": 8934000}, "done": false, "episodes_total": 1394, "training_iteration": 515, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-36-28", "timestamp": 1691094988, "time_this_iter_s": 61.56840705871582, "time_total_s": 14863.56706905365, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4316.7545573711395, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.344827586206897, "ram_util_percent": 63.46206896551725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.5586677751458, "policy_loss": -6.859172678728745e+20, "vf_loss": 303493561.7084548}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48363.5, "diff_num_grad_updates_vs_sampler_policy": 48362.5}}, "num_env_steps_sampled": 8977920, "num_env_steps_trained": 8977920, "num_agent_steps_sampled": 8977920, "num_agent_steps_trained": 8977920}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354395.497483696, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21421719154494276, "mean_inference_ms": 0.3645166570478237, "mean_action_processing_ms": 0.08919530719637077, "mean_env_wait_ms": 0.6936822734257202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034745310393857285, "StateBufferConnector_ms": 0.0026407376141615317, "ViewRequirementAgentConnector_ms": 0.06707319071595098}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354395.497483696, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21421719154494276, "mean_inference_ms": 0.3645166570478237, "mean_action_processing_ms": 0.08919530719637077, "mean_env_wait_ms": 0.6936822734257202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034745310393857285, "StateBufferConnector_ms": 0.0026407376141615317, "ViewRequirementAgentConnector_ms": 0.06707319071595098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8977920, "num_agent_steps_trained": 8977920, "num_env_steps_sampled": 8977920, "num_env_steps_trained": 8977920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.4534269843706, "num_env_steps_trained_throughput_per_sec": 716.4534269843706, "timesteps_total": 8977920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8977920, "timers": {"training_iteration_time_ms": 61482.853, "sample_time_ms": 60333.5, "load_time_ms": 17.013, "load_throughput": 2581511.65, "learn_time_ms": 1131.255, "learn_throughput": 38824.142, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 8977920, "num_env_steps_trained": 8977920, "num_agent_steps_sampled": 8977920, "num_agent_steps_trained": 8977920}, "done": false, "episodes_total": 1395, "training_iteration": 516, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-37-29", "timestamp": 1691095049, "time_this_iter_s": 61.30470418930054, "time_total_s": 14924.87177324295, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4378.05926156044, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.601149425287357, "ram_util_percent": 63.61264367816092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.6615744721437, "policy_loss": -7.121808366466159e+20, "vf_loss": 303782154.6705539}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49049.5, "diff_num_grad_updates_vs_sampler_policy": 49048.5}}, "num_env_steps_sampled": 9021840, "num_env_steps_trained": 9021840, "num_agent_steps_sampled": 9021840, "num_agent_steps_trained": 9021840}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354381.3675466636, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2142353853468938, "mean_inference_ms": 0.36455021333837495, "mean_action_processing_ms": 0.08920486967738227, "mean_env_wait_ms": 0.6935727200526846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034686591890123156, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06704760922325982}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354381.3675466636, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2142353853468938, "mean_inference_ms": 0.36455021333837495, "mean_action_processing_ms": 0.08920486967738227, "mean_env_wait_ms": 0.6935727200526846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034686591890123156, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06704760922325982}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9021840, "num_agent_steps_trained": 9021840, "num_env_steps_sampled": 9021840, "num_env_steps_trained": 9021840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.4883403136889, "num_env_steps_trained_throughput_per_sec": 716.4883403136889, "timesteps_total": 9021840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9021840, "timers": {"training_iteration_time_ms": 61462.269, "sample_time_ms": 60309.212, "load_time_ms": 17.033, "load_throughput": 2578584.68, "learn_time_ms": 1134.909, "learn_throughput": 38699.125, "synch_weights_time_ms": 0.942}, "counters": {"num_env_steps_sampled": 9021840, "num_env_steps_trained": 9021840, "num_agent_steps_sampled": 9021840, "num_agent_steps_trained": 9021840}, "done": false, "episodes_total": 1396, "training_iteration": 517, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-38-30", "timestamp": 1691095110, "time_this_iter_s": 61.30206108093262, "time_total_s": 14986.173834323883, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4439.361322641373, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 18.878160919540232, "ram_util_percent": 63.51494252873563}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.8027623123746, "policy_loss": -7.133853681607636e+20, "vf_loss": 303265843.01457727}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49735.5, "diff_num_grad_updates_vs_sampler_policy": 49734.5}}, "num_env_steps_sampled": 9065760, "num_env_steps_trained": 9065760, "num_agent_steps_sampled": 9065760, "num_agent_steps_trained": 9065760}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354352.7858734988, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21425315623966648, "mean_inference_ms": 0.36458283086427856, "mean_action_processing_ms": 0.08921422827908865, "mean_env_wait_ms": 0.6934650732796659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003466214219184771, "StateBufferConnector_ms": 0.0026346885994689103, "ViewRequirementAgentConnector_ms": 0.06702860740766134}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354352.7858734988, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21425315623966648, "mean_inference_ms": 0.36458283086427856, "mean_action_processing_ms": 0.08921422827908865, "mean_env_wait_ms": 0.6934650732796659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003466214219184771, "StateBufferConnector_ms": 0.0026346885994689103, "ViewRequirementAgentConnector_ms": 0.06702860740766134}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9065760, "num_agent_steps_trained": 9065760, "num_env_steps_sampled": 9065760, "num_env_steps_trained": 9065760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.7634328332583, "num_env_steps_trained_throughput_per_sec": 714.7634328332583, "timesteps_total": 9065760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9065760, "timers": {"training_iteration_time_ms": 61477.068, "sample_time_ms": 60322.141, "load_time_ms": 16.916, "load_throughput": 2596404.091, "learn_time_ms": 1136.888, "learn_throughput": 38631.772, "synch_weights_time_ms": 0.953}, "counters": {"num_env_steps_sampled": 9065760, "num_env_steps_trained": 9065760, "num_agent_steps_sampled": 9065760, "num_agent_steps_trained": 9065760}, "done": false, "episodes_total": 1397, "training_iteration": 518, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-39-32", "timestamp": 1691095172, "time_this_iter_s": 61.44984197616577, "time_total_s": 15047.623676300049, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4500.811164617538, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.389655172413793, "ram_util_percent": 63.439080459770125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.9052743272252, "policy_loss": -7.36033868850147e+20, "vf_loss": 303658316.97376096}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 50421.5, "diff_num_grad_updates_vs_sampler_policy": 50420.5}}, "num_env_steps_sampled": 9109680, "num_env_steps_trained": 9109680, "num_agent_steps_sampled": 9109680, "num_agent_steps_trained": 9109680}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354336.1732303454, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21427043508073168, "mean_inference_ms": 0.364614609634316, "mean_action_processing_ms": 0.08922337182827056, "mean_env_wait_ms": 0.6933601603481874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034590025205869933, "StateBufferConnector_ms": 0.002632914362726985, "ViewRequirementAgentConnector_ms": 0.06701495196368243}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354336.1732303454, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21427043508073168, "mean_inference_ms": 0.364614609634316, "mean_action_processing_ms": 0.08922337182827056, "mean_env_wait_ms": 0.6933601603481874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034590025205869933, "StateBufferConnector_ms": 0.002632914362726985, "ViewRequirementAgentConnector_ms": 0.06701495196368243}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9109680, "num_agent_steps_trained": 9109680, "num_env_steps_sampled": 9109680, "num_env_steps_trained": 9109680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.5044414760364, "num_env_steps_trained_throughput_per_sec": 712.5044414760364, "timesteps_total": 9109680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9109680, "timers": {"training_iteration_time_ms": 61479.441, "sample_time_ms": 60324.306, "load_time_ms": 16.708, "load_throughput": 2628633.28, "learn_time_ms": 1137.307, "learn_throughput": 38617.548, "synch_weights_time_ms": 0.95}, "counters": {"num_env_steps_sampled": 9109680, "num_env_steps_trained": 9109680, "num_agent_steps_sampled": 9109680, "num_agent_steps_trained": 9109680}, "done": false, "episodes_total": 1398, "training_iteration": 519, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-40-34", "timestamp": 1691095234, "time_this_iter_s": 61.6448609828949, "time_total_s": 15109.268537282944, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4562.456025600433, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 17.400000000000002, "ram_util_percent": 63.5448275862069}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.0370974526809, "policy_loss": -7.235130468316798e+20, "vf_loss": 303366388.0816327}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51107.5, "diff_num_grad_updates_vs_sampler_policy": 51106.5}}, "num_env_steps_sampled": 9153600, "num_env_steps_trained": 9153600, "num_agent_steps_sampled": 9153600, "num_agent_steps_trained": 9153600}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354313.607857358, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21428677144022254, "mean_inference_ms": 0.36464549123909334, "mean_action_processing_ms": 0.08923228267076809, "mean_env_wait_ms": 0.6932571887852447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034548441569010415, "StateBufferConnector_ms": 0.0026346842447916665, "ViewRequirementAgentConnector_ms": 0.0670305887858073}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354313.607857358, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21428677144022254, "mean_inference_ms": 0.36464549123909334, "mean_action_processing_ms": 0.08923228267076809, "mean_env_wait_ms": 0.6932571887852447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034548441569010415, "StateBufferConnector_ms": 0.0026346842447916665, "ViewRequirementAgentConnector_ms": 0.0670305887858073}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9153600, "num_agent_steps_trained": 9153600, "num_env_steps_sampled": 9153600, "num_env_steps_trained": 9153600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.1103934779354, "num_env_steps_trained_throughput_per_sec": 716.1103934779354, "timesteps_total": 9153600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9153600, "timers": {"training_iteration_time_ms": 61479.408, "sample_time_ms": 60321.379, "load_time_ms": 16.717, "load_throughput": 2627343.597, "learn_time_ms": 1140.192, "learn_throughput": 38519.844, "synch_weights_time_ms": 0.952}, "counters": {"num_env_steps_sampled": 9153600, "num_env_steps_trained": 9153600, "num_agent_steps_sampled": 9153600, "num_agent_steps_trained": 9153600}, "done": false, "episodes_total": 1399, "training_iteration": 520, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-41-35", "timestamp": 1691095295, "time_this_iter_s": 61.334277868270874, "time_total_s": 15170.602815151215, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4623.790303468704, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.791954022988506, "ram_util_percent": 63.59195402298852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.1540778246288, "policy_loss": -7.006469055083284e+20, "vf_loss": 301963439.27696794}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51793.5, "diff_num_grad_updates_vs_sampler_policy": 51792.5}}, "num_env_steps_sampled": 9197520, "num_env_steps_trained": 9197520, "num_agent_steps_sampled": 9197520, "num_agent_steps_trained": 9197520}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354252.1157110364, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21430293471074163, "mean_inference_ms": 0.3646755775017624, "mean_action_processing_ms": 0.08924099272945246, "mean_env_wait_ms": 0.6931556909571186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034476581372712787, "StateBufferConnector_ms": 0.0026335841731021277, "ViewRequirementAgentConnector_ms": 0.06705302941171747}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354252.1157110364, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21430293471074163, "mean_inference_ms": 0.3646755775017624, "mean_action_processing_ms": 0.08924099272945246, "mean_env_wait_ms": 0.6931556909571186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034476581372712787, "StateBufferConnector_ms": 0.0026335841731021277, "ViewRequirementAgentConnector_ms": 0.06705302941171747}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9197520, "num_agent_steps_trained": 9197520, "num_env_steps_sampled": 9197520, "num_env_steps_trained": 9197520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.7697644143648, "num_env_steps_trained_throughput_per_sec": 714.7697644143648, "timesteps_total": 9197520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9197520, "timers": {"training_iteration_time_ms": 61471.823, "sample_time_ms": 60310.764, "load_time_ms": 16.736, "load_throughput": 2624308.096, "learn_time_ms": 1143.212, "learn_throughput": 38418.056, "synch_weights_time_ms": 0.942}, "counters": {"num_env_steps_sampled": 9197520, "num_env_steps_trained": 9197520, "num_agent_steps_sampled": 9197520, "num_agent_steps_trained": 9197520}, "done": false, "episodes_total": 1400, "training_iteration": 521, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-42-36", "timestamp": 1691095356, "time_this_iter_s": 61.4490749835968, "time_total_s": 15232.051890134811, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4685.239378452301, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.49425287356322, "ram_util_percent": 63.604597701149395}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4948087431693992e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.2325124490364, "policy_loss": -7.170065255628311e+20, "vf_loss": 304220111.75510204}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 52479.5, "diff_num_grad_updates_vs_sampler_policy": 52478.5}}, "num_env_steps_sampled": 9241440, "num_env_steps_trained": 9241440, "num_agent_steps_sampled": 9241440, "num_agent_steps_trained": 9241440}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354254.1467599433, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21431894862189185, "mean_inference_ms": 0.36470501901708463, "mean_action_processing_ms": 0.0892495278420591, "mean_env_wait_ms": 0.6930569501013938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034397298639470882, "StateBufferConnector_ms": 0.0026356090198863635, "ViewRequirementAgentConnector_ms": 0.0670324672352184}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354254.1467599433, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21431894862189185, "mean_inference_ms": 0.36470501901708463, "mean_action_processing_ms": 0.0892495278420591, "mean_env_wait_ms": 0.6930569501013938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034397298639470882, "StateBufferConnector_ms": 0.0026356090198863635, "ViewRequirementAgentConnector_ms": 0.0670324672352184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9241440, "num_agent_steps_trained": 9241440, "num_env_steps_sampled": 9241440, "num_env_steps_trained": 9241440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.4877343425873, "num_env_steps_trained_throughput_per_sec": 710.4877343425873, "timesteps_total": 9241440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9241440, "timers": {"training_iteration_time_ms": 61511.964, "sample_time_ms": 60348.46, "load_time_ms": 16.809, "load_throughput": 2612910.264, "learn_time_ms": 1145.584, "learn_throughput": 38338.519, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 9241440, "num_env_steps_trained": 9241440, "num_agent_steps_sampled": 9241440, "num_agent_steps_trained": 9241440}, "done": false, "episodes_total": 1401, "training_iteration": 522, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-43-38", "timestamp": 1691095418, "time_this_iter_s": 61.81994605064392, "time_total_s": 15293.871836185455, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4747.059324502945, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 17.273563218390805, "ram_util_percent": 63.549425287356335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3448087431693988e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.358033650123, "policy_loss": -7.558917465607105e+20, "vf_loss": 301955950.7172012}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53165.5, "diff_num_grad_updates_vs_sampler_policy": 53164.5}}, "num_env_steps_sampled": 9285360, "num_env_steps_trained": 9285360, "num_agent_steps_sampled": 9285360, "num_agent_steps_trained": 9285360}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354194.849392936, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21433503260161743, "mean_inference_ms": 0.36473409806302176, "mean_action_processing_ms": 0.08925789586418198, "mean_env_wait_ms": 0.6929606761790618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003444537138327574, "StateBufferConnector_ms": 0.002638804606902294, "ViewRequirementAgentConnector_ms": 0.06703505149254432}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354194.849392936, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21433503260161743, "mean_inference_ms": 0.36473409806302176, "mean_action_processing_ms": 0.08925789586418198, "mean_env_wait_ms": 0.6929606761790618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003444537138327574, "StateBufferConnector_ms": 0.002638804606902294, "ViewRequirementAgentConnector_ms": 0.06703505149254432}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9285360, "num_agent_steps_trained": 9285360, "num_env_steps_sampled": 9285360, "num_env_steps_trained": 9285360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.7706572996509, "num_env_steps_trained_throughput_per_sec": 709.7706572996509, "timesteps_total": 9285360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9285360, "timers": {"training_iteration_time_ms": 61565.118, "sample_time_ms": 60407.893, "load_time_ms": 16.712, "load_throughput": 2628048.267, "learn_time_ms": 1139.393, "learn_throughput": 38546.845, "synch_weights_time_ms": 0.951}, "counters": {"num_env_steps_sampled": 9285360, "num_env_steps_trained": 9285360, "num_agent_steps_sampled": 9285360, "num_agent_steps_trained": 9285360}, "done": false, "episodes_total": 1402, "training_iteration": 523, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-44-40", "timestamp": 1691095480, "time_this_iter_s": 61.88218307495117, "time_total_s": 15355.754019260406, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4808.941507577896, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.35909090909091, "ram_util_percent": 63.612500000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.194808743169399e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.4367294978817, "policy_loss": -7.036132647575787e+20, "vf_loss": 303802392.606414}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53851.5, "diff_num_grad_updates_vs_sampler_policy": 53850.5}}, "num_env_steps_sampled": 9329280, "num_env_steps_trained": 9329280, "num_agent_steps_sampled": 9329280, "num_agent_steps_trained": 9329280}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354185.5493242492, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2143501111812182, "mean_inference_ms": 0.3647625386974837, "mean_action_processing_ms": 0.08926608343691451, "mean_env_wait_ms": 0.6928662219793812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034389616567877274, "StateBufferConnector_ms": 0.0026355815839163863, "ViewRequirementAgentConnector_ms": 0.06706171397921405}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354185.5493242492, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2143501111812182, "mean_inference_ms": 0.3647625386974837, "mean_action_processing_ms": 0.08926608343691451, "mean_env_wait_ms": 0.6928662219793812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034389616567877274, "StateBufferConnector_ms": 0.0026355815839163863, "ViewRequirementAgentConnector_ms": 0.06706171397921405}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9329280, "num_agent_steps_trained": 9329280, "num_env_steps_sampled": 9329280, "num_env_steps_trained": 9329280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.7921937111839, "num_env_steps_trained_throughput_per_sec": 715.7921937111839, "timesteps_total": 9329280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9329280, "timers": {"training_iteration_time_ms": 61508.664, "sample_time_ms": 60348.665, "load_time_ms": 16.68, "load_throughput": 2633021.668, "learn_time_ms": 1142.209, "learn_throughput": 38451.812, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 9329280, "num_env_steps_trained": 9329280, "num_agent_steps_sampled": 9329280, "num_agent_steps_trained": 9329280}, "done": false, "episodes_total": 1403, "training_iteration": 524, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-45-42", "timestamp": 1691095542, "time_this_iter_s": 61.361407995224, "time_total_s": 15417.11542725563, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4870.30291557312, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 18.413793103448278, "ram_util_percent": 63.60574712643679}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0448087431693988e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.5753410495058, "policy_loss": -7.682658629677896e+20, "vf_loss": 303588802.122449}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 54537.5, "diff_num_grad_updates_vs_sampler_policy": 54536.5}}, "num_env_steps_sampled": 9373200, "num_env_steps_trained": 9373200, "num_agent_steps_sampled": 9373200, "num_agent_steps_trained": 9373200}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354173.195810095, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2143649803015423, "mean_inference_ms": 0.3647903030402834, "mean_action_processing_ms": 0.08927405434132502, "mean_env_wait_ms": 0.6927728501623782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034302473068237305, "StateBufferConnector_ms": 0.002638399600982666, "ViewRequirementAgentConnector_ms": 0.06704777479171753}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354173.195810095, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2143649803015423, "mean_inference_ms": 0.3647903030402834, "mean_action_processing_ms": 0.08927405434132502, "mean_env_wait_ms": 0.6927728501623782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034302473068237305, "StateBufferConnector_ms": 0.002638399600982666, "ViewRequirementAgentConnector_ms": 0.06704777479171753}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9373200, "num_agent_steps_trained": 9373200, "num_env_steps_sampled": 9373200, "num_env_steps_trained": 9373200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.0772566799997, "num_env_steps_trained_throughput_per_sec": 716.0772566799997, "timesteps_total": 9373200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9373200, "timers": {"training_iteration_time_ms": 61485.563, "sample_time_ms": 60326.049, "load_time_ms": 16.609, "load_throughput": 2644292.327, "learn_time_ms": 1141.792, "learn_throughput": 38465.838, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 9373200, "num_env_steps_trained": 9373200, "num_agent_steps_sampled": 9373200, "num_agent_steps_trained": 9373200}, "done": false, "episodes_total": 1404, "training_iteration": 525, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-46-43", "timestamp": 1691095603, "time_this_iter_s": 61.33754205703735, "time_total_s": 15478.452969312668, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4931.6404576301575, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 19.53793103448276, "ram_util_percent": 63.1816091954023}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8948087431693988e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.6809861430622, "policy_loss": -7.557069399562532e+20, "vf_loss": 303993594.51895046}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55223.5, "diff_num_grad_updates_vs_sampler_policy": 55222.5}}, "num_env_steps_sampled": 9417120, "num_env_steps_trained": 9417120, "num_agent_steps_sampled": 9417120, "num_agent_steps_trained": 9417120}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354169.603334735, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21437955016745128, "mean_inference_ms": 0.3648175669653531, "mean_action_processing_ms": 0.08928189345883866, "mean_env_wait_ms": 0.6926810707438025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350916827166522, "StateBufferConnector_ms": 0.002634966814959491, "ViewRequirementAgentConnector_ms": 0.0669979754789376}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354169.603334735, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21437955016745128, "mean_inference_ms": 0.3648175669653531, "mean_action_processing_ms": 0.08928189345883866, "mean_env_wait_ms": 0.6926810707438025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350916827166522, "StateBufferConnector_ms": 0.002634966814959491, "ViewRequirementAgentConnector_ms": 0.0669979754789376}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9417120, "num_agent_steps_trained": 9417120, "num_env_steps_sampled": 9417120, "num_env_steps_trained": 9417120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.5611984608548, "num_env_steps_trained_throughput_per_sec": 713.5611984608548, "timesteps_total": 9417120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9417120, "timers": {"training_iteration_time_ms": 61510.41, "sample_time_ms": 60347.778, "load_time_ms": 16.564, "load_throughput": 2651478.163, "learn_time_ms": 1144.942, "learn_throughput": 38360.027, "synch_weights_time_ms": 0.96}, "counters": {"num_env_steps_sampled": 9417120, "num_env_steps_trained": 9417120, "num_agent_steps_sampled": 9417120, "num_agent_steps_trained": 9417120}, "done": false, "episodes_total": 1405, "training_iteration": 526, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-47-44", "timestamp": 1691095664, "time_this_iter_s": 61.553500175476074, "time_total_s": 15540.006469488144, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4993.1939578056335, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 17.5, "ram_util_percent": 63.36091954022987}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7448087431693984e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.8211043555257, "policy_loss": -7.600997513233051e+20, "vf_loss": 304459454.909621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55909.5, "diff_num_grad_updates_vs_sampler_policy": 55908.5}}, "num_env_steps_sampled": 9461040, "num_env_steps_trained": 9461040, "num_agent_steps_sampled": 9461040, "num_agent_steps_trained": 9461040}, "sampler_results": {"episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354179.3291618524, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21439379987347174, "mean_inference_ms": 0.36484441595960637, "mean_action_processing_ms": 0.08928956948338156, "mean_env_wait_ms": 0.6925919088096649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003502136323510147, "StateBufferConnector_ms": 0.0026351068078017815, "ViewRequirementAgentConnector_ms": 0.06702847597075672}}, "episode_reward_max": -1348628.9521481635, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354179.3291618524, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21439379987347174, "mean_inference_ms": 0.36484441595960637, "mean_action_processing_ms": 0.08928956948338156, "mean_env_wait_ms": 0.6925919088096649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003502136323510147, "StateBufferConnector_ms": 0.0026351068078017815, "ViewRequirementAgentConnector_ms": 0.06702847597075672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9461040, "num_agent_steps_trained": 9461040, "num_env_steps_sampled": 9461040, "num_env_steps_trained": 9461040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.976171296509, "num_env_steps_trained_throughput_per_sec": 709.976171296509, "timesteps_total": 9461040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9461040, "timers": {"training_iteration_time_ms": 61566.636, "sample_time_ms": 60405.268, "load_time_ms": 16.513, "load_throughput": 2659685.853, "learn_time_ms": 1143.758, "learn_throughput": 38399.748, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 9461040, "num_env_steps_trained": 9461040, "num_agent_steps_sampled": 9461040, "num_agent_steps_trained": 9461040}, "done": false, "episodes_total": 1406, "training_iteration": 527, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-48-46", "timestamp": 1691095726, "time_this_iter_s": 61.86416482925415, "time_total_s": 15601.870634317398, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5055.058122634888, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.560919540229886, "ram_util_percent": 63.310344827586206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5948087431693994e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.886029568775, "policy_loss": -6.374621644412859e+20, "vf_loss": 301340079.2653061}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 56595.5, "diff_num_grad_updates_vs_sampler_policy": 56594.5}}, "num_env_steps_sampled": 9504960, "num_env_steps_trained": 9504960, "num_agent_steps_sampled": 9504960, "num_agent_steps_trained": 9504960}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354107.7529570844, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21440788792641957, "mean_inference_ms": 0.3648708075956204, "mean_action_processing_ms": 0.08929708922152127, "mean_env_wait_ms": 0.6925025240821834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499582589390766, "StateBufferConnector_ms": 0.0026352434273225716, "ViewRequirementAgentConnector_ms": 0.06702922912965338}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354107.7529570844, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21440788792641957, "mean_inference_ms": 0.3648708075956204, "mean_action_processing_ms": 0.08929708922152127, "mean_env_wait_ms": 0.6925025240821834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499582589390766, "StateBufferConnector_ms": 0.0026352434273225716, "ViewRequirementAgentConnector_ms": 0.06702922912965338}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9504960, "num_agent_steps_trained": 9504960, "num_env_steps_sampled": 9504960, "num_env_steps_trained": 9504960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.3356059169384, "num_env_steps_trained_throughput_per_sec": 719.3356059169384, "timesteps_total": 9504960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9504960, "timers": {"training_iteration_time_ms": 61527.58, "sample_time_ms": 60367.771, "load_time_ms": 16.504, "load_throughput": 2661118.968, "learn_time_ms": 1142.218, "learn_throughput": 38451.516, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 9504960, "num_env_steps_trained": 9504960, "num_agent_steps_sampled": 9504960, "num_agent_steps_trained": 9504960}, "done": false, "episodes_total": 1407, "training_iteration": 528, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-49-47", "timestamp": 1691095787, "time_this_iter_s": 61.05947804450989, "time_total_s": 15662.930112361908, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5116.117600679398, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.742528735632185, "ram_util_percent": 63.33448275862068}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4448087431693989e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.9825069327396, "policy_loss": -7.182841600446164e+20, "vf_loss": 303857376.82215744}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57281.5, "diff_num_grad_updates_vs_sampler_policy": 57280.5}}, "num_env_steps_sampled": 9548880, "num_env_steps_trained": 9548880, "num_agent_steps_sampled": 9548880, "num_agent_steps_trained": 9548880}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354100.989483781, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21442185512488207, "mean_inference_ms": 0.3648965023677381, "mean_action_processing_ms": 0.08930443453615197, "mean_env_wait_ms": 0.6924154188462806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034916968572707404, "StateBufferConnector_ms": 0.002636795952206566, "ViewRequirementAgentConnector_ms": 0.06700470334007627}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354100.989483781, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21442185512488207, "mean_inference_ms": 0.3648965023677381, "mean_action_processing_ms": 0.08930443453615197, "mean_env_wait_ms": 0.6924154188462806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034916968572707404, "StateBufferConnector_ms": 0.002636795952206566, "ViewRequirementAgentConnector_ms": 0.06700470334007627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9548880, "num_agent_steps_trained": 9548880, "num_env_steps_sampled": 9548880, "num_env_steps_trained": 9548880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.4102810499915, "num_env_steps_trained_throughput_per_sec": 711.4102810499915, "timesteps_total": 9548880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9548880, "timers": {"training_iteration_time_ms": 61537.06, "sample_time_ms": 60377.888, "load_time_ms": 16.532, "load_throughput": 2656644.164, "learn_time_ms": 1141.552, "learn_throughput": 38473.929, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 9548880, "num_env_steps_trained": 9548880, "num_agent_steps_sampled": 9548880, "num_agent_steps_trained": 9548880}, "done": false, "episodes_total": 1408, "training_iteration": 529, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-50-49", "timestamp": 1691095849, "time_this_iter_s": 61.739675760269165, "time_total_s": 15724.669788122177, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5177.857276439667, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 17.44137931034483, "ram_util_percent": 63.38505747126437}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2948087431693984e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.086101565347, "policy_loss": -7.472073046301215e+20, "vf_loss": 303724716.0116618}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57967.5, "diff_num_grad_updates_vs_sampler_policy": 57966.5}}, "num_env_steps_sampled": 9592800, "num_env_steps_trained": 9592800, "num_agent_steps_sampled": 9592800, "num_agent_steps_trained": 9592800}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354093.377009871, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21443564954292493, "mean_inference_ms": 0.3649217090242346, "mean_action_processing_ms": 0.08931162367787389, "mean_env_wait_ms": 0.692330062285257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003488484550924862, "StateBufferConnector_ms": 0.002635787515079274, "ViewRequirementAgentConnector_ms": 0.06699309629552505}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354093.377009871, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21443564954292493, "mean_inference_ms": 0.3649217090242346, "mean_action_processing_ms": 0.08931162367787389, "mean_env_wait_ms": 0.692330062285257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003488484550924862, "StateBufferConnector_ms": 0.002635787515079274, "ViewRequirementAgentConnector_ms": 0.06699309629552505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9592800, "num_agent_steps_trained": 9592800, "num_env_steps_sampled": 9592800, "num_env_steps_trained": 9592800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.3190607337605, "num_env_steps_trained_throughput_per_sec": 712.3190607337605, "timesteps_total": 9592800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9592800, "timers": {"training_iteration_time_ms": 61569.704, "sample_time_ms": 60410.14, "load_time_ms": 16.561, "load_throughput": 2652004.93, "learn_time_ms": 1141.913, "learn_throughput": 38461.763, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 9592800, "num_env_steps_trained": 9592800, "num_agent_steps_sampled": 9592800, "num_agent_steps_trained": 9592800}, "done": false, "episodes_total": 1409, "training_iteration": 530, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-51-51", "timestamp": 1691095911, "time_this_iter_s": 61.66104698181152, "time_total_s": 15786.330835103989, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5239.518323421478, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.15287356321839, "ram_util_percent": 63.419540229885065}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1448087431693988e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.1814790508838, "policy_loss": -7.29553101941796e+20, "vf_loss": 303360657.02040815}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 58653.5, "diff_num_grad_updates_vs_sampler_policy": 58652.5}}, "num_env_steps_sampled": 9636720, "num_env_steps_trained": 9636720, "num_agent_steps_sampled": 9636720, "num_agent_steps_trained": 9636720}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354077.4961851188, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21444853176314038, "mean_inference_ms": 0.3649465438423397, "mean_action_processing_ms": 0.08931868509610343, "mean_env_wait_ms": 0.6922462266111636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518891888995503, "StateBufferConnector_ms": 0.002642287764438363, "ViewRequirementAgentConnector_ms": 0.06700975950374159}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354077.4961851188, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21444853176314038, "mean_inference_ms": 0.3649465438423397, "mean_action_processing_ms": 0.08931868509610343, "mean_env_wait_ms": 0.6922462266111636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518891888995503, "StateBufferConnector_ms": 0.002642287764438363, "ViewRequirementAgentConnector_ms": 0.06700975950374159}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9636720, "num_agent_steps_trained": 9636720, "num_env_steps_sampled": 9636720, "num_env_steps_trained": 9636720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.2694669732232, "num_env_steps_trained_throughput_per_sec": 715.2694669732232, "timesteps_total": 9636720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9636720, "timers": {"training_iteration_time_ms": 61565.411, "sample_time_ms": 60405.916, "load_time_ms": 16.579, "load_throughput": 2649125.533, "learn_time_ms": 1141.813, "learn_throughput": 38465.137, "synch_weights_time_ms": 0.94}, "counters": {"num_env_steps_sampled": 9636720, "num_env_steps_trained": 9636720, "num_agent_steps_sampled": 9636720, "num_agent_steps_trained": 9636720}, "done": false, "episodes_total": 1410, "training_iteration": 531, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-52-52", "timestamp": 1691095972, "time_this_iter_s": 61.406376123428345, "time_total_s": 15847.737211227417, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5300.924699544907, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.902298850574713, "ram_util_percent": 63.39655172413792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.2600546077806, "policy_loss": -8.301924362053431e+20, "vf_loss": 303926600.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59339.5, "diff_num_grad_updates_vs_sampler_policy": 59338.5}}, "num_env_steps_sampled": 9680640, "num_env_steps_trained": 9680640, "num_agent_steps_sampled": 9680640, "num_agent_steps_trained": 9680640}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354076.676427574, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2144612962564476, "mean_inference_ms": 0.36497087980689813, "mean_action_processing_ms": 0.08932562282038677, "mean_env_wait_ms": 0.6921647616123325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00351489275351338, "StateBufferConnector_ms": 0.002640143208120061, "ViewRequirementAgentConnector_ms": 0.06699013984066317}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354076.676427574, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2144612962564476, "mean_inference_ms": 0.36497087980689813, "mean_action_processing_ms": 0.08932562282038677, "mean_env_wait_ms": 0.6921647616123325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00351489275351338, "StateBufferConnector_ms": 0.002640143208120061, "ViewRequirementAgentConnector_ms": 0.06699013984066317}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9680640, "num_agent_steps_trained": 9680640, "num_env_steps_sampled": 9680640, "num_env_steps_trained": 9680640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 708.8951139898181, "num_env_steps_trained_throughput_per_sec": 708.8951139898181, "timesteps_total": 9680640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9680640, "timers": {"training_iteration_time_ms": 61579.3, "sample_time_ms": 60413.972, "load_time_ms": 16.445, "load_throughput": 2670675.254, "learn_time_ms": 1147.776, "learn_throughput": 38265.311, "synch_weights_time_ms": 0.94}, "counters": {"num_env_steps_sampled": 9680640, "num_env_steps_trained": 9680640, "num_agent_steps_sampled": 9680640, "num_agent_steps_trained": 9680640}, "done": false, "episodes_total": 1411, "training_iteration": 532, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-53-54", "timestamp": 1691096034, "time_this_iter_s": 61.958702087402344, "time_total_s": 15909.69591331482, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5362.883401632309, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 17.477272727272727, "ram_util_percent": 63.525000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.3078006488588, "policy_loss": -7.293591208808798e+20, "vf_loss": 302815516.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60025.5, "diff_num_grad_updates_vs_sampler_policy": 60024.5}}, "num_env_steps_sampled": 9724560, "num_env_steps_trained": 9724560, "num_agent_steps_sampled": 9724560, "num_agent_steps_trained": 9724560}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354047.9811939937, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21447388471200932, "mean_inference_ms": 0.3649949663168767, "mean_action_processing_ms": 0.08933242621184666, "mean_env_wait_ms": 0.6920846854952615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035077333450317383, "StateBufferConnector_ms": 0.0026423822749744763, "ViewRequirementAgentConnector_ms": 0.06696879863739014}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354047.9811939937, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21447388471200932, "mean_inference_ms": 0.3649949663168767, "mean_action_processing_ms": 0.08933242621184666, "mean_env_wait_ms": 0.6920846854952615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035077333450317383, "StateBufferConnector_ms": 0.0026423822749744763, "ViewRequirementAgentConnector_ms": 0.06696879863739014}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9724560, "num_agent_steps_trained": 9724560, "num_env_steps_sampled": 9724560, "num_env_steps_trained": 9724560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.6538113804334, "num_env_steps_trained_throughput_per_sec": 712.6538113804334, "timesteps_total": 9724560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9724560, "timers": {"training_iteration_time_ms": 61554.266, "sample_time_ms": 60389.307, "load_time_ms": 16.426, "load_throughput": 2673764.699, "learn_time_ms": 1147.435, "learn_throughput": 38276.689, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 9724560, "num_env_steps_trained": 9724560, "num_agent_steps_sampled": 9724560, "num_agent_steps_trained": 9724560}, "done": false, "episodes_total": 1412, "training_iteration": 533, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-54-56", "timestamp": 1691096096, "time_this_iter_s": 61.63235592842102, "time_total_s": 15971.32826924324, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5424.51575756073, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.47011494252874, "ram_util_percent": 63.45862068965518}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.3680140548129, "policy_loss": -7.900717223782671e+20, "vf_loss": 303233782.8979592}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60711.5, "diff_num_grad_updates_vs_sampler_policy": 60710.5}}, "num_env_steps_sampled": 9768480, "num_env_steps_trained": 9768480, "num_agent_steps_sampled": 9768480, "num_agent_steps_trained": 9768480}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354028.1544674216, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21448628098098052, "mean_inference_ms": 0.3650185898416766, "mean_action_processing_ms": 0.08933909995836757, "mean_env_wait_ms": 0.6920063284440436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003502610024441494, "StateBufferConnector_ms": 0.002642695823412263, "ViewRequirementAgentConnector_ms": 0.06697151098358498}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354028.1544674216, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21448628098098052, "mean_inference_ms": 0.3650185898416766, "mean_action_processing_ms": 0.08933909995836757, "mean_env_wait_ms": 0.6920063284440436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003502610024441494, "StateBufferConnector_ms": 0.002642695823412263, "ViewRequirementAgentConnector_ms": 0.06697151098358498}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9768480, "num_agent_steps_trained": 9768480, "num_env_steps_sampled": 9768480, "num_env_steps_trained": 9768480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.2334229852668, "num_env_steps_trained_throughput_per_sec": 712.2334229852668, "timesteps_total": 9768480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9768480, "timers": {"training_iteration_time_ms": 61584.924, "sample_time_ms": 60421.967, "load_time_ms": 16.415, "load_throughput": 2675609.362, "learn_time_ms": 1145.452, "learn_throughput": 38342.954, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 9768480, "num_env_steps_trained": 9768480, "num_agent_steps_sampled": 9768480, "num_agent_steps_trained": 9768480}, "done": false, "episodes_total": 1413, "training_iteration": 534, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-55-58", "timestamp": 1691096158, "time_this_iter_s": 61.66831183433533, "time_total_s": 16032.996581077576, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5486.184069395065, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.244318181818183, "ram_util_percent": 63.38636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.4087385616915, "policy_loss": -6.994994680231467e+20, "vf_loss": 303384988.07580173}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 61397.5, "diff_num_grad_updates_vs_sampler_policy": 61396.5}}, "num_env_steps_sampled": 9812400, "num_env_steps_trained": 9812400, "num_agent_steps_sampled": 9812400, "num_agent_steps_trained": 9812400}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354010.9537702154, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21449831295254201, "mean_inference_ms": 0.3650419038622338, "mean_action_processing_ms": 0.08934562075316911, "mean_env_wait_ms": 0.6919285230507408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498925103081597, "StateBufferConnector_ms": 0.0026400883992513022, "ViewRequirementAgentConnector_ms": 0.06694926155938043}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1354010.9537702154, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21449831295254201, "mean_inference_ms": 0.3650419038622338, "mean_action_processing_ms": 0.08934562075316911, "mean_env_wait_ms": 0.6919285230507408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498925103081597, "StateBufferConnector_ms": 0.0026400883992513022, "ViewRequirementAgentConnector_ms": 0.06694926155938043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9812400, "num_agent_steps_trained": 9812400, "num_env_steps_sampled": 9812400, "num_env_steps_trained": 9812400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.9663168711065, "num_env_steps_trained_throughput_per_sec": 716.9663168711065, "timesteps_total": 9812400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9812400, "timers": {"training_iteration_time_ms": 61577.318, "sample_time_ms": 60413.649, "load_time_ms": 16.441, "load_throughput": 2671329.759, "learn_time_ms": 1146.135, "learn_throughput": 38320.095, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 9812400, "num_env_steps_trained": 9812400, "num_agent_steps_sampled": 9812400, "num_agent_steps_trained": 9812400}, "done": false, "episodes_total": 1414, "training_iteration": 535, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-56-59", "timestamp": 1691096219, "time_this_iter_s": 61.26107597351074, "time_total_s": 16094.257657051086, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5547.445145368576, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.893023255813954, "ram_util_percent": 63.467441860465094}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.4631440187682, "policy_loss": -7.195406848418121e+20, "vf_loss": 302870815.1311953}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62083.5, "diff_num_grad_updates_vs_sampler_policy": 62082.5}}, "num_env_steps_sampled": 9856320, "num_env_steps_trained": 9856320, "num_agent_steps_sampled": 9856320, "num_agent_steps_trained": 9856320}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353981.2191797264, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21451025119548084, "mean_inference_ms": 0.36506467608676363, "mean_action_processing_ms": 0.08935202539531995, "mean_env_wait_ms": 0.6918511115904447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034971551580743475, "StateBufferConnector_ms": 0.0026380622779930032, "ViewRequirementAgentConnector_ms": 0.06693798107105298}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353981.2191797264, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21451025119548084, "mean_inference_ms": 0.36506467608676363, "mean_action_processing_ms": 0.08935202539531995, "mean_env_wait_ms": 0.6918511115904447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034971551580743475, "StateBufferConnector_ms": 0.0026380622779930032, "ViewRequirementAgentConnector_ms": 0.06693798107105298}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9856320, "num_agent_steps_trained": 9856320, "num_env_steps_sampled": 9856320, "num_env_steps_trained": 9856320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.2800176738232, "num_env_steps_trained_throughput_per_sec": 717.2800176738232, "timesteps_total": 9856320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9856320, "timers": {"training_iteration_time_ms": 61545.407, "sample_time_ms": 60382.273, "load_time_ms": 16.458, "load_throughput": 2668605.413, "learn_time_ms": 1145.594, "learn_throughput": 38338.197, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 9856320, "num_env_steps_trained": 9856320, "num_agent_steps_sampled": 9856320, "num_agent_steps_trained": 9856320}, "done": false, "episodes_total": 1415, "training_iteration": 536, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-58-00", "timestamp": 1691096280, "time_this_iter_s": 61.234151124954224, "time_total_s": 16155.49180817604, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5608.67929649353, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 17.50689655172414, "ram_util_percent": 63.50459770114942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.571745669529, "policy_loss": -7.581193911170357e+20, "vf_loss": 303197331.1253644}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62769.5, "diff_num_grad_updates_vs_sampler_policy": 62768.5}}, "num_env_steps_sampled": 9900240, "num_env_steps_trained": 9900240, "num_agent_steps_sampled": 9900240, "num_agent_steps_trained": 9900240}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353962.3545658744, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2145220315564972, "mean_inference_ms": 0.36508700798565913, "mean_action_processing_ms": 0.0893582904430477, "mean_env_wait_ms": 0.6917748658575484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003492054731949516, "StateBufferConnector_ms": 0.002640744914179263, "ViewRequirementAgentConnector_ms": 0.06693575693213422}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353962.3545658744, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2145220315564972, "mean_inference_ms": 0.36508700798565913, "mean_action_processing_ms": 0.0893582904430477, "mean_env_wait_ms": 0.6917748658575484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003492054731949516, "StateBufferConnector_ms": 0.002640744914179263, "ViewRequirementAgentConnector_ms": 0.06693575693213422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9900240, "num_agent_steps_trained": 9900240, "num_env_steps_sampled": 9900240, "num_env_steps_trained": 9900240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.2162513970612, "num_env_steps_trained_throughput_per_sec": 714.2162513970612, "timesteps_total": 9900240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9900240, "timers": {"training_iteration_time_ms": 61508.682, "sample_time_ms": 60347.634, "load_time_ms": 16.541, "load_throughput": 2655250.308, "learn_time_ms": 1143.426, "learn_throughput": 38410.877, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 9900240, "num_env_steps_trained": 9900240, "num_agent_steps_sampled": 9900240, "num_agent_steps_trained": 9900240}, "done": false, "episodes_total": 1416, "training_iteration": 537, "trial_id": "5bc4e_00000", "date": "2023-08-03_23-59-02", "timestamp": 1691096342, "time_this_iter_s": 61.49691319465637, "time_total_s": 16216.988721370697, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5670.176209688187, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 17.621839080459768, "ram_util_percent": 63.57931034482758}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.6475251756674, "policy_loss": -7.970981548283514e+20, "vf_loss": 304365244.24489796}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63455.5, "diff_num_grad_updates_vs_sampler_policy": 63454.5}}, "num_env_steps_sampled": 9944160, "num_env_steps_trained": 9944160, "num_agent_steps_sampled": 9944160, "num_agent_steps_trained": 9944160}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353972.0285989216, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2145333942347199, "mean_inference_ms": 0.3651088672133987, "mean_action_processing_ms": 0.08936442782647433, "mean_env_wait_ms": 0.6917000121909138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034888585408528647, "StateBufferConnector_ms": 0.0026382425779937417, "ViewRequirementAgentConnector_ms": 0.06692024969285534}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353972.0285989216, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2145333942347199, "mean_inference_ms": 0.3651088672133987, "mean_action_processing_ms": 0.08936442782647433, "mean_env_wait_ms": 0.6917000121909138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034888585408528647, "StateBufferConnector_ms": 0.0026382425779937417, "ViewRequirementAgentConnector_ms": 0.06692024969285534}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9944160, "num_agent_steps_trained": 9944160, "num_env_steps_sampled": 9944160, "num_env_steps_trained": 9944160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.2853995229877, "num_env_steps_trained_throughput_per_sec": 714.2853995229877, "timesteps_total": 9944160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9944160, "timers": {"training_iteration_time_ms": 61551.851, "sample_time_ms": 60390.511, "load_time_ms": 16.648, "load_throughput": 2638123.488, "learn_time_ms": 1143.606, "learn_throughput": 38404.851, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 9944160, "num_env_steps_trained": 9944160, "num_agent_steps_sampled": 9944160, "num_agent_steps_trained": 9944160}, "done": false, "episodes_total": 1417, "training_iteration": 538, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-00-03", "timestamp": 1691096403, "time_this_iter_s": 61.491109132766724, "time_total_s": 16278.479830503464, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5731.667318820953, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 18.24137931034483, "ram_util_percent": 63.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.68105216068, "policy_loss": -7.971299168286127e+20, "vf_loss": 303237293.6268222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64141.5, "diff_num_grad_updates_vs_sampler_policy": 64140.5}}, "num_env_steps_sampled": 9988080, "num_env_steps_trained": 9988080, "num_agent_steps_sampled": 9988080, "num_agent_steps_trained": 9988080}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353953.4931080716, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21454449851053428, "mean_inference_ms": 0.3651302393200144, "mean_action_processing_ms": 0.08937045319440234, "mean_env_wait_ms": 0.6916264704936214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034859839906083777, "StateBufferConnector_ms": 0.002640866218729222, "ViewRequirementAgentConnector_ms": 0.06691065240413585}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353953.4931080716, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21454449851053428, "mean_inference_ms": 0.3651302393200144, "mean_action_processing_ms": 0.08937045319440234, "mean_env_wait_ms": 0.6916264704936214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034859839906083777, "StateBufferConnector_ms": 0.002640866218729222, "ViewRequirementAgentConnector_ms": 0.06691065240413585}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9988080, "num_agent_steps_trained": 9988080, "num_env_steps_sampled": 9988080, "num_env_steps_trained": 9988080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.0968293996601, "num_env_steps_trained_throughput_per_sec": 714.0968293996601, "timesteps_total": 9988080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9988080, "timers": {"training_iteration_time_ms": 61528.624, "sample_time_ms": 60367.97, "load_time_ms": 16.691, "load_throughput": 2631295.375, "learn_time_ms": 1142.864, "learn_throughput": 38429.763, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 9988080, "num_env_steps_trained": 9988080, "num_agent_steps_sampled": 9988080, "num_agent_steps_trained": 9988080}, "done": false, "episodes_total": 1418, "training_iteration": 539, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-01-05", "timestamp": 1691096465, "time_this_iter_s": 61.50728225708008, "time_total_s": 16339.987112760544, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5793.174601078033, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 17.683908045977013, "ram_util_percent": 63.580459770114956}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.7850001921806, "policy_loss": -7.46468630640034e+20, "vf_loss": 304251204.34985423}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64827.5, "diff_num_grad_updates_vs_sampler_policy": 64826.5}}, "num_env_steps_sampled": 10032000, "num_env_steps_trained": 10032000, "num_agent_steps_sampled": 10032000, "num_agent_steps_trained": 10032000}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353960.7217685087, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21455537805356403, "mean_inference_ms": 0.36515114527854564, "mean_action_processing_ms": 0.08937635778903612, "mean_env_wait_ms": 0.6915535662295423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034839228579872533, "StateBufferConnector_ms": 0.002639670121042352, "ViewRequirementAgentConnector_ms": 0.06688745398270457}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353960.7217685087, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21455537805356403, "mean_inference_ms": 0.36515114527854564, "mean_action_processing_ms": 0.08937635778903612, "mean_env_wait_ms": 0.6915535662295423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034839228579872533, "StateBufferConnector_ms": 0.002639670121042352, "ViewRequirementAgentConnector_ms": 0.06688745398270457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10032000, "num_agent_steps_trained": 10032000, "num_env_steps_sampled": 10032000, "num_env_steps_trained": 10032000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0697154067459, "num_env_steps_trained_throughput_per_sec": 717.0697154067459, "timesteps_total": 10032000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10032000, "timers": {"training_iteration_time_ms": 61487.775, "sample_time_ms": 60329.199, "load_time_ms": 16.802, "load_throughput": 2613911.316, "learn_time_ms": 1140.68, "learn_throughput": 38503.352, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 10032000, "num_env_steps_trained": 10032000, "num_agent_steps_sampled": 10032000, "num_agent_steps_trained": 10032000}, "done": false, "episodes_total": 1419, "training_iteration": 540, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-02-06", "timestamp": 1691096526, "time_this_iter_s": 61.25252985954285, "time_total_s": 16401.239642620087, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5854.427130937576, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 18.09195402298851, "ram_util_percent": 63.475862068965526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.8669111513188, "policy_loss": -7.233373482653851e+20, "vf_loss": 302766001.19533527}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 65513.5, "diff_num_grad_updates_vs_sampler_policy": 65512.5}}, "num_env_steps_sampled": 10075920, "num_env_steps_trained": 10075920, "num_agent_steps_sampled": 10075920, "num_agent_steps_trained": 10075920}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353933.3388428509, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21456615669108095, "mean_inference_ms": 0.36517165855194217, "mean_action_processing_ms": 0.08938214109896732, "mean_env_wait_ms": 0.691481569463372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478179375330607, "StateBufferConnector_ms": 0.0026402374108632407, "ViewRequirementAgentConnector_ms": 0.0668776532014211}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353933.3388428509, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21456615669108095, "mean_inference_ms": 0.36517165855194217, "mean_action_processing_ms": 0.08938214109896732, "mean_env_wait_ms": 0.691481569463372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478179375330607, "StateBufferConnector_ms": 0.0026402374108632407, "ViewRequirementAgentConnector_ms": 0.0668776532014211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10075920, "num_agent_steps_trained": 10075920, "num_env_steps_sampled": 10075920, "num_env_steps_trained": 10075920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.82416017378, "num_env_steps_trained_throughput_per_sec": 714.82416017378, "timesteps_total": 10075920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10075920, "timers": {"training_iteration_time_ms": 61491.6, "sample_time_ms": 60336.02, "load_time_ms": 16.75, "load_throughput": 2622063.128, "learn_time_ms": 1137.738, "learn_throughput": 38602.915, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 10075920, "num_env_steps_trained": 10075920, "num_agent_steps_sampled": 10075920, "num_agent_steps_trained": 10075920}, "done": false, "episodes_total": 1420, "training_iteration": 541, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-03-08", "timestamp": 1691096588, "time_this_iter_s": 61.44473719596863, "time_total_s": 16462.684379816055, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5915.871868133545, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 17.387356321839082, "ram_util_percent": 63.55287356321838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.9114666374362, "policy_loss": -7.813430541151447e+20, "vf_loss": 302075767.212828}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66199.5, "diff_num_grad_updates_vs_sampler_policy": 66198.5}}, "num_env_steps_sampled": 10119840, "num_env_steps_trained": 10119840, "num_agent_steps_sampled": 10119840, "num_agent_steps_trained": 10119840}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353889.1083351395, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21457649674568394, "mean_inference_ms": 0.36519185657288084, "mean_action_processing_ms": 0.08938783069610073, "mean_env_wait_ms": 0.6914110388074008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034740290690943136, "StateBufferConnector_ms": 0.002638335080490899, "ViewRequirementAgentConnector_ms": 0.0668506032412814}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353889.1083351395, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21457649674568394, "mean_inference_ms": 0.36519185657288084, "mean_action_processing_ms": 0.08938783069610073, "mean_env_wait_ms": 0.6914110388074008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034740290690943136, "StateBufferConnector_ms": 0.002638335080490899, "ViewRequirementAgentConnector_ms": 0.0668506032412814}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10119840, "num_agent_steps_trained": 10119840, "num_env_steps_sampled": 10119840, "num_env_steps_trained": 10119840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.5069382695955, "num_env_steps_trained_throughput_per_sec": 712.5069382695955, "timesteps_total": 10119840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10119840, "timers": {"training_iteration_time_ms": 61460.194, "sample_time_ms": 60305.502, "load_time_ms": 16.773, "load_throughput": 2618533.499, "learn_time_ms": 1136.819, "learn_throughput": 38634.118, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 10119840, "num_env_steps_trained": 10119840, "num_agent_steps_sampled": 10119840, "num_agent_steps_trained": 10119840}, "done": false, "episodes_total": 1421, "training_iteration": 542, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-04-09", "timestamp": 1691096649, "time_this_iter_s": 61.644768953323364, "time_total_s": 16524.32914876938, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5977.516637086868, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.590804597701148, "ram_util_percent": 63.520689655172426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.9985992164723, "policy_loss": -8.030230481480332e+20, "vf_loss": 303928776.4314869}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66885.5, "diff_num_grad_updates_vs_sampler_policy": 66884.5}}, "num_env_steps_sampled": 10163760, "num_env_steps_trained": 10163760, "num_agent_steps_sampled": 10163760, "num_agent_steps_trained": 10163760}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353890.711590474, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21458682034144713, "mean_inference_ms": 0.365211833547032, "mean_action_processing_ms": 0.0893934337865457, "mean_env_wait_ms": 0.6913427240082298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470206747249681, "StateBufferConnector_ms": 0.0026379312787737164, "ViewRequirementAgentConnector_ms": 0.06684746061052595}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353890.711590474, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21458682034144713, "mean_inference_ms": 0.365211833547032, "mean_action_processing_ms": 0.0893934337865457, "mean_env_wait_ms": 0.6913427240082298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470206747249681, "StateBufferConnector_ms": 0.0026379312787737164, "ViewRequirementAgentConnector_ms": 0.06684746061052595}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10163760, "num_agent_steps_trained": 10163760, "num_env_steps_sampled": 10163760, "num_env_steps_trained": 10163760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.0163873133678, "num_env_steps_trained_throughput_per_sec": 707.0163873133678, "timesteps_total": 10163760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10163760, "timers": {"training_iteration_time_ms": 61509.334, "sample_time_ms": 60354.477, "load_time_ms": 16.915, "load_throughput": 2596579.759, "learn_time_ms": 1136.831, "learn_throughput": 38633.725, "synch_weights_time_ms": 0.946}, "counters": {"num_env_steps_sampled": 10163760, "num_env_steps_trained": 10163760, "num_agent_steps_sampled": 10163760, "num_agent_steps_trained": 10163760}, "done": false, "episodes_total": 1422, "training_iteration": 543, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-05-11", "timestamp": 1691096711, "time_this_iter_s": 62.12301707267761, "time_total_s": 16586.452165842056, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6039.639654159546, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 18.301136363636367, "ram_util_percent": 63.656818181818196}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.0653026347259, "policy_loss": -7.774760211096563e+20, "vf_loss": 304533052.02915454}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67571.5, "diff_num_grad_updates_vs_sampler_policy": 67570.5}}, "num_env_steps_sampled": 10207680, "num_env_steps_trained": 10207680, "num_agent_steps_sampled": 10207680, "num_agent_steps_trained": 10207680}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353905.399540406, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21459714311500036, "mean_inference_ms": 0.36523133372131505, "mean_action_processing_ms": 0.08939894015634645, "mean_env_wait_ms": 0.6912759365501124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034674249514184815, "StateBufferConnector_ms": 0.0026397030762951783, "ViewRequirementAgentConnector_ms": 0.06684703056258384}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353905.399540406, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21459714311500036, "mean_inference_ms": 0.36523133372131505, "mean_action_processing_ms": 0.08939894015634645, "mean_env_wait_ms": 0.6912759365501124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034674249514184815, "StateBufferConnector_ms": 0.0026397030762951783, "ViewRequirementAgentConnector_ms": 0.06684703056258384}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10207680, "num_agent_steps_trained": 10207680, "num_env_steps_sampled": 10207680, "num_env_steps_trained": 10207680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.202469838477, "num_env_steps_trained_throughput_per_sec": 711.202469838477, "timesteps_total": 10207680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10207680, "timers": {"training_iteration_time_ms": 61518.272, "sample_time_ms": 60362.905, "load_time_ms": 16.832, "load_throughput": 2609334.991, "learn_time_ms": 1137.423, "learn_throughput": 38613.613, "synch_weights_time_ms": 0.948}, "counters": {"num_env_steps_sampled": 10207680, "num_env_steps_trained": 10207680, "num_agent_steps_sampled": 10207680, "num_agent_steps_trained": 10207680}, "done": false, "episodes_total": 1423, "training_iteration": 544, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-06-13", "timestamp": 1691096773, "time_this_iter_s": 61.75741481781006, "time_total_s": 16648.209580659866, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6101.397068977356, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 17.50681818181818, "ram_util_percent": 63.53977272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.132589001002, "policy_loss": -7.100021718561789e+20, "vf_loss": 302538871.3994169}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68257.5, "diff_num_grad_updates_vs_sampler_policy": 68256.5}}, "num_env_steps_sampled": 10251600, "num_env_steps_trained": 10251600, "num_agent_steps_sampled": 10251600, "num_agent_steps_trained": 10251600}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353873.1432063635, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21460751864777589, "mean_inference_ms": 0.3652504982804085, "mean_action_processing_ms": 0.08940435197816227, "mean_env_wait_ms": 0.691209718134512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003464937210083008, "StateBufferConnector_ms": 0.002638578414916992, "ViewRequirementAgentConnector_ms": 0.06684756278991699}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1368051.7961812108, "episode_reward_mean": -1353873.1432063635, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1368051.7961812108, -1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21460751864777589, "mean_inference_ms": 0.3652504982804085, "mean_action_processing_ms": 0.08940435197816227, "mean_env_wait_ms": 0.691209718134512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003464937210083008, "StateBufferConnector_ms": 0.002638578414916992, "ViewRequirementAgentConnector_ms": 0.06684756278991699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10251600, "num_agent_steps_trained": 10251600, "num_env_steps_sampled": 10251600, "num_env_steps_trained": 10251600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.8711987109162, "num_env_steps_trained_throughput_per_sec": 714.8711987109162, "timesteps_total": 10251600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10251600, "timers": {"training_iteration_time_ms": 61536.226, "sample_time_ms": 60380.81, "load_time_ms": 16.79, "load_throughput": 2615782.002, "learn_time_ms": 1137.529, "learn_throughput": 38610.008, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 10251600, "num_env_steps_trained": 10251600, "num_agent_steps_sampled": 10251600, "num_agent_steps_trained": 10251600}, "done": false, "episodes_total": 1424, "training_iteration": 545, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-07-15", "timestamp": 1691096835, "time_this_iter_s": 61.44090700149536, "time_total_s": 16709.65048766136, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6162.837975978851, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 17.656321839080462, "ram_util_percent": 63.493103448275846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.2177641843568, "policy_loss": -8.021114902353552e+20, "vf_loss": 302765003.6034985}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68943.5, "diff_num_grad_updates_vs_sampler_policy": 68942.5}}, "num_env_steps_sampled": 10295520, "num_env_steps_trained": 10295520, "num_agent_steps_sampled": 10295520, "num_agent_steps_trained": 10295520}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353705.510409685, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2147636094514143, "mean_inference_ms": 0.365761850912307, "mean_action_processing_ms": 0.08953904287022679, "mean_env_wait_ms": 0.6913561631682945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470182418823242, "StateBufferConnector_ms": 0.0026373863220214844, "ViewRequirementAgentConnector_ms": 0.06685709953308105}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353705.510409685, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1363488.7761809474, -1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2147636094514143, "mean_inference_ms": 0.365761850912307, "mean_action_processing_ms": 0.08953904287022679, "mean_env_wait_ms": 0.6913561631682945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470182418823242, "StateBufferConnector_ms": 0.0026373863220214844, "ViewRequirementAgentConnector_ms": 0.06685709953308105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10295520, "num_agent_steps_trained": 10295520, "num_env_steps_sampled": 10295520, "num_env_steps_trained": 10295520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.4970376487215, "num_env_steps_trained_throughput_per_sec": 713.4970376487215, "timesteps_total": 10295520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10295520, "timers": {"training_iteration_time_ms": 61568.691, "sample_time_ms": 60414.467, "load_time_ms": 16.894, "load_throughput": 2599734.848, "learn_time_ms": 1136.235, "learn_throughput": 38653.976, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 10295520, "num_env_steps_trained": 10295520, "num_agent_steps_sampled": 10295520, "num_agent_steps_trained": 10295520}, "done": false, "episodes_total": 1425, "training_iteration": 546, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-08-16", "timestamp": 1691096896, "time_this_iter_s": 61.55907988548279, "time_total_s": 16771.209567546844, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6224.397055864334, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 18.22758620689655, "ram_util_percent": 63.56781609195403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.259682168766, "policy_loss": -7.72702924854999e+20, "vf_loss": 301748553.3294461}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 69629.5, "diff_num_grad_updates_vs_sampler_policy": 69628.5}}, "num_env_steps_sampled": 10339440, "num_env_steps_trained": 10339440, "num_agent_steps_sampled": 10339440, "num_agent_steps_trained": 10339440}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353560.5774630099, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2148300469859498, "mean_inference_ms": 0.36600865241569863, "mean_action_processing_ms": 0.08960660115533858, "mean_env_wait_ms": 0.6912233831683986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478527069091797, "StateBufferConnector_ms": 0.0026438236236572266, "ViewRequirementAgentConnector_ms": 0.06691408157348633}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353560.5774630099, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1362800.756835128, -1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2148300469859498, "mean_inference_ms": 0.36600865241569863, "mean_action_processing_ms": 0.08960660115533858, "mean_env_wait_ms": 0.6912233831683986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478527069091797, "StateBufferConnector_ms": 0.0026438236236572266, "ViewRequirementAgentConnector_ms": 0.06691408157348633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10339440, "num_agent_steps_trained": 10339440, "num_env_steps_sampled": 10339440, "num_env_steps_trained": 10339440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.735495337718, "num_env_steps_trained_throughput_per_sec": 715.735495337718, "timesteps_total": 10339440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10339440, "timers": {"training_iteration_time_ms": 61555.638, "sample_time_ms": 60400.961, "load_time_ms": 16.913, "load_throughput": 2596861.61, "learn_time_ms": 1136.666, "learn_throughput": 38639.327, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 10339440, "num_env_steps_trained": 10339440, "num_agent_steps_sampled": 10339440, "num_agent_steps_trained": 10339440}, "done": false, "episodes_total": 1426, "training_iteration": 547, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-09-18", "timestamp": 1691096958, "time_this_iter_s": 61.36642599105835, "time_total_s": 16832.575993537903, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6285.7634818553925, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 17.567816091954022, "ram_util_percent": 63.4241379310345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.3444439857417, "policy_loss": -7.082501738428824e+20, "vf_loss": 302803966.10495627}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 70315.5, "diff_num_grad_updates_vs_sampler_policy": 70314.5}}, "num_env_steps_sampled": 10383360, "num_env_steps_trained": 10383360, "num_agent_steps_sampled": 10383360, "num_agent_steps_trained": 10383360}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353446.389611003, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21487846375605407, "mean_inference_ms": 0.3661698585845462, "mean_action_processing_ms": 0.08965197722939912, "mean_env_wait_ms": 0.6910362203079548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003479480743408203, "StateBufferConnector_ms": 0.0026443004608154297, "ViewRequirementAgentConnector_ms": 0.0668785572052002}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353446.389611003, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360855.0297909304, -1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21487846375605407, "mean_inference_ms": 0.3661698585845462, "mean_action_processing_ms": 0.08965197722939912, "mean_env_wait_ms": 0.6910362203079548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003479480743408203, "StateBufferConnector_ms": 0.0026443004608154297, "ViewRequirementAgentConnector_ms": 0.0668785572052002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10383360, "num_agent_steps_trained": 10383360, "num_env_steps_sampled": 10383360, "num_env_steps_trained": 10383360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0935507809837, "num_env_steps_trained_throughput_per_sec": 717.0935507809837, "timesteps_total": 10383360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10383360, "timers": {"training_iteration_time_ms": 61531.559, "sample_time_ms": 60377.009, "load_time_ms": 16.803, "load_throughput": 2613859.391, "learn_time_ms": 1136.639, "learn_throughput": 38640.229, "synch_weights_time_ms": 0.942}, "counters": {"num_env_steps_sampled": 10383360, "num_env_steps_trained": 10383360, "num_agent_steps_sampled": 10383360, "num_agent_steps_trained": 10383360}, "done": false, "episodes_total": 1427, "training_iteration": 548, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-10-19", "timestamp": 1691097019, "time_this_iter_s": 61.25026488304138, "time_total_s": 16893.826258420944, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6347.013746738434, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 17.168604651162788, "ram_util_percent": 63.56395348837209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.4100178087417, "policy_loss": -7.795985475746845e+20, "vf_loss": 304676878.0991254}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71001.5, "diff_num_grad_updates_vs_sampler_policy": 71000.5}}, "num_env_steps_sampled": 10427280, "num_env_steps_trained": 10427280, "num_agent_steps_sampled": 10427280, "num_agent_steps_trained": 10427280}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353392.9460556852, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21491527328077586, "mean_inference_ms": 0.3662846510369267, "mean_action_processing_ms": 0.08968371041137357, "mean_env_wait_ms": 0.6908322871581521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034782886505126953, "StateBufferConnector_ms": 0.0026428699493408203, "ViewRequirementAgentConnector_ms": 0.0668647289276123}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353392.9460556852, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360468.2767770018, -1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21491527328077586, "mean_inference_ms": 0.3662846510369267, "mean_action_processing_ms": 0.08968371041137357, "mean_env_wait_ms": 0.6908322871581521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034782886505126953, "StateBufferConnector_ms": 0.0026428699493408203, "ViewRequirementAgentConnector_ms": 0.0668647289276123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10427280, "num_agent_steps_trained": 10427280, "num_env_steps_sampled": 10427280, "num_env_steps_trained": 10427280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.2237666742232, "num_env_steps_trained_throughput_per_sec": 711.2237666742232, "timesteps_total": 10427280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10427280, "timers": {"training_iteration_time_ms": 61556.404, "sample_time_ms": 60401.673, "load_time_ms": 16.752, "load_throughput": 2621820.558, "learn_time_ms": 1136.876, "learn_throughput": 38632.189, "synch_weights_time_ms": 0.938}, "counters": {"num_env_steps_sampled": 10427280, "num_env_steps_trained": 10427280, "num_agent_steps_sampled": 10427280, "num_agent_steps_trained": 10427280}, "done": false, "episodes_total": 1428, "training_iteration": 549, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-11-21", "timestamp": 1691097081, "time_this_iter_s": 61.75573420524597, "time_total_s": 16955.58199262619, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6408.76948094368, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 17.04318181818182, "ram_util_percent": 63.5534090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.4778195039175, "policy_loss": -7.556356680914198e+20, "vf_loss": 302670310.05247813}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71687.5, "diff_num_grad_updates_vs_sampler_policy": 71686.5}}, "num_env_steps_sampled": 10471200, "num_env_steps_trained": 10471200, "num_agent_steps_sampled": 10471200, "num_agent_steps_trained": 10471200}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353298.1246186998, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21494813065356586, "mean_inference_ms": 0.36637412660143814, "mean_action_processing_ms": 0.08970857068697845, "mean_env_wait_ms": 0.6906213350552615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034766197204589844, "StateBufferConnector_ms": 0.002645730972290039, "ViewRequirementAgentConnector_ms": 0.06690597534179688}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353298.1246186998, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1361247.6190861494, -1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21494813065356586, "mean_inference_ms": 0.36637412660143814, "mean_action_processing_ms": 0.08970857068697845, "mean_env_wait_ms": 0.6906213350552615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034766197204589844, "StateBufferConnector_ms": 0.002645730972290039, "ViewRequirementAgentConnector_ms": 0.06690597534179688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10471200, "num_agent_steps_trained": 10471200, "num_env_steps_sampled": 10471200, "num_env_steps_trained": 10471200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.8692513241976, "num_env_steps_trained_throughput_per_sec": 711.8692513241976, "timesteps_total": 10471200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10471200, "timers": {"training_iteration_time_ms": 61601.149, "sample_time_ms": 60446.56, "load_time_ms": 16.634, "load_throughput": 2640388.485, "learn_time_ms": 1136.853, "learn_throughput": 38632.964, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 10471200, "num_env_steps_trained": 10471200, "num_agent_steps_sampled": 10471200, "num_agent_steps_trained": 10471200}, "done": false, "episodes_total": 1429, "training_iteration": 550, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-12-22", "timestamp": 1691097142, "time_this_iter_s": 61.700316190719604, "time_total_s": 17017.28230881691, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6470.469797134399, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 18.47471264367816, "ram_util_percent": 63.58965517241377}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.5637185677842, "policy_loss": -7.927701624469598e+20, "vf_loss": 302765275.32361513}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 72373.5, "diff_num_grad_updates_vs_sampler_policy": 72372.5}}, "num_env_steps_sampled": 10515120, "num_env_steps_trained": 10515120, "num_agent_steps_sampled": 10515120, "num_agent_steps_trained": 10515120}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353199.4381353315, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2149821913169156, "mean_inference_ms": 0.3664484442411795, "mean_action_processing_ms": 0.08972908841437578, "mean_env_wait_ms": 0.690416555784982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477811813354492, "StateBufferConnector_ms": 0.00264739990234375, "ViewRequirementAgentConnector_ms": 0.06690549850463867}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353199.4381353315, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1358547.4120187873, -1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2149821913169156, "mean_inference_ms": 0.3664484442411795, "mean_action_processing_ms": 0.08972908841437578, "mean_env_wait_ms": 0.690416555784982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477811813354492, "StateBufferConnector_ms": 0.00264739990234375, "ViewRequirementAgentConnector_ms": 0.06690549850463867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10515120, "num_agent_steps_trained": 10515120, "num_env_steps_sampled": 10515120, "num_env_steps_trained": 10515120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.5523927096061, "num_env_steps_trained_throughput_per_sec": 711.5523927096061, "timesteps_total": 10515120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10515120, "timers": {"training_iteration_time_ms": 61629.4, "sample_time_ms": 60474.405, "load_time_ms": 16.776, "load_throughput": 2617990.178, "learn_time_ms": 1137.124, "learn_throughput": 38623.756, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 10515120, "num_env_steps_trained": 10515120, "num_agent_steps_sampled": 10515120, "num_agent_steps_trained": 10515120}, "done": false, "episodes_total": 1430, "training_iteration": 551, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-13-24", "timestamp": 1691097204, "time_this_iter_s": 61.72739791870117, "time_total_s": 17079.00970673561, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6532.197195053101, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.48181818181818, "ram_util_percent": 63.65909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.982695810564666e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.6045886337236, "policy_loss": -7.628141244071663e+20, "vf_loss": 301870572.83381927}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73059.5, "diff_num_grad_updates_vs_sampler_policy": 73058.5}}, "num_env_steps_sampled": 10559040, "num_env_steps_trained": 10559040, "num_agent_steps_sampled": 10559040, "num_agent_steps_trained": 10559040}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353105.3163851479, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21501357630575194, "mean_inference_ms": 0.3665110844619508, "mean_action_processing_ms": 0.08974621467133398, "mean_env_wait_ms": 0.6902068943984686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478527069091797, "StateBufferConnector_ms": 0.0026483535766601562, "ViewRequirementAgentConnector_ms": 0.06689691543579102}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353105.3163851479, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360169.6632447583, -1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21501357630575194, "mean_inference_ms": 0.3665110844619508, "mean_action_processing_ms": 0.08974621467133398, "mean_env_wait_ms": 0.6902068943984686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003478527069091797, "StateBufferConnector_ms": 0.0026483535766601562, "ViewRequirementAgentConnector_ms": 0.06689691543579102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10559040, "num_agent_steps_trained": 10559040, "num_env_steps_sampled": 10559040, "num_env_steps_trained": 10559040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.7358992580931, "num_env_steps_trained_throughput_per_sec": 713.7358992580931, "timesteps_total": 10559040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10559040, "timers": {"training_iteration_time_ms": 61618.786, "sample_time_ms": 60460.396, "load_time_ms": 16.921, "load_throughput": 2595665.081, "learn_time_ms": 1140.386, "learn_throughput": 38513.271, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 10559040, "num_env_steps_trained": 10559040, "num_agent_steps_sampled": 10559040, "num_agent_steps_trained": 10559040}, "done": false, "episodes_total": 1431, "training_iteration": 552, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-14-26", "timestamp": 1691097266, "time_this_iter_s": 61.53794813156128, "time_total_s": 17140.547654867172, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6593.735143184662, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 17.942528735632187, "ram_util_percent": 63.667816091954045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.482695810564665e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.6872923381127, "policy_loss": -7.988238274335348e+20, "vf_loss": 302946221.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73745.5, "diff_num_grad_updates_vs_sampler_policy": 73744.5}}, "num_env_steps_sampled": 10602960, "num_env_steps_trained": 10602960, "num_agent_steps_sampled": 10602960, "num_agent_steps_trained": 10602960}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353020.8835598219, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21504100650792424, "mean_inference_ms": 0.36656352596793856, "mean_action_processing_ms": 0.08976084724125459, "mean_env_wait_ms": 0.6899975500192126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480672836303711, "StateBufferConnector_ms": 0.002647876739501953, "ViewRequirementAgentConnector_ms": 0.06690144538879395}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1363567.427962754, "episode_reward_mean": -1353020.8835598219, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1363567.427962754, -1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21504100650792424, "mean_inference_ms": 0.36656352596793856, "mean_action_processing_ms": 0.08976084724125459, "mean_env_wait_ms": 0.6899975500192126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480672836303711, "StateBufferConnector_ms": 0.002647876739501953, "ViewRequirementAgentConnector_ms": 0.06690144538879395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10602960, "num_agent_steps_trained": 10602960, "num_env_steps_sampled": 10602960, "num_env_steps_trained": 10602960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.7779823357166, "num_env_steps_trained_throughput_per_sec": 713.7779823357166, "timesteps_total": 10602960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10602960, "timers": {"training_iteration_time_ms": 61559.94, "sample_time_ms": 60400.459, "load_time_ms": 16.755, "load_throughput": 2621275.872, "learn_time_ms": 1141.638, "learn_throughput": 38471.031, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 10602960, "num_env_steps_trained": 10602960, "num_agent_steps_sampled": 10602960, "num_agent_steps_trained": 10602960}, "done": false, "episodes_total": 1432, "training_iteration": 553, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-15-27", "timestamp": 1691097327, "time_this_iter_s": 61.534908294677734, "time_total_s": 17202.08256316185, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6655.27005147934, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 17.775862068965512, "ram_util_percent": 63.657471264367814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.982695810564662e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.7618212463558, "policy_loss": -7.986959727012522e+20, "vf_loss": 304792759.7376093}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 74431.5, "diff_num_grad_updates_vs_sampler_policy": 74430.5}}, "num_env_steps_sampled": 10646880, "num_env_steps_trained": 10646880, "num_agent_steps_sampled": 10646880, "num_agent_steps_trained": 10646880}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352944.269938142, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21506711338504544, "mean_inference_ms": 0.36660763781063727, "mean_action_processing_ms": 0.08977325124303519, "mean_env_wait_ms": 0.6897838035901255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003475189208984375, "StateBufferConnector_ms": 0.0026502609252929688, "ViewRequirementAgentConnector_ms": 0.0668647289276123}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352944.269938142, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1357964.8344514098, -1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21506711338504544, "mean_inference_ms": 0.36660763781063727, "mean_action_processing_ms": 0.08977325124303519, "mean_env_wait_ms": 0.6897838035901255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003475189208984375, "StateBufferConnector_ms": 0.0026502609252929688, "ViewRequirementAgentConnector_ms": 0.0668647289276123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10646880, "num_agent_steps_trained": 10646880, "num_env_steps_sampled": 10646880, "num_env_steps_trained": 10646880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.3276931256981, "num_env_steps_trained_throughput_per_sec": 712.3276931256981, "timesteps_total": 10646880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10646880, "timers": {"training_iteration_time_ms": 61550.185, "sample_time_ms": 60390.296, "load_time_ms": 16.922, "load_throughput": 2595485.88, "learn_time_ms": 1141.864, "learn_throughput": 38463.414, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 10646880, "num_env_steps_trained": 10646880, "num_agent_steps_sampled": 10646880, "num_agent_steps_trained": 10646880}, "done": false, "episodes_total": 1433, "training_iteration": 554, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-16-29", "timestamp": 1691097389, "time_this_iter_s": 61.6600501537323, "time_total_s": 17263.742613315582, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6716.930101633072, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 17.250574712643676, "ram_util_percent": 63.63793103448275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.482695810564663e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.7829105833182, "policy_loss": -7.739582801775059e+20, "vf_loss": 304297763.02623904}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75117.5, "diff_num_grad_updates_vs_sampler_policy": 75116.5}}, "num_env_steps_sampled": 10690800, "num_env_steps_trained": 10690800, "num_agent_steps_sampled": 10690800, "num_agent_steps_trained": 10690800}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352909.7016045311, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21509203898298082, "mean_inference_ms": 0.36664652253617286, "mean_action_processing_ms": 0.08978429981388636, "mean_env_wait_ms": 0.689575823105886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473520278930664, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.06686639785766602}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352909.7016045311, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1359536.7091955482, -1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21509203898298082, "mean_inference_ms": 0.36664652253617286, "mean_action_processing_ms": 0.08978429981388636, "mean_env_wait_ms": 0.689575823105886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473520278930664, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.06686639785766602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10690800, "num_agent_steps_trained": 10690800, "num_env_steps_sampled": 10690800, "num_env_steps_trained": 10690800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.190726828931, "num_env_steps_trained_throughput_per_sec": 714.190726828931, "timesteps_total": 10690800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10690800, "timers": {"training_iteration_time_ms": 61556.039, "sample_time_ms": 60395.231, "load_time_ms": 16.944, "load_throughput": 2592114.929, "learn_time_ms": 1142.761, "learn_throughput": 38433.222, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 10690800, "num_env_steps_trained": 10690800, "num_agent_steps_sampled": 10690800, "num_agent_steps_trained": 10690800}, "done": false, "episodes_total": 1434, "training_iteration": 555, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-17-30", "timestamp": 1691097450, "time_this_iter_s": 61.49927520751953, "time_total_s": 17325.2418885231, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6778.429376840591, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 17.406896551724138, "ram_util_percent": 63.658620689655166}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.982695810564663e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.8692947254237, "policy_loss": -8.186379381204509e+20, "vf_loss": 303562478.728863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75803.5, "diff_num_grad_updates_vs_sampler_policy": 75802.5}}, "num_env_steps_sampled": 10734720, "num_env_steps_trained": 10734720, "num_agent_steps_sampled": 10734720, "num_agent_steps_trained": 10734720}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352845.6692050067, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21511580175835576, "mean_inference_ms": 0.3666816850340836, "mean_action_processing_ms": 0.08979415149522739, "mean_env_wait_ms": 0.6893704907861662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347137451171875, "StateBufferConnector_ms": 0.0026514530181884766, "ViewRequirementAgentConnector_ms": 0.06688761711120605}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352845.6692050067, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1357016.0235657156, -1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21511580175835576, "mean_inference_ms": 0.3666816850340836, "mean_action_processing_ms": 0.08979415149522739, "mean_env_wait_ms": 0.6893704907861662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347137451171875, "StateBufferConnector_ms": 0.0026514530181884766, "ViewRequirementAgentConnector_ms": 0.06688761711120605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10734720, "num_agent_steps_trained": 10734720, "num_env_steps_sampled": 10734720, "num_env_steps_trained": 10734720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.9964210154947, "num_env_steps_trained_throughput_per_sec": 710.9964210154947, "timesteps_total": 10734720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10734720, "timers": {"training_iteration_time_ms": 61577.689, "sample_time_ms": 60417.318, "load_time_ms": 16.866, "load_throughput": 2604041.923, "learn_time_ms": 1142.387, "learn_throughput": 38445.822, "synch_weights_time_ms": 0.954}, "counters": {"num_env_steps_sampled": 10734720, "num_env_steps_trained": 10734720, "num_agent_steps_sampled": 10734720, "num_agent_steps_trained": 10734720}, "done": false, "episodes_total": 1435, "training_iteration": 556, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-18-32", "timestamp": 1691097512, "time_this_iter_s": 61.775554895401, "time_total_s": 17387.017443418503, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6840.204931735992, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 17.832954545454548, "ram_util_percent": 63.69204545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.482695810564664e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.9005077128509, "policy_loss": -7.840285646508585e+20, "vf_loss": 304631278.0408163}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 76489.5, "diff_num_grad_updates_vs_sampler_policy": 76488.5}}, "num_env_steps_sampled": 10778640, "num_env_steps_trained": 10778640, "num_agent_steps_sampled": 10778640, "num_agent_steps_trained": 10778640}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352829.5338270455, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21513850457233694, "mean_inference_ms": 0.3667127698473851, "mean_action_processing_ms": 0.0898029307691961, "mean_env_wait_ms": 0.6891684657514581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003475666046142578, "StateBufferConnector_ms": 0.002656698226928711, "ViewRequirementAgentConnector_ms": 0.06695961952209473}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352829.5338270455, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1358593.2407569496, -1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21513850457233694, "mean_inference_ms": 0.3667127698473851, "mean_action_processing_ms": 0.0898029307691961, "mean_env_wait_ms": 0.6891684657514581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003475666046142578, "StateBufferConnector_ms": 0.002656698226928711, "ViewRequirementAgentConnector_ms": 0.06695961952209473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10778640, "num_agent_steps_trained": 10778640, "num_env_steps_sampled": 10778640, "num_env_steps_trained": 10778640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.9271720107639, "num_env_steps_trained_throughput_per_sec": 714.9271720107639, "timesteps_total": 10778640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10778640, "timers": {"training_iteration_time_ms": 61584.627, "sample_time_ms": 60423.763, "load_time_ms": 16.847, "load_throughput": 2606949.527, "learn_time_ms": 1142.892, "learn_throughput": 38428.829, "synch_weights_time_ms": 0.96}, "counters": {"num_env_steps_sampled": 10778640, "num_env_steps_trained": 10778640, "num_agent_steps_sampled": 10778640, "num_agent_steps_trained": 10778640}, "done": false, "episodes_total": 1436, "training_iteration": 557, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-19-34", "timestamp": 1691097574, "time_this_iter_s": 61.43571400642395, "time_total_s": 17448.453157424927, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6901.640645742416, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 17.775862068965516, "ram_util_percent": 63.656321839080476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.982695810564663e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.9411626432102, "policy_loss": -8.166217916626201e+20, "vf_loss": 303497519.79591835}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77175.5, "diff_num_grad_updates_vs_sampler_policy": 77174.5}}, "num_env_steps_sampled": 10822560, "num_env_steps_trained": 10822560, "num_agent_steps_sampled": 10822560, "num_agent_steps_trained": 10822560}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352771.3550522253, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2151614019368258, "mean_inference_ms": 0.36674088029678165, "mean_action_processing_ms": 0.08981087094639703, "mean_env_wait_ms": 0.6889753274010653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034787654876708984, "StateBufferConnector_ms": 0.002653837203979492, "ViewRequirementAgentConnector_ms": 0.06697797775268555}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1360330.5309402717, "episode_reward_mean": -1352771.3550522253, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360330.5309402717, -1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2151614019368258, "mean_inference_ms": 0.36674088029678165, "mean_action_processing_ms": 0.08981087094639703, "mean_env_wait_ms": 0.6889753274010653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034787654876708984, "StateBufferConnector_ms": 0.002653837203979492, "ViewRequirementAgentConnector_ms": 0.06697797775268555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10822560, "num_agent_steps_trained": 10822560, "num_env_steps_sampled": 10822560, "num_env_steps_trained": 10822560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.4005100128584, "num_env_steps_trained_throughput_per_sec": 713.4005100128584, "timesteps_total": 10822560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10822560, "timers": {"training_iteration_time_ms": 61616.332, "sample_time_ms": 60455.569, "load_time_ms": 16.888, "load_throughput": 2600667.083, "learn_time_ms": 1142.762, "learn_throughput": 38433.198, "synch_weights_time_ms": 0.95}, "counters": {"num_env_steps_sampled": 10822560, "num_env_steps_trained": 10822560, "num_agent_steps_sampled": 10822560, "num_agent_steps_trained": 10822560}, "done": false, "episodes_total": 1437, "training_iteration": 558, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-20-35", "timestamp": 1691097635, "time_this_iter_s": 61.567203760147095, "time_total_s": 17510.020361185074, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6963.2078495025635, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 17.372413793103448, "ram_util_percent": 63.667816091954016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.482695810564664e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.9944737381559, "policy_loss": -8.178186128402286e+20, "vf_loss": 303295691.6676385}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77861.5, "diff_num_grad_updates_vs_sampler_policy": 77860.5}}, "num_env_steps_sampled": 10866480, "num_env_steps_trained": 10866480, "num_agent_steps_sampled": 10866480, "num_agent_steps_trained": 10866480}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1358769.434978041, "episode_reward_mean": -1352691.7318410855, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21518385155112046, "mean_inference_ms": 0.3667671508534841, "mean_action_processing_ms": 0.08981840142000795, "mean_env_wait_ms": 0.6887864192328478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034799575805664062, "StateBufferConnector_ms": 0.002660036087036133, "ViewRequirementAgentConnector_ms": 0.06702232360839844}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1358769.434978041, "episode_reward_mean": -1352691.7318410855, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1357747.7698209302, -1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21518385155112046, "mean_inference_ms": 0.3667671508534841, "mean_action_processing_ms": 0.08981840142000795, "mean_env_wait_ms": 0.6887864192328478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034799575805664062, "StateBufferConnector_ms": 0.002660036087036133, "ViewRequirementAgentConnector_ms": 0.06702232360839844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10866480, "num_agent_steps_trained": 10866480, "num_env_steps_sampled": 10866480, "num_env_steps_trained": 10866480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.0842161221144, "num_env_steps_trained_throughput_per_sec": 706.0842161221144, "timesteps_total": 10866480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10866480, "timers": {"training_iteration_time_ms": 61661.282, "sample_time_ms": 60501.239, "load_time_ms": 17.082, "load_throughput": 2571116.77, "learn_time_ms": 1141.854, "learn_throughput": 38463.754, "synch_weights_time_ms": 0.942}, "counters": {"num_env_steps_sampled": 10866480, "num_env_steps_trained": 10866480, "num_agent_steps_sampled": 10866480, "num_agent_steps_trained": 10866480}, "done": false, "episodes_total": 1438, "training_iteration": 559, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-21-38", "timestamp": 1691097698, "time_this_iter_s": 62.205246925354004, "time_total_s": 17572.225608110428, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7025.4130964279175, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 18.71590909090909, "ram_util_percent": 63.74318181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.9826958105646634e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.0335869524986, "policy_loss": -7.94639633872066e+20, "vf_loss": 302452046.7463557}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 78547.5, "diff_num_grad_updates_vs_sampler_policy": 78546.5}}, "num_env_steps_sampled": 10910400, "num_env_steps_trained": 10910400, "num_agent_steps_sampled": 10910400, "num_agent_steps_trained": 10910400}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1358769.434978041, "episode_reward_mean": -1352618.902953685, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21520616556641006, "mean_inference_ms": 0.36679101236710315, "mean_action_processing_ms": 0.08982525984161718, "mean_env_wait_ms": 0.6885994649785881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482341766357422, "StateBufferConnector_ms": 0.0026628971099853516, "ViewRequirementAgentConnector_ms": 0.06703996658325195}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1358769.434978041, "episode_reward_mean": -1352618.902953685, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1357394.0397767965, -1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21520616556641006, "mean_inference_ms": 0.36679101236710315, "mean_action_processing_ms": 0.08982525984161718, "mean_env_wait_ms": 0.6885994649785881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482341766357422, "StateBufferConnector_ms": 0.0026628971099853516, "ViewRequirementAgentConnector_ms": 0.06703996658325195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10910400, "num_agent_steps_trained": 10910400, "num_env_steps_sampled": 10910400, "num_env_steps_trained": 10910400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.0979698854625, "num_env_steps_trained_throughput_per_sec": 714.0979698854625, "timesteps_total": 10910400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10910400, "timers": {"training_iteration_time_ms": 61642.026, "sample_time_ms": 60481.51, "load_time_ms": 17.04, "load_throughput": 2577444.599, "learn_time_ms": 1142.372, "learn_throughput": 38446.314, "synch_weights_time_ms": 0.94}, "counters": {"num_env_steps_sampled": 10910400, "num_env_steps_trained": 10910400, "num_agent_steps_sampled": 10910400, "num_agent_steps_trained": 10910400}, "done": false, "episodes_total": 1439, "training_iteration": 560, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-22-39", "timestamp": 1691097759, "time_this_iter_s": 61.50727987289429, "time_total_s": 17633.732887983322, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7086.920376300812, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 17.34367816091954, "ram_util_percent": 63.63793103448277}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.482695810564662e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.0700503869236, "policy_loss": -7.161008103529484e+20, "vf_loss": 301811852.24489796}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79233.5, "diff_num_grad_updates_vs_sampler_policy": 79232.5}}, "num_env_steps_sampled": 10954320, "num_env_steps_trained": 10954320, "num_agent_steps_sampled": 10954320, "num_agent_steps_trained": 10954320}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1358769.434978041, "episode_reward_mean": -1352537.1641984198, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21522678072524976, "mean_inference_ms": 0.36681271637344814, "mean_action_processing_ms": 0.08983163458895863, "mean_env_wait_ms": 0.6884154815186112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034842491149902344, "StateBufferConnector_ms": 0.0026612281799316406, "ViewRequirementAgentConnector_ms": 0.06706476211547852}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1358769.434978041, "episode_reward_mean": -1352537.1641984198, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1358769.434978041, -1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21522678072524976, "mean_inference_ms": 0.36681271637344814, "mean_action_processing_ms": 0.08983163458895863, "mean_env_wait_ms": 0.6884154815186112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034842491149902344, "StateBufferConnector_ms": 0.0026612281799316406, "ViewRequirementAgentConnector_ms": 0.06706476211547852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10954320, "num_agent_steps_trained": 10954320, "num_env_steps_sampled": 10954320, "num_env_steps_trained": 10954320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.2553683944705, "num_env_steps_trained_throughput_per_sec": 717.2553683944705, "timesteps_total": 10954320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10954320, "timers": {"training_iteration_time_ms": 61592.948, "sample_time_ms": 60426.037, "load_time_ms": 16.922, "load_throughput": 2595398.117, "learn_time_ms": 1148.883, "learn_throughput": 38228.426, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 10954320, "num_env_steps_trained": 10954320, "num_agent_steps_sampled": 10954320, "num_agent_steps_trained": 10954320}, "done": false, "episodes_total": 1440, "training_iteration": 561, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-23-40", "timestamp": 1691097820, "time_this_iter_s": 61.23696684837341, "time_total_s": 17694.969854831696, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7148.157343149185, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 17.095402298850576, "ram_util_percent": 63.6735632183908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.0958931703262, "policy_loss": -8.196607710397244e+20, "vf_loss": 303951741.17784256}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79919.5, "diff_num_grad_updates_vs_sampler_policy": 79918.5}}, "num_env_steps_sampled": 10998240, "num_env_steps_trained": 10998240, "num_agent_steps_sampled": 10998240, "num_agent_steps_trained": 10998240}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357987.46597719, "episode_reward_mean": -1352487.96640488, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2152462660713413, "mean_inference_ms": 0.3668325611633293, "mean_action_processing_ms": 0.08983752544810944, "mean_env_wait_ms": 0.6882291793536587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034782886505126953, "StateBufferConnector_ms": 0.002655506134033203, "ViewRequirementAgentConnector_ms": 0.06703352928161621}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357987.46597719, "episode_reward_mean": -1352487.96640488, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1356448.335173681, -1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2152462660713413, "mean_inference_ms": 0.3668325611633293, "mean_action_processing_ms": 0.08983752544810944, "mean_env_wait_ms": 0.6882291793536587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034782886505126953, "StateBufferConnector_ms": 0.002655506134033203, "ViewRequirementAgentConnector_ms": 0.06703352928161621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10998240, "num_agent_steps_trained": 10998240, "num_env_steps_sampled": 10998240, "num_env_steps_trained": 10998240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.933293040883, "num_env_steps_trained_throughput_per_sec": 711.933293040883, "timesteps_total": 10998240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10998240, "timers": {"training_iteration_time_ms": 61608.529, "sample_time_ms": 60452.144, "load_time_ms": 16.814, "load_throughput": 2612035.898, "learn_time_ms": 1138.462, "learn_throughput": 38578.377, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 10998240, "num_env_steps_trained": 10998240, "num_agent_steps_sampled": 10998240, "num_agent_steps_trained": 10998240}, "done": false, "episodes_total": 1441, "training_iteration": 562, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-24-42", "timestamp": 1691097882, "time_this_iter_s": 61.694522857666016, "time_total_s": 17756.66437768936, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7209.851866006851, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 17.833333333333332, "ram_util_percent": 63.665517241379305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.126350425075, "policy_loss": -7.99648623987498e+20, "vf_loss": 302559549.5102041}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80605.5, "diff_num_grad_updates_vs_sampler_policy": 80604.5}}, "num_env_steps_sampled": 11042160, "num_env_steps_trained": 11042160, "num_agent_steps_sampled": 11042160, "num_agent_steps_trained": 11042160}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357987.46597719, "episode_reward_mean": -1352430.3320096368, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21526544186235902, "mean_inference_ms": 0.3668510513807124, "mean_action_processing_ms": 0.08984304254741556, "mean_env_wait_ms": 0.688045053522171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.002656698226928711, "ViewRequirementAgentConnector_ms": 0.06705784797668457}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357987.46597719, "episode_reward_mean": -1352430.3320096368, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1357987.46597719, -1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21526544186235902, "mean_inference_ms": 0.3668510513807124, "mean_action_processing_ms": 0.08984304254741556, "mean_env_wait_ms": 0.688045053522171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.002656698226928711, "ViewRequirementAgentConnector_ms": 0.06705784797668457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11042160, "num_agent_steps_trained": 11042160, "num_env_steps_sampled": 11042160, "num_env_steps_trained": 11042160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.985807260461, "num_env_steps_trained_throughput_per_sec": 713.985807260461, "timesteps_total": 11042160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11042160, "timers": {"training_iteration_time_ms": 61606.738, "sample_time_ms": 60450.94, "load_time_ms": 17.117, "load_throughput": 2565870.244, "learn_time_ms": 1137.591, "learn_throughput": 38607.913, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 11042160, "num_env_steps_trained": 11042160, "num_agent_steps_sampled": 11042160, "num_agent_steps_trained": 11042160}, "done": false, "episodes_total": 1442, "training_iteration": 563, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-25-44", "timestamp": 1691097944, "time_this_iter_s": 61.516887187957764, "time_total_s": 17818.18126487732, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7271.368753194809, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 17.0896551724138, "ram_util_percent": 63.6655172413793}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.11731722195, "policy_loss": -7.653844704282411e+20, "vf_loss": 302762989.0845481}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81291.5, "diff_num_grad_updates_vs_sampler_policy": 81290.5}}, "num_env_steps_sampled": 11086080, "num_env_steps_trained": 11086080, "num_agent_steps_sampled": 11086080, "num_agent_steps_trained": 11086080}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357765.6211084237, "episode_reward_mean": -1352361.32827059, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21528331468578185, "mean_inference_ms": 0.3668674395254737, "mean_action_processing_ms": 0.08984817863519785, "mean_env_wait_ms": 0.6878699321184336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477811813354492, "StateBufferConnector_ms": 0.0026574134826660156, "ViewRequirementAgentConnector_ms": 0.06706857681274414}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357765.6211084237, "episode_reward_mean": -1352361.32827059, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1357765.6211084237, -1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21528331468578185, "mean_inference_ms": 0.3668674395254737, "mean_action_processing_ms": 0.08984817863519785, "mean_env_wait_ms": 0.6878699321184336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477811813354492, "StateBufferConnector_ms": 0.0026574134826660156, "ViewRequirementAgentConnector_ms": 0.06706857681274414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11086080, "num_agent_steps_trained": 11086080, "num_env_steps_sampled": 11086080, "num_env_steps_trained": 11086080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.9068874471825, "num_env_steps_trained_throughput_per_sec": 718.9068874471825, "timesteps_total": 11086080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11086080, "timers": {"training_iteration_time_ms": 61550.312, "sample_time_ms": 60393.882, "load_time_ms": 16.948, "load_throughput": 2591531.473, "learn_time_ms": 1138.396, "learn_throughput": 38580.616, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 11086080, "num_env_steps_trained": 11086080, "num_agent_steps_sampled": 11086080, "num_agent_steps_trained": 11086080}, "done": false, "episodes_total": 1443, "training_iteration": 564, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-26-45", "timestamp": 1691098005, "time_this_iter_s": 61.095866680145264, "time_total_s": 17879.277131557465, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7332.464619874954, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 17.949425287356327, "ram_util_percent": 63.65862068965517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.2081444743076, "policy_loss": -7.864882745394001e+20, "vf_loss": 302900656.7113703}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81977.5, "diff_num_grad_updates_vs_sampler_policy": 81976.5}}, "num_env_steps_sampled": 11130000, "num_env_steps_trained": 11130000, "num_agent_steps_sampled": 11130000, "num_agent_steps_trained": 11130000}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1356438.3308611184, "episode_reward_mean": -1352299.9517466784, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21529993202960943, "mean_inference_ms": 0.3668824059912245, "mean_action_processing_ms": 0.08985309369256063, "mean_env_wait_ms": 0.6876958945619361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034766197204589844, "StateBufferConnector_ms": 0.0026557445526123047, "ViewRequirementAgentConnector_ms": 0.06706643104553223}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1356438.3308611184, "episode_reward_mean": -1352299.9517466784, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353824.0562198034, -1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21529993202960943, "mean_inference_ms": 0.3668824059912245, "mean_action_processing_ms": 0.08985309369256063, "mean_env_wait_ms": 0.6876958945619361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034766197204589844, "StateBufferConnector_ms": 0.0026557445526123047, "ViewRequirementAgentConnector_ms": 0.06706643104553223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11130000, "num_agent_steps_trained": 11130000, "num_env_steps_sampled": 11130000, "num_env_steps_trained": 11130000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.0889256813942, "num_env_steps_trained_throughput_per_sec": 713.0889256813942, "timesteps_total": 11130000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11130000, "timers": {"training_iteration_time_ms": 61559.814, "sample_time_ms": 60403.969, "load_time_ms": 16.998, "load_throughput": 2583879.76, "learn_time_ms": 1137.747, "learn_throughput": 38602.612, "synch_weights_time_ms": 0.937}, "counters": {"num_env_steps_sampled": 11130000, "num_env_steps_trained": 11130000, "num_agent_steps_sampled": 11130000, "num_agent_steps_trained": 11130000}, "done": false, "episodes_total": 1444, "training_iteration": 565, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-27-46", "timestamp": 1691098066, "time_this_iter_s": 61.594263792037964, "time_total_s": 17940.871395349503, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7394.058883666992, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 17.308045977011492, "ram_util_percent": 63.47931034482758}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.2187174360536, "policy_loss": -7.861776658537502e+20, "vf_loss": 302428963.5626822}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 82663.5, "diff_num_grad_updates_vs_sampler_policy": 82662.5}}, "num_env_steps_sampled": 11173920, "num_env_steps_trained": 11173920, "num_agent_steps_sampled": 11173920, "num_agent_steps_trained": 11173920}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1356438.3308611184, "episode_reward_mean": -1352266.0977591497, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21531546712530905, "mean_inference_ms": 0.36689595412159276, "mean_action_processing_ms": 0.08985751706742247, "mean_env_wait_ms": 0.6875270994796164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477334976196289, "StateBufferConnector_ms": 0.0026509761810302734, "ViewRequirementAgentConnector_ms": 0.06703853607177734}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1356438.3308611184, "episode_reward_mean": -1352266.0977591497, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351658.8105779118, -1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21531546712530905, "mean_inference_ms": 0.36689595412159276, "mean_action_processing_ms": 0.08985751706742247, "mean_env_wait_ms": 0.6875270994796164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477334976196289, "StateBufferConnector_ms": 0.0026509761810302734, "ViewRequirementAgentConnector_ms": 0.06703853607177734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11173920, "num_agent_steps_trained": 11173920, "num_env_steps_sampled": 11173920, "num_env_steps_trained": 11173920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.6511894938126, "num_env_steps_trained_throughput_per_sec": 712.6511894938126, "timesteps_total": 11173920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11173920, "timers": {"training_iteration_time_ms": 61545.47, "sample_time_ms": 60389.356, "load_time_ms": 16.962, "load_throughput": 2589382.245, "learn_time_ms": 1138.064, "learn_throughput": 38591.841, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 11173920, "num_env_steps_trained": 11173920, "num_agent_steps_sampled": 11173920, "num_agent_steps_trained": 11173920}, "done": false, "episodes_total": 1445, "training_iteration": 566, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-28-48", "timestamp": 1691098128, "time_this_iter_s": 61.63214373588562, "time_total_s": 18002.50353908539, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7455.691027402878, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 17.252873563218387, "ram_util_percent": 63.55977011494252}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.2504391684129, "policy_loss": -7.862636422662474e+20, "vf_loss": 305484723.32361513}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83349.5, "diff_num_grad_updates_vs_sampler_policy": 83348.5}}, "num_env_steps_sampled": 11217840, "num_env_steps_trained": 11217840, "num_agent_steps_sampled": 11217840, "num_agent_steps_trained": 11217840}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352323.1069156975, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21532962267938213, "mean_inference_ms": 0.3669081230664842, "mean_action_processing_ms": 0.08986165167072616, "mean_env_wait_ms": 0.6873642176889294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034792423248291016, "StateBufferConnector_ms": 0.0026552677154541016, "ViewRequirementAgentConnector_ms": 0.06705617904663086}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352323.1069156975, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352279.3752761849, -1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21532962267938213, "mean_inference_ms": 0.3669081230664842, "mean_action_processing_ms": 0.08986165167072616, "mean_env_wait_ms": 0.6873642176889294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034792423248291016, "StateBufferConnector_ms": 0.0026552677154541016, "ViewRequirementAgentConnector_ms": 0.06705617904663086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11217840, "num_agent_steps_trained": 11217840, "num_env_steps_sampled": 11217840, "num_env_steps_trained": 11217840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.7090928147956, "num_env_steps_trained_throughput_per_sec": 716.7090928147956, "timesteps_total": 11217840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11217840, "timers": {"training_iteration_time_ms": 61530.196, "sample_time_ms": 60372.7, "load_time_ms": 17.054, "load_throughput": 2575379.87, "learn_time_ms": 1139.365, "learn_throughput": 38547.779, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 11217840, "num_env_steps_trained": 11217840, "num_agent_steps_sampled": 11217840, "num_agent_steps_trained": 11217840}, "done": false, "episodes_total": 1446, "training_iteration": 567, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-29-49", "timestamp": 1691098189, "time_this_iter_s": 61.28337621688843, "time_total_s": 18063.786915302277, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7516.974403619766, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 17.466666666666665, "ram_util_percent": 63.5977011494253}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.2818662237496, "policy_loss": -8.237710823357714e+20, "vf_loss": 302291424.81632656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84035.5, "diff_num_grad_updates_vs_sampler_policy": 84034.5}}, "num_env_steps_sampled": 11261760, "num_env_steps_trained": 11261760, "num_agent_steps_sampled": 11261760, "num_agent_steps_trained": 11261760}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352302.7549583234, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2153430906649102, "mean_inference_ms": 0.3669194726654695, "mean_action_processing_ms": 0.08986555637540335, "mean_env_wait_ms": 0.6872044217144704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003481626510620117, "StateBufferConnector_ms": 0.0026564598083496094, "ViewRequirementAgentConnector_ms": 0.06704568862915039}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352302.7549583234, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353748.7193548644, -1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2153430906649102, "mean_inference_ms": 0.3669194726654695, "mean_action_processing_ms": 0.08986555637540335, "mean_env_wait_ms": 0.6872044217144704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003481626510620117, "StateBufferConnector_ms": 0.0026564598083496094, "ViewRequirementAgentConnector_ms": 0.06704568862915039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11261760, "num_agent_steps_trained": 11261760, "num_env_steps_sampled": 11261760, "num_env_steps_trained": 11261760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.0455492800742, "num_env_steps_trained_throughput_per_sec": 712.0455492800742, "timesteps_total": 11261760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11261760, "timers": {"training_iteration_time_ms": 61541.911, "sample_time_ms": 60382.688, "load_time_ms": 17.045, "load_throughput": 2576737.967, "learn_time_ms": 1141.103, "learn_throughput": 38489.063, "synch_weights_time_ms": 0.912}, "counters": {"num_env_steps_sampled": 11261760, "num_env_steps_trained": 11261760, "num_agent_steps_sampled": 11261760, "num_agent_steps_trained": 11261760}, "done": false, "episodes_total": 1447, "training_iteration": 568, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-30-51", "timestamp": 1691098251, "time_this_iter_s": 61.68448185920715, "time_total_s": 18125.471397161484, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7578.658885478973, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 17.70459770114942, "ram_util_percent": 63.63793103448274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.2991019824503, "policy_loss": -7.933091530346061e+20, "vf_loss": 301579481.18367344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84721.5, "diff_num_grad_updates_vs_sampler_policy": 84720.5}}, "num_env_steps_sampled": 11305680, "num_env_steps_trained": 11305680, "num_agent_steps_sampled": 11305680, "num_agent_steps_trained": 11305680}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352250.6246651616, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21535541671758263, "mean_inference_ms": 0.3669302272209902, "mean_action_processing_ms": 0.0898693099880564, "mean_env_wait_ms": 0.6870504270940195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003483295440673828, "StateBufferConnector_ms": 0.0026595592498779297, "ViewRequirementAgentConnector_ms": 0.06703019142150879}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352250.6246651616, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353832.9318982863, -1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21535541671758263, "mean_inference_ms": 0.3669302272209902, "mean_action_processing_ms": 0.0898693099880564, "mean_env_wait_ms": 0.6870504270940195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003483295440673828, "StateBufferConnector_ms": 0.0026595592498779297, "ViewRequirementAgentConnector_ms": 0.06703019142150879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11305680, "num_agent_steps_trained": 11305680, "num_env_steps_sampled": 11305680, "num_env_steps_trained": 11305680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.2616452208133, "num_env_steps_trained_throughput_per_sec": 714.2616452208133, "timesteps_total": 11305680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11305680, "timers": {"training_iteration_time_ms": 61470.697, "sample_time_ms": 60308.831, "load_time_ms": 16.903, "load_throughput": 2598414.715, "learn_time_ms": 1143.892, "learn_throughput": 38395.238, "synch_weights_time_ms": 0.91}, "counters": {"num_env_steps_sampled": 11305680, "num_env_steps_trained": 11305680, "num_agent_steps_sampled": 11305680, "num_agent_steps_trained": 11305680}, "done": false, "episodes_total": 1448, "training_iteration": 569, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-31-53", "timestamp": 1691098313, "time_this_iter_s": 61.493261098861694, "time_total_s": 18186.964658260345, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7640.152146577835, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 17.58505747126437, "ram_util_percent": 63.66781609195403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.3556052338624, "policy_loss": -7.841575164278332e+20, "vf_loss": 302714558.98542273}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 85407.5, "diff_num_grad_updates_vs_sampler_policy": 85406.5}}, "num_env_steps_sampled": 11349600, "num_env_steps_trained": 11349600, "num_agent_steps_sampled": 11349600, "num_agent_steps_trained": 11349600}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352222.576004473, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21536760260576687, "mean_inference_ms": 0.36694003221325117, "mean_action_processing_ms": 0.08987289676849863, "mean_env_wait_ms": 0.6869062386506282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034859180450439453, "StateBufferConnector_ms": 0.002657175064086914, "ViewRequirementAgentConnector_ms": 0.06701064109802246}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352222.576004473, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353141.8001389967, -1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21536760260576687, "mean_inference_ms": 0.36694003221325117, "mean_action_processing_ms": 0.08987289676849863, "mean_env_wait_ms": 0.6869062386506282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034859180450439453, "StateBufferConnector_ms": 0.002657175064086914, "ViewRequirementAgentConnector_ms": 0.06701064109802246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11349600, "num_agent_steps_trained": 11349600, "num_env_steps_sampled": 11349600, "num_env_steps_trained": 11349600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.6357157635166, "num_env_steps_trained_throughput_per_sec": 713.6357157635166, "timesteps_total": 11349600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11349600, "timers": {"training_iteration_time_ms": 61474.681, "sample_time_ms": 60310.518, "load_time_ms": 16.899, "load_throughput": 2598916.941, "learn_time_ms": 1146.176, "learn_throughput": 38318.736, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 11349600, "num_env_steps_trained": 11349600, "num_agent_steps_sampled": 11349600, "num_agent_steps_trained": 11349600}, "done": false, "episodes_total": 1449, "training_iteration": 570, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-32-54", "timestamp": 1691098374, "time_this_iter_s": 61.547033071517944, "time_total_s": 18248.511691331863, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7701.699179649353, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 17.354022988505744, "ram_util_percent": 63.593103448275876}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.3732661033164, "policy_loss": -7.895000495368197e+20, "vf_loss": 303267679.2419825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86093.5, "diff_num_grad_updates_vs_sampler_policy": 86092.5}}, "num_env_steps_sampled": 11393520, "num_env_steps_trained": 11393520, "num_agent_steps_sampled": 11393520, "num_agent_steps_trained": 11393520}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352216.105110245, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21537898914705614, "mean_inference_ms": 0.36694942499473254, "mean_action_processing_ms": 0.0898764020536438, "mean_env_wait_ms": 0.686769263405672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034868717193603516, "StateBufferConnector_ms": 0.002653837203979492, "ViewRequirementAgentConnector_ms": 0.06701111793518066}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352216.105110245, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1354367.4605776987, -1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21537898914705614, "mean_inference_ms": 0.36694942499473254, "mean_action_processing_ms": 0.0898764020536438, "mean_env_wait_ms": 0.686769263405672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034868717193603516, "StateBufferConnector_ms": 0.002653837203979492, "ViewRequirementAgentConnector_ms": 0.06701111793518066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11393520, "num_agent_steps_trained": 11393520, "num_env_steps_sampled": 11393520, "num_env_steps_trained": 11393520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.5960493902205, "num_env_steps_trained_throughput_per_sec": 711.5960493902205, "timesteps_total": 11393520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11393520, "timers": {"training_iteration_time_ms": 61523.38, "sample_time_ms": 60357.871, "load_time_ms": 17.013, "load_throughput": 2581493.562, "learn_time_ms": 1147.394, "learn_throughput": 38278.033, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 11393520, "num_env_steps_trained": 11393520, "num_agent_steps_sampled": 11393520, "num_agent_steps_trained": 11393520}, "done": false, "episodes_total": 1450, "training_iteration": 571, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-33-56", "timestamp": 1691098436, "time_this_iter_s": 61.724122762680054, "time_total_s": 18310.235814094543, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7763.423302412033, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 17.445454545454545, "ram_util_percent": 63.588636363636354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.412781651444, "policy_loss": -7.737131953147038e+20, "vf_loss": 304643844.83381927}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86779.5, "diff_num_grad_updates_vs_sampler_policy": 86778.5}}, "num_env_steps_sampled": 11437440, "num_env_steps_trained": 11437440, "num_agent_steps_sampled": 11437440, "num_agent_steps_trained": 11437440}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352226.918028938, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2153910064271021, "mean_inference_ms": 0.3669585084868677, "mean_action_processing_ms": 0.08987977632689308, "mean_env_wait_ms": 0.686640801119778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034880638122558594, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.06699895858764648}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352226.918028938, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1349067.4615794364, -1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2153910064271021, "mean_inference_ms": 0.3669585084868677, "mean_action_processing_ms": 0.08987977632689308, "mean_env_wait_ms": 0.686640801119778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034880638122558594, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.06699895858764648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11437440, "num_agent_steps_trained": 11437440, "num_env_steps_sampled": 11437440, "num_env_steps_trained": 11437440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.2300748677047, "num_env_steps_trained_throughput_per_sec": 709.2300748677047, "timesteps_total": 11437440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11437440, "timers": {"training_iteration_time_ms": 61546.893, "sample_time_ms": 60377.149, "load_time_ms": 16.983, "load_throughput": 2586146.926, "learn_time_ms": 1151.665, "learn_throughput": 38136.088, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 11437440, "num_env_steps_trained": 11437440, "num_agent_steps_sampled": 11437440, "num_agent_steps_trained": 11437440}, "done": false, "episodes_total": 1451, "training_iteration": 572, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-34-58", "timestamp": 1691098498, "time_this_iter_s": 61.92938590049744, "time_total_s": 18372.16519999504, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7825.3526883125305, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 17.745977011494247, "ram_util_percent": 63.62528735632186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.4381729882243, "policy_loss": -8.060835841343888e+20, "vf_loss": 304467861.9591837}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87465.5, "diff_num_grad_updates_vs_sampler_policy": 87464.5}}, "num_env_steps_sampled": 11481360, "num_env_steps_trained": 11481360, "num_agent_steps_sampled": 11481360, "num_agent_steps_trained": 11481360}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352285.4314913072, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154021232183088, "mean_inference_ms": 0.36696712437391343, "mean_action_processing_ms": 0.08988310361162358, "mean_env_wait_ms": 0.6865218975753635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484964370727539, "StateBufferConnector_ms": 0.0026526451110839844, "ViewRequirementAgentConnector_ms": 0.06703615188598633}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352285.4314913072, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350651.4047895025, -1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154021232183088, "mean_inference_ms": 0.36696712437391343, "mean_action_processing_ms": 0.08988310361162358, "mean_env_wait_ms": 0.6865218975753635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003484964370727539, "StateBufferConnector_ms": 0.0026526451110839844, "ViewRequirementAgentConnector_ms": 0.06703615188598633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11481360, "num_agent_steps_trained": 11481360, "num_env_steps_sampled": 11481360, "num_env_steps_trained": 11481360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.9083749326581, "num_env_steps_trained_throughput_per_sec": 716.9083749326581, "timesteps_total": 11481360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11481360, "timers": {"training_iteration_time_ms": 61521.816, "sample_time_ms": 60351.251, "load_time_ms": 16.713, "load_throughput": 2627962.037, "learn_time_ms": 1152.753, "learn_throughput": 38100.104, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 11481360, "num_env_steps_trained": 11481360, "num_agent_steps_sampled": 11481360, "num_agent_steps_trained": 11481360}, "done": false, "episodes_total": 1452, "training_iteration": 573, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-35-59", "timestamp": 1691098559, "time_this_iter_s": 61.2664430141449, "time_total_s": 18433.431643009186, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7886.619131326675, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 17.891954022988504, "ram_util_percent": 63.58275862068967}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.4567600617256, "policy_loss": -8.381804330648059e+20, "vf_loss": 304071638.6180758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88151.5, "diff_num_grad_updates_vs_sampler_policy": 88150.5}}, "num_env_steps_sampled": 11525280, "num_env_steps_trained": 11525280, "num_agent_steps_sampled": 11525280, "num_agent_steps_trained": 11525280}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352320.0540321653, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21541240748163207, "mean_inference_ms": 0.36697515401208186, "mean_action_processing_ms": 0.08988634755142817, "mean_env_wait_ms": 0.6864122335885711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482818603515625, "StateBufferConnector_ms": 0.0026521682739257812, "ViewRequirementAgentConnector_ms": 0.06698155403137207}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352320.0540321653, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1349892.2173506333, -1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21541240748163207, "mean_inference_ms": 0.36697515401208186, "mean_action_processing_ms": 0.08988634755142817, "mean_env_wait_ms": 0.6864122335885711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482818603515625, "StateBufferConnector_ms": 0.0026521682739257812, "ViewRequirementAgentConnector_ms": 0.06698155403137207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11525280, "num_agent_steps_trained": 11525280, "num_env_steps_sampled": 11525280, "num_env_steps_trained": 11525280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.858011235522, "num_env_steps_trained_throughput_per_sec": 711.858011235522, "timesteps_total": 11525280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11525280, "timers": {"training_iteration_time_ms": 61582.31, "sample_time_ms": 60408.101, "load_time_ms": 16.829, "load_throughput": 2609723.133, "learn_time_ms": 1156.268, "learn_throughput": 37984.268, "synch_weights_time_ms": 0.946}, "counters": {"num_env_steps_sampled": 11525280, "num_env_steps_trained": 11525280, "num_agent_steps_sampled": 11525280, "num_agent_steps_trained": 11525280}, "done": false, "episodes_total": 1453, "training_iteration": 574, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-37-01", "timestamp": 1691098621, "time_this_iter_s": 61.700929164886475, "time_total_s": 18495.132572174072, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7948.320060491562, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 17.68977272727273, "ram_util_percent": 63.589772727272724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.5124899638986, "policy_loss": -8.04536485103045e+20, "vf_loss": 301829537.0728863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88837.5, "diff_num_grad_updates_vs_sampler_policy": 88836.5}}, "num_env_steps_sampled": 11569200, "num_env_steps_trained": 11569200, "num_agent_steps_sampled": 11569200, "num_agent_steps_trained": 11569200}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352312.7661791877, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21542217004720282, "mean_inference_ms": 0.36698286488805, "mean_action_processing_ms": 0.08988951597045557, "mean_env_wait_ms": 0.6863087457797329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034813880920410156, "StateBufferConnector_ms": 0.002653360366821289, "ViewRequirementAgentConnector_ms": 0.0670320987701416}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352312.7661791877, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352055.1617353854, -1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21542217004720282, "mean_inference_ms": 0.36698286488805, "mean_action_processing_ms": 0.08988951597045557, "mean_env_wait_ms": 0.6863087457797329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034813880920410156, "StateBufferConnector_ms": 0.002653360366821289, "ViewRequirementAgentConnector_ms": 0.0670320987701416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11569200, "num_agent_steps_trained": 11569200, "num_env_steps_sampled": 11569200, "num_env_steps_trained": 11569200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.6179260627327, "num_env_steps_trained_throughput_per_sec": 713.6179260627327, "timesteps_total": 11569200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11569200, "timers": {"training_iteration_time_ms": 61577.745, "sample_time_ms": 60403.801, "load_time_ms": 16.749, "load_throughput": 2622279.613, "learn_time_ms": 1156.086, "learn_throughput": 37990.258, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 11569200, "num_env_steps_trained": 11569200, "num_agent_steps_sampled": 11569200, "num_agent_steps_trained": 11569200}, "done": false, "episodes_total": 1454, "training_iteration": 575, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-38-02", "timestamp": 1691098682, "time_this_iter_s": 61.54850101470947, "time_total_s": 18556.68107318878, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8009.868561506271, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 17.622988505747124, "ram_util_percent": 63.64942528735632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.5258545277766, "policy_loss": -8.038295840733582e+20, "vf_loss": 302268809.7842566}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 89523.5, "diff_num_grad_updates_vs_sampler_policy": 89522.5}}, "num_env_steps_sampled": 11613120, "num_env_steps_trained": 11613120, "num_agent_steps_sampled": 11613120, "num_agent_steps_trained": 11613120}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352293.184655673, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21543247161746212, "mean_inference_ms": 0.3669905452579942, "mean_action_processing_ms": 0.08989256471162625, "mean_env_wait_ms": 0.6862099888261711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034813880920410156, "StateBufferConnector_ms": 0.002652883529663086, "ViewRequirementAgentConnector_ms": 0.06703996658325195}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352293.184655673, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353411.257811352, -1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21543247161746212, "mean_inference_ms": 0.3669905452579942, "mean_action_processing_ms": 0.08989256471162625, "mean_env_wait_ms": 0.6862099888261711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034813880920410156, "StateBufferConnector_ms": 0.002652883529663086, "ViewRequirementAgentConnector_ms": 0.06703996658325195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11613120, "num_agent_steps_trained": 11613120, "num_env_steps_sampled": 11613120, "num_env_steps_trained": 11613120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.5673656449081, "num_env_steps_trained_throughput_per_sec": 717.5673656449081, "timesteps_total": 11613120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11613120, "timers": {"training_iteration_time_ms": 61535.522, "sample_time_ms": 60361.495, "load_time_ms": 16.87, "load_throughput": 2603394.216, "learn_time_ms": 1156.051, "learn_throughput": 37991.409, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 11613120, "num_env_steps_trained": 11613120, "num_agent_steps_sampled": 11613120, "num_agent_steps_trained": 11613120}, "done": false, "episodes_total": 1455, "training_iteration": 576, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-39-04", "timestamp": 1691098744, "time_this_iter_s": 61.21038222312927, "time_total_s": 18617.89145541191, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8071.078943729401, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 17.640697674418607, "ram_util_percent": 63.67325581395348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.5635432918982, "policy_loss": -8.213754981955222e+20, "vf_loss": 303052818.5947522}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90209.5, "diff_num_grad_updates_vs_sampler_policy": 90208.5}}, "num_env_steps_sampled": 11657040, "num_env_steps_trained": 11657040, "num_agent_steps_sampled": 11657040, "num_agent_steps_trained": 11657040}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352277.1747565889, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21544250593921885, "mean_inference_ms": 0.36699846588571733, "mean_action_processing_ms": 0.08989553378701869, "mean_env_wait_ms": 0.6861187242267239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487110137939453, "StateBufferConnector_ms": 0.0026504993438720703, "ViewRequirementAgentConnector_ms": 0.06701874732971191}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352277.1747565889, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1355946.2856900748, -1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21544250593921885, "mean_inference_ms": 0.36699846588571733, "mean_action_processing_ms": 0.08989553378701869, "mean_env_wait_ms": 0.6861187242267239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487110137939453, "StateBufferConnector_ms": 0.0026504993438720703, "ViewRequirementAgentConnector_ms": 0.06701874732971191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11657040, "num_agent_steps_trained": 11657040, "num_env_steps_sampled": 11657040, "num_env_steps_trained": 11657040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.6992825394223, "num_env_steps_trained_throughput_per_sec": 712.6992825394223, "timesteps_total": 11657040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11657040, "timers": {"training_iteration_time_ms": 61569.999, "sample_time_ms": 60399.173, "load_time_ms": 16.743, "load_throughput": 2623187.0, "learn_time_ms": 1152.975, "learn_throughput": 38092.76, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 11657040, "num_env_steps_trained": 11657040, "num_agent_steps_sampled": 11657040, "num_agent_steps_trained": 11657040}, "done": false, "episodes_total": 1456, "training_iteration": 577, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-40-05", "timestamp": 1691098805, "time_this_iter_s": 61.62786507606506, "time_total_s": 18679.519320487976, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8132.706808805466, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 17.526136363636365, "ram_util_percent": 63.632954545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.6118521732074, "policy_loss": -7.76402119803192e+20, "vf_loss": 304275802.34402335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90895.5, "diff_num_grad_updates_vs_sampler_policy": 90894.5}}, "num_env_steps_sampled": 11700960, "num_env_steps_trained": 11700960, "num_agent_steps_sampled": 11700960, "num_agent_steps_trained": 11700960}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352264.7161478908, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21545264283904636, "mean_inference_ms": 0.3670063933746644, "mean_action_processing_ms": 0.08989835355879988, "mean_env_wait_ms": 0.6860326520543094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003489255905151367, "StateBufferConnector_ms": 0.0026526451110839844, "ViewRequirementAgentConnector_ms": 0.06703615188598633}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352264.7161478908, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351779.8058900128, -1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21545264283904636, "mean_inference_ms": 0.3670063933746644, "mean_action_processing_ms": 0.08989835355879988, "mean_env_wait_ms": 0.6860326520543094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003489255905151367, "StateBufferConnector_ms": 0.0026526451110839844, "ViewRequirementAgentConnector_ms": 0.06703615188598633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11700960, "num_agent_steps_trained": 11700960, "num_env_steps_sampled": 11700960, "num_env_steps_trained": 11700960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.8544618603836, "num_env_steps_trained_throughput_per_sec": 715.8544618603836, "timesteps_total": 11700960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11700960, "timers": {"training_iteration_time_ms": 61537.179, "sample_time_ms": 60368.221, "load_time_ms": 16.72, "load_throughput": 2626856.546, "learn_time_ms": 1151.104, "learn_throughput": 38154.676, "synch_weights_time_ms": 0.963}, "counters": {"num_env_steps_sampled": 11700960, "num_env_steps_trained": 11700960, "num_agent_steps_sampled": 11700960, "num_agent_steps_trained": 11700960}, "done": false, "episodes_total": 1457, "training_iteration": 578, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-41-07", "timestamp": 1691098867, "time_this_iter_s": 61.35629320144653, "time_total_s": 18740.875613689423, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8194.063102006912, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 17.532558139534885, "ram_util_percent": 63.56744186046512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.6353234827693, "policy_loss": -7.819931270775597e+20, "vf_loss": 303007674.3556851}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91581.5, "diff_num_grad_updates_vs_sampler_policy": 91580.5}}, "num_env_steps_sampled": 11744880, "num_env_steps_trained": 11744880, "num_agent_steps_sampled": 11744880, "num_agent_steps_trained": 11744880}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352264.2742688125, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154627700831128, "mean_inference_ms": 0.3670140634056916, "mean_action_processing_ms": 0.08990108688918504, "mean_env_wait_ms": 0.6859501943733747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034911632537841797, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.06707763671875}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352264.2742688125, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352771.9562391299, -1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154627700831128, "mean_inference_ms": 0.3670140634056916, "mean_action_processing_ms": 0.08990108688918504, "mean_env_wait_ms": 0.6859501943733747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034911632537841797, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.06707763671875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11744880, "num_agent_steps_trained": 11744880, "num_env_steps_sampled": 11744880, "num_env_steps_trained": 11744880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.4660929665328, "num_env_steps_trained_throughput_per_sec": 715.4660929665328, "timesteps_total": 11744880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11744880, "timers": {"training_iteration_time_ms": 61526.828, "sample_time_ms": 60360.84, "load_time_ms": 16.699, "load_throughput": 2630063.158, "learn_time_ms": 1148.143, "learn_throughput": 38253.071, "synch_weights_time_ms": 0.975}, "counters": {"num_env_steps_sampled": 11744880, "num_env_steps_trained": 11744880, "num_agent_steps_sampled": 11744880, "num_agent_steps_trained": 11744880}, "done": false, "episodes_total": 1458, "training_iteration": 579, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-42-08", "timestamp": 1691098928, "time_this_iter_s": 61.389594316482544, "time_total_s": 18802.265208005905, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8255.452696323395, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 17.432183908045975, "ram_util_percent": 63.60229885057472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.670418519668, "policy_loss": -7.55990553410714e+20, "vf_loss": 301863590.8921283}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92267.5, "diff_num_grad_updates_vs_sampler_policy": 92266.5}}, "num_env_steps_sampled": 11788800, "num_env_steps_trained": 11788800, "num_agent_steps_sampled": 11788800, "num_agent_steps_trained": 11788800}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352229.5838128012, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21547264470447972, "mean_inference_ms": 0.36702164411095084, "mean_action_processing_ms": 0.08990378640548063, "mean_env_wait_ms": 0.6858723845209437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034940242767333984, "StateBufferConnector_ms": 0.002646207809448242, "ViewRequirementAgentConnector_ms": 0.06703782081604004}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352229.5838128012, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1348628.9521481635, -1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21547264470447972, "mean_inference_ms": 0.36702164411095084, "mean_action_processing_ms": 0.08990378640548063, "mean_env_wait_ms": 0.6858723845209437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034940242767333984, "StateBufferConnector_ms": 0.002646207809448242, "ViewRequirementAgentConnector_ms": 0.06703782081604004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11788800, "num_agent_steps_trained": 11788800, "num_env_steps_sampled": 11788800, "num_env_steps_trained": 11788800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.2308297173065, "num_env_steps_trained_throughput_per_sec": 717.2308297173065, "timesteps_total": 11788800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11788800, "timers": {"training_iteration_time_ms": 61495.979, "sample_time_ms": 60332.337, "load_time_ms": 16.884, "load_throughput": 2601309.76, "learn_time_ms": 1145.629, "learn_throughput": 38337.021, "synch_weights_time_ms": 0.959}, "counters": {"num_env_steps_sampled": 11788800, "num_env_steps_trained": 11788800, "num_agent_steps_sampled": 11788800, "num_agent_steps_trained": 11788800}, "done": false, "episodes_total": 1459, "training_iteration": 580, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-43-09", "timestamp": 1691098989, "time_this_iter_s": 61.23904800415039, "time_total_s": 18863.504256010056, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8316.691744327545, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 17.410344827586208, "ram_util_percent": 63.632183908045974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.685124433423, "policy_loss": -7.818760305268636e+20, "vf_loss": 305292028.64139944}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92953.5, "diff_num_grad_updates_vs_sampler_policy": 92952.5}}, "num_env_steps_sampled": 11832720, "num_env_steps_trained": 11832720, "num_agent_steps_sampled": 11832720, "num_agent_steps_trained": 11832720}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352310.5441527124, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154827844761673, "mean_inference_ms": 0.36702910695138613, "mean_action_processing_ms": 0.08990636040858456, "mean_env_wait_ms": 0.6857995729104843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034880638122558594, "StateBufferConnector_ms": 0.00264739990234375, "ViewRequirementAgentConnector_ms": 0.067047119140625}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352310.5441527124, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351080.6121338895, -1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154827844761673, "mean_inference_ms": 0.36702910695138613, "mean_action_processing_ms": 0.08990636040858456, "mean_env_wait_ms": 0.6857995729104843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034880638122558594, "StateBufferConnector_ms": 0.00264739990234375, "ViewRequirementAgentConnector_ms": 0.067047119140625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11832720, "num_agent_steps_trained": 11832720, "num_env_steps_sampled": 11832720, "num_env_steps_trained": 11832720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.3495676017266, "num_env_steps_trained_throughput_per_sec": 717.3495676017266, "timesteps_total": 11832720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11832720, "timers": {"training_iteration_time_ms": 61446.476, "sample_time_ms": 60285.082, "load_time_ms": 16.823, "load_throughput": 2610662.547, "learn_time_ms": 1143.444, "learn_throughput": 38410.276, "synch_weights_time_ms": 0.957}, "counters": {"num_env_steps_sampled": 11832720, "num_env_steps_trained": 11832720, "num_agent_steps_sampled": 11832720, "num_agent_steps_trained": 11832720}, "done": false, "episodes_total": 1460, "training_iteration": 581, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-44-11", "timestamp": 1691099051, "time_this_iter_s": 61.228644132614136, "time_total_s": 18924.73290014267, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8377.92038846016, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 18.408045977011493, "ram_util_percent": 63.6471264367816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.7340596813501, "policy_loss": -7.977975486571512e+20, "vf_loss": 303590689.5218659}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93639.5, "diff_num_grad_updates_vs_sampler_policy": 93638.5}}, "num_env_steps_sampled": 11876640, "num_env_steps_trained": 11876640, "num_agent_steps_sampled": 11876640, "num_agent_steps_trained": 11876640}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352331.0025975425, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154923794910472, "mean_inference_ms": 0.3670362087648489, "mean_action_processing_ms": 0.08990874059030098, "mean_env_wait_ms": 0.6857285113784305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487825393676758, "StateBufferConnector_ms": 0.002653837203979492, "ViewRequirementAgentConnector_ms": 0.06704282760620117}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352331.0025975425, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351277.942787842, -1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154923794910472, "mean_inference_ms": 0.3670362087648489, "mean_action_processing_ms": 0.08990874059030098, "mean_env_wait_ms": 0.6857285113784305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003487825393676758, "StateBufferConnector_ms": 0.002653837203979492, "ViewRequirementAgentConnector_ms": 0.06704282760620117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11876640, "num_agent_steps_trained": 11876640, "num_env_steps_sampled": 11876640, "num_env_steps_trained": 11876640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.7626184113246, "num_env_steps_trained_throughput_per_sec": 716.7626184113246, "timesteps_total": 11876640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11876640, "timers": {"training_iteration_time_ms": 61381.398, "sample_time_ms": 60225.116, "load_time_ms": 16.887, "load_throughput": 2600876.377, "learn_time_ms": 1138.268, "learn_throughput": 38584.928, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 11876640, "num_env_steps_trained": 11876640, "num_agent_steps_sampled": 11876640, "num_agent_steps_trained": 11876640}, "done": false, "episodes_total": 1461, "training_iteration": 582, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-45-12", "timestamp": 1691099112, "time_this_iter_s": 61.2785120010376, "time_total_s": 18986.011412143707, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8439.198900461197, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 20.620689655172413, "ram_util_percent": 62.71724137931036}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.7625109614157, "policy_loss": -7.648766392285047e+20, "vf_loss": 302788087.5860058}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 94325.5, "diff_num_grad_updates_vs_sampler_policy": 94324.5}}, "num_env_steps_sampled": 11920560, "num_env_steps_trained": 11920560, "num_agent_steps_sampled": 11920560, "num_agent_steps_trained": 11920560}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352331.577026614, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21550112977984429, "mean_inference_ms": 0.3670428988136807, "mean_action_processing_ms": 0.08991094205581453, "mean_env_wait_ms": 0.6856587762326077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034880638122558594, "StateBufferConnector_ms": 0.002649068832397461, "ViewRequirementAgentConnector_ms": 0.06703376770019531}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352331.577026614, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352133.0927386133, -1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21550112977984429, "mean_inference_ms": 0.3670428988136807, "mean_action_processing_ms": 0.08991094205581453, "mean_env_wait_ms": 0.6856587762326077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034880638122558594, "StateBufferConnector_ms": 0.002649068832397461, "ViewRequirementAgentConnector_ms": 0.06703376770019531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11920560, "num_agent_steps_trained": 11920560, "num_env_steps_sampled": 11920560, "num_env_steps_trained": 11920560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.2622185477408, "num_env_steps_trained_throughput_per_sec": 718.2622185477408, "timesteps_total": 11920560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11920560, "timers": {"training_iteration_time_ms": 61369.85, "sample_time_ms": 60215.048, "load_time_ms": 16.998, "load_throughput": 2583861.639, "learn_time_ms": 1136.664, "learn_throughput": 38639.391, "synch_weights_time_ms": 0.971}, "counters": {"num_env_steps_sampled": 11920560, "num_env_steps_trained": 11920560, "num_agent_steps_sampled": 11920560, "num_agent_steps_trained": 11920560}, "done": false, "episodes_total": 1462, "training_iteration": 583, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-46-13", "timestamp": 1691099173, "time_this_iter_s": 61.150628089904785, "time_total_s": 19047.162040233612, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8500.349528551102, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 17.734883720930235, "ram_util_percent": 62.650000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.7917291846984, "policy_loss": -7.985890813509289e+20, "vf_loss": 303338545.7259475}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95011.5, "diff_num_grad_updates_vs_sampler_policy": 95010.5}}, "num_env_steps_sampled": 11964480, "num_env_steps_trained": 11964480, "num_agent_steps_sampled": 11964480, "num_agent_steps_trained": 11964480}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352333.0933991962, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21550950917122885, "mean_inference_ms": 0.3670483105955173, "mean_action_processing_ms": 0.08991309171912047, "mean_env_wait_ms": 0.6855921082911022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034911632537841797, "StateBufferConnector_ms": 0.002635955810546875, "ViewRequirementAgentConnector_ms": 0.06701970100402832}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352333.0933991962, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1349435.7907848314, -1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21550950917122885, "mean_inference_ms": 0.3670483105955173, "mean_action_processing_ms": 0.08991309171912047, "mean_env_wait_ms": 0.6855921082911022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034911632537841797, "StateBufferConnector_ms": 0.002635955810546875, "ViewRequirementAgentConnector_ms": 0.06701970100402832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11964480, "num_agent_steps_trained": 11964480, "num_env_steps_sampled": 11964480, "num_env_steps_trained": 11964480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.0077048836667, "num_env_steps_trained_throughput_per_sec": 718.0077048836667, "timesteps_total": 11964480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11964480, "timers": {"training_iteration_time_ms": 61317.006, "sample_time_ms": 60167.565, "load_time_ms": 16.948, "load_throughput": 2591469.496, "learn_time_ms": 1131.366, "learn_throughput": 38820.344, "synch_weights_time_ms": 0.957}, "counters": {"num_env_steps_sampled": 11964480, "num_env_steps_trained": 11964480, "num_agent_steps_sampled": 11964480, "num_agent_steps_trained": 11964480}, "done": false, "episodes_total": 1463, "training_iteration": 584, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-47-14", "timestamp": 1691099234, "time_this_iter_s": 61.1722457408905, "time_total_s": 19108.334285974503, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8561.521774291992, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 17.72298850574713, "ram_util_percent": 62.58850574712645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.826396085778, "policy_loss": -8.166611260021249e+20, "vf_loss": 303701353.20116615}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95697.5, "diff_num_grad_updates_vs_sampler_policy": 95696.5}}, "num_env_steps_sampled": 12008400, "num_env_steps_trained": 12008400, "num_agent_steps_sampled": 12008400, "num_agent_steps_trained": 12008400}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352372.3592348644, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21551745041903328, "mean_inference_ms": 0.3670536005750209, "mean_action_processing_ms": 0.08991518391504813, "mean_env_wait_ms": 0.6855262224923837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003488302230834961, "StateBufferConnector_ms": 0.0026357173919677734, "ViewRequirementAgentConnector_ms": 0.0670173168182373}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352372.3592348644, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352118.244143409, -1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21551745041903328, "mean_inference_ms": 0.3670536005750209, "mean_action_processing_ms": 0.08991518391504813, "mean_env_wait_ms": 0.6855262224923837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003488302230834961, "StateBufferConnector_ms": 0.0026357173919677734, "ViewRequirementAgentConnector_ms": 0.0670173168182373}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12008400, "num_agent_steps_trained": 12008400, "num_env_steps_sampled": 12008400, "num_env_steps_trained": 12008400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.1166103697827, "num_env_steps_trained_throughput_per_sec": 713.1166103697827, "timesteps_total": 12008400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12008400, "timers": {"training_iteration_time_ms": 61321.333, "sample_time_ms": 60171.832, "load_time_ms": 17.079, "load_throughput": 2571590.549, "learn_time_ms": 1131.292, "learn_throughput": 38822.853, "synch_weights_time_ms": 0.959}, "counters": {"num_env_steps_sampled": 12008400, "num_env_steps_trained": 12008400, "num_agent_steps_sampled": 12008400, "num_agent_steps_trained": 12008400}, "done": false, "episodes_total": 1464, "training_iteration": 585, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-48-16", "timestamp": 1691099296, "time_this_iter_s": 61.59219527244568, "time_total_s": 19169.92648124695, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8623.113969564438, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 17.40804597701149, "ram_util_percent": 62.651724137931055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.8612914683172, "policy_loss": -7.71516740130055e+20, "vf_loss": 303253989.49854225}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 96383.5, "diff_num_grad_updates_vs_sampler_policy": 96382.5}}, "num_env_steps_sampled": 12052320, "num_env_steps_trained": 12052320, "num_agent_steps_sampled": 12052320, "num_agent_steps_trained": 12052320}, "sampler_results": {"episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352374.7365781036, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21552510716169226, "mean_inference_ms": 0.3670590298206758, "mean_action_processing_ms": 0.0899171914156538, "mean_env_wait_ms": 0.6854625853267976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034933090209960938, "StateBufferConnector_ms": 0.0026350021362304688, "ViewRequirementAgentConnector_ms": 0.06705641746520996}}, "episode_reward_max": -1348238.5041661141, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352374.7365781036, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1356438.3308611184, -1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21552510716169226, "mean_inference_ms": 0.3670590298206758, "mean_action_processing_ms": 0.0899171914156538, "mean_env_wait_ms": 0.6854625853267976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034933090209960938, "StateBufferConnector_ms": 0.0026350021362304688, "ViewRequirementAgentConnector_ms": 0.06705641746520996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12052320, "num_agent_steps_trained": 12052320, "num_env_steps_sampled": 12052320, "num_env_steps_trained": 12052320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.1950214078422, "num_env_steps_trained_throughput_per_sec": 714.1950214078422, "timesteps_total": 12052320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12052320, "timers": {"training_iteration_time_ms": 61350.234, "sample_time_ms": 60200.584, "load_time_ms": 16.998, "load_throughput": 2583829.021, "learn_time_ms": 1131.511, "learn_throughput": 38815.346, "synch_weights_time_ms": 0.97}, "counters": {"num_env_steps_sampled": 12052320, "num_env_steps_trained": 12052320, "num_agent_steps_sampled": 12052320, "num_agent_steps_trained": 12052320}, "done": false, "episodes_total": 1465, "training_iteration": 586, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-49-17", "timestamp": 1691099357, "time_this_iter_s": 61.49898862838745, "time_total_s": 19231.425469875336, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8684.612958192825, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 17.404597701149427, "ram_util_percent": 62.71264367816091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.9063500051248, "policy_loss": -7.835847724946986e+20, "vf_loss": 301331286.96209913}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97069.5, "diff_num_grad_updates_vs_sampler_policy": 97068.5}}, "num_env_steps_sampled": 12096240, "num_env_steps_trained": 12096240, "num_agent_steps_sampled": 12096240, "num_agent_steps_trained": 12096240}, "sampler_results": {"episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352292.570866872, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21553242057234073, "mean_inference_ms": 0.36706465380757414, "mean_action_processing_ms": 0.08991920008397748, "mean_env_wait_ms": 0.6854007761439886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034935474395751953, "StateBufferConnector_ms": 0.0026366710662841797, "ViewRequirementAgentConnector_ms": 0.06705355644226074}}, "episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352292.570866872, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352081.3763226883, -1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21553242057234073, "mean_inference_ms": 0.36706465380757414, "mean_action_processing_ms": 0.08991920008397748, "mean_env_wait_ms": 0.6854007761439886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034935474395751953, "StateBufferConnector_ms": 0.0026366710662841797, "ViewRequirementAgentConnector_ms": 0.06705355644226074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12096240, "num_agent_steps_trained": 12096240, "num_env_steps_sampled": 12096240, "num_env_steps_trained": 12096240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.8211200944505, "num_env_steps_trained_throughput_per_sec": 714.8211200944505, "timesteps_total": 12096240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12096240, "timers": {"training_iteration_time_ms": 61331.942, "sample_time_ms": 60182.298, "load_time_ms": 16.967, "load_throughput": 2588625.401, "learn_time_ms": 1131.534, "learn_throughput": 38814.569, "synch_weights_time_ms": 0.973}, "counters": {"num_env_steps_sampled": 12096240, "num_env_steps_trained": 12096240, "num_agent_steps_sampled": 12096240, "num_agent_steps_trained": 12096240}, "done": false, "episodes_total": 1466, "training_iteration": 587, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-50-19", "timestamp": 1691099419, "time_this_iter_s": 61.44492697715759, "time_total_s": 19292.870396852493, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8746.057885169983, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 16.750574712643683, "ram_util_percent": 62.728735632183906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.9143760391992, "policy_loss": -8.008659141294943e+20, "vf_loss": 304009358.81632656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97755.5, "diff_num_grad_updates_vs_sampler_policy": 97754.5}}, "num_env_steps_sampled": 12140160, "num_env_steps_trained": 12140160, "num_agent_steps_sampled": 12140160, "num_agent_steps_trained": 12140160}, "sampler_results": {"episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352310.5462151077, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21554047407968052, "mean_inference_ms": 0.3670702872263009, "mean_action_processing_ms": 0.0899212070496931, "mean_env_wait_ms": 0.6853408877558865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034942626953125, "StateBufferConnector_ms": 0.002640962600708008, "ViewRequirementAgentConnector_ms": 0.06704306602478027}}, "episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352310.5462151077, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352988.816095553, -1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21554047407968052, "mean_inference_ms": 0.3670702872263009, "mean_action_processing_ms": 0.0899212070496931, "mean_env_wait_ms": 0.6853408877558865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034942626953125, "StateBufferConnector_ms": 0.002640962600708008, "ViewRequirementAgentConnector_ms": 0.06704306602478027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12140160, "num_agent_steps_trained": 12140160, "num_env_steps_sampled": 12140160, "num_env_steps_trained": 12140160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.7892230109026, "num_env_steps_trained_throughput_per_sec": 714.7892230109026, "timesteps_total": 12140160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12140160, "timers": {"training_iteration_time_ms": 61341.086, "sample_time_ms": 60192.594, "load_time_ms": 17.068, "load_throughput": 2573203.421, "learn_time_ms": 1130.292, "learn_throughput": 38857.21, "synch_weights_time_ms": 0.965}, "counters": {"num_env_steps_sampled": 12140160, "num_env_steps_trained": 12140160, "num_agent_steps_sampled": 12140160, "num_agent_steps_trained": 12140160}, "done": false, "episodes_total": 1467, "training_iteration": 588, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-51-20", "timestamp": 1691099480, "time_this_iter_s": 61.447540044784546, "time_total_s": 19354.317936897278, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8807.505425214767, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 17.829885057471262, "ram_util_percent": 62.78735632183906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.9792382598966, "policy_loss": -8.922772157092081e+20, "vf_loss": 304295993.44023323}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 98441.5, "diff_num_grad_updates_vs_sampler_policy": 98440.5}}, "num_env_steps_sampled": 12184080, "num_env_steps_trained": 12184080, "num_agent_steps_sampled": 12184080, "num_agent_steps_trained": 12184080}, "sampler_results": {"episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352328.3224156278, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2155482269183411, "mean_inference_ms": 0.3670760069493824, "mean_action_processing_ms": 0.0899231404877476, "mean_env_wait_ms": 0.6852832826732049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034971237182617188, "StateBufferConnector_ms": 0.002641439437866211, "ViewRequirementAgentConnector_ms": 0.06705999374389648}}, "episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352328.3224156278, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350104.7887930474, -1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2155482269183411, "mean_inference_ms": 0.3670760069493824, "mean_action_processing_ms": 0.0899231404877476, "mean_env_wait_ms": 0.6852832826732049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034971237182617188, "StateBufferConnector_ms": 0.002641439437866211, "ViewRequirementAgentConnector_ms": 0.06705999374389648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12184080, "num_agent_steps_trained": 12184080, "num_env_steps_sampled": 12184080, "num_env_steps_trained": 12184080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.1316167901105, "num_env_steps_trained_throughput_per_sec": 710.1316167901105, "timesteps_total": 12184080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12184080, "timers": {"training_iteration_time_ms": 61387.199, "sample_time_ms": 60236.613, "load_time_ms": 17.07, "load_throughput": 2572915.902, "learn_time_ms": 1132.395, "learn_throughput": 38785.036, "synch_weights_time_ms": 0.954}, "counters": {"num_env_steps_sampled": 12184080, "num_env_steps_trained": 12184080, "num_agent_steps_sampled": 12184080, "num_agent_steps_trained": 12184080}, "done": false, "episodes_total": 1468, "training_iteration": 589, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-52-22", "timestamp": 1691099542, "time_this_iter_s": 61.85071587562561, "time_total_s": 19416.168652772903, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8869.356141090393, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 17.527272727272727, "ram_util_percent": 62.829545454545446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1746.9841648468819, "policy_loss": -7.921731535663263e+20, "vf_loss": 304162172.05247813}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99127.5, "diff_num_grad_updates_vs_sampler_policy": 99126.5}}, "num_env_steps_sampled": 12228000, "num_env_steps_trained": 12228000, "num_agent_steps_sampled": 12228000, "num_agent_steps_trained": 12228000}, "sampler_results": {"episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352370.8330021861, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21555592300690027, "mean_inference_ms": 0.36708197003677717, "mean_action_processing_ms": 0.08992502960301675, "mean_env_wait_ms": 0.6852275630092701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495931625366211, "StateBufferConnector_ms": 0.0026443004608154297, "ViewRequirementAgentConnector_ms": 0.06703567504882812}}, "episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352370.8330021861, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352800.1909600974, -1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21555592300690027, "mean_inference_ms": 0.36708197003677717, "mean_action_processing_ms": 0.08992502960301675, "mean_env_wait_ms": 0.6852275630092701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495931625366211, "StateBufferConnector_ms": 0.0026443004608154297, "ViewRequirementAgentConnector_ms": 0.06703567504882812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12228000, "num_agent_steps_trained": 12228000, "num_env_steps_sampled": 12228000, "num_env_steps_trained": 12228000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.3417882196624, "num_env_steps_trained_throughput_per_sec": 710.3417882196624, "timesteps_total": 12228000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12228000, "timers": {"training_iteration_time_ms": 61446.587, "sample_time_ms": 60297.797, "load_time_ms": 16.895, "load_throughput": 2599610.111, "learn_time_ms": 1130.776, "learn_throughput": 38840.596, "synch_weights_time_ms": 0.953}, "counters": {"num_env_steps_sampled": 12228000, "num_env_steps_trained": 12228000, "num_agent_steps_sampled": 12228000, "num_agent_steps_trained": 12228000}, "done": false, "episodes_total": 1469, "training_iteration": 590, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-53-24", "timestamp": 1691099604, "time_this_iter_s": 61.83226680755615, "time_total_s": 19478.00091958046, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8931.18840789795, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 17.535632183908046, "ram_util_percent": 62.87586206896552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1747.0301056353067, "policy_loss": -8.013994341176096e+20, "vf_loss": 302777912.6705539}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99813.5, "diff_num_grad_updates_vs_sampler_policy": 99812.5}}, "num_env_steps_sampled": 12271920, "num_env_steps_trained": 12271920, "num_agent_steps_sampled": 12271920, "num_agent_steps_trained": 12271920}, "sampler_results": {"episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352354.910233355, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21556316874588188, "mean_inference_ms": 0.36708765125650955, "mean_action_processing_ms": 0.08992682325711188, "mean_env_wait_ms": 0.6851736185807233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034961700439453125, "StateBufferConnector_ms": 0.002641916275024414, "ViewRequirementAgentConnector_ms": 0.06704497337341309}}, "episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357359.7262326872, "episode_reward_mean": -1352354.910233355, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350960.0461323499, -1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21556316874588188, "mean_inference_ms": 0.36708765125650955, "mean_action_processing_ms": 0.08992682325711188, "mean_env_wait_ms": 0.6851736185807233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034961700439453125, "StateBufferConnector_ms": 0.002641916275024414, "ViewRequirementAgentConnector_ms": 0.06704497337341309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12271920, "num_agent_steps_trained": 12271920, "num_env_steps_sampled": 12271920, "num_env_steps_trained": 12271920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.3577029143871, "num_env_steps_trained_throughput_per_sec": 711.3577029143871, "timesteps_total": 12271920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12271920, "timers": {"training_iteration_time_ms": 61498.158, "sample_time_ms": 60347.004, "load_time_ms": 16.817, "load_throughput": 2611695.201, "learn_time_ms": 1133.218, "learn_throughput": 38756.89, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 12271920, "num_env_steps_trained": 12271920, "num_agent_steps_sampled": 12271920, "num_agent_steps_trained": 12271920}, "done": false, "episodes_total": 1470, "training_iteration": 591, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-54-26", "timestamp": 1691099666, "time_this_iter_s": 61.743571043014526, "time_total_s": 19539.744490623474, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8992.931978940964, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 17.938636363636363, "ram_util_percent": 62.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.98615664845173e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1747.0612684422263, "policy_loss": -8.72530314049976e+20, "vf_loss": 305431588.2973761}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 100499.5, "diff_num_grad_updates_vs_sampler_policy": 100498.5}}, "num_env_steps_sampled": 12315840, "num_env_steps_trained": 12315840, "num_agent_steps_sampled": 12315840, "num_agent_steps_trained": 12315840}, "sampler_results": {"episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357436.602329438, "episode_reward_mean": -1352419.6757953255, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308, -1357436.602329438], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2155698421123611, "mean_inference_ms": 0.36709336964973505, "mean_action_processing_ms": 0.08992855042459075, "mean_env_wait_ms": 0.685121543240163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034956932067871094, "StateBufferConnector_ms": 0.002642393112182617, "ViewRequirementAgentConnector_ms": 0.06705260276794434}}, "episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357436.602329438, "episode_reward_mean": -1352419.6757953255, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353477.4502721434, -1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308, -1357436.602329438], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2155698421123611, "mean_inference_ms": 0.36709336964973505, "mean_action_processing_ms": 0.08992855042459075, "mean_env_wait_ms": 0.685121543240163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034956932067871094, "StateBufferConnector_ms": 0.002642393112182617, "ViewRequirementAgentConnector_ms": 0.06705260276794434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12315840, "num_agent_steps_trained": 12315840, "num_env_steps_sampled": 12315840, "num_env_steps_trained": 12315840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.0028040354539, "num_env_steps_trained_throughput_per_sec": 711.0028040354539, "timesteps_total": 12315840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12315840, "timers": {"training_iteration_time_ms": 61547.797, "sample_time_ms": 60395.235, "load_time_ms": 16.721, "load_throughput": 2626658.031, "learn_time_ms": 1134.7, "learn_throughput": 38706.27, "synch_weights_time_ms": 0.978}, "counters": {"num_env_steps_sampled": 12315840, "num_env_steps_trained": 12315840, "num_agent_steps_sampled": 12315840, "num_agent_steps_trained": 12315840}, "done": false, "episodes_total": 1471, "training_iteration": 592, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-55-28", "timestamp": 1691099728, "time_this_iter_s": 61.774803161621094, "time_total_s": 19601.519293785095, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9054.706782102585, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 17.28620689655172, "ram_util_percent": 62.89080459770115}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5861566484517305e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1747.0776328039587, "policy_loss": -8.424009091697926e+20, "vf_loss": 302092019.7842566}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101185.5, "diff_num_grad_updates_vs_sampler_policy": 101184.5}}, "num_env_steps_sampled": 12359760, "num_env_steps_trained": 12359760, "num_agent_steps_sampled": 12359760, "num_agent_steps_trained": 12359760}, "sampler_results": {"episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357436.602329438, "episode_reward_mean": -1352381.677351765, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308, -1357436.602329438, -1349677.6059161117], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21557608529850558, "mean_inference_ms": 0.36709898176569844, "mean_action_processing_ms": 0.08993024874939362, "mean_env_wait_ms": 0.6850709625285909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498077392578125, "StateBufferConnector_ms": 0.0026421546936035156, "ViewRequirementAgentConnector_ms": 0.06705880165100098}}, "episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357436.602329438, "episode_reward_mean": -1352381.677351765, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350323.5985212235, -1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308, -1357436.602329438, -1349677.6059161117], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21557608529850558, "mean_inference_ms": 0.36709898176569844, "mean_action_processing_ms": 0.08993024874939362, "mean_env_wait_ms": 0.6850709625285909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003498077392578125, "StateBufferConnector_ms": 0.0026421546936035156, "ViewRequirementAgentConnector_ms": 0.06705880165100098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12359760, "num_agent_steps_trained": 12359760, "num_env_steps_sampled": 12359760, "num_env_steps_trained": 12359760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.9557626975924, "num_env_steps_trained_throughput_per_sec": 714.9557626975924, "timesteps_total": 12359760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12359760, "timers": {"training_iteration_time_ms": 61576.075, "sample_time_ms": 60424.628, "load_time_ms": 16.672, "load_throughput": 2634316.933, "learn_time_ms": 1133.646, "learn_throughput": 38742.259, "synch_weights_time_ms": 0.966}, "counters": {"num_env_steps_sampled": 12359760, "num_env_steps_trained": 12359760, "num_agent_steps_sampled": 12359760, "num_agent_steps_trained": 12359760}, "done": false, "episodes_total": 1472, "training_iteration": 593, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-56-29", "timestamp": 1691099789, "time_this_iter_s": 61.43340229988098, "time_total_s": 19662.952696084976, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9116.140184402466, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 17.202298850574717, "ram_util_percent": 62.916091954022974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.18615664845173e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1747.1141030002962, "policy_loss": -7.932974153169312e+20, "vf_loss": 304126898.4198251}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101871.5, "diff_num_grad_updates_vs_sampler_policy": 101870.5}}, "num_env_steps_sampled": 12403680, "num_env_steps_trained": 12403680, "num_agent_steps_sampled": 12403680, "num_agent_steps_trained": 12403680}, "sampler_results": {"episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357436.602329438, "episode_reward_mean": -1352424.1011844361, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308, -1357436.602329438, -1349677.6059161117, -1354565.981788306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21558214687919064, "mean_inference_ms": 0.36710406506298404, "mean_action_processing_ms": 0.08993187692700463, "mean_env_wait_ms": 0.685020639094916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495454788208008, "StateBufferConnector_ms": 0.0026421546936035156, "ViewRequirementAgentConnector_ms": 0.0670478343963623}}, "episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357436.602329438, "episode_reward_mean": -1352424.1011844361, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352732.9845813934, -1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308, -1357436.602329438, -1349677.6059161117, -1354565.981788306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21558214687919064, "mean_inference_ms": 0.36710406506298404, "mean_action_processing_ms": 0.08993187692700463, "mean_env_wait_ms": 0.685020639094916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003495454788208008, "StateBufferConnector_ms": 0.0026421546936035156, "ViewRequirementAgentConnector_ms": 0.0670478343963623}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12403680, "num_agent_steps_trained": 12403680, "num_env_steps_sampled": 12403680, "num_env_steps_trained": 12403680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.8976236747746, "num_env_steps_trained_throughput_per_sec": 714.8976236747746, "timesteps_total": 12403680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12403680, "timers": {"training_iteration_time_ms": 61602.687, "sample_time_ms": 60452.023, "load_time_ms": 16.606, "load_throughput": 2644785.866, "learn_time_ms": 1132.925, "learn_throughput": 38766.903, "synch_weights_time_ms": 0.971}, "counters": {"num_env_steps_sampled": 12403680, "num_env_steps_trained": 12403680, "num_agent_steps_sampled": 12403680, "num_agent_steps_trained": 12403680}, "done": false, "episodes_total": 1473, "training_iteration": 594, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-57-31", "timestamp": 1691099851, "time_this_iter_s": 61.43829393386841, "time_total_s": 19724.390990018845, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9177.578478336334, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 17.275862068965516, "ram_util_percent": 62.906896551724124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.786156648451732e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1747.142425804027, "policy_loss": -8.477285222987718e+20, "vf_loss": 301632760.9446064}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 102557.5, "diff_num_grad_updates_vs_sampler_policy": 102556.5}}, "num_env_steps_sampled": 12447600, "num_env_steps_trained": 12447600, "num_agent_steps_sampled": 12447600, "num_agent_steps_trained": 12447600}, "sampler_results": {"episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357436.602329438, "episode_reward_mean": -1352384.4006244203, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308, -1357436.602329438, -1349677.6059161117, -1354565.981788306, -1348762.9285798091], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21558753866846544, "mean_inference_ms": 0.36710915608644723, "mean_action_processing_ms": 0.08993346287012377, "mean_env_wait_ms": 0.6849716852145934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034956932067871094, "StateBufferConnector_ms": 0.0026466846466064453, "ViewRequirementAgentConnector_ms": 0.06702661514282227}}, "episode_reward_max": -1348221.7597379887, "episode_reward_min": -1357436.602329438, "episode_reward_mean": -1352384.4006244203, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1349936.720056594, -1350728.5700857893, -1352523.3325348468, -1354905.4321583074, -1350532.1092729883, -1353435.684430431, -1353483.345789234, -1350841.419162035, -1354361.3807061634, -1354257.3002329257, -1355477.897440591, -1350802.9786357817, -1351244.9975839604, -1355417.3383315173, -1350003.625607311, -1352296.1409959777, -1350066.0232628745, -1349530.9917499127, -1354120.8740357894, -1351480.2221837197, -1352872.2508574184, -1353378.142017367, -1352294.9054056276, -1353123.450280141, -1352643.7702562988, -1349640.2047369143, -1354408.5064768577, -1349628.9521333838, -1353460.143966657, -1353197.2681919117, -1353882.2053059523, -1354967.1211583682, -1348238.5041661141, -1353539.6211995918, -1353453.92920142, -1352727.626081201, -1354006.1772786921, -1351551.4958725173, -1352283.4025290725, -1352480.0917188476, -1351305.1060357285, -1352245.6747053568, -1354862.0396392506, -1352229.6924590387, -1354640.2158496005, -1351331.9609053188, -1349642.9795948367, -1354046.2273579368, -1355344.8186337394, -1350679.7661361808, -1351288.5165133814, -1348995.481513432, -1351381.9716344352, -1355510.6742591674, -1350986.1330784322, -1351378.9707493065, -1349135.237000432, -1351726.3807121543, -1355906.0657947753, -1354508.0010903073, -1353133.4692431227, -1355402.4857696125, -1352775.3632749314, -1352368.2098262936, -1350464.8810808507, -1349220.1642502907, -1353849.6556240704, -1350684.8956493489, -1351087.092072528, -1351627.9687172356, -1350438.6574669466, -1357359.7262326872, -1350244.1795387724, -1348535.6900386834, -1351028.0658294382, -1352494.7107161991, -1355448.7524469849, -1354918.8078163578, -1354113.658875328, -1349163.4320528721, -1350097.009383943, -1351810.2679029128, -1354700.4248202376, -1351735.617982191, -1349302.910637999, -1356724.9861392905, -1353126.4566168648, -1351335.3856949897, -1352284.7299968498, -1353362.3743516607, -1352355.9784673308, -1348221.7597379887, -1353878.9111462405, -1354766.436147571, -1354355.8474488966, -1351207.9140769308, -1357436.602329438, -1349677.6059161117, -1354565.981788306, -1348762.9285798091], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21558753866846544, "mean_inference_ms": 0.36710915608644723, "mean_action_processing_ms": 0.08993346287012377, "mean_env_wait_ms": 0.6849716852145934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034956932067871094, "StateBufferConnector_ms": 0.0026466846466064453, "ViewRequirementAgentConnector_ms": 0.06702661514282227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12447600, "num_agent_steps_trained": 12447600, "num_env_steps_sampled": 12447600, "num_env_steps_trained": 12447600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.7727027190315, "num_env_steps_trained_throughput_per_sec": 715.7727027190315, "timesteps_total": 12447600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12447600, "timers": {"training_iteration_time_ms": 61579.832, "sample_time_ms": 60428.887, "load_time_ms": 16.594, "load_throughput": 2646685.809, "learn_time_ms": 1133.219, "learn_throughput": 38756.838, "synch_weights_time_ms": 0.97}, "counters": {"num_env_steps_sampled": 12447600, "num_env_steps_trained": 12447600, "num_agent_steps_sampled": 12447600, "num_agent_steps_trained": 12447600}, "done": true, "episodes_total": 1474, "training_iteration": 595, "trial_id": "5bc4e_00000", "date": "2023-08-04_00-58-32", "timestamp": 1691099912, "time_this_iter_s": 61.36323928833008, "time_total_s": 19785.754229307175, "pid": 30971, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[7000000, 5e-08], [7439200, 8e-08], [7878400, 2.5e-08], [8317600, 2.5e-08], [8756800, 2.5e-08], [9196000, 2.5e-08], [9635200, 1e-08], [10074400, 1e-08], [10513600, 1e-08], [10952800, 5e-09], [11392000, 5e-09], [11831200, 5e-09], [12270400, 5e-09], [12709600, 1e-09], [13148800, 1e-09], [13588000, 1e-09], [14027200, 1e-09], [14466400, 5e-10], [14905600, 5e-10], [15344800, 2.5e-10], [15784000, 2.5e-10], [16223200, 1e-09], [16662400, 1e-11], [17101600, 5e-12], [17540800, 5e-12], [17980000, 1e-12]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 7095160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x318339b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9238.941717624664, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 17.664367816091954, "ram_util_percent": 62.840229885057454}}
